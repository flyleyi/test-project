{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[\"chunk-6ac39367\"],{\"05f4\":function(e,t,a){\"use strict\";var n=(a(\"5466\"),a(\"450d\"),a(\"ecdf\")),r=a.n(n),o=(a(\"38a0\"),a(\"ad41\")),i=a.n(o),s=(a(\"1951\"),a(\"eedf\")),l=a.n(s),u=(a(\"a9e3\"),{headers:{type:Array,default:function(){return[]}},data:{type:Array,default:function(){return[]}},height:{type:[Number,String]},maxHeight:{type:[Number,String]},border:{type:Boolean,default:!1},stripe:{type:Boolean,default:!1},size:{type:String,default:\"medium\"},fit:{type:Boolean,default:!0},showHeader:{type:Boolean,default:!0},highlightCurrentRow:{type:Boolean,default:!0},currentRowKey:{type:[String,Number]},rowClassName:{type:[Function,String]},rowStyle:{type:[Function,Object]},cellClassName:{type:[Function,String]},cellStyle:{type:[Function,Object]},headerRowClassName:{type:[Function,String]},headerRowStyle:{type:[Function,Object]},headerCellClassName:{type:[Function,String]},headerCellStyle:{type:[Function,Object]},rowKey:{type:[Function,String]},emptyText:{type:String,default:\"暂无数据\"},defaultExpandAll:{type:Boolean,default:!1},expandRowKeys:{type:Array},defaultSort:{type:Object},tooltipEffect:{type:String},showSummary:{type:Boolean,default:!1},sumText:{type:String,default:\"合计\"},summaryMethod:{type:Function},spanMethod:{type:Function},selectOnIndeterminate:{type:Boolean,default:!0},indent:{type:Number,default:16},lazy:{type:Boolean},load:{type:Function},treeProps:{type:Object}}),c={name:\"CTable\",components:{ElButton:l.a,ElTable:i.a,ElTableColumn:r.a},props:u,activated:function(){this.doLayout()},methods:{doLayout:function(){var e=this;this.$nextTick((function(){e.$refs.table&&e.$refs.table.doLayout()}))},isShowButton:function(e,t,a){var n=a.hidden;return\"function\"==typeof n?!n(e,t,a):!n}}},f=(a(\"b032\"),a(\"2877\")),d=Object(f.a)(c,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a(\"div\",{staticClass:\"m-table\"},[a(\"el-table\",e._g(e._b({ref:\"table\"},\"el-table\",e.$props,!1),e.$listeners),[e._l(e.headers,(function(t,n){return[\"btns\"!=t.colType||t.hidden?\"column\"!=t.colType||t.hidden?t.hidden?e._e():a(\"el-table-column\",e._b({key:n},\"el-table-column\",t,!1)):a(\"el-table-column\",e._b({key:n,scopedSlots:e._u([{key:\"default\",fn:function(a){return[e._t(\"column|\"+(t.slotName||t.prop),null,{row:a.row,$index:a.$index})]}}],null,!0)},\"el-table-column\",t,!1)):a(\"el-table-column\",e._b({key:n,scopedSlots:e._u([{key:\"default\",fn:function(n){return e._l(t.btns,(function(t,r){return a(\"el-button\",{directives:[{name:\"show\",rawName:\"v-show\",value:e.isShowButton(n.row,n.$index,t),expression:\"isShowButton(scope.row, scope.$index, btn)\"}],key:r,attrs:{size:t.size,type:t.type},on:{click:function(e){return e.stopPropagation(),t.click(n.row,n.$index,r)}}},[e._v(e._s(t.label))])}))}}],null,!0)},\"el-table-column\",t,!1))]}))],2)],1)}),[],!1,null,\"5ed8e428\",null);t.a=d.exports},\"0845\":function(e,t,a){\"use strict\";var n=a(\"dd97\");a.n(n).a},\"9f27\":function(e,t,a){\"use strict\";var n,r=(a(\"0fb7\"),a(\"450d\"),a(\"f529\")),o=a.n(r),i=a(\"a34a\"),s=a.n(i),l=a(\"1da1\"),u=(a(\"be4f\"),a(\"896a\")),c=a.n(u),f=a(\"5530\"),d=a(\"ade3\"),m=(a(\"1951\"),a(\"eedf\")),p=a.n(m),y=(a(\"eca7\"),a(\"3787\")),h=a.n(y),g=(a(\"672e\"),a(\"101e\")),b=a.n(g),v=(a(\"d3b7\"),a(\"3ca3\"),a(\"ddb0\"),a(\"a9e3\"),a(\"b0c0\"),a(\"d81d\"),a(\"a434\"),a(\"be3b\"),a(\"6fac\")),x=a(\"05f4\"),w={system:\"demo\",ajaxFilterSave:void 0,ajaxFilterQuery:void 0};var S=function(){return a.e(\"chunk-7a8ae762\").then(a.bind(null,\"5b22\"))},F=function(e){return[\"\",null,void 0].indexOf(e)>=0?\"-\":e},j={name:\"BTable\",props:{loading:{type:Boolean,default:!1},ajaxGetData:{type:Function,default:function(){}},ajaxFilterSave:{type:Function},ajaxFilterQuery:{type:Function},headers:{type:Array,default:function(){return[]}},pgMarginTop:{type:Number,default:20},pageSizes:{type:Array,default:function(){return[10,50,100,500,1e3]}},pageLimit:{type:Number,default:50},formItems:{type:Array,default:function(){return[]}},initialFormData:{type:Object,default:function(){return{}}},toolbars:{type:Array,default:function(){return[]}},showRefresh:{type:Boolean,default:!0},showColumn:{type:Boolean,default:!1},showQueryFilter:{type:Boolean,default:!1},saveColumnKey:{type:String,default:\"\"},saveQueryKey:{type:String,default:\"\"},system:{type:String,default:void 0},saveSuccessMsg:{type:String,default:\"保存成功\"},saveErrorMsg:{type:String,default:\"数据保存失败\"},immediateLoad:{type:Boolean,default:!0}},components:(n={CTable:x.a,ElPagination:b.a,CDynamicForm:v.a},Object(d.a)(n,h.a.name,h.a),Object(d.a)(n,p.a.name,p.a),n),data:function(){return{headerPromise:null,computedHeaders:[],computedFormItems:[],ajaxCount:0,selectRows:[],loadingIns:null,pageParams:{total:0,offset:0,limit:this.pageLimit,page:1},sortParams:{sort:void 0,order:void 0},tableData:[],formData:Object(f.a)({},this.initialFormData),formAttrs:{inline:!0,size:\"small\"},isArray:function(e){return Array.isArray(e)},sysConfig:{}}},watch:{\"pageParams.limit\":function(){1==this.pageParams.page?this.ajaxGetTableDataByPage():this.pageParams.page=1},\"pageParams.page\":function(){var e=this.pageParams,t=e.page,a=e.limit;this.pageParams.offset=a*(t-1),this.ajaxGetTableDataByPage()},tableData:function(){this.$emit(\"table-data-change\",this.tableData)},formItems:function(){this.dealQueryItems()}},computed:{ajaxPageParams:function(){var e=this.pageParams,t=e.offset,a=e.limit;return{offset:t,limit:a,pageSize:a,pageNum:e.page}},computedSaveColumnKey:function(){if(this.saveColumnKey)return this.saveColumnKey;var e;try{e=this.$route.path}catch(t){e=\"default\"}return\"table|\"+e},computedSaveQueryKey:function(){if(this.saveQueryKey)return this.saveQueryKey;var e;try{e=this.$route.path}catch(t){e=\"default\"}return\"query|\"+e}},created:function(){this.initConfig(),this.headerPromise=this.dealHeaders(),this.dealQueryItems()},mounted:function(){this.immediateLoad&&this.ajaxGetTableDataByPage()},methods:{ajaxGetTableDataByPage:function(){var e=this;(this.$refs.cDynamicForm?this.$refs.cDynamicForm.validate():Promise.resolve()).then((function(){var t=++e.ajaxCount;if(e.lastLoadingMap,e.$refs.table){if(!e.loadingIns){var a={close:function(){}};e.loading&&(a=c.a.service({target:e.$refs.table.$el})),e.loadingIns=a}var n=Object(f.a)(Object(f.a)(Object(f.a)({},e.ajaxPageParams),e.formData),e.sortParams),r=e.ajaxGetData,o=function(a){if(t==e.ajaxCount&&(e.loadingIns.close(),e.loadingIns=null,a)){var n=a.data||{};e.tableData=Array.isArray(n.records)?n.records:[],e.pageParams.total=n.total||0,0===e.tableData.length&&(e.pageParams.page=1)}},i=r&&r(n);i&&\"function\"==typeof i.then?Promise.all([i,e.headerPromise]).then((function(e){o(e[0])})).catch((function(e){console.error(e),o()})):o()}}))},ajaxGetShowFilterData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this.sysConfig,a=t.system,n=t.ajaxFilterQuery,r=this.getSaveKey(e);return\"function\"==typeof n?n({system:a,key:r}):[]},ajaxSaveFilterData:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=this.sysConfig,n=a.system,r=a.ajaxFilterSave,o=this.getSaveKey(t);return\"function\"==typeof r?r({system:n,key:o,columns:e}):[]},dealQueryItems:function(){var e=this;return Object(l.a)(s.a.mark((function t(){var a,n,r,o,i,l;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=e.formItems,n=e.sysConfig,r=n.ajaxFilterQuery,o=n.ajaxFilterSave,!e.showQueryFilter){t.next=20;break}if(!r||!o){t.next=17;break}return t.prev=4,t.next=7,e.ajaxGetShowFilterData(2);case 7:l=t.sent,i=l,t.next=15;break;case 12:t.prev=12,t.t0=t.catch(4),i=[];case 15:t.next=19;break;case 17:i=e.getLocalFilterData(2);case 19:e.dealColumnsHeader(a,i);case 20:a=a.map((function(e){if(e.required=e.required||!1,e.hidden=e.hidden||!1,\"select\"===e.type){var t=e.attrs&&e.attrs.clearable;t=void 0===t||t,e.attrs||(e.attrs={}),e.attrs.clearable=t}return e})),e.computedFormItems=a;case 22:case\"end\":return t.stop()}}),t,null,[[4,12]])})))()},dealHeaders:function(){var e=this;return Object(l.a)(s.a.mark((function t(){var a,n,r,o,i,l;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(a=e.headers,n=e.sysConfig,r=n.ajaxFilterQuery,o=n.ajaxFilterSave,!e.showColumn){t.next=20;break}if(!r||!o){t.next=17;break}return t.prev=4,t.next=7,e.ajaxGetShowFilterData();case 7:l=t.sent,i=l,t.next=15;break;case 12:t.prev=12,t.t0=t.catch(4),i=[];case 15:t.next=19;break;case 17:i=e.getLocalFilterData();case 19:e.dealColumnsHeader(a,i);case 20:e.computedHeaders=a.map((function(t){t.required=t.required||!1,t.hidden=t.hidden||!1,t.resizable=t.resizable||!1;var a=t.index;\"index\"==t.type&&\"function\"==typeof a&&(t.index=function(t){return a(t,e.pageParams.page,e.pageParams.limit)});var n=t.formatter;return t.formatter=\"function\"==typeof n?function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];var r=n.apply(null,t);return F(r)}:function(e,t,a){return F(a)},t}));case 21:case\"end\":return t.stop()}}),t,null,[[4,12]])})))()},initConfig:function(){var e=w,t=this.$props,a=t.system,n=t.ajaxFilterSave,r=t.ajaxFilterQuery;this.sysConfig.system=void 0!==a?a:e.system,this.sysConfig.ajaxFilterSave=void 0!==n?n:e.ajaxFilterSave,this.sysConfig.ajaxFilterQuery=void 0!==r?r:e.ajaxFilterQuery},getSaveKey:function(e){return 1==e?this.computedSaveColumnKey:this.computedSaveQueryKey},saveLocalFilterData:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=this.getSaveKey(t);return new Promise((function(t,n){try{localStorage.setItem(a,JSON.stringify(e)),t()}catch(e){o()({message:e.name+\":\"+e.message,type:\"warning\",duration:5e3}),n()}}))},getLocalFilterData:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,a=this.getSaveKey(t);try{e=JSON.parse(localStorage.getItem(a))||[]}catch(t){e=[]}return e},getQueryParam:function(){return Object(f.a)(Object(f.a)(Object(f.a)({},this.ajaxPageParams),this.formData),this.sortParams)},dealColumnsHeader:function(e,t){for(var a=JSON.parse(JSON.stringify(t)),n=0,r=e.length;n<r;n++){var o=e[n],i=o.prop;if(i)for(var s=0;s<a.length;s++){var l=a[s];if(l.prop==i){Object.assign(o,l,{required:o.required,label:o.label}),a.splice(s,1);break}}}},onPgSizeChange:function(e){this.pageParams.limit=e},onQueryForm:function(){this.$emit(\"query-form\"),1===this.pageParams.page?this.ajaxGetTableDataByPage():this.pageParams.page=1},onResetForm:function(){this.formData=Object(f.a)({},this.initialFormData),this.$refs.cDynamicForm&&this.$refs.cDynamicForm.init(),this.$emit(\"reset-form\")},onFilterQueryCondition:function(){var e=this;return Object(l.a)(s.a.mark((function t(){var a,n,r;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.sysConfig,n=a.ajaxFilterSave,r=a.ajaxFilterQuery,t.next=3,S();case 3:t.sent.default.show({data:e.formItems,ajaxFun:n&&r?function(t){return e.ajaxSaveFilterData(t,2)}:function(t){return e.saveLocalFilterData(t,2)},successMsg:e.saveSuccessMsg,errorMsg:e.saveErrorMsg});case 5:case\"end\":return t.stop()}}),t)})))()},onSelectionChange:function(e){this.selectRows=e},onSortChange:function(e){var t=e.order,a=e.prop;this.sortParams={order:\"ascending\"==t?\"asc\":\"desc\",sort:a},this.ajaxGetTableDataByPage()},onRefreshTable:function(){this.ajaxGetTableDataByPage()},onChangeColumn:function(){var e=this;return Object(l.a)(s.a.mark((function t(){var a,n,r;return s.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=e.sysConfig,n=a.ajaxFilterSave,r=a.ajaxFilterQuery,t.next=3,S();case 3:t.sent.default.show({title:\"自定义显示列\",data:e.headers,ajaxFun:n&&r?e.ajaxSaveFilterData:e.saveLocalFilterData,successMsg:e.saveSuccessMsg,errorMsg:e.saveErrorMsg});case 5:case\"end\":return t.stop()}}),t)})))()},isHiddenButton:function(e){var t=e.hidden;return\"function\"==typeof t?t(e):t}}},C=(a(\"0845\"),a(\"2877\")),P=Object(C.a)(j,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a(\"div\",{staticClass:\"c-table\"},[e.formItems&&e.formItems.length?a(\"c-dynamic-form\",{ref:\"cDynamicForm\",attrs:{\"form-data\":e.formData,\"form-items\":e.computedFormItems,\"form-attrs\":e.formAttrs},on:{\"change-model\":function(t){return e.formData=t}},nativeOn:{keyup:function(t){return!t.type.indexOf(\"key\")&&e._k(t.keyCode,\"enter\",13,t.key,\"Enter\")?null:e.onQueryForm(t)}}},[a(\"el-form-item\",{attrs:{slot:\"form-after\"},slot:\"form-after\"},[a(\"el-button\",{on:{click:e.onResetForm}},[e._v(\"重置\")]),a(\"el-button\",{attrs:{type:\"primary\"},on:{click:e.onQueryForm}},[e._v(\"查询\")]),e.showQueryFilter?a(\"el-button\",{attrs:{type:\"primary\"},on:{click:e.onFilterQueryCondition}},[e._v(\"设置筛选项\")]):e._e()],1)],1):e._e(),a(\"div\",{staticClass:\"toolbars\"},[a(\"div\",{staticClass:\"toolbars-left\"},[e._l(e.toolbars,(function(t,n){return[\"dropdown\"===t.type?a(\"el-dropdown\",{key:n,attrs:{size:\"small\"},on:{command:function(a){return\"function\"==typeof t.command&&t.command(a,e.selectRows)}}},[a(\"el-button\",e._b({attrs:{type:\"primary\",size:\"small\"}},\"el-button\",t.attrs,!1),[e._v(\" \"+e._s(t.label)),a(\"i\",{staticClass:\"el-icon-arrow-down el-icon--right\"})]),t.btns&&t.btns.length?a(\"el-dropdown-menu\",{attrs:{slot:\"dropdown\"},slot:\"dropdown\"},e._l(t.btns,(function(r,o){return a(\"el-dropdown-item\",e._b({directives:[{name:\"show\",rawName:\"v-show\",value:!e.isHiddenButton(t),expression:\"!isHiddenButton(tool)\"}],key:\"\"+n+o,attrs:{type:\"primary\",size:\"small\"},nativeOn:{click:function(t){\"function\"==typeof r.click&&r.click(e.selectRows)}}},\"el-dropdown-item\",r.attrs,!1),[e._v(\" \"+e._s(r.label)+\" \")])})),1):e._e()],1):\"slot\"===t.type?e._t(\"toolbars|\"+t.slotName,null,{rows:e.selectRows}):a(\"el-button\",e._b({directives:[{name:\"show\",rawName:\"v-show\",value:!e.isHiddenButton(t),expression:\"!isHiddenButton(tool)\"}],key:n,attrs:{type:\"primary\",size:\"small\"},on:{click:function(a){\"function\"==typeof t.click&&t.click(e.selectRows)}}},\"el-button\",t.attrs,!1),[e._v(\" \"+e._s(t.label)+\" \")])]}))],2),a(\"div\",{staticClass:\"toolbars-right\"},[e.showRefresh?a(\"el-button\",{attrs:{type:\"primary\",size:\"small\"},on:{click:e.onRefreshTable}},[e._v(\"刷新\")]):e._e(),e.showColumn?a(\"el-button\",{attrs:{type:\"primary\",size:\"small\"},on:{click:e.onChangeColumn}},[e._v(\"自定义显示列\")]):e._e()],1)]),e._t(\"table-before\"),e._t(\"table-title\"),a(\"c-table\",e._g(e._b({ref:\"table\",attrs:{border:!0,size:\"small\",data:e.tableData,headers:e.computedHeaders},on:{\"selection-change\":e.onSelectionChange,\"sort-change\":e.onSortChange},scopedSlots:e._u([e._l(e.headers,(function(t){return{key:\"column|\"+(t.slotName||t.prop),fn:function(a){return[e._t(\"column|\"+(t.slotName||t.prop),null,{row:a.row,$index:a.$index})]}}}))],null,!0)},\"c-table\",e.$attrs,!1),e.$listeners)),a(\"el-pagination\",{style:{\"margin-top\":e.pgMarginTop+\"px\"},attrs:{background:\"\",layout:\"total, prev, pager, next, sizes, slot, jumper\",\"page-sizes\":e.pageSizes,total:e.pageParams.total,\"current-page\":e.pageParams.page,\"page-size\":e.pageParams.limit},on:{\"update:currentPage\":function(t){return e.$set(e.pageParams,\"page\",t)},\"update:current-page\":function(t){return e.$set(e.pageParams,\"page\",t)},\"size-change\":e.onPgSizeChange}},[a(\"span\",{staticClass:\"el-pagination-slot\"},[e._v(\"跳至\")])])],2)}),[],!1,null,\"95e43b62\",null);t.a=P.exports},b032:function(e,t,a){\"use strict\";var n=a(\"f166\");a.n(n).a},dd97:function(e,t,a){},f166:function(e,t,a){}}]);","extractedComments":[]}