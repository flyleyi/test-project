{"code":"(window[\"webpackJsonp\"]=window[\"webpackJsonp\"]||[]).push([[\"chunk-4d28ed00\"],{\"031c\":function(a,e,t){\"use strict\";var i=t(\"bcf4\"),r=t.n(i);r.a},\"3a0e\":function(a,e,t){\"use strict\";t.r(e);var i=function(){var a=this,e=a.$createElement,t=a._self._c||e;return t(\"div\",{staticClass:\"recipe-report\"},[t(\"div\",[Object.keys(a.orderInfo).length?t(\"div\",{staticClass:\"title\"},[a._v(\" 【\"+a._s(a.orderInfo.orderNo)+\"】【\"+a._s(a.$D(\"ORDER_TYPE\",a.orderInfo.type+\"\"))+\"】\"+a._s(a.orderInfo.provinceName)+a._s(a.orderInfo.cityName)+a._s(a.orderInfo.districtName)+a._s(a.orderInfo.parentDeptName)+a._s(a.orderInfo.deptName)+\"的订单营养分析 \")]):a._e(),a.mealListOrigin.length?t(\"div\",{staticClass:\"table-date clearfix\"},[a._v(\" 用餐日期：\"+a._s(a.formateDate(a.mealListOrigin[0].mealDate,4)||\"\")+\" 至 \"+a._s(a.formateDate(a.mealListOrigin[a.mealListOrigin.length-1].mealDate,4)||\"\")+\" \"),t(\"span\",{staticStyle:{float:\"right\"}},[t(\"el-button\",{attrs:{type:\"primary\",size:\"small\"},on:{click:a.onExport}},[a._v(\"导出\")])],1)]):a._e()]),a.mealListOrigin.length?t(\"div\",{staticClass:\"table-item\"},[t(\"materical-table\",{attrs:{mealData:a.mealData}})],1):a._e(),t(\"div\",{directives:[{name:\"show\",rawName:\"v-show\",value:\"table\"===a.showType,expression:\"showType === 'table'\"}],staticClass:\"table-item\"},[t(\"div\",{staticClass:\"catergory\"},[t(\"tab-name\",{attrs:{titleName:\"食物人均每日摄入量\"}}),t(\"span\",{staticClass:\"changeShowType\",on:{click:function(e){return a.toggleShowType(\"image\")}}},[a._v(\"图表查看\")])],1),t(\"div\",[t(\"catergory-table\",{attrs:{categoryData:a.categoryData}})],1)]),t(\"div\",{directives:[{name:\"show\",rawName:\"v-show\",value:\"table\"===a.showType,expression:\"showType === 'table'\"}],staticClass:\"table-item\"},[t(\"div\",{staticClass:\"catergory\"},[t(\"tab-name\",{attrs:{titleName:\"营养素人均每日摄入量\"}})],1),t(\"per-capita-table\",{attrs:{perCapitaData:a.perCapitaData}})],1),t(\"div\",{directives:[{name:\"show\",rawName:\"v-show\",value:\"image\"===a.showType,expression:\"showType === 'image'\"}],staticClass:\"image-show\"},[t(\"div\",{staticClass:\"table-item catergory-image\"},[t(\"div\",{staticClass:\"catergory\"},[t(\"tab-name\",{attrs:{titleName:\"食物人均每日摄入量\"}})],1),t(\"catergory-image\",{attrs:{categoryData:a.categoryData}})],1),t(\"div\",{staticClass:\"table-item per-capita-image\"},[t(\"div\",{staticClass:\"catergory\"},[t(\"tab-name\",{attrs:{titleName:\"营养素人均每日摄入量\"}}),t(\"span\",{staticClass:\"changeShowType\",on:{click:function(e){return a.toggleShowType(\"table\")}}},[a._v(\"表格查看\")])],1),t(\"per-capita-image\",{attrs:{perCapitaData:a.perCapitaData}})],1)]),t(\"div\",{staticClass:\"table-item\"},[t(\"div\",{staticClass:\"catergory\"},[t(\"tab-name\",{attrs:{titleName:\"食谱评价\"}})],1),t(\"recipe-evaluation\",{attrs:{list:a.evaluationData}})],1)])},r=[],n=t(\"ade3\"),s=t(\"5530\"),o=(t(\"99af\"),t(\"159b\"),t(\"b680\"),t(\"b64b\"),t(\"dc9f\")),c=t(\"d996\"),l=t(\"f9e7\"),p=t(\"638f\"),d=t(\"c292\"),m=t(\"6162\"),g=t(\"04cf\"),u=t(\"eaf5\"),D=t(\"d95c\"),b=t(\"6a3d\"),y=[\"星期日\",\"星期一\",\"星期二\",\"星期三\",\"星期四\",\"星期五\",\"星期六\"],f={name:\"recipe-report\",components:{MatericalTable:c[\"a\"],CatergoryTable:l[\"a\"],PerCapitaTable:p[\"a\"],TabName:d[\"a\"],PerCapitaImage:m[\"a\"],CatergoryImage:g[\"a\"],RecipeEvaluation:u[\"a\"]},data:function(){return{orderId:null,orderInfo:{},initMealData:JSON.parse(JSON.stringify(b[\"b\"])),initCategoryData:JSON.parse(JSON.stringify(b[\"a\"])),initPerCapitaData:JSON.parse(JSON.stringify(b[\"c\"])),mealData:b[\"b\"],categoryData:b[\"a\"],perCapitaData:b[\"c\"],showType:\"table\",evaluationData:[],mealListOrigin:[]}},created:function(){this.orderId=this.$route.query.orderId,this.nutritionContent(),this.nutritionPerCapitaIntakeForOrderId(),this.categoryPerCapitaIntakeForOrderId()},methods:{onExport:function(){var a=this;Object(o[\"g\"])({orderId:this.orderId}).then((function(e){var t=a.orderInfo,i=(a.formateDate,t.type),r=t.orderNo,n=t.provinceName,s=t.cityName,o=t.districtName,c=t.parentDeptName,l=t.deptName,p=(t.createTime,t.updateTime,t.arrivalTime,t.creatorName,t.confirmTime,\"【\".concat(r,\"】【\").concat(a.$D(\"ORDER_TYPE\",i+\"\"),\"】\").concat(n).concat(s).concat(o).concat(c).concat(l,\"的订单营养分析报表.xlsx\"));a.$util.downLoadBlob(e,p)}))},toggleShowType:function(a){this.showType=a},nutritionContent:function(){var a=this;Object(o[\"c\"])({orderId:this.orderId}).then((function(e){var t=e.data,i=t.mealDateRespDtoList;a.mealListOrigin=i,a.orderInfo=t||{},a.mealData=a.handleMealList(i)}))},nutritionPerCapitaIntakeForOrderId:function(){var a=this;Object(o[\"e\"])({orderId:this.orderId}).then((function(e){var t=e.data,i=void 0===t?[]:t;a.evaluationData=i,a.perCapitaData=JSON.parse(JSON.stringify(a.initPerCapitaData)),i.forEach((function(e){a.perCapitaData[\"perCapitaHeader\"].push({label:e.nutrientName,prop:e.nutrientName,nutrientUnitName:e.nutrientStatisticalUnitName||e.nutrientUnitName}),a.perCapitaData[\"perCapitaTableData\"][1]=Object.assign(Object(s[\"a\"])({},a.perCapitaData[\"perCapitaTableData\"][1]),Object(n[\"a\"])({},e.nutrientName,1===e.nutrientStatisticalType?e.intakeValue:(100*e.intakeValue).toFixed(2)+\"%\")),a.perCapitaData[\"perCapitaTableData\"][0]=Object.assign({},Object(s[\"a\"])({},a.perCapitaData[\"perCapitaTableData\"][0]),Object(n[\"a\"])({},e.nutrientName,1===e.nutrientStatisticalType?e.referenceIntakeValue:100*e.lowerLimitValue+\"%-\"+100*e.upperLimitValue+\"%\")),a.perCapitaData[\"perCapitaTableData\"][2]=Object.assign({},Object(s[\"a\"])({},a.perCapitaData[\"perCapitaTableData\"][2]),Object(n[\"a\"])({},e.nutrientName,e.diffValue?(100*e.diffValue).toFixed(2)+\"%\":\"\")),a.perCapitaData[\"perCapitaTableData\"][3]=Object.assign({},Object(s[\"a\"])({},a.perCapitaData[\"perCapitaTableData\"][3]),Object(n[\"a\"])({},e.nutrientName,e.grade))}))}))},categoryPerCapitaIntakeForOrderId:function(){var a=this;Object(o[\"a\"])({orderId:this.orderId}).then((function(e){var t=e.data,i=void 0===t?[]:t;a.categoryData=JSON.parse(JSON.stringify(a.initCategoryData)),i.forEach((function(e){a.categoryData[\"categoryHeader\"].push({label:e.ingredientTypeName,prop:e.ingredientTypeName}),a.categoryData[\"categoryTableData\"][0]=Object.assign(Object(s[\"a\"])({},a.categoryData[\"categoryTableData\"][0]),Object(n[\"a\"])({},e.ingredientTypeName,e.referenceIntakeValue)),a.categoryData[\"categoryTableData\"][1]=Object.assign({},Object(s[\"a\"])({},a.categoryData[\"categoryTableData\"][1]),Object(n[\"a\"])({},e.ingredientTypeName,e.intakeValue))}))}))},handleMealList:function(a){for(var e={},t={},i={},r={},s=1,o=0;o<a.length;o++){var c=a[o],l=new Date(c.mealDate),p=y[l.getDay()],d=l.getDate(),m=l.getFullYear();c.weekStr=p,c.dayNum=d<10?\"0\"+d:d,o>0&&!this.isSameWeek(c.mealDate,a[o-1][\"mealDate\"])&&s++;var g=m+\"\"+s;e[g]||(e[g]=[],t[g]=[],i[g]=[{rowName:\"早餐\"},{rowName:\"午餐\"},{rowName:\"晚餐\"},{rowName:\"食材\"}],r[g]=!1),e[g].push(a[o]),t[g].push({dayNum:a[o].dayNum,weekStr:a[o].weekStr})}for(var u=Object.keys(e),D=0;D<u.length;D++)for(var b=0;b<e[u[D]].length;b++){for(var f=e[u[D]][b][\"mealTypeRespDtoList\"],h=0;h<4;h++){var v;i[u[D]][h]=Object.assign({},i[u[D]][h],(v={},Object(n[\"a\"])(v,t[u[D]][b][\"dayNum\"]+\"dishesRespDtoList\",3===h?f[h][\"ingredientRespDtoList\"]:f[h][\"dishesRespDtoList\"]),Object(n[\"a\"])(v,t[u[D]][b][\"dayNum\"]+\"ingredientRespDtoList\",f[h][\"ingredientRespDtoList\"]),v))}f[3][\"ingredientRespDtoList\"].length&&(r[u[D]]=!0),r[u[D]]||delete i[u[D]][3]}return{mealObj:e,mealHeader:t,mealTableData:i,mealHasIngredient:r}},isSameWeek:function(a,e){var t=new Date(a),i=new Date(e),r=[6,0,1,2,3,4,5],n=[1,7,6,5,4,3,2],s=t.getDay(),o=new Date(\"\".concat(t.getFullYear(),\"/\").concat(t.getMonth()+1,\"/\").concat(t.getDate(),\" 00:00:00\")),c=new Date(o).getTime(),l=c-24*r[s]*60*60*1e3,p=c+24*n[s]*60*59*1e3;return i.getTime()>=l&&i.getTime()<=p},formateDate:D[\"a\"]}},h=f,v=(t(\"031c\"),t(\"2877\")),C=Object(v[\"a\"])(h,i,r,!1,null,\"00392841\",null);e[\"default\"]=C.exports},bcf4:function(a,e,t){}}]);","extractedComments":[]}