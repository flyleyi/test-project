{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[\"chunk-4d28ed00\"],{\"031c\":function(a,e,t){\"use strict\";var i=t(\"bcf4\");t.n(i).a},\"3a0e\":function(a,e,t){\"use strict\";t.r(e);var i=t(\"ade3\"),r=t(\"5530\"),n=(t(\"99af\"),t(\"159b\"),t(\"b680\"),t(\"b64b\"),t(\"dc9f\")),s=t(\"d996\"),o=t(\"f9e7\"),c=t(\"638f\"),l=t(\"c292\"),p=t(\"6162\"),d=t(\"04cf\"),m=t(\"eaf5\"),g=t(\"d95c\"),u=t(\"6a3d\"),D=[\"星期日\",\"星期一\",\"星期二\",\"星期三\",\"星期四\",\"星期五\",\"星期六\"],b={name:\"recipe-report\",components:{MatericalTable:s.a,CatergoryTable:o.a,PerCapitaTable:c.a,TabName:l.a,PerCapitaImage:p.a,CatergoryImage:d.a,RecipeEvaluation:m.a},data:function(){return{orderId:null,orderInfo:{},initMealData:JSON.parse(JSON.stringify(u.b)),initCategoryData:JSON.parse(JSON.stringify(u.a)),initPerCapitaData:JSON.parse(JSON.stringify(u.c)),mealData:u.b,categoryData:u.a,perCapitaData:u.c,showType:\"table\",evaluationData:[],mealListOrigin:[]}},created:function(){this.orderId=this.$route.query.orderId,this.nutritionContent(),this.nutritionPerCapitaIntakeForOrderId(),this.categoryPerCapitaIntakeForOrderId()},methods:{onExport:function(){var a=this;Object(n.g)({orderId:this.orderId}).then((function(e){var t=a.orderInfo,i=(a.formateDate,t.type),r=t.orderNo,n=t.provinceName,s=t.cityName,o=t.districtName,c=t.parentDeptName,l=t.deptName,p=(t.createTime,t.updateTime,t.arrivalTime,t.creatorName,t.confirmTime,\"【\".concat(r,\"】【\").concat(a.$D(\"ORDER_TYPE\",i+\"\"),\"】\").concat(n).concat(s).concat(o).concat(c).concat(l,\"的订单营养分析报表.xlsx\"));a.$util.downLoadBlob(e,p)}))},toggleShowType:function(a){this.showType=a},nutritionContent:function(){var a=this;Object(n.c)({orderId:this.orderId}).then((function(e){var t=e.data,i=t.mealDateRespDtoList;a.mealListOrigin=i,a.orderInfo=t||{},a.mealData=a.handleMealList(i)}))},nutritionPerCapitaIntakeForOrderId:function(){var a=this;Object(n.e)({orderId:this.orderId}).then((function(e){var t=e.data,n=void 0===t?[]:t;a.evaluationData=n,a.perCapitaData=JSON.parse(JSON.stringify(a.initPerCapitaData)),n.forEach((function(e){a.perCapitaData.perCapitaHeader.push({label:e.nutrientName,prop:e.nutrientName,nutrientUnitName:e.nutrientStatisticalUnitName||e.nutrientUnitName}),a.perCapitaData.perCapitaTableData[1]=Object.assign(Object(r.a)({},a.perCapitaData.perCapitaTableData[1]),Object(i.a)({},e.nutrientName,1===e.nutrientStatisticalType?e.intakeValue:(100*e.intakeValue).toFixed(2)+\"%\")),a.perCapitaData.perCapitaTableData[0]=Object.assign({},Object(r.a)({},a.perCapitaData.perCapitaTableData[0]),Object(i.a)({},e.nutrientName,1===e.nutrientStatisticalType?e.referenceIntakeValue:100*e.lowerLimitValue+\"%-\"+100*e.upperLimitValue+\"%\")),a.perCapitaData.perCapitaTableData[2]=Object.assign({},Object(r.a)({},a.perCapitaData.perCapitaTableData[2]),Object(i.a)({},e.nutrientName,e.diffValue?(100*e.diffValue).toFixed(2)+\"%\":\"\")),a.perCapitaData.perCapitaTableData[3]=Object.assign({},Object(r.a)({},a.perCapitaData.perCapitaTableData[3]),Object(i.a)({},e.nutrientName,e.grade))}))}))},categoryPerCapitaIntakeForOrderId:function(){var a=this;Object(n.a)({orderId:this.orderId}).then((function(e){var t=e.data,n=void 0===t?[]:t;a.categoryData=JSON.parse(JSON.stringify(a.initCategoryData)),n.forEach((function(e){a.categoryData.categoryHeader.push({label:e.ingredientTypeName,prop:e.ingredientTypeName}),a.categoryData.categoryTableData[0]=Object.assign(Object(r.a)({},a.categoryData.categoryTableData[0]),Object(i.a)({},e.ingredientTypeName,e.referenceIntakeValue)),a.categoryData.categoryTableData[1]=Object.assign({},Object(r.a)({},a.categoryData.categoryTableData[1]),Object(i.a)({},e.ingredientTypeName,e.intakeValue))}))}))},handleMealList:function(a){for(var e={},t={},r={},n={},s=1,o=0;o<a.length;o++){var c=a[o],l=new Date(c.mealDate),p=D[l.getDay()],d=l.getDate(),m=l.getFullYear();c.weekStr=p,c.dayNum=d<10?\"0\"+d:d,o>0&&!this.isSameWeek(c.mealDate,a[o-1].mealDate)&&s++;var g=m+\"\"+s;e[g]||(e[g]=[],t[g]=[],r[g]=[{rowName:\"早餐\"},{rowName:\"午餐\"},{rowName:\"晚餐\"},{rowName:\"食材\"}],n[g]=!1),e[g].push(a[o]),t[g].push({dayNum:a[o].dayNum,weekStr:a[o].weekStr})}for(var u=Object.keys(e),b=0;b<u.length;b++)for(var y=0;y<e[u[b]].length;y++){for(var f=e[u[b]][y].mealTypeRespDtoList,h=0;h<4;h++){var v;r[u[b]][h]=Object.assign({},r[u[b]][h],(v={},Object(i.a)(v,t[u[b]][y].dayNum+\"dishesRespDtoList\",3===h?f[h].ingredientRespDtoList:f[h].dishesRespDtoList),Object(i.a)(v,t[u[b]][y].dayNum+\"ingredientRespDtoList\",f[h].ingredientRespDtoList),v))}f[3].ingredientRespDtoList.length&&(n[u[b]]=!0),n[u[b]]||delete r[u[b]][3]}return{mealObj:e,mealHeader:t,mealTableData:r,mealHasIngredient:n}},isSameWeek:function(a,e){var t=new Date(a),i=new Date(e),r=t.getDay(),n=new Date(\"\".concat(t.getFullYear(),\"/\").concat(t.getMonth()+1,\"/\").concat(t.getDate(),\" 00:00:00\")),s=new Date(n).getTime(),o=s-24*[6,0,1,2,3,4,5][r]*60*60*1e3,c=s+24*[1,7,6,5,4,3,2][r]*60*59*1e3;return i.getTime()>=o&&i.getTime()<=c},formateDate:g.a}},y=(t(\"031c\"),t(\"2877\")),f=Object(y.a)(b,(function(){var a=this,e=a.$createElement,t=a._self._c||e;return t(\"div\",{staticClass:\"recipe-report\"},[t(\"div\",[Object.keys(a.orderInfo).length?t(\"div\",{staticClass:\"title\"},[a._v(\" 【\"+a._s(a.orderInfo.orderNo)+\"】【\"+a._s(a.$D(\"ORDER_TYPE\",a.orderInfo.type+\"\"))+\"】\"+a._s(a.orderInfo.provinceName)+a._s(a.orderInfo.cityName)+a._s(a.orderInfo.districtName)+a._s(a.orderInfo.parentDeptName)+a._s(a.orderInfo.deptName)+\"的订单营养分析 \")]):a._e(),a.mealListOrigin.length?t(\"div\",{staticClass:\"table-date clearfix\"},[a._v(\" 用餐日期：\"+a._s(a.formateDate(a.mealListOrigin[0].mealDate,4)||\"\")+\" 至 \"+a._s(a.formateDate(a.mealListOrigin[a.mealListOrigin.length-1].mealDate,4)||\"\")+\" \"),t(\"span\",{staticStyle:{float:\"right\"}},[t(\"el-button\",{attrs:{type:\"primary\",size:\"small\"},on:{click:a.onExport}},[a._v(\"导出\")])],1)]):a._e()]),a.mealListOrigin.length?t(\"div\",{staticClass:\"table-item\"},[t(\"materical-table\",{attrs:{mealData:a.mealData}})],1):a._e(),t(\"div\",{directives:[{name:\"show\",rawName:\"v-show\",value:\"table\"===a.showType,expression:\"showType === 'table'\"}],staticClass:\"table-item\"},[t(\"div\",{staticClass:\"catergory\"},[t(\"tab-name\",{attrs:{titleName:\"食物人均每日摄入量\"}}),t(\"span\",{staticClass:\"changeShowType\",on:{click:function(e){return a.toggleShowType(\"image\")}}},[a._v(\"图表查看\")])],1),t(\"div\",[t(\"catergory-table\",{attrs:{categoryData:a.categoryData}})],1)]),t(\"div\",{directives:[{name:\"show\",rawName:\"v-show\",value:\"table\"===a.showType,expression:\"showType === 'table'\"}],staticClass:\"table-item\"},[t(\"div\",{staticClass:\"catergory\"},[t(\"tab-name\",{attrs:{titleName:\"营养素人均每日摄入量\"}})],1),t(\"per-capita-table\",{attrs:{perCapitaData:a.perCapitaData}})],1),t(\"div\",{directives:[{name:\"show\",rawName:\"v-show\",value:\"image\"===a.showType,expression:\"showType === 'image'\"}],staticClass:\"image-show\"},[t(\"div\",{staticClass:\"table-item catergory-image\"},[t(\"div\",{staticClass:\"catergory\"},[t(\"tab-name\",{attrs:{titleName:\"食物人均每日摄入量\"}})],1),t(\"catergory-image\",{attrs:{categoryData:a.categoryData}})],1),t(\"div\",{staticClass:\"table-item per-capita-image\"},[t(\"div\",{staticClass:\"catergory\"},[t(\"tab-name\",{attrs:{titleName:\"营养素人均每日摄入量\"}}),t(\"span\",{staticClass:\"changeShowType\",on:{click:function(e){return a.toggleShowType(\"table\")}}},[a._v(\"表格查看\")])],1),t(\"per-capita-image\",{attrs:{perCapitaData:a.perCapitaData}})],1)]),t(\"div\",{staticClass:\"table-item\"},[t(\"div\",{staticClass:\"catergory\"},[t(\"tab-name\",{attrs:{titleName:\"食谱评价\"}})],1),t(\"recipe-evaluation\",{attrs:{list:a.evaluationData}})],1)])}),[],!1,null,\"00392841\",null);e.default=f.exports},bcf4:function(a,e,t){}}]);","extractedComments":[]}