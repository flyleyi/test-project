{"remainingRequest":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/babel-loader/lib/index.js!/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/eslint-loader/index.js??ref--13-0!/Users/fuyueyi/Desktop/practice/mutilwap/src/pages/school-secret/store/modules/user.js","dependencies":[{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/src/pages/school-secret/store/modules/user.js","mtime":1627979214336},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmcuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcudHJpbS5qcyI7CmltcG9ydCB7IGxvZ2luIGFzIF9sb2dpbiwgbG9nb3V0LCBnZXRJbmZvIGFzIF9nZXRJbmZvIH0gZnJvbSAnLi4vLi4vYXBpL3VzZXIvaW5kZXgnOwppbXBvcnQgeyBnZXRUb2tlbiwgc2V0VG9rZW4sIHJlbW92ZVRva2VuIH0gZnJvbSAnLi4vLi4vLi4vLi4vcGx1Z2lucy9jb3JlL2F1dGgnOyAvLyBpbXBvcnQgeyByZXNldFJvdXRlciB9IGZyb20gJy4uLy4uL3JvdXRlcic7CgppbXBvcnQgYXZhdGFyR2lmIGZyb20gJy4uLy4uL2Fzc2V0cy9pbWFnZXMvYXZhdGFyLmdpZic7Cgp2YXIgZ2V0RGVmYXVsdFN0YXRlID0gZnVuY3Rpb24gZ2V0RGVmYXVsdFN0YXRlKCkgewogIHJldHVybiB7CiAgICB0b2tlbjogZ2V0VG9rZW4oKSwKICAgIG5hbWU6ICcnLAogICAgYXZhdGFyOiBhdmF0YXJHaWYsCiAgICBzdGFmZkNvZGU6ICcnLAogICAgLy8g5bel5Y+3CiAgICBzdGFmZk5hbWU6ICcnIC8vIOeUqOaIt+WQjQoKICB9Owp9OwoKdmFyIHN0YXRlID0gZ2V0RGVmYXVsdFN0YXRlKCk7CnZhciBtdXRhdGlvbnMgPSB7CiAgUkVTRVRfU1RBVEU6IGZ1bmN0aW9uIFJFU0VUX1NUQVRFKHN0YXRlKSB7CiAgICBPYmplY3QuYXNzaWduKHN0YXRlLCBnZXREZWZhdWx0U3RhdGUoKSk7CiAgfSwKICBTRVRfVE9LRU46IGZ1bmN0aW9uIFNFVF9UT0tFTihzdGF0ZSwgdG9rZW4pIHsKICAgIHN0YXRlLnRva2VuID0gdG9rZW47CiAgfSwKICBTRVRfTkFNRTogZnVuY3Rpb24gU0VUX05BTUUoc3RhdGUsIG5hbWUpIHsKICAgIHN0YXRlLm5hbWUgPSBuYW1lOwogIH0sCiAgU0VUX0FWQVRBUjogZnVuY3Rpb24gU0VUX0FWQVRBUihzdGF0ZSwgYXZhdGFyKSB7CiAgICBzdGF0ZS5hdmF0YXIgPSBhdmF0YXI7CiAgfSwKICBTRVRfU1RBRkZfQ09ERTogZnVuY3Rpb24gU0VUX1NUQUZGX0NPREUoc3RhdGUsIHN0YWZmQ29kZSkgewogICAgc3RhdGUuc3RhZmZDb2RlID0gc3RhZmZDb2RlOwogIH0sCiAgU0VUX1NUQUZGX05BTUU6IGZ1bmN0aW9uIFNFVF9TVEFGRl9OQU1FKHN0YXRlLCBzdGFmZk5hbWUpIHsKICAgIHN0YXRlLnN0YWZmTmFtZSA9IHN0YWZmTmFtZTsKICB9Cn07CnZhciBhY3Rpb25zID0gewogIC8vIHVzZXIgbG9naW4KICBsb2dpbjogZnVuY3Rpb24gbG9naW4oX3JlZiwgdXNlckluZm8pIHsKICAgIHZhciBjb21taXQgPSBfcmVmLmNvbW1pdDsKICAgIHZhciB1c2VybmFtZSA9IHVzZXJJbmZvLnVzZXJuYW1lLAogICAgICAgIHBhc3N3b3JkID0gdXNlckluZm8ucGFzc3dvcmQ7CiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICBfbG9naW4oewogICAgICAgIHVzZXJuYW1lOiB1c2VybmFtZS50cmltKCksCiAgICAgICAgcGFzc3dvcmQ6IHBhc3N3b3JkCiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgdmFyIGRhdGEgPSByZXNwb25zZS5kYXRhOwogICAgICAgIGNvbW1pdCgnU0VUX1RPS0VOJywgZGF0YS50b2tlbik7CiAgICAgICAgc2V0VG9rZW4oZGF0YS50b2tlbik7CiAgICAgICAgcmVzb2x2ZSgpOwogICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgICByZWplY3QoZXJyb3IpOwogICAgICB9KTsKICAgIH0pOwogIH0sCiAgLy8gZ2V0IHVzZXIgaW5mbwogIGdldEluZm86IGZ1bmN0aW9uIGdldEluZm8oX3JlZjIpIHsKICAgIHZhciBjb21taXQgPSBfcmVmMi5jb21taXQsCiAgICAgICAgc3RhdGUgPSBfcmVmMi5zdGF0ZTsKICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgIF9nZXRJbmZvKHN0YXRlLnRva2VuKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgIHZhciBkYXRhID0gcmVzcG9uc2UuZGF0YTsKCiAgICAgICAgaWYgKCFkYXRhKSB7CiAgICAgICAgICByZXR1cm4gcmVqZWN0KCdWZXJpZmljYXRpb24gZmFpbGVkLCBwbGVhc2UgTG9naW4gYWdhaW4uJyk7CiAgICAgICAgfQoKICAgICAgICB2YXIgbmFtZSA9IGRhdGEubmFtZSwKICAgICAgICAgICAgYXZhdGFyID0gZGF0YS5hdmF0YXIsCiAgICAgICAgICAgIHN0YWZmTmFtZSA9IGRhdGEuc3RhZmZOYW1lLAogICAgICAgICAgICBzdGFmZkNvZGUgPSBkYXRhLnN0YWZmQ29kZTsgLy8gY29tbWl0KCdTRVRfTkFNRScsIG5hbWUpOwogICAgICAgIC8vIGNvbW1pdCgnU0VUX0FWQVRBUicsIGF2YXRhcik7CgogICAgICAgIGNvbW1pdCgnU0VUX1NUQUZGX0NPREUnLCBzdGFmZkNvZGUpOwogICAgICAgIGNvbW1pdCgnU0VUX1NUQUZGX05BTUUnLCBzdGFmZk5hbWUpOwogICAgICAgIHJlc29sdmUoZGF0YSk7CiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikgewogICAgICAgIHJlamVjdChlcnJvcik7CiAgICAgIH0pOwogICAgfSk7CiAgfSwKICAvLyB1c2VyIGxvZ291dAogIGxvZ291dDogZnVuY3Rpb24gbG9nb3V0KF9yZWYzKSB7CiAgICB2YXIgY29tbWl0ID0gX3JlZjMuY29tbWl0LAogICAgICAgIHN0YXRlID0gX3JlZjMuc3RhdGU7CiAgICByZW1vdmVUb2tlbigpOyAvLyBtdXN0IHJlbW92ZSAgdG9rZW4gIGZpcnN0CiAgICAvLyByZXNldFJvdXRlcigpOwoKICAgIGNvbW1pdCgnUkVTRVRfU1RBVEUnKTsgLy8gcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHsKICAgIC8vICAgbG9nb3V0KHN0YXRlLnRva2VuKQogICAgLy8gICAgIC50aGVuKCgpID0+IHsKICAgIC8vICAgICAgIHJlbW92ZVRva2VuKCk7IC8vIG11c3QgcmVtb3ZlICB0b2tlbiAgZmlyc3QKICAgIC8vICAgICAgIHJlc2V0Um91dGVyKCk7CiAgICAvLyAgICAgICBjb21taXQoJ1JFU0VUX1NUQVRFJyk7CiAgICAvLyAgICAgICByZXNvbHZlKCk7CiAgICAvLyAgICAgfSkKICAgIC8vICAgICAuY2F0Y2goZXJyb3IgPT4gewogICAgLy8gICAgICAgcmVqZWN0KGVycm9yKTsKICAgIC8vICAgICB9KTsKICAgIC8vIH0pOwogIH0sCiAgLy8gcmVtb3ZlIHRva2VuCiAgcmVzZXRUb2tlbjogZnVuY3Rpb24gcmVzZXRUb2tlbihfcmVmNCkgewogICAgdmFyIGNvbW1pdCA9IF9yZWY0LmNvbW1pdDsKICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkgewogICAgICByZW1vdmVUb2tlbigpOyAvLyBtdXN0IHJlbW92ZSAgdG9rZW4gIGZpcnN0CgogICAgICBjb21taXQoJ1JFU0VUX1NUQVRFJyk7CiAgICAgIHJlc29sdmUoKTsKICAgIH0pOwogIH0KfTsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWVzcGFjZWQ6IHRydWUsCiAgc3RhdGU6IHN0YXRlLAogIG11dGF0aW9uczogbXV0YXRpb25zLAogIGFjdGlvbnM6IGFjdGlvbnMKfTs="},{"version":3,"sources":["/Users/fuyueyi/Desktop/practice/mutilwap/src/pages/school-secret/store/modules/user.js"],"names":["login","logout","getInfo","getToken","setToken","removeToken","avatarGif","getDefaultState","token","name","avatar","staffCode","staffName","state","mutations","RESET_STATE","Object","assign","SET_TOKEN","SET_NAME","SET_AVATAR","SET_STAFF_CODE","SET_STAFF_NAME","actions","userInfo","commit","username","password","Promise","resolve","reject","trim","then","response","data","catch","error","resetToken","namespaced"],"mappings":"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","sourcesContent":["import { login, logout, getInfo } from '../../api/user/index';\nimport { getToken, setToken, removeToken } from '../../../../plugins/core/auth';\n// import { resetRouter } from '../../router';\nimport avatarGif from '../../assets/images/avatar.gif';\n\nconst getDefaultState = () => {\n  return {\n    token: getToken(),\n    name: '',\n    avatar: avatarGif,\n    staffCode: '', // 工号\n    staffName: '' // 用户名\n  };\n};\n\nconst state = getDefaultState();\n\nconst mutations = {\n  RESET_STATE: state => {\n    Object.assign(state, getDefaultState());\n  },\n  SET_TOKEN: (state, token) => {\n    state.token = token;\n  },\n  SET_NAME: (state, name) => {\n    state.name = name;\n  },\n  SET_AVATAR: (state, avatar) => {\n    state.avatar = avatar;\n  },\n  SET_STAFF_CODE: (state, staffCode) => {\n    state.staffCode = staffCode;\n  },\n  SET_STAFF_NAME: (state, staffName) => {\n    state.staffName = staffName;\n  }\n};\n\nconst actions = {\n  // user login\n  login({ commit }, userInfo) {\n    const { username, password } = userInfo;\n    return new Promise((resolve, reject) => {\n      login({ username: username.trim(), password: password })\n        .then(response => {\n          const { data } = response;\n          commit('SET_TOKEN', data.token);\n          setToken(data.token);\n          resolve();\n        })\n        .catch(error => {\n          reject(error);\n        });\n    });\n  },\n\n  // get user info\n  getInfo({ commit, state }) {\n    return new Promise((resolve, reject) => {\n      getInfo(state.token)\n        .then(response => {\n          const { data } = response;\n\n          if (!data) {\n            return reject('Verification failed, please Login again.');\n          }\n\n          const { name, avatar, staffName, staffCode } = data;\n\n          // commit('SET_NAME', name);\n          // commit('SET_AVATAR', avatar);\n          commit('SET_STAFF_CODE', staffCode);\n          commit('SET_STAFF_NAME', staffName);\n          resolve(data);\n        })\n        .catch(error => {\n          reject(error);\n        });\n    });\n  },\n\n  // user logout\n  logout({ commit, state }) {\n    removeToken(); // must remove  token  first\n    // resetRouter();\n    commit('RESET_STATE');\n    // return new Promise((resolve, reject) => {\n    //   logout(state.token)\n    //     .then(() => {\n    //       removeToken(); // must remove  token  first\n    //       resetRouter();\n    //       commit('RESET_STATE');\n    //       resolve();\n    //     })\n    //     .catch(error => {\n    //       reject(error);\n    //     });\n    // });\n  },\n\n  // remove token\n  resetToken({ commit }) {\n    return new Promise(resolve => {\n      removeToken(); // must remove  token  first\n      commit('RESET_STATE');\n      resolve();\n    });\n  }\n};\n\nexport default {\n  namespaced: true,\n  state,\n  mutations,\n  actions\n};\n"]}]}