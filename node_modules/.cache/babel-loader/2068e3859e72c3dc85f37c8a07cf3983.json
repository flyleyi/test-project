{"remainingRequest":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/babel-loader/lib/index.js!/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/eslint-loader/index.js??ref--13-0!/Users/fuyueyi/Desktop/practice/mutilwap/src/pages/logistics-data/store/modules/user.js","dependencies":[{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/src/pages/logistics-data/store/modules/user.js","mtime":1627979214318},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmcuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcudHJpbS5qcyI7CmltcG9ydCB7IGxvZ2luIGFzIF9sb2dpbiwgbG9nb3V0LCBnZXRJbmZvIGFzIF9nZXRJbmZvIH0gZnJvbSAnLi4vLi4vYXBpL3VzZXIvaW5kZXgnOwppbXBvcnQgeyBnZXRUb2tlbiwgc2V0VG9rZW4sIHJlbW92ZVRva2VuIH0gZnJvbSAnLi4vLi4vLi4vLi4vcGx1Z2lucy9jb3JlL2F1dGgnOwppbXBvcnQgeyByZXNldFJvdXRlciB9IGZyb20gJy4uLy4uL3JvdXRlcic7CmltcG9ydCBhdmF0YXJHaWYgZnJvbSAnLi4vLi4vYXNzZXRzL2ltYWdlcy9hdmF0YXIuZ2lmJzsKCnZhciBnZXREZWZhdWx0U3RhdGUgPSBmdW5jdGlvbiBnZXREZWZhdWx0U3RhdGUoKSB7CiAgcmV0dXJuIHsKICAgIHRva2VuOiBnZXRUb2tlbigpLAogICAgbmFtZTogJycsCiAgICBhdmF0YXI6IGF2YXRhckdpZiwKICAgIHN0YWZmQ29kZTogJycsCiAgICAvLyDlt6Xlj7cKICAgIHN0YWZmTmFtZTogJycgLy8g55So5oi35ZCNCgogIH07Cn07Cgp2YXIgc3RhdGUgPSBnZXREZWZhdWx0U3RhdGUoKTsKdmFyIG11dGF0aW9ucyA9IHsKICBSRVNFVF9TVEFURTogZnVuY3Rpb24gUkVTRVRfU1RBVEUoc3RhdGUpIHsKICAgIE9iamVjdC5hc3NpZ24oc3RhdGUsIGdldERlZmF1bHRTdGF0ZSgpKTsKICB9LAogIFNFVF9UT0tFTjogZnVuY3Rpb24gU0VUX1RPS0VOKHN0YXRlLCB0b2tlbikgewogICAgc3RhdGUudG9rZW4gPSB0b2tlbjsKICB9LAogIFNFVF9OQU1FOiBmdW5jdGlvbiBTRVRfTkFNRShzdGF0ZSwgbmFtZSkgewogICAgc3RhdGUubmFtZSA9IG5hbWU7CiAgfSwKICBTRVRfQVZBVEFSOiBmdW5jdGlvbiBTRVRfQVZBVEFSKHN0YXRlLCBhdmF0YXIpIHsKICAgIHN0YXRlLmF2YXRhciA9IGF2YXRhcjsKICB9LAogIFNFVF9TVEFGRl9DT0RFOiBmdW5jdGlvbiBTRVRfU1RBRkZfQ09ERShzdGF0ZSwgc3RhZmZDb2RlKSB7CiAgICBzdGF0ZS5zdGFmZkNvZGUgPSBzdGFmZkNvZGU7CiAgfSwKICBTRVRfU1RBRkZfTkFNRTogZnVuY3Rpb24gU0VUX1NUQUZGX05BTUUoc3RhdGUsIHN0YWZmTmFtZSkgewogICAgc3RhdGUuc3RhZmZOYW1lID0gc3RhZmZOYW1lOwogIH0KfTsKdmFyIGFjdGlvbnMgPSB7CiAgLy8gdXNlciBsb2dpbgogIGxvZ2luOiBmdW5jdGlvbiBsb2dpbihfcmVmLCB1c2VySW5mbykgewogICAgdmFyIGNvbW1pdCA9IF9yZWYuY29tbWl0OwogICAgdmFyIHVzZXJuYW1lID0gdXNlckluZm8udXNlcm5hbWUsCiAgICAgICAgcGFzc3dvcmQgPSB1c2VySW5mby5wYXNzd29yZDsKICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgIF9sb2dpbih7CiAgICAgICAgdXNlcm5hbWU6IHVzZXJuYW1lLnRyaW0oKSwKICAgICAgICBwYXNzd29yZDogcGFzc3dvcmQKICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICB2YXIgZGF0YSA9IHJlc3BvbnNlLmRhdGE7CiAgICAgICAgY29tbWl0KCdTRVRfVE9LRU4nLCBkYXRhLnRva2VuKTsKICAgICAgICBzZXRUb2tlbihkYXRhLnRva2VuKTsKICAgICAgICByZXNvbHZlKCk7CiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnJvcikgewogICAgICAgIHJlamVjdChlcnJvcik7CiAgICAgIH0pOwogICAgfSk7CiAgfSwKICAvLyBnZXQgdXNlciBpbmZvCiAgZ2V0SW5mbzogZnVuY3Rpb24gZ2V0SW5mbyhfcmVmMikgewogICAgdmFyIGNvbW1pdCA9IF9yZWYyLmNvbW1pdCwKICAgICAgICBzdGF0ZSA9IF9yZWYyLnN0YXRlOwogICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgX2dldEluZm8oc3RhdGUudG9rZW4pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgdmFyIGRhdGEgPSByZXNwb25zZS5kYXRhOwoKICAgICAgICBpZiAoIWRhdGEpIHsKICAgICAgICAgIHJldHVybiByZWplY3QoJ1ZlcmlmaWNhdGlvbiBmYWlsZWQsIHBsZWFzZSBMb2dpbiBhZ2Fpbi4nKTsKICAgICAgICB9CgogICAgICAgIHZhciBuYW1lID0gZGF0YS5uYW1lLAogICAgICAgICAgICBhdmF0YXIgPSBkYXRhLmF2YXRhciwKICAgICAgICAgICAgc3RhZmZOYW1lID0gZGF0YS5zdGFmZk5hbWUsCiAgICAgICAgICAgIHN0YWZmQ29kZSA9IGRhdGEuc3RhZmZDb2RlOyAvLyBjb21taXQoJ1NFVF9OQU1FJywgbmFtZSk7CiAgICAgICAgLy8gY29tbWl0KCdTRVRfQVZBVEFSJywgYXZhdGFyKTsKCiAgICAgICAgY29tbWl0KCdTRVRfU1RBRkZfQ09ERScsIHN0YWZmQ29kZSk7CiAgICAgICAgY29tbWl0KCdTRVRfU1RBRkZfTkFNRScsIHN0YWZmTmFtZSk7CiAgICAgICAgcmVzb2x2ZShkYXRhKTsKICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgcmVqZWN0KGVycm9yKTsKICAgICAgfSk7CiAgICB9KTsKICB9LAogIC8vIHVzZXIgbG9nb3V0CiAgbG9nb3V0OiBmdW5jdGlvbiBsb2dvdXQoX3JlZjMpIHsKICAgIHZhciBjb21taXQgPSBfcmVmMy5jb21taXQsCiAgICAgICAgc3RhdGUgPSBfcmVmMy5zdGF0ZTsKICAgIHJlbW92ZVRva2VuKCk7IC8vIG11c3QgcmVtb3ZlICB0b2tlbiAgZmlyc3QKCiAgICByZXNldFJvdXRlcigpOwogICAgY29tbWl0KCdSRVNFVF9TVEFURScpOyAvLyByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4gewogICAgLy8gICBsb2dvdXQoc3RhdGUudG9rZW4pCiAgICAvLyAgICAgLnRoZW4oKCkgPT4gewogICAgLy8gICAgICAgcmVtb3ZlVG9rZW4oKTsgLy8gbXVzdCByZW1vdmUgIHRva2VuICBmaXJzdAogICAgLy8gICAgICAgcmVzZXRSb3V0ZXIoKTsKICAgIC8vICAgICAgIGNvbW1pdCgnUkVTRVRfU1RBVEUnKTsKICAgIC8vICAgICAgIHJlc29sdmUoKTsKICAgIC8vICAgICB9KQogICAgLy8gICAgIC5jYXRjaChlcnJvciA9PiB7CiAgICAvLyAgICAgICByZWplY3QoZXJyb3IpOwogICAgLy8gICAgIH0pOwogICAgLy8gfSk7CiAgfSwKICAvLyByZW1vdmUgdG9rZW4KICByZXNldFRva2VuOiBmdW5jdGlvbiByZXNldFRva2VuKF9yZWY0KSB7CiAgICB2YXIgY29tbWl0ID0gX3JlZjQuY29tbWl0OwogICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7CiAgICAgIHJlbW92ZVRva2VuKCk7IC8vIG11c3QgcmVtb3ZlICB0b2tlbiAgZmlyc3QKCiAgICAgIGNvbW1pdCgnUkVTRVRfU1RBVEUnKTsKICAgICAgcmVzb2x2ZSgpOwogICAgfSk7CiAgfQp9OwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZXNwYWNlZDogdHJ1ZSwKICBzdGF0ZTogc3RhdGUsCiAgbXV0YXRpb25zOiBtdXRhdGlvbnMsCiAgYWN0aW9uczogYWN0aW9ucwp9Ow=="},{"version":3,"sources":["/Users/fuyueyi/Desktop/practice/mutilwap/src/pages/logistics-data/store/modules/user.js"],"names":["login","logout","getInfo","getToken","setToken","removeToken","resetRouter","avatarGif","getDefaultState","token","name","avatar","staffCode","staffName","state","mutations","RESET_STATE","Object","assign","SET_TOKEN","SET_NAME","SET_AVATAR","SET_STAFF_CODE","SET_STAFF_NAME","actions","userInfo","commit","username","password","Promise","resolve","reject","trim","then","response","data","catch","error","resetToken","namespaced"],"mappings":"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","sourcesContent":["import { login, logout, getInfo } from '../../api/user/index';\r\nimport { getToken, setToken, removeToken } from '../../../../plugins/core/auth';\r\nimport { resetRouter } from '../../router';\r\nimport avatarGif from '../../assets/images/avatar.gif';\r\n\r\nconst getDefaultState = () => {\r\n  return {\r\n    token: getToken(),\r\n    name: '',\r\n    avatar: avatarGif,\r\n    staffCode: '', // 工号\r\n    staffName: '' // 用户名\r\n  };\r\n};\r\n\r\nconst state = getDefaultState();\r\n\r\nconst mutations = {\r\n  RESET_STATE: state => {\r\n    Object.assign(state, getDefaultState());\r\n  },\r\n  SET_TOKEN: (state, token) => {\r\n    state.token = token;\r\n  },\r\n  SET_NAME: (state, name) => {\r\n    state.name = name;\r\n  },\r\n  SET_AVATAR: (state, avatar) => {\r\n    state.avatar = avatar;\r\n  },\r\n  SET_STAFF_CODE: (state, staffCode) => {\r\n    state.staffCode = staffCode;\r\n  },\r\n  SET_STAFF_NAME: (state, staffName) => {\r\n    state.staffName = staffName;\r\n  }\r\n};\r\n\r\nconst actions = {\r\n  // user login\r\n  login({ commit }, userInfo) {\r\n    const { username, password } = userInfo;\r\n    return new Promise((resolve, reject) => {\r\n      login({ username: username.trim(), password: password })\r\n        .then(response => {\r\n          const { data } = response;\r\n          commit('SET_TOKEN', data.token);\r\n          setToken(data.token);\r\n          resolve();\r\n        })\r\n        .catch(error => {\r\n          reject(error);\r\n        });\r\n    });\r\n  },\r\n\r\n  // get user info\r\n  getInfo({ commit, state }) {\r\n    return new Promise((resolve, reject) => {\r\n      getInfo(state.token)\r\n        .then(response => {\r\n          const { data } = response;\r\n\r\n          if (!data) {\r\n            return reject('Verification failed, please Login again.');\r\n          }\r\n\r\n          const { name, avatar, staffName, staffCode } = data;\r\n\r\n          // commit('SET_NAME', name);\r\n          // commit('SET_AVATAR', avatar);\r\n          commit('SET_STAFF_CODE', staffCode);\r\n          commit('SET_STAFF_NAME', staffName);\r\n          resolve(data);\r\n        })\r\n        .catch(error => {\r\n          reject(error);\r\n        });\r\n    });\r\n  },\r\n\r\n  // user logout\r\n  logout({ commit, state }) {\r\n    removeToken(); // must remove  token  first\r\n    resetRouter();\r\n    commit('RESET_STATE');\r\n    // return new Promise((resolve, reject) => {\r\n    //   logout(state.token)\r\n    //     .then(() => {\r\n    //       removeToken(); // must remove  token  first\r\n    //       resetRouter();\r\n    //       commit('RESET_STATE');\r\n    //       resolve();\r\n    //     })\r\n    //     .catch(error => {\r\n    //       reject(error);\r\n    //     });\r\n    // });\r\n  },\r\n\r\n  // remove token\r\n  resetToken({ commit }) {\r\n    return new Promise(resolve => {\r\n      removeToken(); // must remove  token  first\r\n      commit('RESET_STATE');\r\n      resolve();\r\n    });\r\n  }\r\n};\r\n\r\nexport default {\r\n  namespaced: true,\r\n  state,\r\n  mutations,\r\n  actions\r\n};\r\n"]}]}