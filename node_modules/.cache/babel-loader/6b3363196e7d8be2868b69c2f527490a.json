{"remainingRequest":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/node_modules/thread-loader/dist/cjs.js!/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/node_modules/babel-loader/lib/index.js!/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/src/pages/catering/views/order/NewOrder/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/src/pages/catering/views/order/NewOrder/index.vue","mtime":1645178321129},{"path":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF90b0NvbnN1bWFibGVBcnJheSBmcm9tICIvVXNlcnMvZnV5dWV5aS9EZXNrdG9wL3lqeS1wcm9qZWN0cy9tdWx0aS1wcm9qZWN0L211dGlsd2FwL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS90b0NvbnN1bWFibGVBcnJheSI7CmltcG9ydCBfcmVnZW5lcmF0b3JSdW50aW1lIGZyb20gIkBiYWJlbC9ydW50aW1lL3JlZ2VuZXJhdG9yIjsKaW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIi9Vc2Vycy9mdXl1ZXlpL0Rlc2t0b3AveWp5LXByb2plY3RzL211bHRpLXByb2plY3QvbXV0aWx3YXAvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IiOwppbXBvcnQgX29iamVjdFNwcmVhZCBmcm9tICIvVXNlcnMvZnV5dWV5aS9EZXNrdG9wL3lqeS1wcm9qZWN0cy9tdWx0aS1wcm9qZWN0L211dGlsd2FwL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9vYmplY3RTcHJlYWQyIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm51bWJlci50by1maXhlZC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5Lm1hcC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmcuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcudHJpbS5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZpbHRlci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi5kb20tY29sbGVjdGlvbnMuZm9yLWVhY2guanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5maW5kLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuc3BsaWNlLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaW5jbHVkZXMuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcuaW5jbHVkZXMuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5maW5kLWluZGV4LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmtleXMuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5zdHJpbmcucGFkLXN0YXJ0LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMucmVnZXhwLnRvLXN0cmluZy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnN0cmluZy5zdWIuanMiOwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwppbXBvcnQgeyBmb3JtYXRJbnB1dCB9IGZyb20gJy4uLy4uL0Jhc2ljRGF0YS8vdXRpbHMuanMnOwppbXBvcnQgRGVjaW1hbCBmcm9tICdkZWNpbWFsLmpzJzsKaW1wb3J0IENEeW5hbWljRm9ybSBmcm9tICdAL2NvbXBvbmVudHMvY29tbW9uL0NEeW5hbWljRm9ybSc7IC8vIGltcG9ydCBCVGFibGUgZnJvbSAnQC9jb21wb25lbnRzL2J1c2luZXNzL0JUYWJsZSc7CgppbXBvcnQgbWVhbERheUxpc3QgZnJvbSAnLi9kYXRhJzsKaW1wb3J0IENUYWJsZSBmcm9tICdAL2NvbXBvbmVudHMvY29tbW9uL0NUYWJsZSc7CmltcG9ydCB7IGJhc2VUcmVlV2l0aFBvd2VyU2Nob29sIGFzIF9iYXNlVHJlZVdpdGhQb3dlclNjaG9vbCwgb3JkZXJTdGF0aXN0aWNzIGFzIF9vcmRlclN0YXRpc3RpY3MsIGdldE9yZGVyRGV0YWlsIGFzIF9nZXRPcmRlckRldGFpbCwgb3JkZXJDb250ZW50Rm9yU2VsZWN0IGFzIF9vcmRlckNvbnRlbnRGb3JTZWxlY3QsIG9yZGVyQ29udGVudEZvclNlbGVjdEluZ3JlZGllbnQsIGRlbGV0ZU9yZGVyLCBkZWxldGVPcmRlckNvbnRlbnQsIHNhdmVPcmRlckFuZENvbnRlbnQgYXMgX3NhdmVPcmRlckFuZENvbnRlbnQsIGFwcHJvdmVPcmRlciwgb3JkZXJDb250ZW50Rm9yUGFnZSBhcyBfb3JkZXJDb250ZW50Rm9yUGFnZSwgc2F2ZU9yZGVyQmFzZSBhcyBfc2F2ZU9yZGVyQmFzZSB9IGZyb20gJy4uLy4uLy4uL2FwaS9vcmRlci9pbmRleCc7CmltcG9ydCB7IGdldEluZ3JlZGllbnRUcmVlIH0gZnJvbSAnLi4vLi4vLi4vYXBpL0Jhc2VEYXRhL2luZGV4LmpzJzsKaW1wb3J0IHsgaGFuZGxlTWVhbERhdGEgfSBmcm9tICdAL3BhZ2VzL2NhdGVyaW5nL3BsdWdpbnMvY29tbW9uL3V0aWxzJzsKaW1wb3J0IHsgY3V0TWF0Y2hTdGFuZGFyZExpc3QgfSBmcm9tICcuLi8uLi8uLi9hcGkvY3Jvd2QnOwp2YXIgaW5pdFN0YXRpc3RpY3NJbmZvID0gewogIGNvbnRlbnROdW06ICcwLjAwJywKICAvL+iuouWNleWGheWuueaVsOmHjwogIGNsZWFuVmVnZXRhYmxlV2VpZ2h0OiAnMC4wMCcsCiAgLy/lh4Doj5zph43ph48KICBvcmlnaW5hbFZlZ2V0YWJsZVdlaWdodDogJzAuMDAnLAogIC8v5q+b6I+c5pWw6YePCiAgY29zdFByaWNlOiAnMC4wMCcsCiAgLy/miJDmnKzku7cKICBzZWxsaW5nUHJpY2U6ICcwLjAwJyAvL+WUruS7twoKfTsKZXhwb3J0IGRlZmF1bHQgewogIGNvbXBvbmVudHM6IHsKICAgIENEeW5hbWljRm9ybTogQ0R5bmFtaWNGb3JtLAogICAgLy8gQlRhYmxlLAogICAgQ1RhYmxlOiBDVGFibGUKICB9LAogIC8vIOWumuS5ieWxnuaApwogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICB2YXIgdGFicyA9IFsvLyB7CiAgICAvLyAgIGxhYmVsOiAn6I+c6LCx6YeH6LStJywKICAgIC8vICAgbmFtZTogJ21lbnUnCiAgICAvLyB9LAogICAgewogICAgICBsYWJlbDogJ+iPnOWTgScsCiAgICAgIG5hbWU6ICdkaXNoJwogICAgfSwgewogICAgICBsYWJlbDogJ+mjn+adkCcsCiAgICAgIG5hbWU6ICdpbmdyZWRpZW50cycKICAgIH1dOwogICAgdmFyIGRpYWxvZ1RhYnMgPSBbLy8gewogICAgLy8gICBsYWJlbDogJ+iPnOiwsScsCiAgICAvLyAgIG5hbWU6ICdtZW51JwogICAgLy8gfSwKICAgIHsKICAgICAgbGFiZWw6ICfoj5zlk4EnLAogICAgICBuYW1lOiAnZGlzaCcKICAgIH0sIHsKICAgICAgbGFiZWw6ICfpo5/mnZAnLAogICAgICBuYW1lOiAnaW5ncmVkaWVudHMnCiAgICB9XTsKICAgIHZhciB0YWJzS2V5TmFtZSA9IHsKICAgICAgbWVudTogJ+iPnOiwsScsCiAgICAgIGRpc2g6ICfoj5zlk4EnLAogICAgICBpbmdyZWRpZW50czogJ+mjn+adkCcKICAgIH07CiAgICByZXR1cm4gewogICAgICAvL+W9k+WJjeWunuS+iwogICAgICBjdXJyZW50dm06IHRoaXMsCiAgICAgIGZvcm1EYXRhOiB7fSwKICAgICAgYXJlYUxpc3Q6IFtdLAogICAgICBjaXR5TGlzdDogW10sCiAgICAgIG9yZGVyU2VhcmNoVHh0OiAnJywKICAgICAgZGlzdHJpY3RMaXN0OiBbXSwKICAgICAgc2Nob29sTGlzdDogW10sCiAgICAgIGRpc3RyaWN0Q29kZTogbnVsbCwKICAgICAgZGlhbG9nVmlzaWJsZTogZmFsc2UsCiAgICAgIGRpYWxvZ0RhdGVWaXNpYmxlOiBmYWxzZSwKICAgICAgZm9ybUF0dHJzOiB7CiAgICAgICAgaW5saW5lOiB0cnVlLAogICAgICAgIHNpemU6ICdzbWFsbCcKICAgICAgfSwKICAgICAgdGFiczogdGFicywKICAgICAgdGFic0tleU5hbWU6IHRhYnNLZXlOYW1lLAogICAgICBkaWFsb2dUYWJzOiBkaWFsb2dUYWJzLAogICAgICBvdXRPZlN0b2NrU3RhdHVzOiBbewogICAgICAgIGxhYmVsOiAn5YWo6YOoJywKICAgICAgICB2YWx1ZTogJycKICAgICAgfSwgewogICAgICAgIGxhYmVsOiAn57y66LSnJywKICAgICAgICB2YWx1ZTogMQogICAgICB9LCB7CiAgICAgICAgbGFiZWw6ICcg5pyJ6LSnJywKICAgICAgICB2YWx1ZTogMAogICAgICB9XSwKICAgICAgLy8gdW5zZWxlY3RUYWJsZURhdGE6IFtdLAogICAgICAvLyBzZWxlY3RlZFRhYmxlRGF0YTogW10sCiAgICAgIGFjdGl2ZU5hbWU6IHRhYnNbMF0ubmFtZSwKICAgICAgZGlhbG9nQWN0aXZlTmFtZTogZGlhbG9nVGFic1swXS5uYW1lLAogICAgICBkaWFsb2dEYXRhVW5TZWxlY3RPYmo6IHsKICAgICAgICBtZW51OiBbXSwKICAgICAgICBkaXNoOiBbXSwKICAgICAgICBpbmdyZWRpZW50czogW10KICAgICAgfSwKICAgICAgZGlhbG9nRGF0YVNlbGVjdGVkT2JqOiB7CiAgICAgICAgbWVudTogW10sCiAgICAgICAgZGlzaDogW10sCiAgICAgICAgaW5ncmVkaWVudHM6IFtdCiAgICAgIH0sCiAgICAgIGRpYWxvZ1Vuc2VsZWN0SW5wdXQ6ICcnLAogICAgICBkaWFsb2dTZWxlY3RlZElucHV0OiAnJywKICAgICAgb3JkZXJJZDogbnVsbCwKICAgICAgLy/mk43kvZznsbvlnosKICAgICAgb3BlcmFUeXBlOiBudWxsLAogICAgICAvLyBvcmRlcklkOiAzMywKICAgICAgcXVlcnlPYmplY3Q6IHsKICAgICAgICBpbmdyZWRpZW50czogMSwKICAgICAgICBkaXNoOiAyLAogICAgICAgIG1lbnU6IDMKICAgICAgfSwKICAgICAgZGV0YWlsSW5mbzoge30sCiAgICAgIHN0YXRpc3RpY3NJbmZvOiBpbml0U3RhdGlzdGljc0luZm8sCiAgICAgIGluaXRTdGF0aXN0aWNzSW5mbzogaW5pdFN0YXRpc3RpY3NJbmZvLAogICAgICAvLyBtZWFsVHlwZUxpc3Q6IHRoaXMuJEQoJ01FQUxfVFlQRScpLAogICAgICBtZWFsVHlwZUxpc3Q6IFt7CiAgICAgICAgbGFiZWw6ICfml6nppJAnLAogICAgICAgIHZhbHVlOiAxCiAgICAgIH0sIHsKICAgICAgICBsYWJlbDogJ+WNiOmkkCcsCiAgICAgICAgdmFsdWU6IDIKICAgICAgfSwgewogICAgICAgIGxhYmVsOiAn5pma6aSQJywKICAgICAgICB2YWx1ZTogMwogICAgICB9XSwKICAgICAgLy/ml7bpl7TpgInmi6nliJfooagKICAgICAgdGltZUxpc3Q6IFt7CiAgICAgICAgbGFiZWw6ICcwNDowMCcsCiAgICAgICAgdmFsdWU6ICcwNDowMCcKICAgICAgfSwgewogICAgICAgIGxhYmVsOiAnMDY6MDAnLAogICAgICAgIHZhbHVlOiAnMDY6MDAnCiAgICAgIH0sIHsKICAgICAgICBsYWJlbDogJzE1OjAwJywKICAgICAgICB2YWx1ZTogJzE1OjAwJwogICAgICB9XSwKICAgICAgd2Vla0xpc3Q6IFsn5pif5pyf5LiAJywgJ+aYn+acn+S6jCcsICfmmJ/mnJ/kuIknLCAn5pif5pyf5ZubJywgJ+aYn+acn+S6lCcsICfmmJ/mnJ/lha0nLCAn5pif5pyf5pelJ10sCiAgICAgIG9yZGVyUmVtYXJrOiAnJywKICAgICAgaXNFbXB0eTogZmFsc2UsCiAgICAgIC8v5piv5ZCm5Li656m6CiAgICAgIC8v5by55qGG5ZCN56ew77yI5Yik5pat5by55qGG6KGo5qC877yJCiAgICAgIGRpYWxvZ05hbWU6ICcnLAogICAgICBtZWFsRGF5TGlzdDogbWVhbERheUxpc3QsCiAgICAgIGRpYWxvZ1RpdGxlOiAnJywKICAgICAgZGlhbG9nRGF0ZVJhbmdlOiAnJywKICAgICAgLy/nvLrotKfnirbmgIEKICAgICAgb3V0T2ZTdG9ja1N0YXR1OiAnJywKICAgICAgLy/osIPmlpnmmK/lkKbkuIvljZUKICAgICAgaW5jbHVkaW5nRGlzaGVzU2Vhc29uaW5nOiAwLAogICAgICAvL+aYr+WQpuesrOS4gOasoeWIneWni+WMluWcsOWMugogICAgICBpc0ZpcnN0SW5pdDogdHJ1ZSwKICAgICAgc2VsZWN0ZWRJbmdyZWRpZW50TGlzdDogW10sCiAgICAgIC8v6aOf5p2Q5by55qGG5Y+z5L6n6YCJ5Lit5pWw5o2uCiAgICAgIGxlZnRJbmdyZWRpZW50RGF0YTogW10sCiAgICAgIC8v6aOf5p2Q5by55qGG5bem5L6n5bGV56S65pWw5o2u5YyF5ousdGFi5bGV56S6CiAgICAgIGxlZnRJbmdyZWRpZW50RGF0YUxpc3Q6IFtdLAogICAgICAvLyDpo5/mnZDlvLnmoYblt6bkvqfmiYDmnInpo5/mnZDmlbDmja4KICAgICAgc2lkZUFjdGl2ZTogZmFsc2UgLy8gcGlja2VyT3B0aW9uczogewogICAgICAvLyAgIGRpc2FibGVkRGF0ZSh0aW1lKSB7CiAgICAgIC8vICAgICByZXR1cm4gdGltZS5nZXRUaW1lKCkgPCBEYXRlLm5vdygpOwogICAgICAvLyAgIH0KICAgICAgLy8gfQoKICAgIH07CiAgfSwKICBmaWx0ZXJzOiB7CiAgICBmaWx0ZXJXZWlnaHQ6IGZ1bmN0aW9uIGZpbHRlcldlaWdodChpdGVtKSB7CiAgICAgIGlmIChpdGVtLnBhY2tOdW0gPT0gbnVsbCB8fCBpdGVtLnBhY2tOdW0gPT0gJycgfHwgIWl0ZW0ubmV0V2VpZ2h0KSB7CiAgICAgICAgcmV0dXJuICctJzsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gK25ldyBEZWNpbWFsKCtpdGVtLnBhY2tOdW0pLm11bChuZXcgRGVjaW1hbCgraXRlbS5uZXRXZWlnaHQpKTsKICAgICAgfQogICAgfSwKICAgIGZpbHRlckNvc3RQcmljZTogZnVuY3Rpb24gZmlsdGVyQ29zdFByaWNlKGl0ZW0sIHZtKSB7CiAgICAgIGlmIChpdGVtLnF1YW50aXR5ID09IG51bGwgfHwgaXRlbS5xdWFudGl0eSA9PSAnJyB8fCB2bS5pbmNsdWRpbmdEaXNoZXNTZWFzb25pbmcgJiYgIWl0ZW0uY29zdFByaWNlIHx8ICF2bS5pbmNsdWRpbmdEaXNoZXNTZWFzb25pbmcgJiYgIWl0ZW0uZXhjbHVkaW5nU2Vhc29uaW5nQ29zdFByaWNlKSB7CiAgICAgICAgcmV0dXJuICctJzsKICAgICAgfSBlbHNlIHsKICAgICAgICB2YXIgcHJpY2UgPSB2bS5pbmNsdWRpbmdEaXNoZXNTZWFzb25pbmcgPyBpdGVtLmNvc3RQcmljZSA6IGl0ZW0uZXhjbHVkaW5nU2Vhc29uaW5nQ29zdFByaWNlOwogICAgICAgIHJldHVybiArbmV3IERlY2ltYWwoK2l0ZW0ucXVhbnRpdHkpLm11bChuZXcgRGVjaW1hbCgrcHJpY2UpKTsKICAgICAgfQogICAgfSwKICAgIGZpbHRlclNlbGxpbmdQcmljZTogZnVuY3Rpb24gZmlsdGVyU2VsbGluZ1ByaWNlKGl0ZW0pIHsKICAgICAgaWYgKGl0ZW0ucXVhbnRpdHkgPT0gbnVsbCB8fCBpdGVtLnF1YW50aXR5ID09ICcnIHx8ICFpdGVtLnNlbGxpbmdQcmljZSkgewogICAgICAgIHJldHVybiAnLSc7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuICtuZXcgRGVjaW1hbCgraXRlbS5xdWFudGl0eSkubXVsKG5ldyBEZWNpbWFsKCtpdGVtLnNlbGxpbmdQcmljZSkpOwogICAgICB9CiAgICB9LAogICAgZmlsdGVyQ2xlYW5WZWdldGFibGVQcmljZTogZnVuY3Rpb24gZmlsdGVyQ2xlYW5WZWdldGFibGVQcmljZShpdGVtKSB7CiAgICAgIGlmIChpdGVtLnBhY2tOdW0gPT0gbnVsbCB8fCBpdGVtLnBhY2tOdW0gPT0gJycgfHwgIWl0ZW0uY2xlYW5WZWdldGFibGVQcmljZSkgewogICAgICAgIHJldHVybiAnLSc7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuICtuZXcgRGVjaW1hbCgraXRlbS5wYWNrTnVtKS5tdWwobmV3IERlY2ltYWwoK2l0ZW0uY2xlYW5WZWdldGFibGVQcmljZSkpOwogICAgICB9CiAgICB9LAogICAgZmlsdGVyT3JpZ2luYWxWZWdldGFibGVQcmljZTogZnVuY3Rpb24gZmlsdGVyT3JpZ2luYWxWZWdldGFibGVQcmljZShpdGVtKSB7CiAgICAgIGlmIChpdGVtLnBhY2tOdW0gPT0gbnVsbCB8fCBpdGVtLnBhY2tOdW0gPT0gJycgfHwgIWl0ZW0ubmV0V2VpZ2h0IHx8ICFpdGVtLm9yaWdpbmFsVmVnZXRhYmxlUHJpY2UpIHsKICAgICAgICByZXR1cm4gJy0nOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiArbmV3IERlY2ltYWwoK2l0ZW0ucGFja051bSkubXVsKCtpdGVtLm5ldFdlaWdodCkubXVsKG5ldyBEZWNpbWFsKCtpdGVtLm9yaWdpbmFsVmVnZXRhYmxlUHJpY2UpKTsKICAgICAgfQogICAgfSwKICAgIGZpbHRlckluZ3JlZGllbnRzQ29zdFByaWNlOiBmdW5jdGlvbiBmaWx0ZXJJbmdyZWRpZW50c0Nvc3RQcmljZShpdGVtKSB7CiAgICAgIGlmIChpdGVtLnBhY2tOdW0gPT0gbnVsbCB8fCBpdGVtLnBhY2tOdW0gPT0gJycgfHwgIWl0ZW0ubmV0V2VpZ2h0IHx8ICFpdGVtLmN1dE1hdGNoU3RhbmRhcmRJZCB8fCBpdGVtLmN1dE1hdGNoU3RhbmRhcmRJZCA9PT0gMTAgJiYgIWl0ZW0ub3JpZ2luYWxWZWdldGFibGVQcmljZSB8fCBpdGVtLmN1dE1hdGNoU3RhbmRhcmRJZCAhPT0gMTAgJiYgIWl0ZW0uY2xlYW5WZWdldGFibGVQcmljZSkgewogICAgICAgIHJldHVybiAnLSc7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdmFyIHByaWNlID0gaXRlbS5jdXRNYXRjaFN0YW5kYXJkSWQgPT09IDEwID8gaXRlbS5vcmlnaW5hbFZlZ2V0YWJsZVByaWNlIDogaXRlbS5jbGVhblZlZ2V0YWJsZVByaWNlOwogICAgICAgIHJldHVybiAoK25ldyBEZWNpbWFsKCtpdGVtLnBhY2tOdW0pLm11bCgraXRlbS5uZXRXZWlnaHQpLm11bChuZXcgRGVjaW1hbCgrcHJpY2UpKSkudG9GaXhlZCgyKTsKICAgICAgfQogICAgfSwKICAgIC8v5pep6aSQ55So6aSQ5pel5pyfKzHlpKnvvIzljYjppJDmmZrppJDnlKjppJDml6XmnJ/kuLrlvZPlpKkKICAgIGZpbHRlckRpc2hNZWFsRGF0ZTogZnVuY3Rpb24gZmlsdGVyRGlzaE1lYWxEYXRlKGl0ZW0sIHZtKSB7CiAgICAgIGlmICghaXRlbS5tZWFsVHlwZSB8fCAhaXRlbS5hcnJpdmFsRGF0ZSkgewogICAgICAgIHJldHVybiAnLSc7CiAgICAgIH0KCiAgICAgIHZhciB3ZWVrTGlzdCA9IFsn5ZGo5pelJywgJ+WRqOS4gCcsICflkajkuownLCAn5ZGo5LiJJywgJ+WRqOWbmycsICflkajkupQnLCAn5ZGo5YWtJ107CiAgICAgIHZhciBkYXRlOwogICAgICB2YXIgdGltZVN0YW1wOwoKICAgICAgaWYgKGl0ZW0ubWVhbFR5cGUgPT0gMSkgewogICAgICAgIHRpbWVTdGFtcCA9IG5ldyBEYXRlKGl0ZW0uYXJyaXZhbERhdGUpLmdldFRpbWUoKSArIDEwMDAgKiAzNjAwICogMjQ7CiAgICAgICAgZGF0ZSA9IHZtLmZvcm1hdGVEYXRlKHRpbWVTdGFtcCkgKyAnICcgKyB3ZWVrTGlzdFtuZXcgRGF0ZSh0aW1lU3RhbXApLmdldERheSgpXTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aW1lU3RhbXAgPSBuZXcgRGF0ZShpdGVtLmFycml2YWxEYXRlKS5nZXRUaW1lKCk7CiAgICAgICAgZGF0ZSA9IHZtLmZvcm1hdGVEYXRlKHRpbWVTdGFtcCkgKyAnICcgKyB3ZWVrTGlzdFtuZXcgRGF0ZSh0aW1lU3RhbXApLmdldERheSgpXTsKICAgICAgfQoKICAgICAgaXRlbS5tZWFsRGF0ZSA9IHZtLmZvcm1hdGVEYXRlKHRpbWVTdGFtcCk7CiAgICAgIHJldHVybiBkYXRlOwogICAgfSwKICAgIGZpbHRlckluZ3JlZGllbnRNZWFsRGF0ZTogZnVuY3Rpb24gZmlsdGVySW5ncmVkaWVudE1lYWxEYXRlKGl0ZW0sIHZtKSB7CiAgICAgIGlmICghaXRlbS5hcnJpdmFsRGF0ZSkgewogICAgICAgIHJldHVybiAnLSc7CiAgICAgIH0KCiAgICAgIHZhciB3ZWVrTGlzdCA9IFsn5ZGo5pelJywgJ+WRqOS4gCcsICflkajkuownLCAn5ZGo5LiJJywgJ+WRqOWbmycsICflkajkupQnLCAn5ZGo5YWtJ107CiAgICAgIHZhciB0aW1lU3RhbXAgPSBuZXcgRGF0ZShpdGVtLmFycml2YWxEYXRlKS5nZXRUaW1lKCk7CiAgICAgIGl0ZW0ubWVhbERhdGUgPSB2bS5mb3JtYXRlRGF0ZSh0aW1lU3RhbXApOwogICAgICB2YXIgZGF0ZSA9IHZtLmZvcm1hdGVEYXRlKHRpbWVTdGFtcCkgKyAnICcgKyB3ZWVrTGlzdFtuZXcgRGF0ZSh0aW1lU3RhbXApLmdldERheSgpXTsKICAgICAgcmV0dXJuIGRhdGU7CiAgICB9CiAgfSwKICAvLyDorqHnrpflsZ7mgKfvvIzkvJrnm5HlkKzkvp3otZblsZ7mgKflgLzpmo/kuYvlj5jljJYKICBjb21wdXRlZDogewogICAgZXhwYW5kSGVhZGVyczogZnVuY3Rpb24gZXhwYW5kSGVhZGVycygpIHsKICAgICAgdmFyIGxpc3QgPSB0aGlzLndlZWtMaXN0Lm1hcChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgIHJldHVybiB7CiAgICAgICAgICBsYWJlbDogaXRlbSwKICAgICAgICAgIHByb3A6IGl0ZW0sCiAgICAgICAgICBjb2xUeXBlOiAnY29sdW1uJwogICAgICAgIH07CiAgICAgIH0pOwogICAgICBsaXN0LnVuc2hpZnQoewogICAgICAgIGxhYmVsOiAnJywKICAgICAgICBwcm9wOiAnbWVhbFR5cGVTdHJpbmcnCiAgICAgIH0pOwogICAgICByZXR1cm4gbGlzdDsKICAgIH0sCiAgICBkaWFsb2dTZWxlY3RlZEhlYWRlcnM6IGZ1bmN0aW9uIGRpYWxvZ1NlbGVjdGVkSGVhZGVycygpIHsKICAgICAgdmFyIGhlYWRlcnMgPSBbXTsKCiAgICAgIHN3aXRjaCAodGhpcy5hY3RpdmVOYW1lKSB7CiAgICAgICAgY2FzZSAnbWVudSc6CiAgICAgICAgICBoZWFkZXJzID0gWy8vIHsKICAgICAgICAgIC8vICAgdHlwZTogJ3NlbGVjdGlvbicKICAgICAgICAgIC8vIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgIGxhYmVsOiAn566A5ou8JywKICAgICAgICAgICAgcHJvcDogJ3BpbnlpbkhlYWRlcicKICAgICAgICAgIH0sIHsKICAgICAgICAgICAgbGFiZWw6ICfoj5zosLHlkI3np7AnLAogICAgICAgICAgICBwcm9wOiAncmVsYXRpb25OYW1lJwogICAgICAgICAgfSwgewogICAgICAgICAgICBsYWJlbDogJ+mAgueUqOS6uue+pCcsCiAgICAgICAgICAgIHByb3A6ICdjcm93ZE5hbWVzJwogICAgICAgICAgfSwgewogICAgICAgICAgICBsYWJlbDogJ+aVsOmHj++8iOS7ve+8iScsCiAgICAgICAgICAgIHByb3A6ICdxdWFudGl0eScsCiAgICAgICAgICAgIGNvbFR5cGU6ICdjb2x1bW4nLAogICAgICAgICAgICBzbG90TmFtZTogJ3F1YW50aXR5SW50ZWdlcicKICAgICAgICAgIH1dOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgJ2Rpc2gnOgogICAgICAgICAgaGVhZGVycyA9IFt7CiAgICAgICAgICAgIGxhYmVsOiAn6I+c5ZOB5ZCN56ewJywKICAgICAgICAgICAgcHJvcDogJ3JlbGF0aW9uTmFtZScKICAgICAgICAgIH0sIHsKICAgICAgICAgICAgbGFiZWw6ICfmlbDph4/vvIjku73vvIknLAogICAgICAgICAgICBwcm9wOiAncXVhbnRpdHknLAogICAgICAgICAgICBjb2xUeXBlOiAnY29sdW1uJywKICAgICAgICAgICAgc2xvdE5hbWU6ICdxdWFudGl0eUludGVnZXInLAogICAgICAgICAgICB3aWR0aDogMTQwCiAgICAgICAgICB9LCB7CiAgICAgICAgICAgIGxhYmVsOiAn5pON5L2cJywKICAgICAgICAgICAgY29sVHlwZTogJ2NvbHVtbicsCiAgICAgICAgICAgIHNsb3ROYW1lOiAnb3BlYXJ0aW9uJywKICAgICAgICAgICAgd2lkdGg6ICc4MCcKICAgICAgICAgIH1dOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgJ2luZ3JlZGllbnRzJzoKICAgICAgICAgIGhlYWRlcnMgPSBbewogICAgICAgICAgICBsYWJlbDogJ+mjn+adkOWQjeensCcsCiAgICAgICAgICAgIHByb3A6ICdyZWxhdGlvbk5hbWUnCiAgICAgICAgICB9LCB7CiAgICAgICAgICAgIGxhYmVsOiAn5pWw6YePJywKICAgICAgICAgICAgY29sVHlwZTogJ2NvbHVtbicsCiAgICAgICAgICAgIHNsb3ROYW1lOiAncGFja051bScsCiAgICAgICAgICAgIHdpZHRoOiAnMTgwJwogICAgICAgICAgfSwgewogICAgICAgICAgICBsYWJlbDogJ+aTjeS9nCcsCiAgICAgICAgICAgIGNvbFR5cGU6ICdjb2x1bW4nLAogICAgICAgICAgICBzbG90TmFtZTogJ29wZWFydGlvbicsCiAgICAgICAgICAgIHdpZHRoOiAnODAnCiAgICAgICAgICB9IC8vIHsKICAgICAgICAgIC8vICAgbGFiZWw6ICfmlbDph4/vvIhrZ++8iScsCiAgICAgICAgICAvLyAgIHByb3A6ICdxdWFudGl0eScsCiAgICAgICAgICAvLyAgIGNvbFR5cGU6ICdjb2x1bW4nLAogICAgICAgICAgLy8gICBzbG90TmFtZTogJ3F1YW50aXR5RGVjaW1hbCcKICAgICAgICAgIC8vIH0KICAgICAgICAgIF07CiAgICAgICAgICBicmVhazsKCiAgICAgICAgZGVmYXVsdDoKICAgICAgICAgIGJyZWFrOwogICAgICB9CgogICAgICByZXR1cm4gaGVhZGVyczsKICAgIH0sCiAgICBkaWFsb2dIZWFkZXJzOiBmdW5jdGlvbiBkaWFsb2dIZWFkZXJzKCkgewogICAgICB2YXIgaGVhZGVycyA9IFtdOwoKICAgICAgc3dpdGNoICh0aGlzLmRpYWxvZ05hbWUpIHsKICAgICAgICBjYXNlICdtZW51JzoKICAgICAgICAgIGhlYWRlcnMgPSBbLy8gewogICAgICAgICAgLy8gICB0eXBlOiAnc2VsZWN0aW9uJwogICAgICAgICAgLy8gfSwKICAgICAgICAgIHsKICAgICAgICAgICAgdHlwZTogJ2V4cGFuZCcsCiAgICAgICAgICAgIGNvbFR5cGU6ICdjb2x1bW4nLAogICAgICAgICAgICBzbG90TmFtZTogJ2V4cGFuZFRhYmxlJwogICAgICAgICAgfSwgewogICAgICAgICAgICBsYWJlbDogJ+eugOaLvCcsCiAgICAgICAgICAgIHByb3A6ICdwaW55aW5IZWFkZXInCiAgICAgICAgICB9LCB7CiAgICAgICAgICAgIGxhYmVsOiAn6I+c6LCx5ZCN56ewJywKICAgICAgICAgICAgcHJvcDogJ3JlbGF0aW9uTmFtZScKICAgICAgICAgIH0sIHsKICAgICAgICAgICAgbGFiZWw6ICfpgILnlKjkurrnvqQnLAogICAgICAgICAgICBwcm9wOiAnY3Jvd2ROYW1lcycKICAgICAgICAgIH1dOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgJ2Rpc2gnOgogICAgICAgICAgaGVhZGVycyA9IFsvLyB7CiAgICAgICAgICAvLyAgIHR5cGU6ICdzZWxlY3Rpb24nCiAgICAgICAgICAvLyB9LAogICAgICAgICAgewogICAgICAgICAgICBsYWJlbDogJ+eugOaLvCcsCiAgICAgICAgICAgIHByb3A6ICdwaW55aW5IZWFkZXInCiAgICAgICAgICB9LCB7CiAgICAgICAgICAgIGxhYmVsOiAn6I+c5ZOB5ZCN56ewJywKICAgICAgICAgICAgcHJvcDogJ3JlbGF0aW9uTmFtZScsCiAgICAgICAgICAgIGNvbFR5cGU6ICdjb2x1bW4nCiAgICAgICAgICB9LCB7CiAgICAgICAgICAgIGxhYmVsOiAn6I+c57O7JywKICAgICAgICAgICAgcHJvcDogJ2Rpc2hlc1N0eWxlTmFtZScKICAgICAgICAgIH0sIHsKICAgICAgICAgICAgbGFiZWw6ICfkurrnvqQnLAogICAgICAgICAgICBwcm9wOiAnY3Jvd2ROYW1lcycKICAgICAgICAgIH0sIHsKICAgICAgICAgICAgbGFiZWw6ICfmiJDmnKzlj4LogIPku7fvvIjlhYPvvIknLAogICAgICAgICAgICBwcm9wOiAnY29zdFByaWNlJywKICAgICAgICAgICAgd2lkdGg6ICcxMjAnCiAgICAgICAgICB9XTsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlICdpbmdyZWRpZW50cyc6CiAgICAgICAgICBoZWFkZXJzID0gWy8vIHsKICAgICAgICAgIC8vICAgdHlwZTogJ3NlbGVjdGlvbicKICAgICAgICAgIC8vIH0sCiAgICAgICAgICAvLyB7CiAgICAgICAgICAvLyAgIGxhYmVsOiAn566A5ou8JywKICAgICAgICAgIC8vICAgcHJvcDogJ3BpbnlpbkhlYWRlcicKICAgICAgICAgIC8vIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgIGxhYmVsOiAn6aOf5p2Q5ZCN56ewJywKICAgICAgICAgICAgcHJvcDogJ3JlbGF0aW9uTmFtZScsCiAgICAgICAgICAgIGNvbFR5cGU6ICdjb2x1bW4nLAogICAgICAgICAgICBzbG90TmFtZTogJ25hbWVhbmRqaWFucGluJwogICAgICAgICAgfSwgewogICAgICAgICAgICBsYWJlbDogJ+WNleS9jScsCiAgICAgICAgICAgIHByb3A6ICdwYWNrVW5pdCcsCiAgICAgICAgICAgIHdpZHRoOiA2MAogICAgICAgICAgfV07CiAgICAgICAgICBicmVhazsKCiAgICAgICAgZGVmYXVsdDoKICAgICAgICAgIGJyZWFrOwogICAgICB9CgogICAgICByZXR1cm4gaGVhZGVyczsKICAgIH0sCiAgICBoZWFkZXJzOiBmdW5jdGlvbiBoZWFkZXJzKCkgewogICAgICB2YXIgaGVhZGVycyA9IFtdOwoKICAgICAgc3dpdGNoICh0aGlzLmFjdGl2ZU5hbWUpIHsKICAgICAgICBjYXNlICdtZW51JzoKICAgICAgICAgIGhlYWRlcnMgPSBbewogICAgICAgICAgICBsYWJlbDogJ+eugOaLvCcsCiAgICAgICAgICAgIHByb3A6ICdwaW55aW5IZWFkZXInCiAgICAgICAgICB9LCB7CiAgICAgICAgICAgIGxhYmVsOiAn6I+c6LCx5ZCN56ewJywKICAgICAgICAgICAgcHJvcDogJ3JlbGF0aW9uTmFtZScKICAgICAgICAgIH0sIHsKICAgICAgICAgICAgbGFiZWw6ICfpgILnlKjkurrnvqQnLAogICAgICAgICAgICBwcm9wOiAnY3Jvd2ROYW1lcycKICAgICAgICAgIH0sIHsKICAgICAgICAgICAgbGFiZWw6ICfmlbDph4/vvIjku73vvIknLAogICAgICAgICAgICBwcm9wOiAncXVhbnRpdHknCiAgICAgICAgICB9LCB7CiAgICAgICAgICAgIGxhYmVsOiAn5oiQ5pys5Y+C6ICD5Lu377yI5YWD77yJJywKICAgICAgICAgICAgcHJvcDogJ2Nvc3RQcmljZScsCiAgICAgICAgICAgIC8vIHdpZHRoOiAxMDAsCiAgICAgICAgICAgIC8vIGFsaWduOiAncmlnaHQnLAogICAgICAgICAgICB3aWR0aDogJzEyMCcsCiAgICAgICAgICAgIGNvbFR5cGU6ICdjb2x1bW4nCiAgICAgICAgICB9LCB7CiAgICAgICAgICAgIGxhYmVsOiAn5ZSu5Lu377yI5YWD77yJJywKICAgICAgICAgICAgcHJvcDogJ3NlbGxpbmdQcmljZScsCiAgICAgICAgICAgIC8vIHdpZHRoOiAxMDAsCiAgICAgICAgICAgIC8vIGFsaWduOiAncmlnaHQnLAogICAgICAgICAgICBjb2xUeXBlOiAnY29sdW1uJwogICAgICAgICAgfSwgewogICAgICAgICAgICBsYWJlbDogJ+aTjeS9nCcsCiAgICAgICAgICAgIGNvbFR5cGU6ICdidG5zJywKICAgICAgICAgICAgLy8gZml4ZWQ6ICdyaWdodCcsCiAgICAgICAgICAgIHdpZHRoOiAnMTIwcHgnLAogICAgICAgICAgICBidG5zOiBbewogICAgICAgICAgICAgIGxhYmVsOiAn57yW6L6RJywKICAgICAgICAgICAgICB0eXBlOiAndGV4dCcsCiAgICAgICAgICAgICAgc2l6ZTogJ21pbmknLAogICAgICAgICAgICAgIGNsaWNrOiB0aGlzLmVkaXRDcm93ZAogICAgICAgICAgICB9LCB7CiAgICAgICAgICAgICAgbGFiZWw6ICfliKDpmaQnLAogICAgICAgICAgICAgIHR5cGU6ICd0ZXh0JywKICAgICAgICAgICAgICBzaXplOiAnbWluaScsCiAgICAgICAgICAgICAgY2xpY2s6IHRoaXMuZGVsZXRlQ3Jvd2QKICAgICAgICAgICAgfV0KICAgICAgICAgIH1dOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgJ2Rpc2gnOgogICAgICAgICAgaGVhZGVycyA9IFsvLyB7CiAgICAgICAgICAvLyAgIGxhYmVsOiAn566A5ou8JywKICAgICAgICAgIC8vICAgcHJvcDogJ3BpbnlpbkhlYWRlcicKICAgICAgICAgIC8vIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgIGxhYmVsOiAn5bqP5Y+3JywKICAgICAgICAgICAgYWxpZ246ICdjZW50ZXInLAogICAgICAgICAgICB0eXBlOiAnaW5kZXgnCiAgICAgICAgICB9LCB7CiAgICAgICAgICAgIGxhYmVsOiAn55So6aSQ5pel5pyfJywKICAgICAgICAgICAgY29sVHlwZTogJ2NvbHVtbicsCiAgICAgICAgICAgIHNsb3ROYW1lOiAnbWVhbERhdGUnCiAgICAgICAgICB9LCB7CiAgICAgICAgICAgIGxhYmVsOiAn6I+c5ZOB5ZCN56ewJywKICAgICAgICAgICAgcHJvcDogJ3JlbGF0aW9uTmFtZScsCiAgICAgICAgICAgIGNvbFR5cGU6ICdjb2x1bW4nCiAgICAgICAgICB9LCB7CiAgICAgICAgICAgIGxhYmVsOiAn6I+c57O7JywKICAgICAgICAgICAgcHJvcDogJ2Rpc2hlc1N0eWxlTmFtZScKICAgICAgICAgIH0sIHsKICAgICAgICAgICAgbGFiZWw6ICfkurrnvqQnLAogICAgICAgICAgICBwcm9wOiAnY3Jvd2ROYW1lcycKICAgICAgICAgIH0sIHsKICAgICAgICAgICAgbGFiZWw6ICfppJDliKsnLAogICAgICAgICAgICBwcm9wOiAnbWVhbFR5cGUnLAogICAgICAgICAgICBjb2xUeXBlOiAnY29sdW1uJywKICAgICAgICAgICAgd2lkdGg6ICcxMDBweCcKICAgICAgICAgIH0sIHsKICAgICAgICAgICAgbGFiZWw6ICfmlbDph4/vvIjku73vvIknLAogICAgICAgICAgICBwcm9wOiAncXVhbnRpdHknLAogICAgICAgICAgICBjb2xUeXBlOiAnY29sdW1uJywKICAgICAgICAgICAgc2xvdE5hbWU6ICdxdWFudGl0eUludGVnZXInLAogICAgICAgICAgICB3aWR0aDogJzEwMHB4JwogICAgICAgICAgfSwgewogICAgICAgICAgICBsYWJlbDogJ+WIsOi0p+aXtumXtCcsCiAgICAgICAgICAgIGNvbFR5cGU6ICdjb2x1bW4nLAogICAgICAgICAgICBzbG90TmFtZTogJ2Fycml2YWxEYXRlJywKICAgICAgICAgICAgd2lkdGg6ICcyNTBweCcKICAgICAgICAgIH0sIHsKICAgICAgICAgICAgbGFiZWw6ICfmiJDmnKzlj4LogIPku7fvvIjlhYPvvIknLAogICAgICAgICAgICBwcm9wOiAnY29zdFByaWNlJywKICAgICAgICAgICAgd2lkdGg6IDEyMCwKICAgICAgICAgICAgLy8gYWxpZ246ICdyaWdodCcsCiAgICAgICAgICAgIGNvbFR5cGU6ICdjb2x1bW4nCiAgICAgICAgICB9LCB7CiAgICAgICAgICAgIGxhYmVsOiAn5ZSu5Lu377yI5YWD77yJJywKICAgICAgICAgICAgcHJvcDogJ3NlbGxpbmdQcmljZScsCiAgICAgICAgICAgIHdpZHRoOiAxMDAsCiAgICAgICAgICAgIC8vIGFsaWduOiAncmlnaHQnLAogICAgICAgICAgICBjb2xUeXBlOiAnY29sdW1uJwogICAgICAgICAgfSwgewogICAgICAgICAgICBsYWJlbDogJ+aTjeS9nCcsCiAgICAgICAgICAgIGNvbFR5cGU6ICdidG5zJywKICAgICAgICAgICAgLy8gZml4ZWQ6ICdyaWdodCcsCiAgICAgICAgICAgIHdpZHRoOiAnMTIwcHgnLAogICAgICAgICAgICBidG5zOiBbLy8gewogICAgICAgICAgICAvLyAgIGxhYmVsOiAn57yW6L6RJywKICAgICAgICAgICAgLy8gICB0eXBlOiAndGV4dCcsCiAgICAgICAgICAgIC8vICAgc2l6ZTogJ21pbmknLAogICAgICAgICAgICAvLyAgIGNsaWNrOiB0aGlzLmVkaXRDcm93ZAogICAgICAgICAgICAvLyB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbGFiZWw6ICfliKDpmaQnLAogICAgICAgICAgICAgIHR5cGU6ICd0ZXh0JywKICAgICAgICAgICAgICBzaXplOiAnbWluaScsCiAgICAgICAgICAgICAgY2xpY2s6IHRoaXMuZGVsZXRlQ3Jvd2QKICAgICAgICAgICAgfV0KICAgICAgICAgIH1dOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGNhc2UgJ2luZ3JlZGllbnRzJzoKICAgICAgICAgIGhlYWRlcnMgPSBbLy8gewogICAgICAgICAgLy8gICBsYWJlbDogJ+eugOaLvCcsCiAgICAgICAgICAvLyAgIHByb3A6ICdwaW55aW5IZWFkZXInCiAgICAgICAgICAvLyB9LAogICAgICAgICAgewogICAgICAgICAgICBsYWJlbDogJ+W6j+WPtycsCiAgICAgICAgICAgIGFsaWduOiAnY2VudGVyJywKICAgICAgICAgICAgdHlwZTogJ2luZGV4JwogICAgICAgICAgfSwgewogICAgICAgICAgICBsYWJlbDogJ+eUqOmkkOaXpeacnycsCiAgICAgICAgICAgIGNvbFR5cGU6ICdjb2x1bW4nLAogICAgICAgICAgICBzbG90TmFtZTogJ2luZ3JlZGllbnREYXRlJwogICAgICAgICAgfSwgewogICAgICAgICAgICBsYWJlbDogJ+mjn+adkOWQjeensCcsCiAgICAgICAgICAgIHByb3A6ICdyZWxhdGlvbk5hbWUnLAogICAgICAgICAgICBjb2xUeXBlOiAnY29sdW1uJwogICAgICAgICAgfSwgLy8gewogICAgICAgICAgLy8gICBsYWJlbDogJ+WIh+mFjeagh+WHhu+8iOmVvyrlrr0q6auYL2Nt77yJJywKICAgICAgICAgIC8vICAgY29sVHlwZTogJ2NvbHVtbicsCiAgICAgICAgICAvLyAgIHNsb3ROYW1lOiAnY3V0TWF0Y2hTdGFuZGFyZElkJywKICAgICAgICAgIC8vICAgd2lkdGg6ICcxODAnCiAgICAgICAgICAvLyB9LAogICAgICAgICAgewogICAgICAgICAgICBsYWJlbDogJ+aVsOmHjycsCiAgICAgICAgICAgIGNvbFR5cGU6ICdjb2x1bW4nLAogICAgICAgICAgICBzbG90TmFtZTogJ3BhY2tOdW0nLAogICAgICAgICAgICB3aWR0aDogJzE2MCcKICAgICAgICAgIH0sIHsKICAgICAgICAgICAgbGFiZWw6ICflh4Dph43vvIhrZ++8iScsCiAgICAgICAgICAgIHByb3A6ICduZXRXZWlnaHQnLAogICAgICAgICAgICB3aWR0aDogJzEwMCcKICAgICAgICAgIH0sIHsKICAgICAgICAgICAgbGFiZWw6ICfmgLvph43ph4/vvIhrZ++8iScsCiAgICAgICAgICAgIGNvbFR5cGU6ICdjb2x1bW4nLAogICAgICAgICAgICBzbG90TmFtZTogJ3F1YW50aXR5QWxsJywKICAgICAgICAgICAgd2lkdGg6ICcxMDAnCiAgICAgICAgICB9LCB7CiAgICAgICAgICAgIGxhYmVsOiAn5Yiw6LSn5pe26Ze0JywKICAgICAgICAgICAgY29sVHlwZTogJ2NvbHVtbicsCiAgICAgICAgICAgIHNsb3ROYW1lOiAnYXJyaXZhbERhdGUnLAogICAgICAgICAgICB3aWR0aDogJzI1MHB4JwogICAgICAgICAgfSwgewogICAgICAgICAgICBsYWJlbDogJ+aIkOacrOWPguiAg+S7t++8iOWFg++8iScsCiAgICAgICAgICAgIHByb3A6ICcgY29zdFByaWNlJywKICAgICAgICAgICAgd2lkdGg6ICcxMjAnLAogICAgICAgICAgICBjb2xUeXBlOiAnY29sdW1uJywKICAgICAgICAgICAgc2xvdE5hbWU6ICdpbmdyZWRpZW50c0Nvc3RQcmljZScKICAgICAgICAgIH0sIC8vIHsKICAgICAgICAgIC8vICAgbGFiZWw6ICflh4Doj5zku7fmoLzvvIjlhYPvvIknLAogICAgICAgICAgLy8gICBwcm9wOiAnY2xlYW5WZWdldGFibGVQcmljZScsCiAgICAgICAgICAvLyAgIHdpZHRoOiAnMTEwJywKICAgICAgICAgIC8vICAgY29sVHlwZTogJ2NvbHVtbicKICAgICAgICAgIC8vIH0sCiAgICAgICAgICAvLyB7CiAgICAgICAgICAvLyAgIGxhYmVsOiAn5q+b6I+c5Lu35qC877yI5YWD77yJJywKICAgICAgICAgIC8vICAgcHJvcDogJ29yaWdpbmFsVmVnZXRhYmxlUHJpY2UnLAogICAgICAgICAgLy8gICB3aWR0aDogJzExMCcsCiAgICAgICAgICAvLyAgIGNvbFR5cGU6ICdjb2x1bW4nCiAgICAgICAgICAvLyB9LAogICAgICAgICAgewogICAgICAgICAgICBsYWJlbDogJ+aTjeS9nCcsCiAgICAgICAgICAgIGNvbFR5cGU6ICdidG5zJywKICAgICAgICAgICAgLy8gZml4ZWQ6ICdyaWdodCcsCiAgICAgICAgICAgIHdpZHRoOiAnMTIwcHgnLAogICAgICAgICAgICBidG5zOiBbLy8gewogICAgICAgICAgICAvLyAgIGxhYmVsOiAn57yW6L6RJywKICAgICAgICAgICAgLy8gICB0eXBlOiAndGV4dCcsCiAgICAgICAgICAgIC8vICAgc2l6ZTogJ21pbmknLAogICAgICAgICAgICAvLyAgIGNsaWNrOiB0aGlzLmVkaXRDcm93ZAogICAgICAgICAgICAvLyB9LAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgbGFiZWw6ICfliKDpmaQnLAogICAgICAgICAgICAgIHR5cGU6ICd0ZXh0JywKICAgICAgICAgICAgICBzaXplOiAnbWluaScsCiAgICAgICAgICAgICAgY2xpY2s6IHRoaXMuZGVsZXRlQ3Jvd2QKICAgICAgICAgICAgfV0KICAgICAgICAgIH1dOwogICAgICAgICAgYnJlYWs7CgogICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICBicmVhazsKICAgICAgfQoKICAgICAgcmV0dXJuIGhlYWRlcnM7CiAgICB9LAogICAgZm9ybUl0ZW1zOiBmdW5jdGlvbiBmb3JtSXRlbXMoKSB7CiAgICAgIHZhciBfdGhpcyA9IHRoaXM7CgogICAgICByZXR1cm4gW3sKICAgICAgICB0eXBlOiAnc2VsZWN0JywKICAgICAgICBsYWJlbDogJ+iuouWNleWIm+W7uue7mScsCiAgICAgICAgcHJvcDogJ3Byb3ZpbmNlQ29kZScsCiAgICAgICAgdmFsdWVLZXk6ICdjb2RlJywKICAgICAgICBsYWJlbEtleTogJ25hbWUnLAogICAgICAgIC8vIGxhYmVsUHJvcDogJ3Byb3ZpbmNlTmFtZScsCiAgICAgICAgb3B0aW9uczogdGhpcy5hcmVhTGlzdCwKICAgICAgICBhdHRyczogewogICAgICAgICAgcGxhY2Vob2xkZXI6ICfnnIHku70nLAogICAgICAgICAgY2xlYXJhYmxlOiB0cnVlCiAgICAgICAgfSAvLyBhamF4OiBtb2RlbCA9PiB7CiAgICAgICAgLy8gICByZXR1cm4gYmFzZVRyZWUoKTsKICAgICAgICAvLyB9CgogICAgICB9LCB7CiAgICAgICAgdHlwZTogJ3NlbGVjdCcsCiAgICAgICAgLy8gbGFiZWw6ICflnLDnuqfluILvvJonLAogICAgICAgIHByb3A6ICdjaXR5Q29kZScsCiAgICAgICAgcGFyZW50UHJvcDogJ3Byb3ZpbmNlQ29kZScsCiAgICAgICAgLy8gbGFiZWxQcm9wOiAnY2l0eU5hbWUnLAogICAgICAgIHZhbHVlS2V5OiAnY29kZScsCiAgICAgICAgbGFiZWxLZXk6ICduYW1lJywKICAgICAgICBhdHRyczogewogICAgICAgICAgcGxhY2Vob2xkZXI6ICflnLDnuqfluIInLAogICAgICAgICAgY2xlYXJhYmxlOiB0cnVlCiAgICAgICAgfSwKICAgICAgICAvLyBvcHRpb25zOiB0aGlzLmNpdHlMaXN0LAogICAgICAgIGFqYXg6IGZ1bmN0aW9uIGFqYXgobW9kZWwpIHsKICAgICAgICAgIHZhciByZXN1bHQgPSBfdGhpcy5nZXRDaXR5TGlzdChtb2RlbC5wcm92aW5jZUNvZGUpOwoKICAgICAgICAgIGlmICghX3RoaXMub3JkZXJJZCAmJiBfdGhpcy4kaGFzKFsnb3JkZXItZGVmYXVsdC1maXJzdCddKSAmJiByZXN1bHQgJiYgcmVzdWx0Lmxlbmd0aCAmJiBfdGhpcy5pc0ZpcnN0SW5pdCkgewogICAgICAgICAgICAvLyBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgX3RoaXMuJHJlZnMuY0R5bmFtaWNGb3JtLnNldE1vZGVsRGF0YSgnY2l0eUNvZGUnLCByZXN1bHRbMF0uY29kZSk7IC8vIH0pOwoKICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHsKICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQpOwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9LCB7CiAgICAgICAgdHlwZTogJ3NlbGVjdCcsCiAgICAgICAgLy8gbGFiZWw6ICfljLov5Y6/77yaJywKICAgICAgICBwcm9wOiAnZGlzdHJpY3RDb2RlJywKICAgICAgICBwYXJlbnRQcm9wOiAnY2l0eUNvZGUnLAogICAgICAgIGF0dHJzOiB7CiAgICAgICAgICBwbGFjZWhvbGRlcjogJ+WMui/ljr8nLAogICAgICAgICAgY2xlYXJhYmxlOiB0cnVlCiAgICAgICAgfSwKICAgICAgICAvLyBsYWJlbFByb3A6ICdkaXN0cmljdE5hbWUnLAogICAgICAgIC8vIG9wdGlvbnM6IHRoaXMuZGlzdHJpY3RMaXN0LAogICAgICAgIHZhbHVlS2V5OiAnY29kZScsCiAgICAgICAgbGFiZWxLZXk6ICduYW1lJywKICAgICAgICBhamF4OiBmdW5jdGlvbiBhamF4KG1vZGVsKSB7CiAgICAgICAgICB2YXIgcmVzdWx0ID0gX3RoaXMuZ2V0Q291bnR5TGlzdChtb2RlbC5jaXR5Q29kZSk7CgogICAgICAgICAgaWYgKF90aGlzLm9yZGVySWQpIHsKICAgICAgICAgICAgX3RoaXMuJHJlZnMuYlRhYmxlICYmIF90aGlzLiRyZWZzLmJUYWJsZVswXSAmJiBfdGhpcy4kcmVmcy5iVGFibGVbMF0uYWpheEdldFRhYmxlRGF0YUJ5UGFnZSgpOwoKICAgICAgICAgICAgX3RoaXMub3JkZXJTdGF0aXN0aWNzKCk7CiAgICAgICAgICB9CgogICAgICAgICAgaWYgKCFfdGhpcy5vcmRlcklkICYmIF90aGlzLiRoYXMoWydvcmRlci1kZWZhdWx0LWZpcnN0J10pICYmIHJlc3VsdCAmJiByZXN1bHQubGVuZ3RoICYmIF90aGlzLmlzRmlyc3RJbml0KSB7CiAgICAgICAgICAgIC8vIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICBfdGhpcy4kcmVmcy5jRHluYW1pY0Zvcm0uc2V0TW9kZWxEYXRhKCdkaXN0cmljdENvZGUnLCByZXN1bHRbMF0uY29kZSk7IC8vIH0pOwoKICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHsKICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQpOwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9LCB7CiAgICAgICAgdHlwZTogJ3NlbGVjdCcsCiAgICAgICAgLy8gbGFiZWw6ICfljLov5Y6/77yaJywKICAgICAgICBwcm9wOiAnc2Nob29sQ29kZScsCiAgICAgICAgcGFyZW50UHJvcDogJ2Rpc3RyaWN0Q29kZScsCiAgICAgICAgYXR0cnM6IHsKICAgICAgICAgIHBsYWNlaG9sZGVyOiAn5a2m5qChJywKICAgICAgICAgIGNsZWFyYWJsZTogdHJ1ZQogICAgICAgIH0sCiAgICAgICAgLy8gbGFiZWxQcm9wOiAnZGlzdHJpY3ROYW1lJywKICAgICAgICAvLyBvcHRpb25zOiB0aGlzLmRpc3RyaWN0TGlzdCwKICAgICAgICB2YWx1ZUtleTogJ2lkJywKICAgICAgICBsYWJlbEtleTogJ25hbWUnLAogICAgICAgIGFqYXg6IGZ1bmN0aW9uIGFqYXgobW9kZWwpIHsKICAgICAgICAgIHZhciByZXN1bHQgPSBfdGhpcy5nZXRTY2hvb2xMaXN0KG1vZGVsLmRpc3RyaWN0Q29kZSk7CgogICAgICAgICAgaWYgKCFfdGhpcy5vcmRlcklkICYmIF90aGlzLiRoYXMoWydvcmRlci1kZWZhdWx0LWZpcnN0J10pICYmIHJlc3VsdCAmJiByZXN1bHQubGVuZ3RoICYmIF90aGlzLmlzRmlyc3RJbml0KSB7CiAgICAgICAgICAgIC8vIHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgICBfdGhpcy4kcmVmcy5jRHluYW1pY0Zvcm0uc2V0TW9kZWxEYXRhKCdzY2hvb2xDb2RlJywgcmVzdWx0WzBdLmlkKTsgLy8gfSk7CgogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkgewogICAgICAgICAgICByZXNvbHZlKHJlc3VsdCk7CiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0sIHsKICAgICAgICB0eXBlOiAnc2VsZWN0JywKICAgICAgICAvLyBsYWJlbDogJ+WMui/ljr/vvJonLAogICAgICAgIHByb3A6ICdzY2hvb2xCcmFuY2hDb2RlJywKICAgICAgICBwYXJlbnRQcm9wOiAnc2Nob29sQ29kZScsCiAgICAgICAgYXR0cnM6IHsKICAgICAgICAgIHBsYWNlaG9sZGVyOiAn5a2m6YOoJywKICAgICAgICAgIGNsZWFyYWJsZTogdHJ1ZQogICAgICAgIH0sCiAgICAgICAgLy8gbGFiZWxQcm9wOiAnZGlzdHJpY3ROYW1lJywKICAgICAgICAvLyBvcHRpb25zOiB0aGlzLmRpc3RyaWN0TGlzdCwKICAgICAgICB2YWx1ZUtleTogJ2lkJywKICAgICAgICBsYWJlbEtleTogJ25hbWUnLAogICAgICAgIGFqYXg6IGZ1bmN0aW9uIGFqYXgobW9kZWwpIHsKICAgICAgICAgIHZhciByZXN1bHQgPSBfdGhpcy5nZXRTY2hvb2xCcmFuY2hMaXN0KG1vZGVsLnNjaG9vbENvZGUpOwoKICAgICAgICAgIGlmICghX3RoaXMub3JkZXJJZCAmJiBfdGhpcy4kaGFzKFsnb3JkZXItZGVmYXVsdC1maXJzdCddKSAmJiByZXN1bHQgJiYgcmVzdWx0Lmxlbmd0aCAmJiBfdGhpcy5pc0ZpcnN0SW5pdCkgewogICAgICAgICAgICAvLyBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICAgICAgX3RoaXMuJHJlZnMuY0R5bmFtaWNGb3JtLnNldE1vZGVsRGF0YSgnc2Nob29sQnJhbmNoQ29kZScsIHJlc3VsdFswXS5pZCk7CgogICAgICAgICAgICBfdGhpcy5pc0ZpcnN0SW5pdCA9IGZhbHNlOyAvLyB9KTsKICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHsKICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQpOwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9LCB7CiAgICAgICAgdHlwZTogJ3NlbGVjdCcsCiAgICAgICAgcHJvcDogJ29yZGVyU3RhdHVzJywKICAgICAgICBsYWJlbDogJ+iuouWNleaAp+i0qCcsCiAgICAgICAgYXR0cnM6IHsKICAgICAgICAgIHBsYWNlaG9sZGVyOiAn6K6i5Y2V5oCn6LSoJywKICAgICAgICAgIGNsZWFyYWJsZTogdHJ1ZQogICAgICAgIH0sCiAgICAgICAgb3B0aW9uczogdGhpcy4kRCgnT1JERVJfVFlQRScpIC8vIG9wdGlvbnM6IFsKICAgICAgICAvLyAgIHsKICAgICAgICAvLyAgICAgbGFiZWw6ICfluLjop4QnLAogICAgICAgIC8vICAgICB2YWx1ZTogMQogICAgICAgIC8vICAgfSwKICAgICAgICAvLyAgIHsKICAgICAgICAvLyAgICAgbGFiZWw6ICfntKfmgKUnLAogICAgICAgIC8vICAgICB2YWx1ZTogMgogICAgICAgIC8vICAgfQogICAgICAgIC8vIF0KCiAgICAgIH0gLy8gewogICAgICAvLyAgIHR5cGU6ICdkYXRlLXBpY2tlcicsCiAgICAgIC8vICAgcHJvcDogJ2Fycml2YWxEYXRlJywKICAgICAgLy8gICBsYWJlbDogJ+iuouWNleW8gOWni+mFjemAgeaXpeacnycsCiAgICAgIC8vICAgYXR0cnM6IHsKICAgICAgLy8gICAgIHBsYWNlaG9sZGVyOiAn5byA5aeL6YWN6YCB5pel5pyfJywKICAgICAgLy8gICAgICd2YWx1ZS1mb3JtYXQnOiAneXl5eS1NTS1kZCcsCiAgICAgIC8vICAgICAncGlja2VyLW9wdGlvbnMnOiB7CiAgICAgIC8vICAgICAgIGRpc2FibGVkRGF0ZTogdGltZSA9PiB7CiAgICAgIC8vICAgICAgICAgaWYgKHRoaXMuZm9ybURhdGEub3JkZXJTdGF0dXMgPT0gMykgewogICAgICAvLyAgICAgICAgICAgcmV0dXJuIHRpbWUuZ2V0VGltZSgpID49IERhdGUubm93KCk7CiAgICAgIC8vICAgICAgICAgfSBlbHNlIHsKICAgICAgLy8gICAgICAgICAgIHJldHVybiB0aW1lLmdldFRpbWUoKSA8IERhdGUubm93KCk7CiAgICAgIC8vICAgICAgICAgfQogICAgICAvLyAgICAgICB9CiAgICAgIC8vICAgICB9CiAgICAgIC8vICAgfQogICAgICAvLyB9CiAgICAgIF07CiAgICB9LAogICAgYlRhYmxlRm9ybUl0ZW1zOiBmdW5jdGlvbiBiVGFibGVGb3JtSXRlbXMoKSB7CiAgICAgIHJldHVybiBbewogICAgICAgIHR5cGU6ICdpbnB1dCcsCiAgICAgICAgcHJvcDogJ25hbWVPclBpbnlpbkhlYWRlcicsCiAgICAgICAgYXR0cnM6IHsKICAgICAgICAgIHBsYWNlaG9sZGVyOiAn5ZCN56ew566A5ou8JwogICAgICAgIH0KICAgICAgfV07CiAgICB9LAogICAgLy/mlrDlop7lvLnnqpfmnKrpgInmi6nooajmoLwKICAgIHVuc2VsZWN0VGFibGVEYXRhOiBmdW5jdGlvbiB1bnNlbGVjdFRhYmxlRGF0YSgpIHsKICAgICAgaWYgKCF0aGlzLmRpYWxvZ1Vuc2VsZWN0SW5wdXQudHJpbSgpKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuZGlhbG9nRGF0YVVuU2VsZWN0T2JqW3RoaXMuZGlhbG9nTmFtZV07CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0RmlsdGVyRGF0YSh0aGlzLmRpYWxvZ0RhdGFVblNlbGVjdE9ialt0aGlzLmRpYWxvZ05hbWVdLCB0aGlzLmRpYWxvZ1Vuc2VsZWN0SW5wdXQudHJpbSgpKTsKICAgICAgfQogICAgfSwKICAgIHVuc2VsZWN0TGVmdEluZ3JlZGllbnREYXRhOiBmdW5jdGlvbiB1bnNlbGVjdExlZnRJbmdyZWRpZW50RGF0YSgpIHsKICAgICAgaWYgKCF0aGlzLmRpYWxvZ1Vuc2VsZWN0SW5wdXQudHJpbSgpKSB7CiAgICAgICAgcmV0dXJuIHRoaXMubGVmdEluZ3JlZGllbnREYXRhOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiB0aGlzLmdldEZpbHRlckxpc3QodGhpcy5sZWZ0SW5ncmVkaWVudERhdGEsIHRoaXMuZGlhbG9nVW5zZWxlY3RJbnB1dC50cmltKCkpOwogICAgICB9CiAgICB9LAogICAgLy/mlrDlop7lt7LpgInmi6nooajmoLzmlbDmja4KICAgIHNlbGVjdGVkVGFibGVEYXRhOiBmdW5jdGlvbiBzZWxlY3RlZFRhYmxlRGF0YSgpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CgogICAgICBpZiAodGhpcy5vdXRPZlN0b2NrU3RhdHUgPT09ICcnKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuZGlhbG9nRGF0YVNlbGVjdGVkT2JqW3RoaXMuYWN0aXZlTmFtZV07CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIHRoaXMuZGlhbG9nRGF0YVNlbGVjdGVkT2JqW3RoaXMuYWN0aXZlTmFtZV0uZmlsdGVyKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgICByZXR1cm4gaXRlbS5vdXRPZlN0b2NrID09IF90aGlzMi5vdXRPZlN0b2NrU3RhdHU7CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0KICB9LAogIC8vIOebkeaOp2RhdGHkuK3nmoTmlbDmja7lj5jljJYKICB3YXRjaDogewogICAgJ2Zvcm1EYXRhLm9yZGVyU3RhdHVzJzogZnVuY3Rpb24gZm9ybURhdGFPcmRlclN0YXR1cyhuZXdWYWwsIG9sZFZhbCkgewogICAgICBpZiAobmV3VmFsICE9IG9sZFZhbCkgewogICAgICAgIHRoaXMuaW5pdERhdGUoKTsKICAgICAgfQogICAgfSwKICAgICdmb3JtRGF0YS5kaXN0cmljdENvZGUnOiBmdW5jdGlvbiBmb3JtRGF0YURpc3RyaWN0Q29kZShuZXdWYWwsIG9sZFZhbCkgewogICAgICBpZiAobmV3VmFsICE9IG9sZFZhbCkgewogICAgICAgIHRoaXMuZGlhbG9nRGF0YVNlbGVjdGVkT2JqWydkaXNoJ10gPSBbXTsKICAgICAgICB0aGlzLmRpYWxvZ0RhdGFTZWxlY3RlZE9ialsnaW5ncmVkaWVudHMnXSA9IFtdOwogICAgICB9CiAgICB9CiAgfSwKICAvLyDmlrnms5Xpm4blkIgKICBtZXRob2RzOiB7CiAgICBmb3JtYXRJbnB1dDogZm9ybWF0SW5wdXQsCiAgICBjaGFuZ2VEYXRlOiBmdW5jdGlvbiBjaGFuZ2VEYXRlKHZhbHVlKSB7CiAgICAgIHZhciBfdGhpczMgPSB0aGlzOwoKICAgICAgaWYgKHZhbHVlKSB7CiAgICAgICAgdGhpcy5zZWxlY3RlZFRhYmxlRGF0YS5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgICBpZiAoIWl0ZW0uYXJyaXZhbERhdGUpIHsKICAgICAgICAgICAgLy8gaXRlbS5hcnJpdmFsRGF0ZSA9IHZhbHVlOwogICAgICAgICAgICBfdGhpczMuJHNldChpdGVtLCAnYXJyaXZhbERhdGUnLCB2YWx1ZSk7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sCiAgICBjaGFuZ2VUaW1lOiBmdW5jdGlvbiBjaGFuZ2VUaW1lKHZhbHVlKSB7CiAgICAgIHZhciBfdGhpczQgPSB0aGlzOwoKICAgICAgaWYgKHZhbHVlKSB7CiAgICAgICAgdGhpcy5zZWxlY3RlZFRhYmxlRGF0YS5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgICBpZiAoIWl0ZW0uYXJyaXZhbFRpbWUpIHsKICAgICAgICAgICAgX3RoaXM0LiRzZXQoaXRlbSwgJ2Fycml2YWxUaW1lJywgdmFsdWUpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9LAogICAgZGlzYWJsZWREYXRlOiBmdW5jdGlvbiBkaXNhYmxlZERhdGUodGltZSkgewogICAgICBpZiAodGhpcy5mb3JtRGF0YS5vcmRlclN0YXR1cyA9PSAzKSB7CiAgICAgICAgcmV0dXJuIHRpbWUuZ2V0VGltZSgpID4gRGF0ZS5ub3coKSAtIDM2MDAgKiAxMDAwICogMjQ7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJuIHRpbWUuZ2V0VGltZSgpIDw9IERhdGUubm93KCkgLSAzNjAwICogMTAwMCAqIDI0OwogICAgICB9CiAgICB9LAogICAgYmFzZVRyZWVXaXRoUG93ZXJTY2hvb2w6IGZ1bmN0aW9uIGJhc2VUcmVlV2l0aFBvd2VyU2Nob29sKCkgewogICAgICB2YXIgX3RoaXM1ID0gdGhpczsKCiAgICAgIHJldHVybiBfYmFzZVRyZWVXaXRoUG93ZXJTY2hvb2woKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICBfdGhpczUuYXJlYUxpc3QgPSByZXMuZGF0YSB8fCBbXTsKCiAgICAgICAgaWYgKCFfdGhpczUub3JkZXJJZCAmJiBfdGhpczUuJGhhcyhbJ29yZGVyLWRlZmF1bHQtZmlyc3QnXSkgJiYgX3RoaXM1LmFyZWFMaXN0Lmxlbmd0aCkgewogICAgICAgICAgX3RoaXM1LiRyZWZzLmNEeW5hbWljRm9ybS5zZXRNb2RlbERhdGEoJ3Byb3ZpbmNlQ29kZScsIF90aGlzNS5hcmVhTGlzdFswXS5jb2RlKTsKICAgICAgICB9CgogICAgICAgIHJldHVybjsKICAgICAgfSk7CiAgICB9LAogICAgZ2V0Q3V0TWF0Y2hTdGFuZGFyZExpc3Q6IGZ1bmN0aW9uIGdldEN1dE1hdGNoU3RhbmRhcmRMaXN0KCkgewogICAgICB2YXIgX3RoaXM2ID0gdGhpczsKCiAgICAgIHJldHVybiBjdXRNYXRjaFN0YW5kYXJkTGlzdCgpLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgIF90aGlzNi5jdXRNYXRjaFN0YW5kYXJkTGlzdCA9IHJlcy5kYXRhIHx8IFtdOwogICAgICB9KS5jYXRjaChmdW5jdGlvbiAoKSB7CiAgICAgICAgX3RoaXM2LmN1dE1hdGNoU3RhbmRhcmRMaXN0ID0gW107CiAgICAgIH0pOwogICAgfSwKICAgIGdldENpdHlMaXN0OiBmdW5jdGlvbiBnZXRDaXR5TGlzdChwcm92aW5jZUNvZGUpIHsKICAgICAgdmFyIGNpdHlMaXN0ID0gW107CgogICAgICBpZiAoIXByb3ZpbmNlQ29kZSkgewogICAgICAgIHJldHVybiBjaXR5TGlzdDsKICAgICAgfSBlbHNlIHsKICAgICAgICBjaXR5TGlzdCA9IHRoaXMuYXJlYUxpc3QuZmluZChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgICAgcmV0dXJuIGl0ZW0uY29kZSA9PT0gcHJvdmluY2VDb2RlOwogICAgICAgIH0pLmNoaWxkTGlzdDsKICAgICAgfQoKICAgICAgdGhpcy5jaXR5TGlzdCA9IGNpdHlMaXN0OwogICAgICByZXR1cm4gY2l0eUxpc3Q7CiAgICB9LAogICAgZ2V0Q291bnR5TGlzdDogZnVuY3Rpb24gZ2V0Q291bnR5TGlzdChjaXR5Q29kZSkgewogICAgICB2YXIgZGlzdHJpY3RMaXN0ID0gW107CgogICAgICBpZiAoIWNpdHlDb2RlKSB7CiAgICAgICAgcmV0dXJuIGRpc3RyaWN0TGlzdDsKICAgICAgfSBlbHNlIHsKICAgICAgICBkaXN0cmljdExpc3QgPSB0aGlzLmNpdHlMaXN0LmZpbmQoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICAgIHJldHVybiBpdGVtLmNvZGUgPT09IGNpdHlDb2RlOwogICAgICAgIH0pLmNoaWxkTGlzdDsKICAgICAgfQoKICAgICAgdGhpcy5kaXN0cmljdExpc3QgPSBkaXN0cmljdExpc3Q7CiAgICAgIHJldHVybiBkaXN0cmljdExpc3Q7CiAgICB9LAogICAgZ2V0U2Nob29sTGlzdDogZnVuY3Rpb24gZ2V0U2Nob29sTGlzdChkaXN0cmljdENvZGUpIHsKICAgICAgdmFyIHNjaG9vbExpc3QgPSBbXTsKCiAgICAgIGlmICghZGlzdHJpY3RDb2RlKSB7CiAgICAgICAgcmV0dXJuIHNjaG9vbExpc3Q7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgc2Nob29sTGlzdCA9IHRoaXMuZGlzdHJpY3RMaXN0LmZpbmQoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICAgIHJldHVybiBpdGVtLmNvZGUgPT09IGRpc3RyaWN0Q29kZTsKICAgICAgICB9KS5zY2hvb2xMaXN0OwogICAgICB9CgogICAgICB0aGlzLnNjaG9vbExpc3QgPSBzY2hvb2xMaXN0OwogICAgICByZXR1cm4gc2Nob29sTGlzdDsKICAgIH0sCiAgICBnZXRTY2hvb2xCcmFuY2hMaXN0OiBmdW5jdGlvbiBnZXRTY2hvb2xCcmFuY2hMaXN0KHNjaG9vbENvZGUpIHsKICAgICAgdmFyIHNjaG9vbEJyYW5jaExpc3QgPSBbXTsKCiAgICAgIGlmICghc2Nob29sQ29kZSkgewogICAgICAgIHJldHVybiBzY2hvb2xCcmFuY2hMaXN0OwogICAgICB9IGVsc2UgewogICAgICAgIHNjaG9vbEJyYW5jaExpc3QgPSB0aGlzLnNjaG9vbExpc3QuZmluZChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgICAgcmV0dXJuIGl0ZW0uaWQgPT09IHNjaG9vbENvZGU7CiAgICAgICAgfSkuc2Nob29sQnJhbmNoUmVzcER0b0xpc3Q7CiAgICAgIH0KCiAgICAgIHJldHVybiBzY2hvb2xCcmFuY2hMaXN0OwogICAgfSwKICAgIGhhbmRsZVRhYkNsaWNrOiBmdW5jdGlvbiBoYW5kbGVUYWJDbGljaygpIHsKICAgICAgdGhpcy5vdXRPZlN0b2NrU3RhdHUgPSAnJzsKICAgIH0sCiAgICBoYW5kbGVEaWFsb2dUYWJDbGljazogZnVuY3Rpb24gaGFuZGxlRGlhbG9nVGFiQ2xpY2soKSB7CiAgICAgIHRoaXMuZGlhbG9nVW5zZWxlY3RJbnB1dCA9ICcnOwogICAgICB0aGlzLmRpYWxvZ1NlbGVjdGVkSW5wdXQgPSAnJzsKICAgICAgdGhpcy5yZXNldExpc3RTZWxlY3RlZCh0aGlzLmRpYWxvZ0RhdGFVblNlbGVjdE9ialt0aGlzLmRpYWxvZ0FjdGl2ZU5hbWVdKTsKICAgICAgdGhpcy5yZXNldExpc3RTZWxlY3RlZCh0aGlzLmRpYWxvZ0RhdGFTZWxlY3RlZE9ialt0aGlzLmRpYWxvZ0FjdGl2ZU5hbWVdKTsKCiAgICAgIGlmICghdGhpcy5kaWFsb2dEYXRhVW5TZWxlY3RPYmpbdGhpcy5kaWFsb2dBY3RpdmVOYW1lXS5sZW5ndGgpIHsKICAgICAgICB0aGlzLm9yZGVyQ29udGVudEZvclNlbGVjdCgwKTsKICAgICAgfSAvLyBpZiAoIXRoaXMuZGlhbG9nRGF0YVNlbGVjdGVkT2JqW3RoaXMuZGlhbG9nQWN0aXZlTmFtZV0ubGVuZ3RoKSB7CiAgICAgIC8vICAgdGhpcy5vcmRlckNvbnRlbnRGb3JTZWxlY3QoMSk7CiAgICAgIC8vIH0KCiAgICB9LAogICAgZmV0Y2hUYWJsZURhdGE6IGZ1bmN0aW9uIGZldGNoVGFibGVEYXRhKGZvcm0pIHsKICAgICAgdmFyIF90aGlzNyA9IHRoaXM7CgogICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHsKICAgICAgICByZXNvbHZlKF90aGlzNy5kaWFsb2dEYXRhU2VsZWN0ZWRPYmpbX3RoaXM3LmFjdGl2ZU5hbWVdKTsKICAgICAgfSk7IC8vIGlmICghdGhpcy5mb3JtRGF0YS5kaXN0cmljdENvZGUgJiYgIXRoaXMuZGlzdHJpY3RDb2RlKSB7CiAgICAgIC8vICAgcmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4gcmVzb2x2ZSh7fSkpOwogICAgICAvLyB9CiAgICAgIC8vIGxldCBwYXJhbXMgPSBPYmplY3QuYXNzaWduKHt9LCBmb3JtLCB7CiAgICAgIC8vICAgZGlzdHJpY3RDb2RlOiB0aGlzLmZvcm1EYXRhLmRpc3RyaWN0Q29kZSB8fCB0aGlzLmRpc3RyaWN0Q29kZSB8fCAnJywKICAgICAgLy8gICBvcmRlcklkOiB0aGlzLm9yZGVySWQsCiAgICAgIC8vICAgcXVlcnlUeXBlOiB0aGlzLnF1ZXJ5T2JqZWN0W3RoaXMuYWN0aXZlTmFtZV0KICAgICAgLy8gfSk7CiAgICAgIC8vIHJldHVybiBvcmRlckNvbnRlbnRGb3JQYWdlKHBhcmFtcykudGhlbihyZXMgPT4gewogICAgICAvLyAgIGlmIChyZXMuZGF0YSAmJiByZXMuZGF0YS5yZWNvcmRzICYmIHJlcy5kYXRhLnJlY29yZHMubGVuZ3RoKSB7CiAgICAgIC8vICAgICB0aGlzLmVtcHR5ID0gZmFsc2U7CiAgICAgIC8vICAgfSBlbHNlIHsKICAgICAgLy8gICAgIHRoaXMuZW1wdHkgPSB0cnVlOwogICAgICAvLyAgIH0KICAgICAgLy8gICByZXR1cm4gbmV3IFByb21pc2UocmVzb2x2ZSA9PiByZXNvbHZlKHJlcykpOwogICAgICAvLyB9KTsKICAgIH0sCiAgICAvL+iOt+WPluiuouWNleWIl+ihqAogICAgb3JkZXJDb250ZW50Rm9yUGFnZTogZnVuY3Rpb24gb3JkZXJDb250ZW50Rm9yUGFnZSh0YWJOYW1lKSB7CiAgICAgIHZhciBfdGhpczggPSB0aGlzOwoKICAgICAgdmFyIHBhcmFtcyA9IHsKICAgICAgICBvZmZzZXQ6IDAsCiAgICAgICAgbGltaXQ6IDEwMDAwLAogICAgICAgIGRpc3RyaWN0Q29kZTogdGhpcy5mb3JtRGF0YS5kaXN0cmljdENvZGUgfHwgdGhpcy5kaXN0cmljdENvZGUgfHwgJycsCiAgICAgICAgb3JkZXJJZDogdGhpcy5vcmRlcklkLAogICAgICAgIHF1ZXJ5VHlwZTogdGhpcy5xdWVyeU9iamVjdFt0YWJOYW1lXQogICAgICB9OwogICAgICByZXR1cm4gX29yZGVyQ29udGVudEZvclBhZ2UocGFyYW1zKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICBpZiAocmVzLmRhdGEgJiYgcmVzLmRhdGEucmVjb3JkcykgewogICAgICAgICAgdmFyIHJlc3VsdCA9IHJlcy5kYXRhLnJlY29yZHMgfHwgW107CgogICAgICAgICAgaWYgKHRhYk5hbWUgPT09ICdkaXNoJykgewogICAgICAgICAgICByZXN1bHQuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgICAgICAgIGl0ZW0ucXVhbnRpdHkgPSBwYXJzZUludChpdGVtLnF1YW50aXR5KSB8fCAwOwogICAgICAgICAgICB9KTsgLy8g6K6+572u6YeN5paw5LiL5Y2V6aG16Z2i5omT5byA6KeE5YiZ77ya5YWo6YOo6aOf5p2Q5LiL5Y2V77yM5YiZ6buY6K6k5omT5byA6aOf5p2Q6aG16Z2i44CC5LuF6I+c5ZOB77yM5YiZ5omT5byA6I+c5ZOB6aG16Z2iLuiLpeS4pOiAhemDveacie+8jOWImeaJk+W8gOiPnOWTgeWNs+WPrwogICAgICAgICAgICAvLyBpZiAodGhpcy5vcGVyYVR5cGUgPT0gJ2NvcHknKSB7CgogICAgICAgICAgICBpZiAocmVzdWx0Lmxlbmd0aCA+IDApIHsKICAgICAgICAgICAgICBfdGhpczguYWN0aXZlTmFtZSA9ICdkaXNoJzsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBfdGhpczguYWN0aXZlTmFtZSA9ICdpbmdyZWRpZW50cyc7CiAgICAgICAgICAgIH0gLy8gfQoKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoX3RoaXM4Lm9wZXJhVHlwZSA9PSAnY29weScpIHsKICAgICAgICAgICAgLy8g6YeN5paw5LiL5Y2V55qE6aG16Z2i5pe26Ze05riF56m6CiAgICAgICAgICAgIHJlc3VsdCA9IHJlc3VsdC5tYXAoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICAgICAgICByZXR1cm4gX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCBpdGVtKSwge30sIHsKICAgICAgICAgICAgICAgIGFycml2YWxEYXRlOiAnJywKICAgICAgICAgICAgICAgIGFycml2YWxUaW1lOiAnJwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0KCiAgICAgICAgICBfdGhpczguZGlhbG9nRGF0YVNlbGVjdGVkT2JqW3RhYk5hbWVdID0gcmVzdWx0OwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgZWRpdENyb3dkOiBmdW5jdGlvbiBlZGl0Q3Jvd2Qocm93KSB7CiAgICAgIHRoaXMuZGlhbG9nQWN0aXZlTmFtZSA9IHRoaXMuYWN0aXZlTmFtZTsKICAgICAgdGhpcy5hZGRPcmRlckNvbnRlbnQoJ2VkaXQnKTsKICAgIH0sCiAgICBkZWxldGVDcm93ZDogZnVuY3Rpb24gZGVsZXRlQ3Jvd2Qocm93LCBpbmRleCkgewogICAgICB2YXIgX3RoaXM5ID0gdGhpczsKCiAgICAgIHRoaXMuJGNvbmZpcm0oJ+aYr+WQpuWIoOmZpOivpeihjD8nLCAn5o+Q56S6JywgewogICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAn56Gu5a6aJywKICAgICAgICBjYW5jZWxCdXR0b25UZXh0OiAn5Y+W5raIJywKICAgICAgICB0eXBlOiAnd2FybmluZycKICAgICAgfSkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgX3RoaXM5LmRpYWxvZ0RhdGFTZWxlY3RlZE9ialtfdGhpczkuYWN0aXZlTmFtZV0uc3BsaWNlKGluZGV4LCAxKTsKCiAgICAgICAgX3RoaXM5Lndhcm5pbmcoJ+WIoOmZpOaIkOWKn++8gScpOyAvLyBkZWxldGVPcmRlckNvbnRlbnQoewogICAgICAgIC8vICAgb3JkZXJDb250ZW50SWQ6IHJvdy5vcmRlckNvbnRlbnRJZAogICAgICAgIC8vIH0pLnRoZW4ocmVzID0+IHsKICAgICAgICAvLyAgIHRoaXMud2FybmluZygn5Yig6Zmk5oiQ5Yqf77yBJyk7CiAgICAgICAgLy8gICB0aGlzLm9yZGVyU3RhdGlzdGljcygpOwogICAgICAgIC8vICAgdGhpcy4kcmVmcy5iVGFibGUgJiYKICAgICAgICAvLyAgICAgdGhpcy4kcmVmcy5iVGFibGVbMF0gJiYKICAgICAgICAvLyAgICAgdGhpcy4kcmVmcy5iVGFibGVbMF0uYWpheEdldFRhYmxlRGF0YUJ5UGFnZSgpOwogICAgICAgIC8vIH0pOwoKICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKCkge30pOwogICAgfSwKICAgIG9yZGVyU3RhdGlzdGljczogZnVuY3Rpb24gb3JkZXJTdGF0aXN0aWNzKCkgewogICAgICB2YXIgX3RoaXMxMCA9IHRoaXM7CgogICAgICB2YXIgaW5pdFN0YXRpc3RpY3NJbmZvID0gdGhpcy5pbml0U3RhdGlzdGljc0luZm87CgogICAgICBpZiAoIXRoaXMub3JkZXJJZCkgewogICAgICAgIHRoaXMuc3RhdGlzdGljc0luZm8gPSBpbml0U3RhdGlzdGljc0luZm87CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBfb3JkZXJTdGF0aXN0aWNzKHsKICAgICAgICBvcmRlcklkOiB0aGlzLm9yZGVySWQsCiAgICAgICAgZGlzdHJpY3RDb2RlOiB0aGlzLmZvcm1EYXRhLmRpc3RyaWN0Q29kZSB8fCB0aGlzLmRpc3RyaWN0Q29kZSB8fCAnJwogICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICBfdGhpczEwLnN0YXRpc3RpY3NJbmZvID0gcmVzLmRhdGEgfHwgaW5pdFN0YXRpc3RpY3NJbmZvOwogICAgICB9KTsKICAgIH0sCiAgICBvcmRlckNvbnRlbnRGb3JTZWxlY3Q6IGZ1bmN0aW9uIG9yZGVyQ29udGVudEZvclNlbGVjdChpc1NlbGVjdGVkLCB0YWJOYW1lKSB7CiAgICAgIHZhciBfdGhpczExID0gdGhpczsKCiAgICAgIGlmICghdGhpcy5vcmRlcklkICYmIGlzU2VsZWN0ZWQpIHsKICAgICAgICB0aGlzLmRpYWxvZ0RhdGFTZWxlY3RlZE9ialt0aGlzLmRpYWxvZ0FjdGl2ZU5hbWVdID0gW107CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBfb3JkZXJDb250ZW50Rm9yU2VsZWN0KHsKICAgICAgICBvcmRlcklkOiB0aGlzLm9yZGVySWQsCiAgICAgICAgZGVwdElkOiB0aGlzLmZvcm1EYXRhLnNjaG9vbEJyYW5jaENvZGUsCiAgICAgICAgcXVlcnlUeXBlOiB0YWJOYW1lICYmIHRoaXMucXVlcnlPYmplY3RbdGFiTmFtZV0gfHwgdGhpcy5xdWVyeU9iamVjdFt0aGlzLmRpYWxvZ0FjdGl2ZU5hbWVdLAogICAgICAgIGlzU2VsZWN0ZWQ6IGlzU2VsZWN0ZWQsCiAgICAgICAgZGlzdHJpY3RDb2RlOiB0aGlzLmZvcm1EYXRhLmRpc3RyaWN0Q29kZSB8fCB0aGlzLmRpc3RyaWN0Q29kZQogICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICB2YXIgcmVzdWx0ID0gcmVzLmRhdGEgfHwgW107CgogICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcmVzdWx0Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICByZXN1bHRbaV0uY3VzdG9tSWQgPSByZXN1bHQubGVuZ3RoIC0gMSAtIGk7CiAgICAgICAgICByZXN1bHRbaV0uc2VsZWN0ZWQgPSBmYWxzZTsKCiAgICAgICAgICBpZiAoX3RoaXMxMS5kaWFsb2dOYW1lID09PSAnbWVudScpIHsKICAgICAgICAgICAgcmVzdWx0W2ldLmV4cGFuZFRhYmxlRGF0YSA9IF90aGlzMTEuaGFuZGxlTWVhbERhdGEocmVzdWx0W2ldLm1lYWxEYXlMaXN0KTsKICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAgIGlmICghaXNTZWxlY3RlZCkgewogICAgICAgICAgX3RoaXMxMS5kaWFsb2dEYXRhVW5TZWxlY3RPYmpbX3RoaXMxMS5hY3RpdmVOYW1lXSA9IHJlc3VsdDsKCiAgICAgICAgICBfdGhpczExLiRzZXQoX3RoaXMxMS5kaWFsb2dEYXRhVW5TZWxlY3RPYmosIHRhYk5hbWUsIHJlc3VsdCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIF90aGlzMTEuZGlhbG9nRGF0YVNlbGVjdGVkT2JqW190aGlzMTEuYWN0aXZlTmFtZV0gPSByZXN1bHQ7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBhZGRPcmRlckNvbnRlbnQ6IGZ1bmN0aW9uIGFkZE9yZGVyQ29udGVudCh0YWJOYW1lKSB7CiAgICAgIHRoaXMuZGlhbG9nTmFtZSA9IHRhYk5hbWU7CiAgICAgIHRoaXMuZGlhbG9nVmlzaWJsZSA9IHRydWU7CgogICAgICBpZiAodGFiTmFtZSA9PT0gJ21lbnUnKSB7CiAgICAgICAgdGhpcy5kaWFsb2dUaXRsZSA9ICflvJXnlKgnICsgdGhpcy50YWJzS2V5TmFtZVt0YWJOYW1lXTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmRpYWxvZ1RpdGxlID0gJ+a3u+WKoCcgKyB0aGlzLnRhYnNLZXlOYW1lW3RhYk5hbWVdOwogICAgICB9CgogICAgICBpZiAodGFiTmFtZSA9PSAnaW5ncmVkaWVudHMnKSB7CiAgICAgICAgdGhpcy5nZXRJbmdyZWRpZW50VHJlZSgpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMub3JkZXJDb250ZW50Rm9yU2VsZWN0KDAsIHRhYk5hbWUpOwogICAgICB9IC8vIHRoaXMub3JkZXJDb250ZW50Rm9yU2VsZWN0KDAsIHRhYk5hbWUpOwogICAgICAvLyDph43nva7po5/mnZDmt7vliqDlvLnmoYbpgInkuK3mlbDmja4KCgogICAgICB0aGlzLnNlbGVjdGVkSW5ncmVkaWVudExpc3QgPSBbXTsgLy8gaWYgKHR5cGUgPT0gJ2VkaXQnKSAgIHsKICAgICAgLy8gbGV0IGtleXMgPSBPYmplY3Qua2V5cyh0aGlzLnF1ZXJ5T2JqZWN0KTsKICAgICAgLy8gZm9yIChsZXQgaSA9IDA7IGkgPCBrZXlzLmxlbmd0aDsgaSsrKSB7CiAgICAgIC8vICAgdGhpcy5vcmRlckNvbnRlbnRGb3JTZWxlY3QoMSwga2V5c1tpXSk7CiAgICAgIC8vIH0KICAgICAgLy8gfQogICAgfSwKICAgIGVtcHR5T3JkZXJDb250ZW50OiBmdW5jdGlvbiBlbXB0eU9yZGVyQ29udGVudCgpIHsKICAgICAgdmFyIF90aGlzMTIgPSB0aGlzOwoKICAgICAgdGhpcy4kY29uZmlybSgiXHU2NjJGXHU1NDI2XHU2RTA1XHU3QTdBXHU2MjQwXHU2NzA5Ii5jb25jYXQodGhpcy50YWJzS2V5TmFtZVt0aGlzLmFjdGl2ZU5hbWVdLCAiPyIpLCAn5o+Q56S6JywgewogICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAn56Gu5a6aJywKICAgICAgICBjYW5jZWxCdXR0b25UZXh0OiAn5Y+W5raIJywKICAgICAgICB0eXBlOiAnd2FybmluZycKICAgICAgfSkudGhlbihmdW5jdGlvbiAoKSB7CiAgICAgICAgX3RoaXMxMi5kaWFsb2dEYXRhU2VsZWN0ZWRPYmpbX3RoaXMxMi5hY3RpdmVOYW1lXSA9IFtdOwogICAgICB9KS5jYXRjaChmdW5jdGlvbiAoKSB7fSk7CiAgICB9LAogICAgc2F2ZVRvRHJhZnQ6IGZ1bmN0aW9uIHNhdmVUb0RyYWZ0KCkgewogICAgICB2YXIgX3RoaXMxMyA9IHRoaXM7CgogICAgICB0aGlzLnNhdmVPcmRlckJhc2UoKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICBfdGhpczEzLndhcm5pbmcoJ+S/neWtmOaIkOWKnycsICdzdWNjZXNzJyk7CiAgICAgIH0pOwogICAgfSwKICAgIHByZXZpZXdBbmRTdWJtaXQ6IGZ1bmN0aW9uIHByZXZpZXdBbmRTdWJtaXQoKSB7CiAgICAgIHZhciBfdGhpczE0ID0gdGhpczsKCiAgICAgIHRoaXMuc2F2ZU9yZGVyQW5kQ29udGVudCgpLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgIF90aGlzMTQuJHJvdXRlci5wdXNoKHsKICAgICAgICAgIHBhdGg6ICcvb3JkZXIvcHJldmlldycsCiAgICAgICAgICBxdWVyeTogewogICAgICAgICAgICBvcmRlcklkOiBfdGhpczE0Lm9yZGVySWQsCiAgICAgICAgICAgIG9wZXJhVHlwZTogJ3ByZXZpZXcnCiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSwKICAgIC8v5L+d5a2Y6K6i5Y2VCiAgICBzYXZlT3JkZXJCYXNlOiBmdW5jdGlvbiBzYXZlT3JkZXJCYXNlKCkgewogICAgICB2YXIgX3RoaXMkZm9ybURhdGEgPSB0aGlzLmZvcm1EYXRhLAogICAgICAgICAgc2Nob29sQnJhbmNoQ29kZSA9IF90aGlzJGZvcm1EYXRhLnNjaG9vbEJyYW5jaENvZGUsCiAgICAgICAgICBhcnJpdmFsRGF0ZSA9IF90aGlzJGZvcm1EYXRhLmFycml2YWxEYXRlLAogICAgICAgICAgb3JkZXJTdGF0dXMgPSBfdGhpcyRmb3JtRGF0YS5vcmRlclN0YXR1cywKICAgICAgICAgIHByb3ZpbmNlQ29kZSA9IF90aGlzJGZvcm1EYXRhLnByb3ZpbmNlQ29kZSwKICAgICAgICAgIGNpdHlDb2RlID0gX3RoaXMkZm9ybURhdGEuY2l0eUNvZGUsCiAgICAgICAgICBzY2hvb2xDb2RlID0gX3RoaXMkZm9ybURhdGEuc2Nob29sQ29kZSwKICAgICAgICAgIGRpc3RyaWN0Q29kZSA9IF90aGlzJGZvcm1EYXRhLmRpc3RyaWN0Q29kZTsKCiAgICAgIGlmICghc2Nob29sQnJhbmNoQ29kZSkgewogICAgICAgIHRoaXMud2FybmluZygn6K+36YCJ5oup5a2m6YOoJyk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAoIW9yZGVyU3RhdHVzKSB7CiAgICAgICAgdGhpcy53YXJuaW5nKCfor7fpgInmi6norqLljZXmgKfotKgnKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KCiAgICAgIHZhciBwYXJhbXMgPSB7CiAgICAgICAgb3JkZXJJZDogdGhpcy5vcmRlcklkLAogICAgICAgIHR5cGU6IG9yZGVyU3RhdHVzLAogICAgICAgIGRlcHRJZDogc2Nob29sQnJhbmNoQ29kZSwKICAgICAgICBwYXJlbnREZXB0SWQ6IHNjaG9vbENvZGUsCiAgICAgICAgYXJyaXZhbFRpbWU6IGFycml2YWxEYXRlLAogICAgICAgIHJlbWFya3M6IHRoaXMub3JkZXJSZW1hcmssCiAgICAgICAgcHJvdmluY2VDb2RlOiBwcm92aW5jZUNvZGUsCiAgICAgICAgY2l0eUNvZGU6IGNpdHlDb2RlLAogICAgICAgIGRpc3RyaWN0Q29kZTogZGlzdHJpY3RDb2RlLAogICAgICAgIGluY2x1ZGluZ0Rpc2hlc1NlYXNvbmluZzogdGhpcy5pbmNsdWRpbmdEaXNoZXNTZWFzb25pbmcKICAgICAgfTsKICAgICAgcmV0dXJuIF9zYXZlT3JkZXJCYXNlKHBhcmFtcyk7CiAgICB9LAogICAgc2VsZWN0VG9SaWdodDogZnVuY3Rpb24gc2VsZWN0VG9SaWdodCgpIHsKICAgICAgdmFyIF90aGlzMTUgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovX3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7CiAgICAgICAgdmFyIGxpc3QsIHNlbGVjdGVkTGlzdCwgcmVwZWF0TGlzdCwgdGlwc01lc3NhZ2VDb250ZW50LCB0aXBzTWVzc2FnZSwgaSwgcmVmQXJyOwogICAgICAgIHJldHVybiBfcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgICBsaXN0ID0gX3RoaXMxNS5sZWZ0SW5ncmVkaWVudERhdGFMaXN0OwogICAgICAgICAgICAgICAgc2VsZWN0ZWRMaXN0ID0gbGlzdC5maWx0ZXIoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICAgICAgICAgICAgcmV0dXJuIGl0ZW0uc2VsZWN0ZWQ7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIHJlcGVhdExpc3QgPSBfdGhpczE1LmhhbmRsZVNlbGVjdFJlcGVhdChzZWxlY3RlZExpc3QsIF90aGlzMTUuc2VsZWN0ZWRJbmdyZWRpZW50TGlzdCk7CgogICAgICAgICAgICAgICAgaWYgKCFyZXBlYXRMaXN0Lmxlbmd0aCkgewogICAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gOTsKICAgICAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgdGlwc01lc3NhZ2VDb250ZW50ID0gJyc7CiAgICAgICAgICAgICAgICByZXBlYXRMaXN0LmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICAgICAgICAgICAgdGlwc01lc3NhZ2VDb250ZW50ICs9ICI8ZGl2PiIuY29uY2F0KGl0ZW0ucmVsYXRpb25OYW1lLCAiXHU1REYyXHU2REZCXHU1MkEwXHU4RkM3IikuY29uY2F0KGl0ZW0ucGFja051bSB8fCAnMCcpLmNvbmNhdChpdGVtLnBhY2tVbml0LCAiPC9kaXY+Iik7CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIHRpcHNNZXNzYWdlID0gIlxuICAgICAgICAgICAgPGRpdiBjbGFzcz0ndGlwcy1jb250ZW50LW1lc3NhYWdlJz5cdTY3MDlcdTkxQ0RcdTU5MERcdTZERkJcdTUyQTBcdTk4REZcdTY3NTAsXHU4QkY3XHU3NkY0XHU2M0E1XHU1NzI4XHU1M0YzXHU0RkE3XHU5NzYyXHU2NzdGXHU0RTJEXHU4QkJFXHU3RjZFXHU2NTcwXHU5MUNGXHVGRjAxPC9kaXY+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzPSd0aXBzLWNvbnRlbnQtYm94Jz5cbiAgICAgICAgICAgICIuY29uY2F0KHRpcHNNZXNzYWdlQ29udGVudCwgIlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgIik7CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gOTsKICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczE1LiRjb25maXJtKHRpcHNNZXNzYWdlLCAn5o+Q6YaSJywgewogICAgICAgICAgICAgICAgICBjdXN0b21DbGFzczogJ29yZGVyLXRpcHMtbWVzc2FnZScsCiAgICAgICAgICAgICAgICAgIGRhbmdlcm91c2x5VXNlSFRNTFN0cmluZzogdHJ1ZSwKICAgICAgICAgICAgICAgICAgY2xvc2VPbkNsaWNrTW9kYWw6IGZhbHNlLAogICAgICAgICAgICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogJ+ehruWumicsCiAgICAgICAgICAgICAgICAgIGNhbmNlbEJ1dHRvblRleHQ6ICflj5bmtognIC8vIHR5cGU6ICd3YXJuaW5nJwoKICAgICAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgICAvLyDljrvpmaTlt6bkvqfpgInkuK3nm7jlr7nlj7Pkvqfph43lpI3nmoTmlbDmja4KICAgICAgICAgICAgICAgICAgdmFyIHJlcGVhdExpc3RJZCA9IHJlcGVhdExpc3QubWFwKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGl0ZW0ucmVsYXRpb25JZDsKICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgIHNlbGVjdGVkTGlzdCA9IHNlbGVjdGVkTGlzdC5maWx0ZXIoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gIXJlcGVhdExpc3RJZC5pbmNsdWRlcyhpdGVtLnJlbGF0aW9uSWQpOwogICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgICAgc2VsZWN0ZWRMaXN0ID0gW107CiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgY2FzZSA5OgogICAgICAgICAgICAgICAgZm9yIChpID0gc2VsZWN0ZWRMaXN0Lmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7CiAgICAgICAgICAgICAgICAgIF90aGlzMTUuc2VsZWN0ZWRJbmdyZWRpZW50TGlzdC51bnNoaWZ0KE9iamVjdC5hc3NpZ24oe30sIHNlbGVjdGVkTGlzdFtpXSwgewogICAgICAgICAgICAgICAgICAgIGN1c3RvbUlkOiBfdGhpczE1LnNlbGVjdGVkSW5ncmVkaWVudExpc3RbMF0gJiYgX3RoaXMxNS5zZWxlY3RlZEluZ3JlZGllbnRMaXN0WzBdLmN1c3RvbUlkICsgMSB8fCAwLAogICAgICAgICAgICAgICAgICAgIHNlbGVjdGVkOiBmYWxzZSwKICAgICAgICAgICAgICAgICAgICBwYWNrTnVtOiAxCiAgICAgICAgICAgICAgICAgIH0pKTsKICAgICAgICAgICAgICAgIH0gLy/muIXmpZrpgInkuK3nirbmgIEKICAgICAgICAgICAgICAgIC8vIHRoaXMuJHJlZnNbJ3Vuc2VsZWN0VGFibGUnXS4kcmVmc1sndGFibGUnXS5jbGVhclNlbGVjdGlvbigpOwoKCiAgICAgICAgICAgICAgICByZWZBcnIgPSBfdGhpczE1LiRyZWZzWyd1bnNlbGVjdFRhYmxlJ107CiAgICAgICAgICAgICAgICByZWZBcnIuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgICAgICAgICAgICBpdGVtLiRyZWZzWyd0YWJsZSddLmNsZWFyU2VsZWN0aW9uKCk7CiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICBfdGhpczE1LnJlc2V0TGlzdFNlbGVjdGVkKGxpc3QpOwoKICAgICAgICAgICAgICBjYXNlIDEzOgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZSk7CiAgICAgIH0pKSgpOwogICAgfSwKICAgIHNlbGVjdFRvTGVmdDogZnVuY3Rpb24gc2VsZWN0VG9MZWZ0KCkgewogICAgICB2YXIgbGlzdCA9IHRoaXMuZGlhbG9nRGF0YVNlbGVjdGVkT2JqW3RoaXMuZGlhbG9nQWN0aXZlTmFtZV07CiAgICAgIHRoaXMuZGlhbG9nRGF0YVNlbGVjdGVkT2JqW3RoaXMuZGlhbG9nQWN0aXZlTmFtZV0gPSBsaXN0LmZpbHRlcihmdW5jdGlvbiAoaXRlbSkgewogICAgICAgIHJldHVybiAhaXRlbS5zZWxlY3RlZDsKICAgICAgfSk7CiAgICAgIHRoaXMuJHJlZnNbJ3NlbGVjdGVkVGFibGUnXVswXS4kcmVmc1sndGFibGUnXS5jbGVhclNlbGVjdGlvbigpOwogICAgfSwKICAgIGluZ3JlZGllbnRSb3dDbGljazogZnVuY3Rpb24gaW5ncmVkaWVudFJvd0NsaWNrKHJvdykgewogICAgICBpZiAocm93LnNlbGVjdGVkKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB2YXIgaXRlbSA9IHRoaXMubGVmdEluZ3JlZGllbnREYXRhTGlzdC5maW5kKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgcmV0dXJuIGl0ZW0ucmVsYXRpb25JZCA9PT0gcm93LnJlbGF0aW9uSWQgJiYgaXRlbS5wcmltYXJ5Q2xhc3NpZmljYXRpb25OYW1lID09PSByb3cucHJpbWFyeUNsYXNzaWZpY2F0aW9uTmFtZTsKICAgICAgfSk7IC8vIGl0ZW0uc2VsZWN0ZWQgPSAhaXRlbS5zZWxlY3RlZDsKCiAgICAgIHRoaXMuc2VsZWN0ZWRJbmdyZWRpZW50TGlzdC51bnNoaWZ0KE9iamVjdC5hc3NpZ24oe30sIHJvdywgewogICAgICAgIHBhY2tOdW06IDEKICAgICAgfSkpOwogICAgICBpdGVtLnNlbGVjdGVkID0gdHJ1ZTsKICAgIH0sCiAgICB1bnNlbGVjdFRhYmxlUm93Q2xpY2s6IGZ1bmN0aW9uIHVuc2VsZWN0VGFibGVSb3dDbGljayhyb3csIGNvbHVtbiwgZXZlbnQpIHsKICAgICAgdmFyIGluZGV4ID0gdGhpcy5kaWFsb2dEYXRhVW5TZWxlY3RPYmpbdGhpcy5kaWFsb2dOYW1lXS5maW5kSW5kZXgoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICByZXR1cm4gaXRlbS5jdXN0b21JZCA9PT0gcm93LmN1c3RvbUlkOwogICAgICB9KTsKICAgICAgdmFyIHN0YXR1cyA9ICF0aGlzLmRpYWxvZ0RhdGFVblNlbGVjdE9ialt0aGlzLmRpYWxvZ05hbWVdW2luZGV4XS5zZWxlY3RlZDsKCiAgICAgIGlmICh0aGlzLmRpYWxvZ05hbWUgPT09ICdtZW51JykgewogICAgICAgIHRoaXMucmVzZXRMaXN0U2VsZWN0ZWQodGhpcy5kaWFsb2dEYXRhVW5TZWxlY3RPYmpbdGhpcy5kaWFsb2dOYW1lXSk7CiAgICAgICAgdGhpcy5kaWFsb2dEYXRhVW5TZWxlY3RPYmpbdGhpcy5kaWFsb2dOYW1lXVtpbmRleF0uc2VsZWN0ZWQgPSBzdGF0dXM7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5kaWFsb2dEYXRhVW5TZWxlY3RPYmpbdGhpcy5kaWFsb2dOYW1lXVtpbmRleF0uc2VsZWN0ZWQgPSBzdGF0dXM7CiAgICAgIH0gLy8gdGhpcy5kaWFsb2dEYXRhVW5TZWxlY3RPYmpbdGhpcy5kaWFsb2dBY3RpdmVOYW1lXSA9IEpTT04ucGFyc2UoCiAgICAgIC8vICAgSlNPTi5zdHJpbmdpZnkodGhpcy5kaWFsb2dEYXRhVW5TZWxlY3RPYmpbdGhpcy5kaWFsb2dBY3RpdmVOYW1lXSkKICAgICAgLy8gKTsKICAgICAgLy/ngrnlh7vliIfmjaLpgInkuK3nirbmgIEKICAgICAgLy8gdGhpcy4kbmV4dFRpY2soKCkgPT4gewogICAgICAvLyAgIHRoaXMuJHJlZnNbJ3Vuc2VsZWN0VGFibGUnXVswXS4kcmVmc1sndGFibGUnXS50b2dnbGVSb3dTZWxlY3Rpb24oCiAgICAgIC8vICAgICByb3csCiAgICAgIC8vICAgICBzdGF0dXMKICAgICAgLy8gICApOwogICAgICAvLyB9KTsKCiAgICB9LAogICAgLy/ljZXkuKrpgInkuK3vvIh0eXBlOiBzZWxlY3Rpb27vvInmmoLml7bkuI3nlKgKICAgIHVuc2VsZWN0VGFibGVSb3dTZWxlY3Q6IGZ1bmN0aW9uIHVuc2VsZWN0VGFibGVSb3dTZWxlY3Qoc2VsZWN0aW9uLCByb3cpIHsvLyByb3cuc2VsZWN0ZWQgPSAhcm93LnNlbGVjdGVkOwogICAgfSwKICAgIC8v5YWo6YCJ77yIdHlwZTogc2VsZWN0aW9u77yJ5pqC5pe25LiN55SoCiAgICB1bnNlbGVjdFRhYmxlUm93U2VsZWN0QWxsOiBmdW5jdGlvbiB1bnNlbGVjdFRhYmxlUm93U2VsZWN0QWxsKHNlbGVjdGlvbiwgdHlwZSkgewogICAgICB2YXIgaGFzQWxsU2VsZWN0ZWQgPSBzZWxlY3Rpb24uZXZlcnkoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICByZXR1cm4gaXRlbS5zZWxlY3RlZDsKICAgICAgfSk7CgogICAgICBpZiAoIXNlbGVjdGlvbi5sZW5ndGgpIHsKICAgICAgICBoYXNBbGxTZWxlY3RlZCA9IHRydWU7CiAgICAgIH0KCiAgICAgIGlmICh0eXBlID09PSAndW5zZWxlY3QnKSB7CiAgICAgICAgdGhpcy5kaWFsb2dEYXRhVW5TZWxlY3RPYmpbdGhpcy5kaWFsb2dBY3RpdmVOYW1lXS5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgICBpZiAoaGFzQWxsU2VsZWN0ZWQpIHsKICAgICAgICAgICAgaXRlbS5zZWxlY3RlZCA9IGZhbHNlOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgaXRlbS5zZWxlY3RlZCA9IHRydWU7CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gJ3NlbGVjdGVkJykgewogICAgICAgIHRoaXMuZGlhbG9nRGF0YVNlbGVjdGVkT2JqW3RoaXMuZGlhbG9nQWN0aXZlTmFtZV0uZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgICAgaWYgKGhhc0FsbFNlbGVjdGVkKSB7CiAgICAgICAgICAgIGl0ZW0uc2VsZWN0ZWQgPSBmYWxzZTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGl0ZW0uc2VsZWN0ZWQgPSB0cnVlOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9LAogICAgc2VsZWN0ZWRUYWJsZVJvd0NsaWNrOiBmdW5jdGlvbiBzZWxlY3RlZFRhYmxlUm93Q2xpY2socm93LCBjb2x1bW4sIGV2ZW50KSB7CiAgICAgIHZhciBfdGhpczE2ID0gdGhpczsKCiAgICAgIHZhciBpbmRleCA9IHRoaXMuZGlhbG9nRGF0YVNlbGVjdGVkT2JqW3RoaXMuZGlhbG9nQWN0aXZlTmFtZV0uZmluZEluZGV4KGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgcmV0dXJuIGl0ZW0uY3VzdG9tSWQgPT09IHJvdy5jdXN0b21JZDsKICAgICAgfSk7CiAgICAgIHZhciBzdGF0dXMgPSAhdGhpcy5kaWFsb2dEYXRhU2VsZWN0ZWRPYmpbdGhpcy5kaWFsb2dBY3RpdmVOYW1lXVtpbmRleF0uc2VsZWN0ZWQ7CiAgICAgIHRoaXMuZGlhbG9nRGF0YVNlbGVjdGVkT2JqW3RoaXMuZGlhbG9nQWN0aXZlTmFtZV1baW5kZXhdLnNlbGVjdGVkID0gc3RhdHVzOyAvLyB0aGlzLmRpYWxvZ0RhdGFTZWxlY3RlZE9ialt0aGlzLmRpYWxvZ0FjdGl2ZU5hbWVdID0gSlNPTi5wYXJzZSgKICAgICAgLy8gICBKU09OLnN0cmluZ2lmeSh0aGlzLmRpYWxvZ0RhdGFTZWxlY3RlZE9ialt0aGlzLmRpYWxvZ0FjdGl2ZU5hbWVdKQogICAgICAvLyApOwoKICAgICAgdGhpcy4kbmV4dFRpY2soZnVuY3Rpb24gKCkgewogICAgICAgIF90aGlzMTYuJHJlZnNbJ3NlbGVjdGVkVGFibGUnXVswXS4kcmVmc1sndGFibGUnXS50b2dnbGVSb3dTZWxlY3Rpb24ocm93LCBzdGF0dXMpOwogICAgICB9KTsKICAgIH0sCiAgICAvL+W8ueahhumAieaLqeeKtuaAgQogICAgZ2V0Um93Q3VzdG9tTmFtZTogZnVuY3Rpb24gZ2V0Um93Q3VzdG9tTmFtZShyb3csIHJvd0luZGV4KSB7CiAgICAgIGlmIChyb3cucm93LnNlbGVjdGVkKSB7CiAgICAgICAgcmV0dXJuICd0YWJsZS1zZWxlY3RlZCB0YWJsZS1pdGVtJzsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gJ3RhYmxlLWl0ZW0nOwogICAgICB9CiAgICB9LAogICAgLy/nvLrotKfllYblk4HmoIfms6gKICAgIGdldFJvd0N1c3RvbU5hbWVTdGF0dXM6IGZ1bmN0aW9uIGdldFJvd0N1c3RvbU5hbWVTdGF0dXMoX3JlZikgewogICAgICB2YXIgcm93ID0gX3JlZi5yb3csCiAgICAgICAgICByb3dJbmRleCA9IF9yZWYucm93SW5kZXg7CgogICAgICBpZiAocm93Lm91dE9mU3RvY2spIHsKICAgICAgICByZXR1cm4gJ3RhYmxlLW5vLXByb2R1Y3Rpb24nOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiAnJzsKICAgICAgfQogICAgfSwKICAgIC8v5re75Yqg6KGo5qC85pWw5o2uCiAgICBkaWFsb2dDb25maXJtOiBmdW5jdGlvbiBkaWFsb2dDb25maXJtKCkgewogICAgICB2YXIgX3RoaXMxNyA9IHRoaXM7CgogICAgICB2YXIgc2VsZWN0TGlzdCA9IFtdOwoKICAgICAgaWYgKHRoaXMuZGlhbG9nTmFtZSA9PT0gJ2luZ3JlZGllbnRzJykgewogICAgICAgIC8vIOmjn+adkOmAieS4reaVsOaNruaMieWPs+S+p+mAieS4reWxleekugogICAgICAgIHNlbGVjdExpc3QgPSB0aGlzLnNlbGVjdGVkSW5ncmVkaWVudExpc3Q7IC8vIOagoemqjOmAieS4remjn+adkOaVsOmHj+mdnuepugoKICAgICAgICB2YXIgYXJyID0gc2VsZWN0TGlzdC5maWx0ZXIoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICAgIHJldHVybiAhaXRlbS5wYWNrTnVtOwogICAgICAgIH0pOwoKICAgICAgICBpZiAoYXJyLmxlbmd0aCA+IDApIHsKICAgICAgICAgIHRoaXMud2FybmluZygn6K+35aGr5YaZ6aOf5p2Q5pWw6YeP77yBJyk7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIHNlbGVjdExpc3QgPSB0aGlzLmRpYWxvZ0RhdGFVblNlbGVjdE9ialt0aGlzLmRpYWxvZ05hbWVdLmZpbHRlcihmdW5jdGlvbiAoaXRlbSkgewogICAgICAgICAgcmV0dXJuIGl0ZW0uc2VsZWN0ZWQ7CiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIGlmICghc2VsZWN0TGlzdC5sZW5ndGgpIHsKICAgICAgICB0aGlzLndhcm5pbmcoIlx1OEJGN1x1OTAwOVx1NjJFOSIuY29uY2F0KHRoaXMudGFic0tleU5hbWVbdGhpcy5kaWFsb2dOYW1lXSkpOwogICAgICAgIHJldHVybjsKICAgICAgfSAvL+mjn+adkOm7mOiupOWIh+mFjeagh+WHhuS4uuavm+iPnAoKCiAgICAgIGlmICh0aGlzLmRpYWxvZ05hbWUgPT09ICdpbmdyZWRpZW50cycpIHsKICAgICAgICBzZWxlY3RMaXN0LmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICAgIC8vIGl0ZW0uY3V0TWF0Y2hTdGFuZGFyZElkID0gMTA7CiAgICAgICAgICBfdGhpczE3LiRzZXQoaXRlbSwgJ2N1dE1hdGNoU3RhbmRhcmRJZCcsIDEwKTsKICAgICAgICB9KTsgLy8KCiAgICAgICAgdmFyIGhhc0FkZEluZ3JlZGllbnRMaXN0ID0gdGhpcy5kaWFsb2dEYXRhU2VsZWN0ZWRPYmpbdGhpcy5kaWFsb2dOYW1lXTsKICAgICAgICB2YXIgcmVwZWF0TGlzdCA9IHRoaXMuaGFuZGxlU2VsZWN0UmVwZWF0KHNlbGVjdExpc3QsIGhhc0FkZEluZ3JlZGllbnRMaXN0KTsKCiAgICAgICAgaWYgKHJlcGVhdExpc3QubGVuZ3RoKSB7CiAgICAgICAgICB2YXIgdGlwc01lc3NhZ2VDb250ZW50ID0gJyc7CiAgICAgICAgICByZXBlYXRMaXN0LmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICAgICAgdGlwc01lc3NhZ2VDb250ZW50ICs9ICI8ZGl2PiIuY29uY2F0KGl0ZW0ucmVsYXRpb25OYW1lLCAiXHU1REYyXHU2REZCXHU1MkEwXHU4RkM3IikuY29uY2F0KGl0ZW0ucGFja051bSB8fCAnMCcpLmNvbmNhdChpdGVtLnBhY2tVbml0LCAiPC9kaXY+Iik7CiAgICAgICAgICB9KTsKICAgICAgICAgIHZhciB0aXBzTWVzc2FnZSA9ICJcbiAgICAgICAgICAgIDxkaXYgY2xhc3M9J3RpcHMtY29udGVudC1tZXNzYWFnZSc+XHU2NzA5XHU5MUNEXHU1OTBEXHU2REZCXHU1MkEwXHU5OERGXHU2NzUwXHVGRjBDXHU2NjJGXHU1NDI2XHU3ODZFXHU4QkE0XHU3RUU3XHU3RUVEXHU2REZCXHU1MkEwXHVGRjFGPC9kaXY+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzPSd0aXBzLWNvbnRlbnQtYm94Jz5cbiAgICAgICAgICAgICIuY29uY2F0KHRpcHNNZXNzYWdlQ29udGVudCwgIlxuICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgICA8ZGl2IGNsYXNzPSd0aXBzLWNvbnRlbnQtaW5mbyc+XHU3MEI5XHU1MUZCXHUzMDEwXHU1M0JCXHU5MUNEXHU2REZCXHU1MkEwXHUzMDExXHVGRjBDXHU1M0VBXHU2REZCXHU1MkEwXHU2NUIwXHU1ODlFXHU3Njg0XHU5OERGXHU2NzUwXHVGRjBDXHU3MEI5XHU1MUZCXHUzMDEwXHU1MTY4XHU5MEU4XHU2REZCXHU1MkEwXHUzMDExXHU1MjE5XHU2REZCXHU1MkEwXHU2MjQwXHU2NzA5XHU5MDA5XHU2MkU5XHU3Njg0XHU5OERGXHU2NzUwPC9kaXY+XG4gICAgICAgICAgIik7CiAgICAgICAgICB0aGlzLiRjb25maXJtKHRpcHNNZXNzYWdlLCAn5o+Q6YaSJywgewogICAgICAgICAgICBjdXN0b21DbGFzczogJ29yZGVyLXRpcHMtbWVzc2FnZScsCiAgICAgICAgICAgIGRhbmdlcm91c2x5VXNlSFRNTFN0cmluZzogdHJ1ZSwKICAgICAgICAgICAgY2xvc2VPbkNsaWNrTW9kYWw6IGZhbHNlLAogICAgICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogJ+WFqOmDqOa3u+WKoCcsCiAgICAgICAgICAgIGNhbmNlbEJ1dHRvblRleHQ6ICfljrvph43mt7vliqAnIC8vIHR5cGU6ICd3YXJuaW5nJwoKICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgICB2YXIgX3RoaXMxNyRkaWFsb2dEYXRhU2VsOwoKICAgICAgICAgICAgKF90aGlzMTckZGlhbG9nRGF0YVNlbCA9IF90aGlzMTcuZGlhbG9nRGF0YVNlbGVjdGVkT2JqW190aGlzMTcuZGlhbG9nTmFtZV0pLnVuc2hpZnQuYXBwbHkoX3RoaXMxNyRkaWFsb2dEYXRhU2VsLCBfdG9Db25zdW1hYmxlQXJyYXkoc2VsZWN0TGlzdCkpOwoKICAgICAgICAgICAgX3RoaXMxNy5jbG9zZURpYWxvZygpOwoKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKCkgewogICAgICAgICAgICB2YXIgX3RoaXMxNyRkaWFsb2dEYXRhU2VsMjsKCiAgICAgICAgICAgIHNlbGVjdExpc3QgPSBzZWxlY3RMaXN0LmZpbHRlcihmdW5jdGlvbiAoaXRlbSkgewogICAgICAgICAgICAgIHJldHVybiAhfnJlcGVhdExpc3QuZmluZEluZGV4KGZ1bmN0aW9uIChpdCkgewogICAgICAgICAgICAgICAgcmV0dXJuIGl0LnJlbGF0aW9uSWQgPT09IGl0ZW0ucmVsYXRpb25JZDsKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAoX3RoaXMxNyRkaWFsb2dEYXRhU2VsMiA9IF90aGlzMTcuZGlhbG9nRGF0YVNlbGVjdGVkT2JqW190aGlzMTcuZGlhbG9nTmFtZV0pLnVuc2hpZnQuYXBwbHkoX3RoaXMxNyRkaWFsb2dEYXRhU2VsMiwgX3RvQ29uc3VtYWJsZUFycmF5KHNlbGVjdExpc3QpKTsKCiAgICAgICAgICAgIF90aGlzMTcuY2xvc2VEaWFsb2coKTsKCiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0pOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB2YXIgX3RoaXMkZGlhbG9nRGF0YVNlbGVjOwoKICAgICAgICAgIChfdGhpcyRkaWFsb2dEYXRhU2VsZWMgPSB0aGlzLmRpYWxvZ0RhdGFTZWxlY3RlZE9ialt0aGlzLmRpYWxvZ05hbWVdKS51bnNoaWZ0LmFwcGx5KF90aGlzJGRpYWxvZ0RhdGFTZWxlYywgX3RvQ29uc3VtYWJsZUFycmF5KHNlbGVjdExpc3QpKTsKCiAgICAgICAgICB0aGlzLmNsb3NlRGlhbG9nKCk7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIGlmICh0aGlzLmRpYWxvZ05hbWUgPT0gJ2Rpc2gnKSB7CiAgICAgICAgICB0aGlzLnNldERpc2hSZXBlYXQoJ2Rpc2gnLCBzZWxlY3RMaXN0KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdmFyIF90aGlzJGRpYWxvZ0RhdGFTZWxlYzI7CgogICAgICAgICAgdGhpcy5kaWFsb2dEYXRlVmlzaWJsZSA9IHRydWU7CgogICAgICAgICAgKF90aGlzJGRpYWxvZ0RhdGFTZWxlYzIgPSB0aGlzLmRpYWxvZ0RhdGFTZWxlY3RlZE9ialt0aGlzLmRpYWxvZ05hbWVdKS51bnNoaWZ0LmFwcGx5KF90aGlzJGRpYWxvZ0RhdGFTZWxlYzIsIF90b0NvbnN1bWFibGVBcnJheShzZWxlY3RMaXN0KSk7CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgLy8g6I+c5ZOB6YeN5aSNCiAgICBzZXREaXNoUmVwZWF0OiBmdW5jdGlvbiBzZXREaXNoUmVwZWF0KHR5cGUsIHNlbGVjdExpc3QpIHsKICAgICAgdmFyIF90aGlzMTggPSB0aGlzOwoKICAgICAgdmFyIGhhc0FkZERpc2hMaXN0ID0gdGhpcy5kaWFsb2dEYXRhU2VsZWN0ZWRPYmpbdHlwZV07CiAgICAgIHZhciByZXBlYXRMaXN0ID0gdGhpcy5oYW5kbGVTZWxlY3RSZXBlYXQoc2VsZWN0TGlzdCwgaGFzQWRkRGlzaExpc3QpOwoKICAgICAgaWYgKHJlcGVhdExpc3QubGVuZ3RoKSB7CiAgICAgICAgdmFyIHRpcHNNZXNzYWdlQ29udGVudCA9ICcnOwogICAgICAgIHJlcGVhdExpc3QuZm9yRWFjaChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgICAgdmFyIHBhcmFtID0gJyc7CgogICAgICAgICAgaWYgKGl0ZW0ucXVhbnRpdHkpIHsKICAgICAgICAgICAgcGFyYW0gPSAn5bey5re75Yqg6L+HJyArIGl0ZW0ucXVhbnRpdHkgKyAn5Lu9JzsKICAgICAgICAgIH0KCiAgICAgICAgICB0aXBzTWVzc2FnZUNvbnRlbnQgKz0gIjxkaXY+Ii5jb25jYXQoaXRlbS5yZWxhdGlvbk5hbWUsICIgIikuY29uY2F0KHBhcmFtLCAiPC9kaXY+Iik7CiAgICAgICAgfSk7CiAgICAgICAgdmFyIHRpcHNNZXNzYWdlID0gIlxuICAgICAgICAgICAgPGRpdiBjbGFzcz0ndGlwcy1jb250ZW50LW1lc3NhYWdlJz5cdTY3MDlcdTkxQ0RcdTU5MERcdTZERkJcdTUyQTBcdTgzRENcdTU0QzFcdUZGMENcdTY2MkZcdTU0MjZcdTc4NkVcdThCQTRcdTdFRTdcdTdFRURcdTZERkJcdTUyQTBcdUZGMUY8L2Rpdj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9J3RpcHMtY29udGVudC1ib3gnPlxuICAgICAgICAgICAgIi5jb25jYXQodGlwc01lc3NhZ2VDb250ZW50LCAiXG4gICAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgICAgIDxkaXYgY2xhc3M9J3RpcHMtY29udGVudC1pbmZvJz5cdTcwQjlcdTUxRkJcdTMwMTBcdTUzQkJcdTkxQ0RcdTZERkJcdTUyQTBcdTMwMTFcdUZGMENcdTUzRUFcdTZERkJcdTUyQTBcdTY1QjBcdTU4OUVcdTc2ODRcdTgzRENcdTU0QzFcdUZGMENcdTcwQjlcdTUxRkJcdTMwMTBcdTUxNjhcdTkwRThcdTZERkJcdTUyQTBcdTMwMTFcdTUyMTlcdTZERkJcdTUyQTBcdTYyNDBcdTY3MDlcdTkwMDlcdTYyRTlcdTc2ODRcdTgzRENcdTU0QzE8L2Rpdj5cbiAgICAgICAgICAiKTsKICAgICAgICB0aGlzLiRjb25maXJtKHRpcHNNZXNzYWdlLCAn5o+Q6YaSJywgewogICAgICAgICAgY3VzdG9tQ2xhc3M6ICdvcmRlci10aXBzLW1lc3NhZ2UnLAogICAgICAgICAgZGFuZ2Vyb3VzbHlVc2VIVE1MU3RyaW5nOiB0cnVlLAogICAgICAgICAgY2xvc2VPbkNsaWNrTW9kYWw6IGZhbHNlLAogICAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICflhajpg6jmt7vliqAnLAogICAgICAgICAgY2FuY2VsQnV0dG9uVGV4dDogJ+WOu+mHjea3u+WKoCcgLy8gdHlwZTogJ3dhcm5pbmcnCgogICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgICAgdmFyIF90aGlzMTgkZGlhbG9nRGF0YVNlbDsKCiAgICAgICAgICAoX3RoaXMxOCRkaWFsb2dEYXRhU2VsID0gX3RoaXMxOC5kaWFsb2dEYXRhU2VsZWN0ZWRPYmpbdHlwZV0pLnVuc2hpZnQuYXBwbHkoX3RoaXMxOCRkaWFsb2dEYXRhU2VsLCBfdG9Db25zdW1hYmxlQXJyYXkoc2VsZWN0TGlzdCkpOwoKICAgICAgICAgIF90aGlzMTguY2xvc2VEaWFsb2coKTsKCiAgICAgICAgICByZXR1cm47CiAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKCkgewogICAgICAgICAgdmFyIF90aGlzMTgkZGlhbG9nRGF0YVNlbDI7CgogICAgICAgICAgc2VsZWN0TGlzdCA9IHNlbGVjdExpc3QuZmlsdGVyKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgICAgIHJldHVybiAhfnJlcGVhdExpc3QuZmluZEluZGV4KGZ1bmN0aW9uIChpdCkgewogICAgICAgICAgICAgIHJldHVybiBpdC5yZWxhdGlvbklkID09PSBpdGVtLnJlbGF0aW9uSWQ7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgfSk7CgogICAgICAgICAgKF90aGlzMTgkZGlhbG9nRGF0YVNlbDIgPSBfdGhpczE4LmRpYWxvZ0RhdGFTZWxlY3RlZE9ialt0eXBlXSkudW5zaGlmdC5hcHBseShfdGhpczE4JGRpYWxvZ0RhdGFTZWwyLCBfdG9Db25zdW1hYmxlQXJyYXkoc2VsZWN0TGlzdCkpOwoKICAgICAgICAgIF90aGlzMTguY2xvc2VEaWFsb2coKTsKCiAgICAgICAgICByZXR1cm47CiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdmFyIF90aGlzJGRpYWxvZ0RhdGFTZWxlYzM7CgogICAgICAgIChfdGhpcyRkaWFsb2dEYXRhU2VsZWMzID0gdGhpcy5kaWFsb2dEYXRhU2VsZWN0ZWRPYmpbdHlwZV0pLnVuc2hpZnQuYXBwbHkoX3RoaXMkZGlhbG9nRGF0YVNlbGVjMywgX3RvQ29uc3VtYWJsZUFycmF5KHNlbGVjdExpc3QpKTsKCiAgICAgICAgdGhpcy5jbG9zZURpYWxvZygpOwogICAgICB9CiAgICB9LAogICAgLy/ojrflj5bpo5/mnZDph43lpI3lhoXlrrkKICAgIGhhbmRsZVNlbGVjdFJlcGVhdDogZnVuY3Rpb24gaGFuZGxlU2VsZWN0UmVwZWF0KHNlbGVjdExpc3QsIGhhc0FkZExpc3QpIHsKICAgICAgdmFyIHJlcGVhdExpc3QgPSBbXTsKICAgICAgaGFzQWRkTGlzdC5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgaWYgKHNlbGVjdExpc3QuZmluZChmdW5jdGlvbiAoaXQpIHsKICAgICAgICAgIHJldHVybiBpdC5yZWxhdGlvbklkID09PSBpdGVtLnJlbGF0aW9uSWQ7CiAgICAgICAgfSkpIHsKICAgICAgICAgIHJlcGVhdExpc3QucHVzaChpdGVtKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgICByZXR1cm4gcmVwZWF0TGlzdDsKICAgIH0sCiAgICAvL+S/neWtmOiuouWNleWGheWuuQogICAgc2F2ZU9yZGVyQW5kQ29udGVudDogZnVuY3Rpb24gc2F2ZU9yZGVyQW5kQ29udGVudCgpIHsKICAgICAgdmFyIF90aGlzMTkgPSB0aGlzOwoKICAgICAgdmFyIGtleXMgPSBPYmplY3Qua2V5cyh0aGlzLmRpYWxvZ0RhdGFTZWxlY3RlZE9iaik7CiAgICAgIHZhciBvcmRlckNvbnRlbnRBZGRSZXFEdG9MaXN0ID0gW107CgogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGtleXMubGVuZ3RoOyBpKyspIHsKICAgICAgICB2YXIgb3JkZXJDb250ZW50UmVxRHRvTGlzdCA9IFtdOwoKICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHRoaXMuZGlhbG9nRGF0YVNlbGVjdGVkT2JqW2tleXNbaV1dLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICBpZiAoa2V5c1tpXSA9PSAnZGlzaCcgJiYgIXRoaXMuZGlhbG9nRGF0YVNlbGVjdGVkT2JqW2tleXNbaV1dW2pdLm1lYWxUeXBlKSB7CiAgICAgICAgICAgIHRoaXMud2FybmluZygn6K+36YCJ5oup6aSQ5YirJyk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0KCiAgICAgICAgICBpZiAoa2V5c1tpXSA9PSAnaW5ncmVkaWVudHMnICYmICF0aGlzLmRpYWxvZ0RhdGFTZWxlY3RlZE9ialtrZXlzW2ldXVtqXS5jdXRNYXRjaFN0YW5kYXJkSWQpIHsKICAgICAgICAgICAgdGhpcy53YXJuaW5nKCfor7fpgInmi6nliIfphY3moIflh4YnKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQoKICAgICAgICAgIGlmIChrZXlzW2ldID09PSAnZGlzaCcgJiYgIXRoaXMuZGlhbG9nRGF0YVNlbGVjdGVkT2JqW2tleXNbaV1dW2pdLnF1YW50aXR5IHx8IGtleXNbaV0gPT09ICdpbmdyZWRpZW50cycgJiYgIXRoaXMuZGlhbG9nRGF0YVNlbGVjdGVkT2JqW2tleXNbaV1dW2pdLnBhY2tOdW0pIHsKICAgICAgICAgICAgdGhpcy53YXJuaW5nKCfor7fovpPlhaXmlbDph48nKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgICAgfQoKICAgICAgICAgIGlmICghdGhpcy5kaWFsb2dEYXRhU2VsZWN0ZWRPYmpba2V5c1tpXV1bal0uYXJyaXZhbERhdGUgfHwgIXRoaXMuZGlhbG9nRGF0YVNlbGVjdGVkT2JqW2tleXNbaV1dW2pdLmFycml2YWxUaW1lKSB7CiAgICAgICAgICAgIHRoaXMud2FybmluZygn6K+36YCJ5oup5Yiw6LSn5pe26Ze0Jyk7CiAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgIH0gLy8gaWYgKHRoaXMuZGlhbG9nRGF0YVNlbGVjdGVkT2JqW2tleXNbaV1dW2pdLm91dE9mU3RvY2sgPT09IDEpIHsKICAgICAgICAgIC8vICAgdGhpcy53YXJuaW5nKCforqLljZXkuK3lkKvmnInnvLrotKfllYblk4EnKTsKICAgICAgICAgIC8vICAgcmV0dXJuOwogICAgICAgICAgLy8gfQoKCiAgICAgICAgICBvcmRlckNvbnRlbnRSZXFEdG9MaXN0LnB1c2godGhpcy5kaWFsb2dEYXRhU2VsZWN0ZWRPYmpba2V5c1tpXV1bal0pOwogICAgICAgIH0KCiAgICAgICAgb3JkZXJDb250ZW50QWRkUmVxRHRvTGlzdC5wdXNoKHsKICAgICAgICAgIHR5cGU6IHRoaXMucXVlcnlPYmplY3Rba2V5c1tpXV0sCiAgICAgICAgICBvcmRlckNvbnRlbnRSZXFEdG9MaXN0OiBvcmRlckNvbnRlbnRSZXFEdG9MaXN0CiAgICAgICAgfSk7CiAgICAgIH0KCiAgICAgIHZhciBpc0VtcHR5ID0gb3JkZXJDb250ZW50QWRkUmVxRHRvTGlzdC5ldmVyeShmdW5jdGlvbiAoaXRlbSkgewogICAgICAgIHJldHVybiAhaXRlbS5vcmRlckNvbnRlbnRSZXFEdG9MaXN0Lmxlbmd0aDsKICAgICAgfSk7CgogICAgICBpZiAoaXNFbXB0eSkgewogICAgICAgIHRoaXMud2FybmluZygn6K+35re75Yqg6K6i5Y2V5YaF5a65Jyk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICB2YXIgX3RoaXMkZm9ybURhdGEyID0gdGhpcy5mb3JtRGF0YSwKICAgICAgICAgIHNjaG9vbEJyYW5jaENvZGUgPSBfdGhpcyRmb3JtRGF0YTIuc2Nob29sQnJhbmNoQ29kZSwKICAgICAgICAgIGFycml2YWxEYXRlID0gX3RoaXMkZm9ybURhdGEyLmFycml2YWxEYXRlLAogICAgICAgICAgb3JkZXJTdGF0dXMgPSBfdGhpcyRmb3JtRGF0YTIub3JkZXJTdGF0dXMsCiAgICAgICAgICBwcm92aW5jZUNvZGUgPSBfdGhpcyRmb3JtRGF0YTIucHJvdmluY2VDb2RlLAogICAgICAgICAgY2l0eUNvZGUgPSBfdGhpcyRmb3JtRGF0YTIuY2l0eUNvZGUsCiAgICAgICAgICBzY2hvb2xDb2RlID0gX3RoaXMkZm9ybURhdGEyLnNjaG9vbENvZGUsCiAgICAgICAgICBkaXN0cmljdENvZGUgPSBfdGhpcyRmb3JtRGF0YTIuZGlzdHJpY3RDb2RlOwogICAgICB2YXIgcGFyYW1zID0gewogICAgICAgIG9yZGVySWQ6IHRoaXMub3BlcmFUeXBlID09PSAnY29weScgPyBudWxsIDogdGhpcy5vcmRlcklkLAogICAgICAgIHR5cGU6IG9yZGVyU3RhdHVzLAogICAgICAgIGRlcHRJZDogc2Nob29sQnJhbmNoQ29kZSwKICAgICAgICBwYXJlbnREZXB0SWQ6IHNjaG9vbENvZGUsCiAgICAgICAgLy8gYXJyaXZhbFRpbWU6IGFycml2YWxEYXRlLAogICAgICAgIHJlbWFya3M6IHRoaXMub3JkZXJSZW1hcmssCiAgICAgICAgaW5jbHVkaW5nRGlzaGVzU2Vhc29uaW5nOiB0aGlzLmluY2x1ZGluZ0Rpc2hlc1NlYXNvbmluZywKICAgICAgICBwcm92aW5jZUNvZGU6IHByb3ZpbmNlQ29kZSwKICAgICAgICBjaXR5Q29kZTogY2l0eUNvZGUsCiAgICAgICAgZGlzdHJpY3RDb2RlOiBkaXN0cmljdENvZGUsCiAgICAgICAgb3JkZXJDb250ZW50QWRkUmVxRHRvTGlzdDogb3JkZXJDb250ZW50QWRkUmVxRHRvTGlzdAogICAgICB9OwogICAgICByZXR1cm4gX3NhdmVPcmRlckFuZENvbnRlbnQocGFyYW1zKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgICBfdGhpczE5LmRpYWxvZ1Zpc2libGUgPSBmYWxzZTsKCiAgICAgICAgX3RoaXMxOS53YXJuaW5nKCfkv53lrZjmiJDlip8nLCAnc3VjY2VzcycpOwoKICAgICAgICB2YXIgcmVzRGF0YSA9IHJlcy5kYXRhIHx8IHt9OwogICAgICAgIF90aGlzMTkub3JkZXJJZCA9IHJlc0RhdGEub3JkZXJJZDsKICAgICAgfSk7CiAgICB9LAogICAgLy/ml6XmnJ/pgInmi6nlvLnnqpcKICAgIGRpYWxvZ0RhdGVDb25maXJtOiBmdW5jdGlvbiBkaWFsb2dEYXRlQ29uZmlybSgpIHsKICAgICAgdmFyIGxvYWRpbmcgPSB0aGlzLiRsb2FkaW5nKHsKICAgICAgICBsb2NrOiB0cnVlLAogICAgICAgIHRleHQ6ICdMb2FkaW5nJywKICAgICAgICBzcGlubmVyOiAnZWwtaWNvbi1sb2FkaW5nJywKICAgICAgICBiYWNrZ3JvdW5kOiAncmdiYSgwLCAwLCAwLCAwLjcpJwogICAgICB9KTsKCiAgICAgIHRyeSB7CiAgICAgICAgdmFyIHdlZWtMaXN0ID0gdGhpcy5kaWFsb2dEYXRhU2VsZWN0ZWRPYmpbdGhpcy5kaWFsb2dOYW1lXVswXVsnbWVhbERheUxpc3QnXTsgLy/ml6XmnJ/nm7jlt67lpKnmlbAKCiAgICAgICAgdmFyIGRheU51bSA9IChuZXcgRGF0ZSh0aGlzLmRpYWxvZ0RhdGVSYW5nZVsxXSkgLSBuZXcgRGF0ZSh0aGlzLmRpYWxvZ0RhdGVSYW5nZVswXSkpIC8gMTAwMCAvIDM2MDAgLyAyNCArIDE7CiAgICAgICAgdmFyIHN0YXJ0V2VlayA9IG5ldyBEYXRlKHRoaXMuZGlhbG9nRGF0ZVJhbmdlWzBdKS5nZXREYXkoKTsKICAgICAgICB2YXIgc3RhcnREYXkgPSBuZXcgRGF0ZSh0aGlzLmRpYWxvZ0RhdGVSYW5nZVswXSkuZ2V0VGltZSgpOwogICAgICAgIHZhciBzdGFydEluZGV4OwoKICAgICAgICBpZiAoc3RhcnRXZWVrKSB7CiAgICAgICAgICBzdGFydEluZGV4ID0gc3RhcnRXZWVrIC0gMTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgc3RhcnRJbmRleCA9IDY7CiAgICAgICAgfQoKICAgICAgICB2YXIgbGlzdCA9IFtdOwoKICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGRheU51bTsgaSsrKSB7CiAgICAgICAgICB2YXIgbWVhbFR5cGVMaXN0ID0gd2Vla0xpc3Rbc3RhcnRJbmRleF1bJ21lYWxUeXBlTGlzdCddOwoKICAgICAgICAgIGZvciAodmFyIF9pID0gMDsgX2kgPCBtZWFsVHlwZUxpc3QubGVuZ3RoOyBfaSsrKSB7CiAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgbWVhbFR5cGVMaXN0W19pXS5jb250ZW50TGlzdC5sZW5ndGg7IGorKykgewogICAgICAgICAgICAgIHZhciBpdGVtID0gbWVhbFR5cGVMaXN0W19pXS5jb250ZW50TGlzdFtqXTsgLy/ml6nppJDliY3kuIDlpKkgMTUg54K56YCB77yM5Y2I6aSQ5pma6aSQ5b2T5aSp5Lmd54K56YCBCgogICAgICAgICAgICAgIGxpc3QucHVzaChPYmplY3QuYXNzaWduKHt9LCBpdGVtLCB7CiAgICAgICAgICAgICAgICBhcnJpdmFsRGF0ZTogaXRlbS5tZWFsVHlwZSA9PT0gMSA/IHRoaXMuZm9ybWF0ZURhdGUoc3RhcnREYXkgLSAxMDAwICogMzYwMCAqIDI0KSA6IHRoaXMuZm9ybWF0ZURhdGUoc3RhcnREYXkpLAogICAgICAgICAgICAgICAgYXJyaXZhbFRpbWU6IHRoaXMuZ2V0QXJyaXZhbFRpbWUoaXRlbS5tZWFsVHlwZSkKICAgICAgICAgICAgICB9KSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KCiAgICAgICAgICBzdGFydEluZGV4ID0gc3RhcnRJbmRleCA9PT0gNiA/IDAgOiBzdGFydEluZGV4ICsgMTsgLy/lpKnmlbArMSDlpKkKCiAgICAgICAgICBzdGFydERheSArPSAzNjAwICogMjQgKiAxMDAwOwogICAgICAgIH0gLy8gdGhpcy5kaWFsb2dEYXRhU2VsZWN0ZWRPYmpbJ2Rpc2gnXS51bnNoaWZ0KC4uLmxpc3QpOwoKCiAgICAgICAgdGhpcy5zZXREaXNoUmVwZWF0KCdkaXNoJywgbGlzdCk7CiAgICAgICAgdGhpcy5kaWFsb2dEYXRhU2VsZWN0ZWRPYmpbJ21lbnUnXSA9IFtdOwogICAgICB9IGNhdGNoIChlcnIpIHt9IGZpbmFsbHkgewogICAgICAgIHRoaXMuY2xvc2VEYXRlRGlhbG9nKCk7CiAgICAgICAgbG9hZGluZy5jbG9zZSgpOwogICAgICB9CiAgICB9LAogICAgLy/ojrflj5bphY3pgIHml7bpl7QKICAgIGdldEFycml2YWxUaW1lOiBmdW5jdGlvbiBnZXRBcnJpdmFsVGltZSh0eXBlKSB7CiAgICAgIHZhciB0aW1lID0gJyc7CgogICAgICBzd2l0Y2ggKHR5cGUpIHsKICAgICAgICBjYXNlIDE6CiAgICAgICAgICB0aW1lID0gJzE1OjAwJzsKICAgICAgICAgIGJyZWFrOwoKICAgICAgICBjYXNlIDI6CiAgICAgICAgY2FzZSAzOgogICAgICAgICAgdGltZSA9ICcwNjowMCc7CiAgICAgICAgICBicmVhazsKCiAgICAgICAgZGVmYXVsdDoKICAgICAgICAgIGJyZWFrOwogICAgICB9CgogICAgICByZXR1cm4gdGltZTsKICAgIH0sCiAgICAvL+aIkOacrOS7t+iuoeeulyjmmoLml7bpmpDol48pCiAgICBoYW5kbGVJbnB1dE51bWJlcjogZnVuY3Rpb24gaGFuZGxlSW5wdXROdW1iZXIoKSB7Ly8gbGV0IHByaWNlU3VtID0gMDsKICAgICAgLy8gY29uc3Qga2V5cyA9IE9iamVjdC5rZXlzKHRoaXMuZGlhbG9nRGF0YVNlbGVjdGVkT2JqKTsKICAgICAgLy8gZm9yIChsZXQgaSA9IDA7IGkgPCBrZXlzLmxlbmd0aDsgaSsrKSB7CiAgICAgIC8vICAgZm9yIChsZXQgaiA9IDA7IGogPCB0aGlzLmRpYWxvZ0RhdGFTZWxlY3RlZE9ialtrZXlzW2ldXS5sZW5ndGg7IGorKykgewogICAgICAvLyAgICAgY29uc3QgaXRlbSA9IHRoaXMuZGlhbG9nRGF0YVNlbGVjdGVkT2JqW2tleXNbaV1dW2pdOwogICAgICAvLyAgICAgaWYgKGtleXNbaV0gPT09ICdkaXNoJykgewogICAgICAvLyAgICAgICBpZiAoaXRlbS5xdWFudGl0eSAmJiBpdGVtLmNvc3RQcmljZSkgewogICAgICAvLyAgICAgICAgIHByaWNlU3VtICs9IGl0ZW0ucXVhbnRpdHkgKiBpdGVtLmNvc3RQcmljZTsKICAgICAgLy8gICAgICAgfQogICAgICAvLyAgICAgfSBlbHNlIGlmIChrZXlzW2ldID09PSAnaW5ncmVkaWVudHMnKSB7CiAgICAgIC8vICAgICAgIGlmIChpdGVtLmN1dE1hdGNoU3RhbmRhcmRJZCkgewogICAgICAvLyAgICAgICAgIGlmIChpdGVtLmN1dE1hdGNoU3RhbmRhcmRJZCA9PT0gOSkgewogICAgICAvLyAgICAgICAgICAgaWYgKGl0ZW0ucGFja051bSAmJiBpdGVtLmNsZWFuVmVnZXRhYmxlUHJpY2UpIHsKICAgICAgLy8gICAgICAgICAgICAgcHJpY2VTdW0gKz0KICAgICAgLy8gICAgICAgICAgICAgICBpdGVtLnBhY2tOdW0gKiBpdGVtLm5ldFdlaWdodCAqIGl0ZW0uY2xlYW5WZWdldGFibGVQcmljZTsKICAgICAgLy8gICAgICAgICAgIH0KICAgICAgLy8gICAgICAgICB9IGVsc2UgewogICAgICAvLyAgICAgICAgICAgaWYgKGl0ZW0ucGFja051bSAmJiBpdGVtLm9yaWdpbmFsVmVnZXRhYmxlUHJpY2UpIHsKICAgICAgLy8gICAgICAgICAgICAgcHJpY2VTdW0gKz0KICAgICAgLy8gICAgICAgICAgICAgICBpdGVtLnBhY2tOdW0gKiBpdGVtLm5ldFdlaWdodCAqIGl0ZW0ub3JpZ2luYWxWZWdldGFibGVQcmljZTsKICAgICAgLy8gICAgICAgICAgIH0KICAgICAgLy8gICAgICAgICB9CiAgICAgIC8vICAgICAgIH0KICAgICAgLy8gICAgIH0KICAgICAgLy8gICB9CiAgICAgIC8vIH0KICAgICAgLy8gdGhpcy5zdGF0aXN0aWNzSW5mby5jb3N0UHJpY2UgPSBwcmljZVN1bS50b0ZpeGVkKDIpOwogICAgfSwKICAgIC8v6YeN572u6YCJ5oup54q25oCBCiAgICByZXNldExpc3RTZWxlY3RlZDogZnVuY3Rpb24gcmVzZXRMaXN0U2VsZWN0ZWQobGlzdCkgewogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxpc3QubGVuZ3RoOyBpKyspIHsKICAgICAgICBpZiAobGlzdFtpXS5zZWxlY3RlZCkgewogICAgICAgICAgbGlzdFtpXS5zZWxlY3RlZCA9IGZhbHNlOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIC8v6L+H5ruk5pWw57uE77yI5ZCN56ew5oiW6ICF566A5ou86L+H5ruk77yJCiAgICBnZXRGaWx0ZXJEYXRhOiBmdW5jdGlvbiBnZXRGaWx0ZXJEYXRhKGxpc3QsIHN0cikgewogICAgICB2YXIgZmlsdGVyTGlzdCA9IGxpc3QuZmlsdGVyKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgcmV0dXJuIH5pdGVtLnBpbnlpbkhlYWRlci5pbmRleE9mKHN0ci50b0xvY2FsZVVwcGVyQ2FzZSgpKSB8fCB+aXRlbS5yZWxhdGlvbk5hbWUuaW5kZXhPZihzdHIpOwogICAgICB9KTsKICAgICAgcmV0dXJuIGZpbHRlckxpc3Q7CiAgICB9LAogICAgZ2V0RmlsdGVyTGlzdDogZnVuY3Rpb24gZ2V0RmlsdGVyTGlzdChsaXN0LCBzdHIpIHsKICAgICAgdmFyIGFyciA9IGxpc3QubWFwKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgdmFyIG5ld0NoaWxkcmVuID0gaXRlbS5jaGlsZHJlbi5maWx0ZXIoZnVuY3Rpb24gKGVsKSB7CiAgICAgICAgICByZXR1cm4gfmVsLnBpbnlpbkhlYWRlci5pbmRleE9mKHN0ci50b0xvY2FsZVVwcGVyQ2FzZSgpKSB8fCB+ZWwucmVsYXRpb25OYW1lLmluZGV4T2Yoc3RyKTsKICAgICAgICB9KTsKICAgICAgICByZXR1cm4gewogICAgICAgICAgbmFtZTogaXRlbS5uYW1lLAogICAgICAgICAgY2hpbGRyZW46IG5ld0NoaWxkcmVuCiAgICAgICAgfTsKICAgICAgfSk7CiAgICAgIHZhciBmaWx0ZXJMaXN0ID0gYXJyLmZpbHRlcihmdW5jdGlvbiAoaXRlbSkgewogICAgICAgIHJldHVybiBpdGVtLmNoaWxkcmVuLmxlbmd0aCA+IDA7CiAgICAgIH0pOwogICAgICB0aGlzLnNpZGVBY3RpdmUgPSBmaWx0ZXJMaXN0Lmxlbmd0aCA+IDAgPyBmaWx0ZXJMaXN0WzBdLm5hbWUgOiAnJzsKICAgICAgcmV0dXJuIGZpbHRlckxpc3Q7CiAgICB9LAogICAgaGFuZGxlRGlhbG9nQ2xvc2U6IGZ1bmN0aW9uIGhhbmRsZURpYWxvZ0Nsb3NlKGRvbmUpIHsKICAgICAgLy8gdGhpcy5pbml0RGlhbG9nRGF0YSgpOwogICAgICBkb25lKCk7CiAgICB9LAogICAgaW5pdERpYWxvZ0RhdGE6IGZ1bmN0aW9uIGluaXREaWFsb2dEYXRhKCkgewogICAgICB0aGlzLmRpYWxvZ0RhdGFVblNlbGVjdE9iaiA9IHsKICAgICAgICBtZW51OiBbXSwKICAgICAgICBkaXNoOiBbXSwKICAgICAgICBpbmdyZWRpZW50czogW10KICAgICAgfTsKICAgICAgdGhpcy5kaWFsb2dEYXRhU2VsZWN0ZWRPYmogPSB7CiAgICAgICAgbWVudTogW10sCiAgICAgICAgZGlzaDogW10sCiAgICAgICAgaW5ncmVkaWVudHM6IFtdCiAgICAgIH07CiAgICAgIHRoaXMuZGlhbG9nVW5zZWxlY3RJbnB1dCA9ICcnOwogICAgICB0aGlzLmRpYWxvZ1NlbGVjdGVkSW5wdXQgPSAnJzsKICAgIH0sCiAgICAvL+iOt+WPluiuouWNleivpuaDhe+8iOiuouWNleeahOecgeW4guWMuuaAp+i0qO+8iQogICAgZ2V0T3JkZXJEZXRhaWw6IGZ1bmN0aW9uIGdldE9yZGVyRGV0YWlsKCkgewogICAgICB2YXIgX3RoaXMyMCA9IHRoaXM7CgogICAgICByZXR1cm4gX2dldE9yZGVyRGV0YWlsKHsKICAgICAgICBvcmRlcklkOiB0aGlzLm9yZGVySWQKICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgdmFyIHJlc0RhdGEgPSByZXMuZGF0YSB8fCB7fTsKICAgICAgICB2YXIgcHJvdmluY2VDb2RlID0gcmVzRGF0YS5wcm92aW5jZUNvZGUsCiAgICAgICAgICAgIGNpdHlDb2RlID0gcmVzRGF0YS5jaXR5Q29kZSwKICAgICAgICAgICAgZGlzdHJpY3RDb2RlID0gcmVzRGF0YS5kaXN0cmljdENvZGUsCiAgICAgICAgICAgIHBhcmVudERlcHRJZCA9IHJlc0RhdGEucGFyZW50RGVwdElkLAogICAgICAgICAgICBkZXB0SWQgPSByZXNEYXRhLmRlcHRJZCwKICAgICAgICAgICAgYXJyaXZhbFRpbWUgPSByZXNEYXRhLmFycml2YWxUaW1lLAogICAgICAgICAgICB0eXBlID0gcmVzRGF0YS50eXBlLAogICAgICAgICAgICByZW1hcmtzID0gcmVzRGF0YS5yZW1hcmtzLAogICAgICAgICAgICBpbmNsdWRpbmdEaXNoZXNTZWFzb25pbmcgPSByZXNEYXRhLmluY2x1ZGluZ0Rpc2hlc1NlYXNvbmluZzsKICAgICAgICBfdGhpczIwLmRpc3RyaWN0Q29kZSA9IGRpc3RyaWN0Q29kZTsgLy/nvJbovpHml7bliJ3lp4vljJbljLrln5/kv6Hmga8KCiAgICAgICAgX3RoaXMyMC4kc2V0KF90aGlzMjAuZm9ybURhdGEsICdwcm92aW5jZUNvZGUnLCBwcm92aW5jZUNvZGUpOwoKICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgIF90aGlzMjAuJHNldChfdGhpczIwLmZvcm1EYXRhLCAnY2l0eUNvZGUnLCBjaXR5Q29kZSk7CiAgICAgICAgfSwgMCk7CiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICBfdGhpczIwLiRzZXQoX3RoaXMyMC5mb3JtRGF0YSwgJ2Rpc3RyaWN0Q29kZScsIGRpc3RyaWN0Q29kZSk7CiAgICAgICAgfSwgMCk7CiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICBfdGhpczIwLiRzZXQoX3RoaXMyMC5mb3JtRGF0YSwgJ3NjaG9vbENvZGUnLCBwYXJlbnREZXB0SWQpOwogICAgICAgIH0sIDApOwogICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgX3RoaXMyMC4kc2V0KF90aGlzMjAuZm9ybURhdGEsICdzY2hvb2xCcmFuY2hDb2RlJywgZGVwdElkKTsKICAgICAgICB9LCAwKTsKCiAgICAgICAgX3RoaXMyMC4kc2V0KF90aGlzMjAuZm9ybURhdGEsICdvcmRlclN0YXR1cycsIHR5cGUgKyAnJyk7CgogICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgX3RoaXMyMC4kc2V0KF90aGlzMjAuZm9ybURhdGEsICdhcnJpdmFsRGF0ZScsIF90aGlzMjAuZm9ybWF0ZURhdGUoYXJyaXZhbFRpbWUsIDMpKTsKICAgICAgICB9LCAwKTsKICAgICAgICBfdGhpczIwLmluY2x1ZGluZ0Rpc2hlc1NlYXNvbmluZyA9IGluY2x1ZGluZ0Rpc2hlc1NlYXNvbmluZzsKICAgICAgICBfdGhpczIwLm9yZGVyUmVtYXJrID0gcmVtYXJrczsgLy8gdGhpcy5mb3JtRGF0YS5wcm92aW5jZUNvZGUgPSBwcm92aW5jZUNvZGU7CiAgICAgICAgLy8gdGhpcy5mb3JtRGF0YS5jaXR5Q29kZSA9IGNpdHlDb2RlOwogICAgICAgIC8vIHRoaXMuZm9ybURhdGEucGFyZW50RGVwdElkID0gcGFyZW50RGVwdElkOwogICAgICAgIC8vIHRoaXMuZm9ybURhdGEuZGVwdElkID0gZGVwdElkOwoKICAgICAgICByZXR1cm47CiAgICAgIH0pOwogICAgfSwKICAgIGhhbmRsZU1lYWxEYXRhOiBoYW5kbGVNZWFsRGF0YSwKICAgIGluaXREYXRlOiBmdW5jdGlvbiBpbml0RGF0ZSgpIHsKICAgICAgdmFyIGtleXMgPSBPYmplY3Qua2V5cyh0aGlzLmRpYWxvZ0RhdGFTZWxlY3RlZE9iaik7CgogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGtleXMubGVuZ3RoOyBpKyspIHsKICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IHRoaXMuZGlhbG9nRGF0YVNlbGVjdGVkT2JqW2tleXNbaV1dLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICB0aGlzLmRpYWxvZ0RhdGFTZWxlY3RlZE9ialtrZXlzW2ldXVtqXS5hcnJpdmFsRGF0ZSA9ICcnOwogICAgICAgICAgdGhpcy5kaWFsb2dEYXRhU2VsZWN0ZWRPYmpba2V5c1tpXV1bal0uYXJyaXZhbFRpbWUgPSAnJzsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBmb3JtYXRlRGF0ZTogZnVuY3Rpb24gZm9ybWF0ZURhdGUodGltZXN0YW1wKSB7CiAgICAgIHZhciB0eXBlID0gYXJndW1lbnRzLmxlbmd0aCA+IDEgJiYgYXJndW1lbnRzWzFdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMV0gOiAxOwoKICAgICAgaWYgKCF0aW1lc3RhbXApIHsKICAgICAgICByZXR1cm4gJy0nOwogICAgICB9CgogICAgICB2YXIgdGltZSA9IG5ldyBEYXRlKHRpbWVzdGFtcCk7CiAgICAgIHZhciB5ZWFyID0gdGltZS5nZXRGdWxsWWVhcigpOwogICAgICB2YXIgbW9udGggPSAodGltZS5nZXRNb250aCgpICsgMSkudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAnMCcpOwogICAgICB2YXIgZGF0ZSA9IHRpbWUuZ2V0RGF0ZSgpLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJzAnKTsKICAgICAgdmFyIGhvdXJzID0gdGltZS5nZXRIb3VycygpLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJzAnKTsKICAgICAgdmFyIG1pbnV0ZSA9IHRpbWUuZ2V0TWludXRlcygpLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJzAnKTsKICAgICAgdmFyIHNlY29uZCA9IHRpbWUuZ2V0U2Vjb25kcygpLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJzAnKTsKICAgICAgcmV0dXJuIHllYXIgKyAnLScgKyBtb250aCArICctJyArIGRhdGU7CiAgICB9LAogICAgY2xvc2VEaWFsb2c6IGZ1bmN0aW9uIGNsb3NlRGlhbG9nKCkgewogICAgICB0aGlzLmRpYWxvZ1Zpc2libGUgPSBmYWxzZTsKICAgICAgdGhpcy5kaWFsb2dVbnNlbGVjdElucHV0ID0gJyc7CiAgICAgIHRoaXMuZGlhbG9nRGF0YVVuU2VsZWN0T2JqW3RoaXMuZGlhbG9nTmFtZV0gPSBbXTsKICAgICAgdGhpcy5kaWFsb2dOYW1lID0gJyc7CiAgICB9LAogICAgY2xvc2VEYXRlRGlhbG9nOiBmdW5jdGlvbiBjbG9zZURhdGVEaWFsb2coKSB7CiAgICAgIHRoaXMuZGlhbG9nRGF0ZVZpc2libGUgPSBmYWxzZTsKICAgICAgdGhpcy5kaWFsb2dEYXRlUmFuZ2UgPSAnJzsKICAgICAgdGhpcy5jbG9zZURpYWxvZygpOwogICAgfSwKICAgIHdhcm5pbmc6IGZ1bmN0aW9uIHdhcm5pbmcobWVzc2FnZSkgewogICAgICB2YXIgdHlwZSA9IGFyZ3VtZW50cy5sZW5ndGggPiAxICYmIGFyZ3VtZW50c1sxXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzFdIDogJ3dhcm5pbmcnOwogICAgICB0aGlzLiRtZXNzYWdlKHsKICAgICAgICBzaG93Q2xvc2U6IHRydWUsCiAgICAgICAgbWVzc2FnZTogbWVzc2FnZSwKICAgICAgICB0eXBlOiB0eXBlCiAgICAgIH0pOwogICAgfSwKICAgIG9uRGVsZXRlOiBmdW5jdGlvbiBvbkRlbGV0ZShyb3cpIHsKICAgICAgdmFyIGluZGV4ID0gdGhpcy5zZWxlY3RlZEluZ3JlZGllbnRMaXN0LmZpbmRJbmRleChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgIHJldHVybiBpdGVtLnJlbGF0aW9uSWQgPT09IHJvdy5yZWxhdGlvbklkICYmIGl0ZW0ucHJpbWFyeUNsYXNzaWZpY2F0aW9uTmFtZSA9PT0gcm93LnByaW1hcnlDbGFzc2lmaWNhdGlvbk5hbWU7CiAgICAgIH0pOwogICAgICB0aGlzLnNlbGVjdGVkSW5ncmVkaWVudExpc3Quc3BsaWNlKGluZGV4LCAxKTsKICAgICAgdmFyIGxpc3QgPSB0aGlzLmxlZnRJbmdyZWRpZW50RGF0YUxpc3Q7CiAgICAgIHZhciBsZWZ0SXRlbSA9IGxpc3QuZmluZChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgIHJldHVybiBpdGVtLnJlbGF0aW9uSWQgPT09IHJvdy5yZWxhdGlvbklkICYmIGl0ZW0ucHJpbWFyeUNsYXNzaWZpY2F0aW9uTmFtZSA9PT0gcm93LnByaW1hcnlDbGFzc2lmaWNhdGlvbk5hbWU7CiAgICAgIH0pOwogICAgICBsZWZ0SXRlbS5zZWxlY3RlZCA9IGZhbHNlOwogICAgfSwKICAgIGdldEluZ3JlZGllbnRUcmVlOiBmdW5jdGlvbiBnZXRJbmdyZWRpZW50VHJlZSgpIHsKICAgICAgdmFyIF90aGlzMjEgPSB0aGlzOwoKICAgICAgb3JkZXJDb250ZW50Rm9yU2VsZWN0SW5ncmVkaWVudCh7CiAgICAgICAgb3JkZXJJZDogdGhpcy5vcmRlcklkLAogICAgICAgIGRlcHRJZDogdGhpcy5mb3JtRGF0YS5zY2hvb2xCcmFuY2hDb2RlLAogICAgICAgIHF1ZXJ5VHlwZTogMSwKICAgICAgICBpc1NlbGVjdGVkOiAwLAogICAgICAgIGRpc3RyaWN0Q29kZTogdGhpcy5mb3JtRGF0YS5kaXN0cmljdENvZGUgfHwgdGhpcy5kaXN0cmljdENvZGUKICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzKSB7CiAgICAgICAgX3RoaXMyMS5sZWZ0SW5ncmVkaWVudERhdGEgPSBfdGhpczIxLmZvbWF0VHJlZURhdGEocmVzLmRhdGEpOwogICAgICB9KTsKICAgIH0sCiAgICBmb21hdFRyZWVEYXRhOiBmdW5jdGlvbiBmb21hdFRyZWVEYXRhKG9yaWdpbkRhdGEpIHsKICAgICAgdmFyIF90aGlzMjIgPSB0aGlzOwoKICAgICAgdGhpcy5sZWZ0SW5ncmVkaWVudERhdGFMaXN0ID0gW107CiAgICAgIHZhciBkYXRhID0gW107CgogICAgICBmb3IgKHZhciBrZXkgaW4gb3JpZ2luRGF0YSkgewogICAgICAgIGRhdGEucHVzaCh7CiAgICAgICAgICBuYW1lOiBrZXksCiAgICAgICAgICBjaGlsZHJlbjogb3JpZ2luRGF0YVtrZXldLm1hcChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgICAgICByZXR1cm4gX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCBpdGVtKSwge30sIHsKICAgICAgICAgICAgICBzZWxlY3RlZDogZmFsc2UKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9KQogICAgICAgIH0pOwogICAgICB9CgogICAgICBkYXRhLm1hcChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgIHZhciBfdGhpczIyJGxlZnRJbmdyZWRpZW47CgogICAgICAgIChfdGhpczIyJGxlZnRJbmdyZWRpZW4gPSBfdGhpczIyLmxlZnRJbmdyZWRpZW50RGF0YUxpc3QpLnB1c2guYXBwbHkoX3RoaXMyMiRsZWZ0SW5ncmVkaWVuLCBfdG9Db25zdW1hYmxlQXJyYXkoaXRlbS5jaGlsZHJlbikpOwogICAgICB9KTsKICAgICAgdGhpcy5zaWRlQWN0aXZlID0gZGF0YVswXS5uYW1lOwogICAgICByZXR1cm4gZGF0YTsKICAgIH0sCiAgICBoYW5kbGVJY29uOiBmdW5jdGlvbiBoYW5kbGVJY29uKHR5cGUsIHJvdykgewogICAgICBpZiAodHlwZSA9PT0gJ21pbnVzJykgewogICAgICAgIGlmIChyb3cucGFja051bSA+IDEpIHsKICAgICAgICAgIC8vIHJvdy5wYWNrTnVtID0gK25ldyBEZWNpbWFsKCtyb3cucGFja051bSkuc3ViKG5ldyBEZWNpbWFsKDEpKTsKICAgICAgICAgIHRoaXMuJHNldChyb3csICdwYWNrTnVtJywgK25ldyBEZWNpbWFsKCtyb3cucGFja051bSkuc3ViKG5ldyBEZWNpbWFsKDEpKSk7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuJHNldChyb3csICdwYWNrTnVtJywgK25ldyBEZWNpbWFsKCtyb3cucGFja051bSkuYWRkKG5ldyBEZWNpbWFsKDEpKSk7IC8vIHJvdy5wYWNrTnVtID0gK25ldyBEZWNpbWFsKCtyb3cucGFja051bSkuYWRkKG5ldyBEZWNpbWFsKDEpKTsKICAgICAgfQoKICAgICAgY29uc29sZS5sb2coNTU1NTU1NTUsIHJvdy5wYWNrTnVtKTsKICAgIH0KICB9LAogIC8vIOeUn+WRveWRqOacnyAtIOWIm+W7uuWujOaIkO+8iOWPr+S7peiuv+mXruW9k+WJjXRoaXPlrp7kvovvvIkKICBjcmVhdGVkOiBmdW5jdGlvbiBjcmVhdGVkKCkgewogICAgdmFyIF90aGlzMjMgPSB0aGlzOwoKICAgIHZhciBvcGVyYVR5cGUgPSB0aGlzLiRyb3V0ZS5wYXJhbXMub3BlcmFUeXBlOwogICAgdmFyIG9yZGVySWQ7CgogICAgaWYgKG9wZXJhVHlwZSA9PT0gJ2NvcHknKSB7CiAgICAgIG9yZGVySWQgPSB0aGlzLiRyb3V0ZS5wYXJhbXMub3JkZXJJZDsKICAgICAgdGhpcy5vcGVyYVR5cGUgPSBvcGVyYVR5cGU7CiAgICB9IGVsc2UgewogICAgICBvcmRlcklkID0gdGhpcy4kcm91dGUucXVlcnkub3JkZXJJZDsKICAgICAgdGhpcy5vcGVyYVR5cGUgPSB0aGlzLiRyb3V0ZS5xdWVyeS5vcGVyYVR5cGU7CiAgICB9CgogICAgdGhpcy5vcmRlcklkID0gb3JkZXJJZDsKICAgIHRoaXMuYmFzZVRyZWVXaXRoUG93ZXJTY2hvb2woKS50aGVuKGZ1bmN0aW9uIChyZXMpIHsKICAgICAgLy8gbGV0IG9yZGVySWQgPSB0aGlzLiRyb3V0ZS5xdWVyeS5vcmRlcklkOwogICAgICAvLyB0aGlzLm9yZGVySWQgPSBvcmRlcklkOwogICAgICBpZiAob3JkZXJJZCkgewogICAgICAgIC8v6I635Y+W6K6i5Y2V5L+h5oGvCiAgICAgICAgX3RoaXMyMy5nZXRPcmRlckRldGFpbCgpLnRoZW4oZnVuY3Rpb24gKHJlcykgewogICAgICAgICAgX3RoaXMyMy5vcmRlclN0YXRpc3RpY3MoKTsKCiAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IF90aGlzMjMudGFicy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBfdGhpczIzLm9yZGVyQ29udGVudEZvclBhZ2UoX3RoaXMyMy50YWJzW2ldLm5hbWUpOwogICAgICAgICAgfSAvLyB0aGlzLiRyZWZzLmJUYWJsZTsKICAgICAgICAgIC8vIHRoaXMuJHJlZnMuYlRhYmxlWzBdICYmIHRoaXMuJHJlZnMuYlRhYmxlWzBdLmFqYXhHZXRUYWJsZURhdGFCeVBhZ2UoKTsKCiAgICAgICAgfSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgX3RoaXMyMy4kc2V0KF90aGlzMjMuZm9ybURhdGEsICdvcmRlclN0YXR1cycsICcxJyk7CiAgICAgIH0KICAgIH0pOwogICAgdGhpcy5nZXRDdXRNYXRjaFN0YW5kYXJkTGlzdCgpOwogIH0sCiAgLy8g55Sf5ZG95ZGo5pyfIC0g5oyC6L295a6M5oiQ77yI5Y+v5Lul6K6/6ZeuRE9N5YWD57Sg77yJCiAgbW91bnRlZDogZnVuY3Rpb24gbW91bnRlZCgpIHt9Cn07"},null]}