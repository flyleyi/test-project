{"remainingRequest":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/fuyueyi/Desktop/practice/mutilwap/src/pages/visitor-h5/views/my-visitor/components/ArrivalCompany.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/src/pages/visitor-h5/views/my-visitor/components/ArrivalCompany.vue","mtime":1646020538184},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBldmVudEJ1cyBmcm9tICdAL3BhZ2VzL3Zpc2l0b3ItaDUvcGx1Z2lucy9jb21tb24vZXZlbnRCdXMuanMnOwppbXBvcnQgdHJlZU5vZGUgZnJvbSAnLi9UcmVlTm9kZS52dWUnOwppbXBvcnQgeyBnZXRDb21wYW55TGlzdCB9IGZyb20gJ0AvcGFnZXMvdmlzaXRvci1oNS9hcGkvbXlWaXNpdG9yJzsKZXhwb3J0IGRlZmF1bHQgewogIGNvbXBvbmVudHM6IHsgdHJlZU5vZGUgfSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgY2FtcHVzT2JqOiB7fSwKICAgICAgY29tcGFueUluZm86IHt9LAogICAgICBjYW1wdXNMaXN0OiBbXSwKICAgICAgLy8gYWN0aXZlTGlzdDogW10sIC8v6K6+572u6buY6K6k6YCJ5Lit5YWl5Y+jCiAgICAgIC8vIGFjdGl2ZU5hbWVMaXN0OiBbXSwKICAgICAgYWN0aXZlOiAnJywKICAgICAgYWN0aXZlTmFtZTogJycsCiAgICAgIGNvbXBhbnlOYW1lOiAnJywKICAgICAgc2hvd0Rvb3JEaWFsb2c6IGZhbHNlCiAgICB9OwogIH0sCiAgbWV0aG9kczogewogICAgZ2V0Q29tcGFueUxpc3QoKSB7CiAgICAgIGdldENvbXBhbnlMaXN0KCkudGhlbihyZXMgPT4gewogICAgICAgIHRoaXMuY2FtcHVzTGlzdCA9IHJlcy5kYXRhOwogICAgICAgIHRoaXMuYWN0aXZlTGlzdCA9IHRoaXMuY2FtcHVzTGlzdC5tYXAoaXRlbSA9PiB7CiAgICAgICAgICByZXR1cm4gaXRlbS5kb29yTGlzdFswXS5pZDsKICAgICAgICB9KTsKICAgICAgICB0aGlzLmFjdGl2ZU5hbWVMaXN0ID0gdGhpcy5jYW1wdXNMaXN0Lm1hcChpdGVtID0+IHsKICAgICAgICAgIHJldHVybiBpdGVtLmRvb3JMaXN0WzBdLmRvb3I7CiAgICAgICAgfSk7CiAgICAgIH0pOwogICAgfSwKICAgIHNlbGVjdERvb3IoaXRlbSwgaW5kZXgpIHsKICAgICAgLy8gdGhpcy4kc2V0KHRoaXMuYWN0aXZlTGlzdCwgaW5kZXgsIGl0ZW0uaWQpOwogICAgICAvLyB0aGlzLiRzZXQodGhpcy5hY3RpdmVOYW1lTGlzdCwgaW5kZXgsIGl0ZW0uZG9vcik7CiAgICAgIHRoaXMuYWN0aXZlID0gaXRlbS5pZDsKICAgICAgdGhpcy5hY3RpdmVOYW1lID0gaXRlbS5kb29yOwoKICAgICAgZXZlbnRCdXMuJGVtaXQoCiAgICAgICAgJ3NldEFycml2YWxDb21wYW55JywKICAgICAgICB0aGlzLmNhbXB1c09iaiwKICAgICAgICB0aGlzLmNvbXBhbnlJbmZvLAogICAgICAgIHRoaXMuYWN0aXZlTmFtZSwKICAgICAgICB0aGlzLmNvbXBhbnlOYW1lLAogICAgICAgIHRoaXMuYWN0aXZlCiAgICAgICk7CiAgICAgIGV2ZW50QnVzLiRlbWl0KCdzZXRjdXJUeXBlJywgdGhpcy4kcm91dGUucXVlcnkudHlwZSk7CiAgICAgIHRoaXMuJHJvdXRlci5nbygtMSk7CiAgICB9LAogICAgc2V0Q29tcGFueShpdGVtLCBjYW1wdXNPYmosIGluZGV4KSB7CiAgICAgIHRoaXMuY29tcGFueUluZm8gPSBpdGVtOwogICAgICB0aGlzLmNhbXB1c09iaiA9IGNhbXB1c09iajsKICAgICAgaWYgKGl0ZW0uZ3JvdXBEZXB0RHRvTGlzdCAmJiBpdGVtLmdyb3VwRGVwdER0b0xpc3QubGVuZ3RoID4gMCkgewogICAgICAgIHRoaXMuJG5vdGlmeSgn6K+36YCJ5oup5pyA5ZCO5LiA57qn5Y2V5L2NJyk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGlmIChpdGVtLmxldmVsICE9IDIpIHsKICAgICAgICB0aGlzLmNvbXBhbnlOYW1lID0gaXRlbS5kZXB0TmFtZSB8fCBpdGVtLm5hbWU7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhpcy5jb21wYW55TmFtZSA9IHRoaXMuZ2V0Q29tcGFueU5hbWUoCiAgICAgICAgICBpdGVtLnBhcmVudElkLAogICAgICAgICAgY2FtcHVzT2JqLmdyb3VwRGVwdER0b0xpc3QKICAgICAgICApOwogICAgICB9CiAgICAgIHRoaXMuc2V0SW5mbyhpbmRleCk7CiAgICB9LAogICAgZ2V0Q29tcGFueU5hbWUoaWQsIGFycmF5KSB7CiAgICAgIGxldCBhcnIgPSBhcnJheS5maWx0ZXIoaXRlbSA9PiB7CiAgICAgICAgcmV0dXJuIGl0ZW0uZGVwdElkID09IGlkOwogICAgICB9KTsKICAgICAgcmV0dXJuIGFyclswXS5kZXB0TmFtZTsKICAgIH0sCgogICAgc2V0SW5mbyhpbmRleCkgewogICAgICBpZiAoT2JqZWN0LmtleXModGhpcy5jb21wYW55SW5mbykubGVuZ3RoID09IDApIHsKICAgICAgICB0aGlzLiRub3RpZnkoJ+ivt+mAieaLqeWIsOiuv+mDqOmXqO+8gScpOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICB0aGlzLnNob3dEb29yRGlhbG9nID0gdHJ1ZTsKICAgIH0sCiAgICBvbkNhbmNlbCgpIHsKICAgICAgdGhpcy5zaG93RG9vckRpYWxvZyA9IGZhbHNlOwogICAgfQogIH0sCiAgY3JlYXRlZCgpIHsKICAgIHRoaXMuZ2V0Q29tcGFueUxpc3QoKTsKICAgIHRoaXMuYWN0aXZlID0gdGhpcy4kcm91dGUucXVlcnkuZ3Vlc3REb29ySWQ7CiAgfQp9Owo="},{"version":3,"sources":["ArrivalCompany.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ArrivalCompany.vue","sourceRoot":"src/pages/visitor-h5/views/my-visitor/components","sourcesContent":["<template>\n  <div class=\"app-wrapper\">\n    <ul>\n      <li\n        class=\"campus-item\"\n        v-for=\"(campusObj, index) in campusList\"\n        :key=\"campusObj.id\"\n        @click.stop=\"setCompany(campusObj, campusObj, index)\"\n      >\n        <div class=\"sum-info\">\n          <div class=\"campus-name\">{{ campusObj.deptName }}</div>\n          <!--  <ul class=\"door-list\">\n            <li\n              v-for=\"item in campusObj.doorList\"\n              :key=\"item.id\"\n              :class=\"item.id == activeList[index] ? 'active' : ''\"\n              @click.stop=\"selectDoor(item, index)\"\n            >\n              {{ item.door }}\n            </li>\n          </ul> -->\n          <div class=\"address\">{{ campusObj.address }}</div>\n        </div>\n        <div class=\"detail-info\">\n          <tree-node\n            :initActive=\"$route.query.guestDeptId\"\n            :data=\"campusObj.groupDeptDtoList\"\n            @setCompany=\"setCompany($event, campusObj, index)\"\n          ></tree-node>\n        </div>\n      </li>\n    </ul>\n\n    <!-- <van-dialog\n      class=\"door-dialog\"\n      v-model=\"showDoorDialog\"\n      title=\"请选择访客到达门岗\"\n      :showConfirmButton=\"false\"\n      show-cancel-button\n      @cancel=\"onCancel\"\n    >\n     -->\n    <van-popup\n      :style=\"{ height: '40%' }\"\n      closeable\n      :close-on-click-overlay=\"false\"\n      v-model=\"showDoorDialog\"\n      round\n      position=\"bottom\"\n    >\n      <div class=\"door-wrapper\">\n        <div class=\"title\">请选择访客到达门岗</div>\n        <div>\n          {{ this.campusObj.deptName + ' ' + this.campusObj.address }}\n        </div>\n        <ul class=\"door-list\">\n          <li\n            v-for=\"item in this.campusObj.doorList\"\n            :key=\"item.id\"\n            :class=\"item.id == active ? 'active' : ''\"\n            @click.stop=\"selectDoor(item)\"\n          >\n            {{ item.door }}\n          </li>\n        </ul>\n      </div>\n    </van-popup>\n    <!-- </van-dialog> -->\n  </div>\n</template>\n\n<script>\nimport eventBus from '@/pages/visitor-h5/plugins/common/eventBus.js';\nimport treeNode from './TreeNode.vue';\nimport { getCompanyList } from '@/pages/visitor-h5/api/myVisitor';\nexport default {\n  components: { treeNode },\n  data() {\n    return {\n      campusObj: {},\n      companyInfo: {},\n      campusList: [],\n      // activeList: [], //设置默认选中入口\n      // activeNameList: [],\n      active: '',\n      activeName: '',\n      companyName: '',\n      showDoorDialog: false\n    };\n  },\n  methods: {\n    getCompanyList() {\n      getCompanyList().then(res => {\n        this.campusList = res.data;\n        this.activeList = this.campusList.map(item => {\n          return item.doorList[0].id;\n        });\n        this.activeNameList = this.campusList.map(item => {\n          return item.doorList[0].door;\n        });\n      });\n    },\n    selectDoor(item, index) {\n      // this.$set(this.activeList, index, item.id);\n      // this.$set(this.activeNameList, index, item.door);\n      this.active = item.id;\n      this.activeName = item.door;\n\n      eventBus.$emit(\n        'setArrivalCompany',\n        this.campusObj,\n        this.companyInfo,\n        this.activeName,\n        this.companyName,\n        this.active\n      );\n      eventBus.$emit('setcurType', this.$route.query.type);\n      this.$router.go(-1);\n    },\n    setCompany(item, campusObj, index) {\n      this.companyInfo = item;\n      this.campusObj = campusObj;\n      if (item.groupDeptDtoList && item.groupDeptDtoList.length > 0) {\n        this.$notify('请选择最后一级单位');\n        return;\n      }\n      if (item.level != 2) {\n        this.companyName = item.deptName || item.name;\n      } else {\n        this.companyName = this.getCompanyName(\n          item.parentId,\n          campusObj.groupDeptDtoList\n        );\n      }\n      this.setInfo(index);\n    },\n    getCompanyName(id, array) {\n      let arr = array.filter(item => {\n        return item.deptId == id;\n      });\n      return arr[0].deptName;\n    },\n\n    setInfo(index) {\n      if (Object.keys(this.companyInfo).length == 0) {\n        this.$notify('请选择到访部门！');\n        return;\n      }\n      this.showDoorDialog = true;\n    },\n    onCancel() {\n      this.showDoorDialog = false;\n    }\n  },\n  created() {\n    this.getCompanyList();\n    this.active = this.$route.query.guestDoorId;\n  }\n};\n</script>\n\n<style lang=\"less\" scoped>\n.app-wrapper {\n  padding: 15px 18px;\n}\n.campus-item {\n  margin-bottom: 15px;\n\n  .sum-info {\n    background: #ffffff;\n    box-shadow: 0px 1px 10px 0px rgba(94, 94, 94, 0.08);\n    padding: 12px;\n    .campus-name {\n      font-size: 17px;\n      font-family: PingFangSC-Medium, PingFang SC;\n      font-weight: 500;\n      color: rgba(0, 0, 0, 0.85);\n      line-height: 24px;\n      margin-bottom: 10px;\n      span {\n        font-size: 12px;\n      }\n    }\n  }\n  .detail-info {\n    background: #fbfbfc;\n  }\n}\n.door-list {\n  display: flex;\n  flex-wrap: wrap;\n  padding: 20px 0;\n  // margin-bottom: 11px;\n  li {\n    padding: 5px 14px;\n    margin-right: 12px;\n    margin-bottom: 10px;\n    border-radius: 2px;\n    border: 1px solid rgba(0, 0, 0, 0.65);\n    font-size: 12px;\n    font-family: PingFangSC-Regular, PingFang SC;\n    font-weight: 400;\n    color: rgba(0, 0, 0, 0.65);\n    &.active {\n      border: 1px solid transparent;\n      // border: none;\n      background: #3388ff;\n      color: #fff;\n    }\n  }\n}\n\n.door-wrapper {\n  padding: 20px;\n  .title {\n    margin-bottom: 20px;\n    text-align: center;\n  }\n}\n</style>\n"]}]}