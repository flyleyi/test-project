{"remainingRequest":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/src/pages/bonus-tool-admin/views/account/index.vue?vue&type=style&index=0&id=3f0587db&lang=less&scoped=true&","dependencies":[{"path":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/src/pages/bonus-tool-admin/views/account/index.vue","mtime":1627979214255},{"path":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/node_modules/less-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/node_modules/style-resources-loader/lib/index.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKL2RlZXAvIC5lbC10YWJsZSB0ZCB7CiAgcGFkZGluZzogNnB4IDA7Cn0KLmFwcC1jb250YWluZXIgewogIC5kaWFsb2ctY29udGVudCB7CiAgICAmIC9kZWVwLyB7CiAgICAgIC5pdGVtLWxhYmVsIHsKICAgICAgICBmb250LXNpemU6IDE0cHg7CiAgICAgICAgbGluZS1oZWlnaHQ6IDIwcHg7CiAgICAgICAgY29sb3I6IHJnYmEoMCwgMCwgMCwgMC44NSk7CiAgICAgIH0KICAgICAgLmVsLWlucHV0IC9kZWVwLyAuZWwtaW5wdXRfX2lubmVyIHsKICAgICAgICBtYXJnaW4tdG9wOiAxMnB4OwogICAgICAgIGhlaWdodDogMzZweDsKICAgICAgICBsaW5lLWhlaWdodDogMzZweDsKICAgICAgICBib3JkZXItY29sb3I6IHJnYmEoMCwgMCwgMCwgMC40NSk7CiAgICAgIH0KICAgICAgLmVycm9yLXRpcCB7CiAgICAgICAgbWFyZ2luLXRvcDogOHB4OwogICAgICAgIGhlaWdodDogMTdweDsKICAgICAgICBsaW5lLWhlaWdodDogMTdweDsKICAgICAgICBmb250LXNpemU6IDEycHg7CiAgICAgICAgY29sb3I6ICNmZjQ2MzU7CiAgICAgIH0KICAgICAgLm5leHQtY2hlY2tib3ggewogICAgICAgIG1hcmdpbi10b3A6IDIwcHg7CiAgICAgICAgL2RlZXAvIC5lbC1jaGVja2JveF9fbGFiZWwgewogICAgICAgICAgY29sb3I6IHJnYmEoMCwgMCwgMCwgMC42NSk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfQp9Cg=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuRA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/pages/bonus-tool-admin/views/account","sourcesContent":["<template>\n  <div class=\"app-container\">\n    <div class=\"common-title\">用户列表</div>\n    <div class=\"common-container\">\n      <!-- 头部 -->\n      <!-- 产品（史耀军）要求隐藏新增按钮，之后也不需要展示 -->\n      <!-- <div class=\"common-header\">\n        <div class=\"common-header-left\">\n          <el-button type=\"primary\" size=\"medium\" @click=\"onAddAccount\">\n            新增账号\n          </el-button>\n        </div>\n        <div class=\"common-header-right\"></div>\n      </div> -->\n      <c-table :headers=\"headers\" :data=\"tableData\" :border=\"true\">\n        <template v-slot:column|operator=\"{ row }\">\n          <el-button\n            size=\"small\"\n            type=\"blue\"\n            icon=\"custom-reset-icon\"\n            class=\"reset-btn\"\n            @click=\"onResetPwd(row)\"\n            >重置密码</el-button\n          >\n          <!-- 需求变更，要求隐藏删除按钮 -->\n          <!-- <el-button\n            size=\"small\"\n            type=\"red\"\n            icon=\"custom-delete-icon\"\n            class=\"delete-btn\"\n            @click=\"onDelAccount(row)\"\n            >删除账号</el-button\n          > -->\n        </template>\n      </c-table>\n    </div>\n    <el-dialog\n      title=\"提示\"\n      :visible.sync=\"addAccountDialog.show\"\n      :center=\"true\"\n      :close-on-click-modal=\"false\"\n      :close-on-press-escape=\"false\"\n      :show-close=\"false\"\n      width=\"456px\"\n    >\n      <div class=\"dialog-content\">\n        <div class=\"item-label\">学校名称</div>\n        <el-input v-model.trim=\"addAccountDialog.schoolName\"></el-input>\n        <div class=\"error-tip\">{{ addAccountDialog.errorTip }}</div>\n        <el-checkbox class=\"next-checkbox\" v-model=\"addAccountDialog.doNext\"\n          >继续新增下一个</el-checkbox\n        >\n      </div>\n      <span slot=\"footer\" class=\"dialog-footer\">\n        <el-button\n          :loading=\"addAccountDialog.loading\"\n          @click=\"addAccountDialog.show = false\"\n          >取 消</el-button\n        >\n        <el-button\n          :loading=\"addAccountDialog.loading\"\n          type=\"primary\"\n          @click=\"onSubmitAddAccount\"\n          >确 定</el-button\n        >\n      </span>\n    </el-dialog>\n  </div>\n</template>\n<script>\nimport CTable from '@/components/common/CTable';\nimport {\n  getUserList,\n  vailSchoolName,\n  addUser,\n  resetPassword,\n  deleteUser\n} from '../../api/user';\nimport {\n  MessageBox,\n  Form,\n  FormItem,\n  Input,\n  Checkbox,\n  Loading\n} from 'element-ui';\nexport default {\n  name: 'Account',\n  components: {\n    CTable,\n    [Form.name]: Form,\n    [FormItem.name]: FormItem,\n    [Input.name]: Input,\n    [Checkbox.name]: Checkbox\n  },\n  data() {\n    return {\n      //表头配置\n      headers: [\n        {\n          label: '序号',\n          type: 'index',\n          width: '100px'\n        },\n        {\n          label: '校方名称',\n          prop: 'schoolName'\n        },\n        {\n          label: '关联账号',\n          prop: 'username'\n        },\n        {\n          label: '创建时间',\n          prop: 'updateTime',\n          formatter: (r, c, v) =>\n            this.$util.dateConverter('yyyy-MM-dd hh:mm', v)\n        },\n        {\n          label: '操作',\n          colType: 'column',\n          slotName: 'operator'\n        }\n      ],\n      //表数据\n      tableData: [],\n      //新增弹窗\n      addAccountDialog: {\n        show: false,\n        schoolName: '',\n        doNext: false,\n        errorTip: '',\n        loading: false\n      }\n    };\n  },\n  created() {\n    this.ajaxGetUserList();\n  },\n  methods: {\n    /**\n     * 查询用户列表\n     */\n    ajaxGetUserList() {\n      let loading = Loading.service({\n        text: '正在查询用户列表，请稍后...',\n        target: '.app-container'\n      });\n      getUserList()\n        .then(({ data }) => {\n          this.tableData = data;\n        })\n        .finally(() => {\n          loading.close();\n        });\n    },\n    /**\n     * 验证学校名称是否已存在\n     * @param {String} schoolName 学校名称\n     */\n    ajaxVailSchoolName(schoolName) {\n      return vailSchoolName({ schoolName });\n    },\n    /**\n     * 新增账号\n     * @param {String} schoolName 学校名称\n     */\n    ajaxAddUser(schoolName) {\n      return addUser({ schoolName });\n    },\n    /**\n     * 重置账号密码\n     * @param {String} userId 用户id\n     */\n    ajaxResetPassword(userId) {\n      return resetPassword({ userId });\n    },\n    /**\n     * 重置账号密码\n     * @param {String} userId 用户id\n     */\n    ajaxDeleteUser(userId) {\n      return deleteUser({ userId });\n    },\n    /**\n     * 点击重置密码\n     * @param {Object} row table行数据\n     */\n    async onResetPwd(row) {\n      let loading;\n      try {\n        await MessageBox.confirm('确定重置该账号密码?', '提醒', {\n          confirmButtonText: '确定',\n          cancelButtonText: '取消',\n          center: true\n        });\n        loading = Loading.service({\n          text: '操作中，请稍后...',\n          target: '.app-container'\n        });\n        await this.ajaxResetPassword(row.userId);\n        this.$message.success(`重置账号${row.username}的密码成功`);\n        loading.close();\n      } catch (error) {\n        console.log(error);\n        loading && loading.close();\n      }\n    },\n    /**\n     * 点击删除账号\n     * @param {Object} row table行数据\n     */\n    async onDelAccount(row) {\n      let loading;\n      try {\n        await MessageBox.confirm('确定删除该账号?', '提醒', {\n          confirmButtonText: '确定',\n          cancelButtonText: '取消',\n          center: true\n        });\n        loading = Loading.service({\n          text: '操作中，请稍后...',\n          target: '.app-container'\n        });\n        await this.ajaxDeleteUser(row.userId);\n        this.$message.success(`删除账号${row.username}成功`);\n        loading.close();\n        this.ajaxGetUserList(); //重新获取账号列表\n      } catch (error) {\n        console.log(error);\n        loading && loading.close();\n      }\n    },\n    /**\n     * 点开新增账号按钮\n     */\n    onAddAccount() {\n      this.addAccountDialog.schoolName = '';\n      this.addAccountDialog.doNext = false;\n      this.addAccountDialog.errorTip = '';\n      this.addAccountDialog.show = true;\n    },\n    /**\n     * 点击确定新增账号\n     */\n    async onSubmitAddAccount() {\n      let { schoolName, doNext } = this.addAccountDialog;\n      if (!schoolName) {\n        this.addAccountDialog.errorTip = '学校名称不能为空！';\n        return;\n      }\n      try {\n        this.addAccountDialog.loading = true;\n        //验证填入的学校名是否已存在\n        let { data } = await this.ajaxVailSchoolName(schoolName);\n        if (!data) {\n          this.addAccountDialog.errorTip = '该学校名称已存在，请勿重复添加！';\n          this.addAccountDialog.loading = false;\n          return;\n        }\n        this.addAccountDialog.errorTip = ''; //置空error-tip\n        await this.ajaxAddUser(schoolName); //调用新增账号接口\n        this.addAccountDialog.loading = false;\n        this.addAccountDialog.schoolName = ''; //置空学校名称\n        this.$message.success('新增账号成功');\n        //未勾选继续新建下一个，则创建完成关闭窗口\n        if (!doNext) {\n          this.addAccountDialog.show = false;\n        }\n        this.ajaxGetUserList(); //刷新用户列表\n      } catch (error) {\n        console.error(error);\n        this.addAccountDialog.loading = false;\n      }\n    }\n  }\n};\n</script>\n<style lang=\"less\" scoped>\n/deep/ .el-table td {\n  padding: 6px 0;\n}\n.app-container {\n  .dialog-content {\n    & /deep/ {\n      .item-label {\n        font-size: 14px;\n        line-height: 20px;\n        color: rgba(0, 0, 0, 0.85);\n      }\n      .el-input /deep/ .el-input__inner {\n        margin-top: 12px;\n        height: 36px;\n        line-height: 36px;\n        border-color: rgba(0, 0, 0, 0.45);\n      }\n      .error-tip {\n        margin-top: 8px;\n        height: 17px;\n        line-height: 17px;\n        font-size: 12px;\n        color: #ff4635;\n      }\n      .next-checkbox {\n        margin-top: 20px;\n        /deep/ .el-checkbox__label {\n          color: rgba(0, 0, 0, 0.65);\n        }\n      }\n    }\n  }\n}\n</style>\n"]}]}