{"remainingRequest":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/src/pages/h5/views/sims/enrollFill/FamilyInfo.vue?vue&type=style&index=0&id=485c0ff4&lang=less&scoped=true&","dependencies":[{"path":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/src/pages/h5/views/sims/enrollFill/FamilyInfo.vue","mtime":1627979214309},{"path":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/node_modules/less-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/node_modules/style-resources-loader/lib/index.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKQGltcG9ydCAnLi9sZXNzL3NpbXMtZm9ybS5sZXNzJzsKLnRpdGxlIHsKICBmb250LXdlaWdodDogYm9sZDsKfQo="},{"version":3,"sources":["FamilyInfo.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkQA;AACA;AACA;AACA","file":"FamilyInfo.vue","sourceRoot":"src/pages/h5/views/sims/enrollFill","sourcesContent":["<template>\n  <div class=\"sims-app-container\">\n    <page-header :index=\"1\"></page-header>\n    <div class=\"sims-form-title\">\n      <span class=\"zh\">家庭信息</span>\n      <span class=\"en\">FAMILY INFORMATION</span>\n    </div>\n    <van-form class=\"sims-form\" ref=\"form\" label-align=\"right\">\n      <van-field\n        v-model=\"formData.postalAddress\"\n        readonly\n        clickable\n        name=\"area\"\n        label=\"通讯地址\"\n        placeholder=\"请选择\"\n        class=\"w-5em\"\n        @click=\"showPostalAddressPicker = true\"\n      >\n        <field-icon slot=\"right-icon\" icon=\"icon_location\" />\n      </van-field>\n      <van-popup v-model=\"showPostalAddressPicker\" position=\"bottom\">\n        <van-area\n          :value=\"formData.communicationArea\"\n          :area-list=\"areaList\"\n          item-height=\"0.8rem\"\n          @confirm=\"onConfirmPostalAddress\"\n          @cancel=\"showPostalAddressPicker = false\"\n        />\n      </van-popup>\n      <van-field\n        v-model=\"formData.communicationAddr\"\n        name=\"详细地址\"\n        label=\"详细地址\"\n        maxlength=\"50\"\n        placeholder=\"请输入\"\n        class=\"w-5em\"\n      />\n      <van-field name=\"radio\" label=\"是否离异\" class=\"w-5em\">\n        <template #input>\n          <van-radio-group v-model=\"formData.brokenHome\" direction=\"horizontal\">\n            <van-radio :name=\"true\">是</van-radio>\n            <van-radio :name=\"false\">否</van-radio>\n          </van-radio-group>\n        </template>\n      </van-field>\n      <c-select-picker\n        v-model=\"formData.familyIncode\"\n        label=\"家庭年收入\"\n        value-key=\"value\"\n        text-key=\"label\"\n        class=\"w-5em\"\n        :options=\"$D('JTNSR')\"\n      ></c-select-picker>\n      <div v-for=\"(item, index) in formData.stuFamilyModelList\" :key=\"index\">\n        <p class=\"sims-form-group-title\">{{ item.relationName }}</p>\n        <van-field\n          v-model=\"item.fullName\"\n          placeholder=\"请输入\"\n          label=\"姓名\"\n          maxlength=\"30\"\n          class=\"bg-blur w-5em\"\n        />\n        <van-field\n          v-model=\"item.telephone\"\n          label=\"联系电话\"\n          placeholder=\"请输入\"\n          maxlength=\"30\"\n          class=\"bg-blur w-5em\"\n        />\n        <c-select-picker\n          v-model=\"item.education\"\n          label=\"学历\"\n          value-key=\"value\"\n          text-key=\"label\"\n          class=\"bg-blur w-5em\"\n          @change=\"val => onSelectChange(item, 'educationName', val)\"\n          :options=\"$D('XLM')\"\n        ></c-select-picker>\n        <c-select-picker\n          v-model=\"item.employed\"\n          label=\"职业类别\"\n          value-key=\"value\"\n          text-key=\"label\"\n          class=\"bg-blur w-5em\"\n          @change=\"val => onSelectChange(item, 'employedName', val)\"\n          :options=\"$D('ZYLB')\"\n        ></c-select-picker>\n      </div>\n    </van-form>\n    <div class=\"sims-form-bottom\">\n      <van-button block plain type=\"info\" native-type=\"back\" @click=\"onBack\"\n        >上一步</van-button\n      >\n      <van-button block type=\"info\" native-type=\"submit\" @click=\"onSubmit\"\n        >保存并下一步</van-button\n      >\n    </div>\n  </div>\n</template>\n<script>\nimport {\n  Form,\n  Field,\n  Picker,\n  Popup,\n  DatetimePicker,\n  RadioGroup,\n  Radio,\n  Area,\n  Uploader,\n  Button\n} from 'vant';\nimport {\n  codeConverterName,\n  getAreaData\n} from '@/pages/sims/plugins/common/area';\nimport CSelectPicker from '@/pages/h5/components/common/CSelectPicker.vue';\nimport store from '../../../store/index';\nimport { Toast } from 'vant';\nimport mixins from './mixins';\nimport { saveOrUpdateEnrollFamilyH5 } from '@/pages/h5/api/sims/enrollFill';\nimport { Loading } from 'element-ui';\nimport PageHeader from '../components/pageHeader.vue';\nimport FieldIcon from '../components/FieldIcon.vue';\nexport default {\n  name: 'FamilyInfo',\n  mixins: [mixins],\n  components: {\n    [Form.name]: Form,\n    [Field.name]: Field,\n    [Picker.name]: Picker,\n    [Popup.name]: Popup,\n    [DatetimePicker.name]: DatetimePicker,\n    [RadioGroup.name]: RadioGroup,\n    [Radio.name]: Radio,\n    [Area.name]: Area,\n    [Uploader.name]: Uploader,\n    [Button.name]: Button,\n    CSelectPicker,\n    PageHeader,\n    FieldIcon\n  },\n  data() {\n    return {\n      areaList: getAreaData(), // 地址信息\n      columns: ['杭州', '宁波', '温州', '绍兴', '湖州', '嘉兴', '金华', '衢州'],\n      showPostalAddressPicker: false, // 通讯地址显隐\n      formData: {\n        postalAddress: '',\n        communicationProvince: '',\n        communicationCity: '',\n        communicationArea: '',\n        communicationAddr: '',\n        brokenHome: null,\n        familyIncode: '',\n        stuFamilyModelList: []\n      },\n      fatherInfo: {},\n      motherInfo: {},\n      guardianInfo: {}\n    };\n  },\n  watch: {\n    'pageData.enrollFamilyModel': {\n      handler(newVal) {\n        this.initData(newVal);\n      }\n    }\n  },\n  methods: {\n    // 回退\n    onBack() {\n      this.$router.replace({\n        path: '/sims/entrollFill/identityInfo',\n        query: this.$route.query\n      });\n    },\n    // 表单提交\n    onSubmit(vals) {\n      let loading = Toast.loading();\n      //保存身份信息\n      saveOrUpdateEnrollFamilyH5({\n        ...this.formData,\n        staffCode: this.$route.query.staffCode\n      })\n        .then(res => {\n          loading.close();\n          this.$router.replace({\n            path: '/sims/entrollFill/enrollInfo',\n            query: this.$route.query\n          });\n        })\n        .catch(e => {\n          loading.close();\n          Toast.fail(e.message);\n        });\n    },\n    /**\n     * 职业、学历选择切换\n     * @param {Object} item 监护人对象\n     * @param {String} key 要修改的key\n     * @param {Object} val 选中项\n     */\n    onSelectChange(item, key, val) {\n      item[key] = val.label;\n    },\n    /**\n     * 通讯地址\n     */\n    onConfirmPostalAddress(val) {\n      this.formData.communicationProvince = val[0].code;\n      this.formData.communicationCity = val[1].code;\n      this.formData.communicationArea = val[2].code;\n      this.formData.postalAddress = this.getAddress(\n        val[0].code,\n        val[1].code,\n        val[2].code\n      );\n      this.showPostalAddressPicker = false;\n    },\n    //初始化数据\n    initData(newVal) {\n      let {\n        communicationProvince,\n        communicationCity,\n        communicationArea\n      } = newVal;\n      Object.assign(this.formData, newVal);\n      //更新户籍地址\n      if (communicationProvince) {\n        this.formData.postalAddress = this.getAddress(\n          communicationProvince,\n          communicationCity,\n          communicationArea\n        );\n      }\n    },\n    /**\n     * 获取地址\n     */\n    getAddress(provinceCode, cityCode, countyCode) {\n      return [\n        codeConverterName(provinceCode),\n        codeConverterName(cityCode),\n        codeConverterName(countyCode)\n      ]\n        .filter(item => item)\n        .join('/');\n    },\n    // 长度校验\n    lengthPattern(str) {\n      if (!str) return true;\n      return /^.{2,20}$/.test(str);\n    }\n  }\n};\n</script>\n<style lang=\"less\" scoped>\n@import './less/sims-form.less';\n.title {\n  font-weight: bold;\n}\n</style>\n"]}]}