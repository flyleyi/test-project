{"remainingRequest":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/fuyueyi/Desktop/practice/mutilwap/src/pages/executive-serve/views/Home.vue?vue&type=style&index=0&id=edb9bd6e&lang=less&scoped=true&","dependencies":[{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/src/pages/executive-serve/views/Home.vue","mtime":1627979214295},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/less-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/style-resources-loader/lib/index.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoNCi5ob21lIHsNCiAgLnRyaWFuZ2xldGVzdCB7DQogICAgLnRyaWFuZ2xlKFQpOw0KICB9DQogIC5ib3JkZXIgew0KICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsNCiAgICB3aWR0aDogMTAwcHg7DQogICAgaGVpZ2h0OiAxMDBweDsNCiAgICAuYm9yZGVyKFIsICMwZjApOw0KICB9DQp9DQo="},{"version":3,"sources":["Home.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Home.vue","sourceRoot":"src/pages/executive-serve/views","sourcesContent":["<template>\r\n  <div class=\"home\"></div>\r\n</template>\r\n\r\n<script>\r\nimport { login, getAuth, getPlateList } from './../api/user';\r\nimport config from './../config';\r\nexport default {\r\n  name: 'Home',\r\n  data() {\r\n    return {\r\n      plateId: null\r\n    };\r\n  },\r\n  created() {\r\n    let staffCode = this.$route.query.staffCode;\r\n    this.plateId = this.$route.query.plateId || null;\r\n    if (this.plateId) {\r\n      this.getAuth();\r\n    } else {\r\n      let username;\r\n      if (config.NODE_ENV == 'production') {\r\n        username = staffCode;\r\n      } else {\r\n        username = staffCode ^ 1000000001;\r\n      }\r\n      login(username)\r\n        .then(res => {\r\n          this.getAuth();\r\n          // this.getPlateList()\r\n          //   .then(res => {\r\n          //     const data = res.data || [];\r\n          //     localStorage.setItem('plateList', JSON.stringify(data));\r\n          //     this.getAuth();\r\n          //   })\r\n          //   .catch(e => {\r\n          //     localStorage.setItem('plateList', []);\r\n          //   });\r\n        })\r\n        .catch(e => {\r\n          localStorage.setItem('userInfo', '');\r\n          console.log(e);\r\n          this.warning('暂未开通权限');\r\n        });\r\n    }\r\n\r\n    // localStorage.setItem('userInfo', JSON.stringify(userInfo));\r\n    // this.$router.replace({\r\n    //   path: '/fill'\r\n    // });\r\n  },\r\n  methods: {\r\n    getPlateList() {\r\n      return getPlateList();\r\n    },\r\n    getAuth() {\r\n      // let plateId = null;\r\n      // if (this.plateId) {\r\n      //   plateId = this.plateId;\r\n      // } else {\r\n      //   let plateList =\r\n      //     (localStorage.getItem('plateList') &&\r\n      //       JSON.parse(localStorage.getItem('plateList'))) ||\r\n      //     [];\r\n      //   plateId = (plateList[0] && plateList[0].id) || '';\r\n      // }\r\n      // localStorage.setItem('plateId', plateId);\r\n      getAuth().then(res => {\r\n        const { data } = res;\r\n        const { roles } = data;\r\n        localStorage.setItem('userInfo', JSON.stringify(data));\r\n        this.getDefaultPage();\r\n      });\r\n    },\r\n    getDefaultPage() {\r\n      const userInfo =\r\n        (localStorage.getItem('userInfo') &&\r\n          JSON.parse(localStorage.getItem('userInfo'))) ||\r\n        {};\r\n      const roles = userInfo.roles || [];\r\n      if (roles.includes('填报人')) {\r\n        this.$router.replace({\r\n          path: '/fill'\r\n        });\r\n      } else if (roles.includes('审核人')) {\r\n        this.$router.replace({\r\n          path: '/check'\r\n        });\r\n      } else if (roles.includes('处理人') || roles.includes('监督人')) {\r\n        this.$router.replace({\r\n          path: '/supervise'\r\n        });\r\n      }\r\n    },\r\n    warning(msg, type = 'warning') {\r\n      this.$message({\r\n        message: msg,\r\n        type: type,\r\n        showClose: true\r\n      });\r\n    }\r\n  }\r\n};\r\n</script>\r\n<style lang=\"less\" scoped>\r\n.home {\r\n  .triangletest {\r\n    .triangle(T);\r\n  }\r\n  .border {\r\n    position: relative;\r\n    width: 100px;\r\n    height: 100px;\r\n    .border(R, #0f0);\r\n  }\r\n}\r\n</style>\r\n"]}]}