{"remainingRequest":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/fuyueyi/Desktop/practice/mutilwap/src/pages/executive-serveh5/views/filler/QuitServe.vue?vue&type=style&index=0&id=2556dede&lang=less&scoped=true&","dependencies":[{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/src/pages/executive-serveh5/views/filler/QuitServe.vue","mtime":1627979214303},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/less-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/style-resources-loader/lib/index.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi5xdWl0LXdyYXBwZXIgewogIHBhZGRpbmctdG9wOiAwLjJyZW07Cn0KLnF1aXQtcmVhc29uIHsKICBwYWRkaW5nOiAwLjNyZW07CiAgYmFja2dyb3VuZDogI2ZmZjsKICAvZGVlcC8udmFuLWNlbGwgewogICAgcGFkZGluZzogMDsKICB9CiAgL2RlZXAvLnZhbi1maWVsZF9fY29udHJvbCB7CiAgICBoZWlnaHQ6IDMuMjZyZW07CiAgICBiYWNrZ3JvdW5kOiAjZjZmNmY2OwogICAgYm9yZGVyLXJhZGl1czogNHB4OwogICAgcGFkZGluZzogMC4ycmVtOwogICAgZm9udC1zaXplOiAwLjI4cmVtOwogICAgbGluZS1oZWlnaHQ6IDAuMzJyZW07CiAgfQp9Ci5idG4td3JhcHBlciB7CiAgcGFkZGluZzogMC4zcmVtOwp9Ci5zZXJ2ZS1idG4gewogIGRpc3BsYXk6IGlubGluZS1ibG9jazsKICB3aWR0aDogMTAwJTsKICBoZWlnaHQ6IDAuOTRyZW07CiAgYmFja2dyb3VuZDogI2ZmOTgwMDsKICBjb2xvcjogI2ZmZjsKICBsaW5lLWhlaWdodDogMC45NHJlbTsKICB0ZXh0LWFsaWduOiBjZW50ZXI7CiAgYm9yZGVyLXJhZGl1czogMC4xcmVtOwp9Ci5yYWRpby13cmFwcGVyIHsKICBiYWNrZ3JvdW5kOiAjZmZmOwogIHBhZGRpbmc6IDAgMC4zcmVtOwogIG1hcmdpbi1ib3R0b206IDAuMnJlbTsKICAvZGVlcC8udmFuLXJhZGlvIHsKICAgIGxpbmUtaGVpZ2h0OiAxcmVtOwogICAgaGVpZ2h0OiAxcmVtOwogIH0KfQoucmF0ZS13cmFwcGVyIHsKICBiYWNrZ3JvdW5kOiAjZmZmOwogIHBhZGRpbmc6IDAuM3JlbTsKICBtYXJnaW4tYm90dG9tOiAwLjJyZW07Cn0KLnNlcnZlLXJhdGUtaXRlbSB7CiAgcG9zaXRpb246IHJlbGF0aXZlOwogIHBhZGRpbmctbGVmdDogMnJlbTsKICBtYXJnaW4tdG9wOiAwLjFyZW07CiAgbWluLWhlaWdodDogMC40cmVtOwp9Ci5zZXJ2ZS1yYXRlLWl0ZW0tdGl0bGUgewogIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICB3aWR0aDogMnJlbTsKICB0ZXh0LWFsaWduOiByaWdodDsKICBsZWZ0OiAwcmVtOwogIGxpbmUtaGVpZ2h0OiAwLjQ0cmVtOwogIGNvbG9yOiAjMzAzMDMyOwp9Ci5zZXJ2ZS10YWcgewogIGJhY2tncm91bmQ6ICNmZmY7CiAgbWFyZ2luLXRvcDogMC4ycmVtOwogIHBhZGRpbmc6IDAuM3JlbTsKfQouc2VydmUtdGFnLWl0ZW0gewogIGRpc3BsYXk6IGlubGluZS1ibG9jazsKICBwYWRkaW5nOiAwLjFyZW0gMC4zcmVtOwogIGJvcmRlci1yYWRpdXM6IDAuM3JlbTsKICBiYWNrZ3JvdW5kOiAjZjZmNmY2OwogIG1hcmdpbjogMC4ycmVtIDAuMnJlbSAwIDA7CiAgY29sb3I6ICM3NTc1NzU7Cn0KLnNlcnZlLXRhZy1hY3RpdmUgewogIGJhY2tncm91bmQ6IHJnYmEoMjU1LCAxNTIsIDAsIDAuMTQpOwogIGNvbG9yOiAjZmY5ODAwOwp9Ci5idG4tZGlzYWJsZWQgewogIGJhY2tncm91bmQ6ICNkMGQwZDA7CiAgY3Vyc29yOiBub3QtYWxsb3dlZDsKfQo="},{"version":3,"sources":["QuitServe.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"QuitServe.vue","sourceRoot":"src/pages/executive-serveh5/views/filler","sourcesContent":["<template>\n  <div class=\"quit-wrapper\">\n    <div class=\"radio-wrapper\" v-if=\"type === 'exam'\">\n      <van-radio-group v-model=\"radio\">\n        <van-radio name=\"pass\">通过</van-radio>\n        <van-radio name=\"deny\">不通过</van-radio>\n        <van-radio name=\"delete\">直接删除</van-radio>\n      </van-radio-group>\n    </div>\n    <div class=\"rate-wrapper\" v-if=\"type === 'evaluate'\">\n      <div class=\"serve-rate-item\">\n        <div class=\"serve-rate-item-title\">\n          服务效率：\n        </div>\n        <div class=\"serve-rate-item-content\">\n          <van-rate\n            color=\"#ffd21e\"\n            @change=\"changeRate\"\n            v-model=\"serveEfficiency\"\n          />\n        </div>\n      </div>\n      <div class=\"serve-rate-item\">\n        <div class=\"serve-rate-item-title\">\n          服务满意度：\n        </div>\n        <div class=\"serve-rate-item-content\">\n          <van-rate\n            @change=\"changeRate\"\n            color=\"#ffd21e\"\n            v-model=\"serveSatisfied\"\n          />\n        </div>\n      </div>\n    </div>\n\n    <div\n      class=\"quit-reason\"\n      v-if=\"!(type == 'exam' && (radio == 'pass' || !radio))\"\n    >\n      <van-field\n        type=\"textarea\"\n        v-model=\"quitText\"\n        :maxlength=\"maxLength\"\n        oninput=\"getValue\"\n        :placeholder=\"placeholder\"\n      />\n    </div>\n    <div class=\"serve-tag\" v-if=\"type === 'evaluate'\">\n      <div class=\"serve-tag-title\">\n        添加标签\n      </div>\n      <div class=\"serve-tag-list\">\n        <span\n          v-for=\"(item, index) in tagList\"\n          class=\"serve-tag-item\"\n          :class=\"{ 'serve-tag-active': item.selected }\"\n          @click=\"clickTag(index)\"\n          :key=\"item.name\"\n        >\n          {{ item.name }}\n        </span>\n      </div>\n    </div>\n    <div class=\"btn-wrapper\">\n      <div\n        class=\"btn-one serve-btn\"\n        :class=\"{ 'btn-disabled': disableBtn }\"\n        @click=\"clickBtn\"\n      >\n        提交\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\n/**\n * @type quit 退出服务\n * @type delete 删除服务\n * @type revoke 撤销服务\n * @type evaluate 评价服务\n * @type addrecord 添加处理记录\n * @type exam 审核\n * @type deleteRecord 删除处理记录\n * @type back 退回服务\n */\n\nimport {\n  handleServe,\n  getServeDetail,\n  addRecord,\n  getHandlerList,\n  getServeStatus,\n  getRecordList,\n  getEvaluateList,\n  downloadFile,\n  deleteRecord\n} from './../../api/serve.js';\nexport default {\n  name: 'QuitServe',\n  data() {\n    return {\n      quitText: '',\n      type: '',\n      radio: '',\n      placeholder: '必填，请输入 6-100 字原因',\n      serveEfficiency: 0,\n      serveSatisfied: 0,\n      disableBtn: false,\n      recordId: null,\n      tagList: [\n        {\n          name: '闪电接单',\n          selected: false\n        },\n        {\n          name: '热心服务',\n          selected: false\n        },\n        {\n          name: '沟通能手',\n          selected: false\n        },\n        {\n          name: '资源大佬',\n          selected: false\n        }\n      ],\n      maxLength: 100\n    };\n  },\n  created() {\n    const { meta, query } = this.$route;\n    this.type = meta.type;\n    this.serveId = query.serveId || '';\n    console.log('serveId', this.serveId);\n    this.recordId = query.recordId || '';\n    if (this.type == 'addrecord') {\n      this.maxLength = 500;\n      if (meta.title == '添加回复') {\n        this.placeholder = '必填，请输入6-500字回复';\n      } else {\n        this.placeholder = '必填，请输入6-500字服务记录';\n      }\n    }\n    if (this.type == 'evaluate') {\n      this.maxLength = 500;\n    }\n    switch (this.type) {\n      case 'quit':\n        break;\n      case 'evaluate':\n        this.placeholder = '评语';\n        this.disableBtn = true;\n        break;\n    }\n  },\n  methods: {\n    clickTag(index) {\n      this.tagList[index].selected = !this.tagList[index].selected;\n    },\n    getValue(value) {\n      return value.slice(0, this.maxLength);\n    },\n    changeRate() {\n      if (this.serveEfficiency && this.serveSatisfied) {\n        this.disableBtn = false;\n      } else {\n        this.disableBtn = true;\n      }\n    },\n    clickBtn() {\n      if (this.disableBtn) {\n        return;\n      }\n      switch (this.type) {\n        case 'quit':\n          this.finishServe(3);\n          break;\n        case 'delete':\n          this.deleteServe();\n          break;\n        case 'revoke':\n          this.revokeServe();\n          break;\n        case 'evaluate':\n          this.evaluateServe();\n          break;\n        case 'addrecord':\n          this.addRecord();\n          break;\n        case 'exam':\n          this.verifyServe();\n          break;\n        case 'deleteRecord':\n          this.deleteRecord(1);\n          break;\n        case 'deleteReply':\n          this.deleteRecord(2);\n          break;\n        case 'back':\n          this.finishServe(2);\n          break;\n      }\n    },\n    deleteServe() {\n      let textPass = this.checkText();\n      if (!textPass) return;\n      let params = {\n        serveId: this.serveId,\n        processType: 6,\n        content: this.quitText.trim()\n      };\n      this.disableBtn = true;\n      handleServe(params)\n        .then(res => {\n          this.disableBtn = false;\n          this.$toast('删除成功');\n          this.$router.push({\n            path: '/supervise'\n          });\n        })\n        .catch(e => {\n          this.disableBtn = false;\n        });\n    },\n    revokeServe() {\n      let textPass = this.checkText();\n      if (!textPass) return;\n      let params = {\n        serveId: this.serveId,\n        processType: 5,\n        content: this.quitText.trim()\n      };\n      this.disableBtn = true;\n      handleServe(params)\n        .then(res => {\n          this.disableBtn = false;\n          this.$toast('撤销成功');\n          this.$router.push({\n            path: '/fill'\n          });\n        })\n        .catch(e => {\n          this.disableBtn = false;\n        });\n    },\n    verifyServe() {\n      if (this.radio !== 'pass') {\n        let textPass = this.checkText();\n        if (!textPass) return;\n      }\n      //审核服务\n      let params = {\n        serveId: this.serveId,\n        processType: 1,\n        content: this.quitText.trim(),\n        approveType: this.radio === 'pass' ? 1 : this.radio === 'deny' ? 2 : 3\n      };\n      this.disableBtn = true;\n      handleServe(params)\n        .then(res => {\n          this.$toast('审核成功');\n          this.$router.push({\n            path: '/check'\n          });\n          this.disableBtn = false;\n        })\n        .catch(e => {\n          this.disableBtn = false;\n        });\n    },\n    addRecord() {\n      let textPass;\n      if (this.$route.meta.title == '添加回复') {\n        textPass = this.checkText(6, 500, '请输入 6-500 字回复');\n      } else {\n        textPass = this.checkText(6, 500, '请输入 6-500 字服务记录');\n      }\n\n      if (!textPass) return;\n      let params = {\n        serveId: this.serveId,\n        content: this.quitText.trim(),\n        parentId: this.recordId || null\n      };\n      this.disableBtn = true;\n      addRecord(params)\n        .then(res => {\n          this.disableBtn = false;\n          if (this.$route.meta.title == '添加回复') {\n            this.$toast('回复服务记录成功');\n          } else {\n            this.$toast('添加服务记录成功');\n          }\n          this.$router.go(-1);\n        })\n        .catch(e => {\n          this.disableBtn = false;\n        });\n    },\n    deleteRecord(type) {\n      let textPass = this.checkText();\n      if (!textPass) return;\n      this.disableBtn = true;\n      deleteRecord({\n        id: this.recordId,\n        content: this.quitText.trim()\n      })\n        .then(res => {\n          this.disableBtn = false;\n          if (type == 2) {\n            this.$toast('删除回复成功');\n          } else {\n            this.$toast('删除服务记录成功');\n          }\n\n          this.$router.go(-1);\n        })\n        .catch(e => {\n          this.disableBtn = false;\n        });\n    },\n    finishServe(handleType) {\n      //处理类型(1提交完成服务2退出服务(非主处理人)3退回服务(主处理人))\n      let params = {\n        serveId: this.serveId,\n        processType: 3,\n        handleType: handleType,\n        content: this.quitText.trim()\n      };\n      if (handleType == 2 || handleType == 3) {\n        let textPass = this.checkText();\n        if (!textPass) return;\n      }\n      this.disableBtn = true;\n      handleServe(params)\n        .then(res => {\n          this.disableBtn = false;\n          console.log('res:', res);\n          if (handleType == 3) {\n            this.$toast('退回成功');\n          }\n          if (handleType == 2) {\n            this.$toast('退出成功');\n          }\n          this.$router.push({\n            path: '/handle'\n          });\n        })\n        .catch(e => {});\n    },\n    evaluateServe() {\n      let label = '',\n        selectTagnameList = [];\n      for (let i = 0; i < this.tagList.length; i++) {\n        if (this.tagList[i].selected) {\n          selectTagnameList.push(this.tagList[i].name);\n        }\n      }\n      if (!this.serveSatisfied || !this.serveEfficiency) {\n        this.$toast('请进行评分');\n        return;\n      }\n      if (\n        this.quitText.trim() &&\n        (this.quitText.trim() < 6 || this.quitText.trim() > 500)\n      ) {\n        this.$toast('请输入 6-500 字服务评价');\n        return;\n      }\n      //评价服务\n      let params = {\n        serveId: this.serveId,\n        processType: 4,\n        satisfiedScore: this.serveSatisfied,\n        finishScore: this.serveEfficiency,\n        evaluateLabel: selectTagnameList.join(','),\n        content: this.quitText.trim()\n      };\n      handleServe(params).then(res => {\n        this.$toast('评价成功');\n        this.$router.push({\n          path: '/fill'\n        });\n      });\n    },\n    checkText(min = 6, max = 100, text = '输入 6-100 字原因') {\n      if (\n        this.quitText.trim().length < min ||\n        this.quitText.trim().length > max\n      ) {\n        this.$toast(text);\n        return false;\n      }\n      return true;\n    }\n  }\n};\n</script>\n\n<style lang=\"less\" scoped>\n.quit-wrapper {\n  padding-top: 0.2rem;\n}\n.quit-reason {\n  padding: 0.3rem;\n  background: #fff;\n  /deep/.van-cell {\n    padding: 0;\n  }\n  /deep/.van-field__control {\n    height: 3.26rem;\n    background: #f6f6f6;\n    border-radius: 4px;\n    padding: 0.2rem;\n    font-size: 0.28rem;\n    line-height: 0.32rem;\n  }\n}\n.btn-wrapper {\n  padding: 0.3rem;\n}\n.serve-btn {\n  display: inline-block;\n  width: 100%;\n  height: 0.94rem;\n  background: #ff9800;\n  color: #fff;\n  line-height: 0.94rem;\n  text-align: center;\n  border-radius: 0.1rem;\n}\n.radio-wrapper {\n  background: #fff;\n  padding: 0 0.3rem;\n  margin-bottom: 0.2rem;\n  /deep/.van-radio {\n    line-height: 1rem;\n    height: 1rem;\n  }\n}\n.rate-wrapper {\n  background: #fff;\n  padding: 0.3rem;\n  margin-bottom: 0.2rem;\n}\n.serve-rate-item {\n  position: relative;\n  padding-left: 2rem;\n  margin-top: 0.1rem;\n  min-height: 0.4rem;\n}\n.serve-rate-item-title {\n  position: absolute;\n  width: 2rem;\n  text-align: right;\n  left: 0rem;\n  line-height: 0.44rem;\n  color: #303032;\n}\n.serve-tag {\n  background: #fff;\n  margin-top: 0.2rem;\n  padding: 0.3rem;\n}\n.serve-tag-item {\n  display: inline-block;\n  padding: 0.1rem 0.3rem;\n  border-radius: 0.3rem;\n  background: #f6f6f6;\n  margin: 0.2rem 0.2rem 0 0;\n  color: #757575;\n}\n.serve-tag-active {\n  background: rgba(255, 152, 0, 0.14);\n  color: #ff9800;\n}\n.btn-disabled {\n  background: #d0d0d0;\n  cursor: not-allowed;\n}\n</style>\n"]}]}