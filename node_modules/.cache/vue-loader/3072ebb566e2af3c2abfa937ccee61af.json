{"remainingRequest":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/fuyueyi/Desktop/practice/mutilwap/src/pages/visitor-h5/views/verify-visitor/components/ImageUpload.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/src/pages/visitor-h5/views/verify-visitor/components/ImageUpload.vue","mtime":1645178321204},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBscnogZnJvbSAnbHJ6JzsKaW1wb3J0IHsgZ2V0VXBsb2FkIH0gZnJvbSAnQC9wYWdlcy92aXNpdG9yLWg1L2FwaS9teVZpc2l0b3InOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ2ltYWdlLXVwbG9hZCcsCiAgcHJvcHM6IHsKICAgIGltYWdlU2hvd0xpc3Q6IHsKICAgICAgdHlwZTogQXJyYXksCiAgICAgIGRlZmF1bHQ6ICgpID0+IFtdCiAgICB9CiAgfSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgYWRkZWQ6IGZhbHNlCiAgICB9OwogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIGZpbGVMaXN0OiB7CiAgICAgIGdldDogZnVuY3Rpb24oKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuaW1hZ2VTaG93TGlzdCB8fCBbXTsKICAgICAgfSwKICAgICAgc2V0OiBmdW5jdGlvbigpIHt9CiAgICB9CiAgfSwKICBtZXRob2RzOiB7CiAgICBvblJlYWQoZmlsZSkgewogICAgICAvLyDkuIrkvKDlm77niYfliLDlm77niYfmnI3liqHlmagKICAgICAgdGhpcy5hZGRlZCA9IGZhbHNlOwogICAgICBpZiAodGhpcy5pbWFnZVNob3dMaXN0Lmxlbmd0aCA+PSA2KSB7CiAgICAgICAgcmV0dXJuIHRoaXMuJHRvYXN0KCfmnIDlpJrlj6rog73pgInmi6k25byg5Zu+54mHJyk7CiAgICAgIH0KICAgICAgaWYgKGZpbGUuZmlsZS5zaXplID4gMTA0ODU3NjAwKSB7CiAgICAgICAgcmV0dXJuIHRoaXMuJHRvYXN0KCflm77niYfpnIDlsI/kuo4xMDBN77yM6K+36YeN5paw5LiK5LygJyk7CiAgICAgIH0KICAgICAgY29uc3QgbG9hZGluZyA9IHRoaXMuJHRvYXN0LmxvYWRpbmcoewogICAgICAgIG1lc3NhZ2U6ICflvIDlp4vljovnvKnkuIrkvKAnLAogICAgICAgIG1hc2s6IHRydWUKICAgICAgfSk7CiAgICAgIGxyeihmaWxlLmZpbGUpCiAgICAgICAgLnRoZW4ocnN0ID0+IHsKICAgICAgICAgIGdldFVwbG9hZChyc3QuZm9ybURhdGEpCiAgICAgICAgICAgIC50aGVuKHJlcyA9PiB7CiAgICAgICAgICAgICAgaWYgKHJlcy5zdGF0dXMgPT0gMjAwKSB7CiAgICAgICAgICAgICAgICB0aGlzLmFkZGVkID0gdHJ1ZTsKICAgICAgICAgICAgICAgIHRoaXMuZmlsZUxpc3QucHVzaChyZXMuZGF0YSk7CiAgICAgICAgICAgICAgICB0aGlzLiRlbWl0KCdiYWNrVXJsRGF0YScsIHRoaXMuZmlsZUxpc3QpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSkKICAgICAgICAgICAgLmNhdGNoKGVycm9yID0+IHsKICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7CiAgICAgICAgICAgICAgdGhpcy4kdG9hc3QoJ+S4iuS8oOWksei0pScpOwogICAgICAgICAgICB9KQogICAgICAgICAgICAuZmluYWxseSgoKSA9PiB7CiAgICAgICAgICAgICAgbG9hZGluZy5jbGVhcigpOwogICAgICAgICAgICB9KTsKICAgICAgICB9KQogICAgICAgIC5jYXRjaCgoKSA9PiB7CiAgICAgICAgICBsb2FkaW5nLmNsZWFyKCk7CiAgICAgICAgICB0aGlzLiR0b2FzdCgn5Y6L57yp5aSx6LSlJyk7CiAgICAgICAgfSk7CiAgICB9LAogICAgZGVsSW1nKGluZGV4KSB7CiAgICAgIC8vIOWIoOmZpOaMh+WumuS4i+agh+eahOWbvueJh+WvueixoQogICAgICBpZiAoaXNOYU4oaW5kZXgpIHx8IGluZGV4ID49IHRoaXMuaW1hZ2VTaG93TGlzdC5sZW5ndGgpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KICAgICAgdGhpcy5maWxlTGlzdC5zcGxpY2UoaW5kZXgsIDEpOwogICAgICB0aGlzLiRlbWl0KCdiYWNrVXJsRGF0YScsIHRoaXMuZmlsZUxpc3QpOwogICAgfSwKICAgIHByZXZpZXdJbWcoZSwgaXRlbSkgewogICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgIC8vIHRoaXMuc2hvdyA9IHRydWU7CiAgICAgIHRoaXMuJGRkLmJpei51dGlsLnByZXZpZXdJbWFnZSh7CiAgICAgICAgdXJsczogW2l0ZW1dLCAvL+WbvueJh+WcsOWdgOWIl+ihqAogICAgICAgIGN1cnJlbnQ6IGl0ZW0sIC8v5b2T5YmN5pi+56S655qE5Zu+54mH6ZO+5o6lCiAgICAgICAgb25TdWNjZXNzOiBmdW5jdGlvbihyZXN1bHQpIHsKICAgICAgICAgIC8qKi8KICAgICAgICB9LAogICAgICAgIG9uRmFpbDogZnVuY3Rpb24oZXJyKSB7fQogICAgICB9KTsKICAgIH0KICB9Cn07Cg=="},{"version":3,"sources":["ImageUpload.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ImageUpload.vue","sourceRoot":"src/pages/visitor-h5/views/verify-visitor/components","sourcesContent":["<template>\n  <div class=\"upload\">\n    <div class=\"flex flex-w upload-list\">\n      <template v-for=\"(item, i) in fileList\">\n        <div class=\"upload-item\" :key=\"i\" v-if=\"i < 6\">\n          <img\n            :src=\"item\"\n            alt=\"图片\"\n            @click=\"previewImg($event, item)\"\n            class=\"van-uploader__preview-image\"\n          />\n          <div class=\"upload-close\" @click=\"delImg(i)\">\n            <img src=\"@/pages/visitor-h5/assets/images/my-visitor/delete.png\" />\n          </div>\n        </div>\n      </template>\n      <van-uploader\n        preview-image\n        :max-count=\"3\"\n        :accept=\"'image/*'\"\n        :after-read=\"onRead\"\n        v-if=\"imageShowList.length < 3\"\n      >\n        <img\n          src=\"@/pages/visitor-h5/assets/images/icon/pic_add4@2x.png\"\n          class=\"upload-add-image\"\n        />\n      </van-uploader>\n    </div>\n  </div>\n</template>\n<script>\nimport lrz from 'lrz';\nimport { getUpload } from '@/pages/visitor-h5/api/myVisitor';\nexport default {\n  name: 'image-upload',\n  props: {\n    imageShowList: {\n      type: Array,\n      default: () => []\n    }\n  },\n  data() {\n    return {\n      added: false\n    };\n  },\n  computed: {\n    fileList: {\n      get: function() {\n        return this.imageShowList || [];\n      },\n      set: function() {}\n    }\n  },\n  methods: {\n    onRead(file) {\n      // 上传图片到图片服务器\n      this.added = false;\n      if (this.imageShowList.length >= 6) {\n        return this.$toast('最多只能选择6张图片');\n      }\n      if (file.file.size > 104857600) {\n        return this.$toast('图片需小于100M，请重新上传');\n      }\n      const loading = this.$toast.loading({\n        message: '开始压缩上传',\n        mask: true\n      });\n      lrz(file.file)\n        .then(rst => {\n          getUpload(rst.formData)\n            .then(res => {\n              if (res.status == 200) {\n                this.added = true;\n                this.fileList.push(res.data);\n                this.$emit('backUrlData', this.fileList);\n              }\n            })\n            .catch(error => {\n              console.log(error);\n              this.$toast('上传失败');\n            })\n            .finally(() => {\n              loading.clear();\n            });\n        })\n        .catch(() => {\n          loading.clear();\n          this.$toast('压缩失败');\n        });\n    },\n    delImg(index) {\n      // 删除指定下标的图片对象\n      if (isNaN(index) || index >= this.imageShowList.length) {\n        return false;\n      }\n      this.fileList.splice(index, 1);\n      this.$emit('backUrlData', this.fileList);\n    },\n    previewImg(e, item) {\n      e.preventDefault();\n      // this.show = true;\n      this.$dd.biz.util.previewImage({\n        urls: [item], //图片地址列表\n        current: item, //当前显示的图片链接\n        onSuccess: function(result) {\n          /**/\n        },\n        onFail: function(err) {}\n      });\n    }\n  }\n};\n</script>\n\n<style lang=\"less\" scoped>\n.upload {\n  text-align: left;\n  .upload-title {\n    height: 20px;\n    font-size: 14px;\n    font-family: PingFang-SC-Medium, PingFang-SC;\n    font-weight: 500;\n    color: rgba(30, 30, 30, 1);\n    line-height: 20px;\n    margin: 0 0 10px 3px;\n  }\n  .upload-item {\n    width: calc((100% - 18px) / 3);\n    max-width: 105px;\n    height: 108px;\n    margin: 0 3px 6px;\n    position: relative;\n  }\n  .upload-close {\n    position: absolute;\n    top: -8px;\n    right: -8px;\n    width: 18px;\n    height: 18px;\n    // background: rgba(15, 15, 15, 0.36);\n    text-align: center;\n    line-height: 18px;\n    img {\n      width: 16px;\n      height: 16px;\n    }\n  }\n  .upload-add-image {\n    width: 108px;\n    height: 108px;\n  }\n  /deep/.van-uploader {\n    width: 108px;\n    height: 108px;\n    margin: 0 0 6px 3px;\n  }\n  /deep/.van-uploader__input {\n    width: 108px;\n    height: 108px;\n  }\n  /deep/.van-uploader__input-wrapper {\n    width: 108px;\n    height: 108px;\n  }\n  /deep/.van-uploader__preview-image {\n    width: 100%;\n    height: 108px;\n    border-radius: 0 !important;\n  }\n}\n.upload-list {\n  flex-wrap: wrap;\n}\n</style>\n"]}]}