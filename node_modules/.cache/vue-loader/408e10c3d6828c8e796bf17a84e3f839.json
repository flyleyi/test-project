{"remainingRequest":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/fuyueyi/Desktop/practice/mutilwap/src/pages/charity-foundation/views/student/components/StudyEmployment/index.vue?vue&type=style&index=0&id=6f70b3e7&lang=less&scoped=true&","dependencies":[{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/src/pages/charity-foundation/views/student/components/StudyEmployment/index.vue","mtime":1627979214292},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/less-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/style-resources-loader/lib/index.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi5TdHVkeUVtcGxveW1lbnRCb3ggewogIG1pbi1oZWlnaHQ6IDIwMHB4OwogIC5zdHVkeUJveCwKICAuZW1wbG95bWVudEJveCB7CiAgICBkaXNwbGF5OiBmbGV4OwogICAgPiAuSW5mb2JveCB7CiAgICAgIHdpZHRoOiAxMiU7CiAgICAgIGhlaWdodDogNDBweDsKICAgICAgZGlzcGxheTogZmxleDsKICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7CiAgICAgIGJvcmRlcjogMXB4IHNvbGlkICMwMDA7CiAgICAgIG1hcmdpbi1ib3R0b206IC0xcHg7CiAgICAgIG1hcmdpbi1yaWdodDogLTFweDsKICAgICAgLmxhYmVsQW50SW5wdXQgewogICAgICAgIHBhZGRpbmc6IDAgMTBweDsKICAgICAgICAvZGVlcC8uZWwtaW5wdXRfX2lubmVyIHsKICAgICAgICAgIGhlaWdodDogMzBweDsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9CiAgLmFjaGlldmVtZW50Qm94IHsKICAgIG1hcmdpbi10b3A6IDIwcHg7CiAgICAuYWNoaWV2ZW1lbnRUaXAgewogICAgICBmb250LXNpemU6IDE2cHg7CiAgICAgIGZvbnQtd2VpZ2h0OiA5MDA7CiAgICB9CiAgICAuYnRuIHsKICAgICAgZGlzcGxheTogZmxleDsKICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7CiAgICAgIG1hcmdpbi10b3A6IDIwcHg7CiAgICAgIHBhZGRpbmctdG9wOiAyMHB4OwogICAgICBib3JkZXItdG9wOiAxcHggc29saWQgI2ViZWJlYjsKICAgIH0KICAgIC50YWJsZUJ0biB7CiAgICAgIG1hcmdpbi10b3A6IDIwcHg7CiAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOwogICAgICAuYXZhdGFyLXVwbG9hZGVyIHsKICAgICAgICBwYWRkaW5nOiAwIDEwcHg7CiAgICAgIH0KICAgIH0KICB9CiAgLmFjaGlldmVtZW50VGFibGUgewogICAgbWFyZ2luLXRvcDogMjBweDsKICAgIC50YWJsZUxhYmVsIHsKICAgICAgb3ZlcmZsb3c6IGhpZGRlbjsKICAgICAgd2hpdGUtc3BhY2U6IG5vd3JhcDsKICAgICAgdGV4dC1vdmVyZmxvdzogZWxsaXBzaXM7CiAgICB9CiAgICAuaG9ub3IgewogICAgICBwIHsKICAgICAgICBjb2xvcjogIzQwOWVmZjsKICAgICAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICAgIH0KICAgIH0KICAgIC5ob25vci5pbWdib3ggewogICAgICBwb3NpdGlvbjogcmVsYXRpdmU7CiAgICAgIHdpZHRoOiA2MHB4OwogICAgICBoZWlnaHQ6IDYwcHg7CiAgICAgIGltZyB7CiAgICAgICAgd2lkdGg6IDEwMCU7CiAgICAgICAgaGVpZ2h0OiAxMDAlOwogICAgICAgIGN1cnNvcjogcG9pbnRlcjsKICAgICAgfQogICAgICBzcGFuIHsKICAgICAgICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgICAgICAgdG9wOiAwOwogICAgICAgIHJpZ2h0OiAwOwogICAgICAgIHotaW5kZXg6IDI7CiAgICAgICAgd2lkdGg6IDI4cHg7CiAgICAgICAgaGVpZ2h0OiAyOHB4OwogICAgICAgIGJhY2tncm91bmQ6IHJnYmEoMCwgMCwgMCwgMC41KTsKICAgICAgICBib3JkZXItYm90dG9tLWxlZnQtcmFkaXVzOiAyOHB4OwogICAgICAgIGJvcmRlci10b3AtbGVmdC1yYWRpdXM6IDBweDsKICAgICAgICBkaXNwbGF5OiBmbGV4OwogICAgICAgIC8vIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7CiAgICAgICAgY29sb3I6ICNmZmY7CiAgICAgIH0KICAgIH0KICB9Cn0K"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAotBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/pages/charity-foundation/views/student/components/StudyEmployment","sourcesContent":["<template>\n  <div class=\"StudyEmploymentBox\" v-loading=\"loading\">\n    <div class=\"studyBox\" v-if=\"studentData.studentStatus === '0'\">\n      <div class=\"Infobox\">在读学校</div>\n      <div class=\"Infobox\">\n        <div class=\"labelAntInput\">\n          <el-input\n            v-show=\"isTableEdit\"\n            v-model.trim=\"StudyEmployment.currentSchool\"\n          >\n          </el-input>\n          <p v-show=\"!isTableEdit\">\n            {{ StudyEmployment.currentSchool || '--' }}\n          </p>\n        </div>\n      </div>\n      <div class=\"Infobox\">在读年级</div>\n      <div class=\"Infobox\" :style=\"{ width: '18%' }\">\n        <div class=\"labelAntInput\">\n          <el-select\n            v-show=\"isTableEdit\"\n            v-model.trim=\"StudyEmployment.currentGradeValue\"\n            placeholder=\"选择年级\"\n          >\n            <el-option\n              v-for=\"(item, index) in GradeList\"\n              :key=\"index\"\n              :label=\"item.label\"\n              :value=\"item.value\"\n            ></el-option>\n          </el-select>\n          <p v-show=\"!isTableEdit\">\n            {{ StudyEmployment.currentGrade || '--' }}\n          </p>\n        </div>\n      </div>\n      <div class=\"Infobox\">班级名称</div>\n      <div class=\"Infobox\">\n        <div class=\"labelAntInput\">\n          <el-input v-show=\"isTableEdit\" v-model=\"StudyEmployment.currentClass\">\n          </el-input>\n          <p v-show=\"!isTableEdit\">\n            {{ StudyEmployment.currentClass || '--' }}\n          </p>\n        </div>\n      </div>\n      <div class=\"Infobox\">班主任姓名</div>\n      <div class=\"Infobox\">\n        <div class=\"labelAntInput\">\n          <el-input\n            v-show=\"isTableEdit\"\n            v-model.trim=\"StudyEmployment.teacherName\"\n          >\n          </el-input>\n          <p v-show=\"!isTableEdit\">{{ StudyEmployment.teacherName || '--' }}</p>\n        </div>\n      </div>\n      <div class=\"Infobox\">班主任联系方式</div>\n      <div class=\"Infobox\">\n        <div class=\"labelAntInput\">\n          <el-input\n            v-show=\"isTableEdit\"\n            v-model.trim=\"StudyEmployment.teacherIphone\"\n          >\n          </el-input>\n          <p v-show=\"!isTableEdit\">\n            {{ StudyEmployment.teacherIphone || '--' }}\n          </p>\n        </div>\n      </div>\n    </div>\n    <div class=\"employmentBox\" v-if=\"studentData.studentStatus === '1'\">\n      <div class=\"Infobox\">工作单位</div>\n      <div class=\"Infobox\">\n        <div class=\"labelAntInput\">\n          <el-input v-show=\"isTableEdit\" v-model.trim=\"workEmployment.workUnit\">\n          </el-input>\n          <p v-show=\"!isTableEdit\">{{ workEmployment.workUnit || '--' }}</p>\n        </div>\n      </div>\n      <div class=\"Infobox\">职务</div>\n      <div class=\"Infobox\">\n        <div class=\"labelAntInput\">\n          <el-input v-show=\"isTableEdit\" v-model.trim=\"workEmployment.post\">\n          </el-input>\n          <p v-show=\"!isTableEdit\">{{ workEmployment.post || '--' }}</p>\n        </div>\n      </div>\n    </div>\n    <div class=\"achievementBox\">\n      <p\n        class=\"achievementTip\"\n        v-if=\"\n          employMentData &&\n            Array.isArray(employMentData.studentHistoryAchievementList) &&\n            employMentData.studentHistoryAchievementList.length > 0\n        \"\n      >\n        历年成绩:\n      </p>\n      <div\n        class=\"achievementTable\"\n        v-if=\"\n          employMentData &&\n            Array.isArray(employMentData.studentHistoryAchievementList) &&\n            employMentData.studentHistoryAchievementList.length > 0\n        \"\n      >\n        <el-table\n          ref=\"multipleTable\"\n          :data=\"\n            employMentData ? employMentData.studentHistoryAchievementList : []\n          \"\n          tooltip-effect=\"dark\"\n          style=\"width: 100%\"\n          border\n        >\n          <el-table-column width=\"140\" label=\"学期\" prop=\"semester\">\n            <template slot-scope=\"scope\">\n              <div>\n                <el-input\n                  v-show=\"isTableEdit\"\n                  v-model.trim=\"scope.row.semester\"\n                >\n                </el-input>\n                <p v-show=\"!isTableEdit\" class=\"tableLabel\">\n                  {{ scope.row.semester ? scope.row.semester : '--' }}\n                </p>\n              </div>\n            </template>\n          </el-table-column>\n          <!-- 科目动态表 -->\n          <el-table-column\n            width=\"70\"\n            v-for=\"(item, index) in tableHeader\"\n            :key=\"index\"\n            :label=\"item.name\"\n            :prop=\"item.type\"\n          >\n            <template slot-scope=\"scope\">\n              <div>\n                <el-input\n                  v-show=\"isTableEdit\"\n                  v-model.trim=\"tableData[scope.$index][item.type]\"\n                  @keyup.native=\"\n                    proving(\n                      tableData[scope.$index][item.type],\n                      tableData[scope.$index],\n                      item.type\n                    )\n                  \"\n                >\n                </el-input>\n                <p v-show=\"!isTableEdit\">\n                  {{\n                    tableData[scope.$index] &&\n                    (Number(tableData[scope.$index][item.type]) > 0 ||\n                      tableData[scope.$index][item.type] == 0)\n                      ? tableData[scope.$index][item.type]\n                      : '--'\n                  }}\n                </p>\n              </div>\n            </template>\n          </el-table-column>\n          <el-table-column prop=\"totalScore\" label=\"总分\" show-overflow-tooltip>\n            <template slot-scope=\"scope\">\n              <div>\n                <p class=\"tableLabel\">\n                  {{ scope.row | total }}\n                </p>\n              </div>\n            </template>\n          </el-table-column>\n          <el-table-column\n            prop=\"classRanking\"\n            label=\"班级排名\"\n            show-overflow-tooltip\n          >\n            <template slot-scope=\"scope\">\n              <div>\n                <el-input\n                  v-show=\"isTableEdit\"\n                  v-model.trim=\"scope.row.classRanking\"\n                  @keyup.native=\"\n                    provingNumber(\n                      tableData[scope.$index].classRanking,\n                      tableData[scope.$index],\n                      'classRanking'\n                    )\n                  \"\n                >\n                </el-input>\n                <p v-show=\"!isTableEdit\" class=\"tableLabel\">\n                  {{ scope.row.classRanking ? scope.row.classRanking : '--' }}\n                </p>\n              </div>\n            </template>\n          </el-table-column>\n          <el-table-column\n            prop=\"gradeRanking\"\n            label=\"年级排名\"\n            show-overflow-tooltip\n          >\n            <template slot-scope=\"scope\">\n              <div>\n                <el-input\n                  v-show=\"isTableEdit\"\n                  v-model.trim=\"scope.row.gradeRanking\"\n                  @keyup.native=\"\n                    provingNumber(\n                      tableData[scope.$index].gradeRanking,\n                      tableData[scope.$index],\n                      'gradeRanking'\n                    )\n                  \"\n                >\n                </el-input>\n                <p v-show=\"!isTableEdit\" class=\"tableLabel\">\n                  {{ scope.row.gradeRanking ? scope.row.gradeRanking : '--' }}\n                </p>\n              </div>\n            </template>\n          </el-table-column>\n          <el-table-column label=\"所获荣誉\">\n            <template slot-scope=\"scope\">\n              <div\n                class=\"honor\"\n                v-if=\"\n                  !Array.isArray(scope.row.honor) || scope.row.honor.length <= 0\n                \"\n              >\n                <!-- <el-upload\n                  class=\"avatar-uploader\"\n                  action=\"\"\n                  :show-file-list=\"false\"\n                  :multiple=\"false\"\n                  :before-upload=\"beforeAvatarUpload\"\n                  :http-request=\"\n                    file => {\n                      uploadHonor(file, scope.row);\n                    }\n                  \"\n                  accept=\".jpg,.jpeg,.png,.bmp,.gif,.JPG,.JPEG,.PBG,.BMP,.GIF\"\n                >\n                  <p>协议文件</p>\n                </el-upload> -->\n                <p @click=\"showPreview(scope.row, scope.$index)\">上传附件</p>\n              </div>\n              <div class=\"honor imgbox\" v-else>\n                <img\n                  :src=\"scope.row.honor[0]\"\n                  @click=\"showPreview(scope.row, scope.$index)\"\n                />\n                <span v-if=\"scope.row.honor.length > 1\">{{\n                  scope.row.honor.length\n                }}</span>\n              </div>\n            </template>\n          </el-table-column>\n          <el-table-column\n            prop=\"teacherComment\"\n            label=\"教师评语\"\n            width=\"200\"\n            show-overflow-tooltip\n          >\n            <template slot-scope=\"scope\">\n              <div>\n                <el-input\n                  v-show=\"isTableEdit\"\n                  v-model.trim=\"scope.row.teacherComment\"\n                  maxlength=\"300\"\n                >\n                </el-input>\n                <p v-show=\"!isTableEdit\" class=\"tableLabel\">\n                  {{ scope.row.teacherComment }}\n                </p>\n              </div>\n            </template>\n          </el-table-column>\n        </el-table>\n      </div>\n      <div class=\"tableBtn\">\n        <el-button\n          type=\"primary\"\n          size=\"small\"\n          :disabled=\"isTableEdit\"\n          @click=\"tableEdit\"\n          >编辑</el-button\n        >\n        <el-button\n          type=\"primary\"\n          size=\"small\"\n          :disabled=\"!isTableEdit\"\n          @click=\"cancel\"\n          >取消</el-button\n        >\n        <el-button type=\"primary\" size=\"small\" @click=\"preservation\"\n          >保存</el-button\n        >\n        <el-upload\n          :disabled=\"!employMentData\"\n          class=\"avatar-uploader\"\n          action=\"\"\n          :show-file-list=\"false\"\n          :multiple=\"false\"\n          :http-request=\"ajaxUploadSingle\"\n          :before-upload=\"beforeAvatarUpload\"\n          accept=\".xls,.xlsx.XLS,.XLSX\"\n        >\n          <el-button type=\"primary\" size=\"small\" :disabled=\"!employMentData\"\n            >导入</el-button\n          >\n        </el-upload>\n        <el-button\n          type=\"primary\"\n          size=\"small\"\n          :disabled=\"\n            !employMentData ||\n              !Array.isArray(employMentData.studentHistoryAchievementList) ||\n              employMentData.studentHistoryAchievementList.length <= 0\n          \"\n          @click=\"exportAchievement\"\n          >导出</el-button\n        >\n        <el-button type=\"primary\" size=\"small\" @click=\"downloadTemplate\"\n          >下载导入模板</el-button\n        >\n        <el-button type=\"primary\" size=\"small\" @click=\"goBack\">返回</el-button>\n      </div>\n    </div>\n    <preview-image ref=\"PerviewImg\" @closed=\"closed\"></preview-image>\n  </div>\n</template>\n\n<script>\nimport axios from '@/plugins/axios';\nimport {\n  Card,\n  Button,\n  Upload,\n  Table,\n  TableColumn,\n  Input,\n  Select,\n  Option\n} from 'element-ui';\nimport PreviewImage from '../PreviewImage/index';\nimport {\n  getStudyDeatil,\n  exportStudentTemplate,\n  exportStudentScore,\n  updateOrAddSudentScore,\n  getSchoolType,\n  importStudentScore\n} from '@/pages/charity-foundation/api/sutdent/index';\nimport { ajaxUploadSingle } from '@/pages/charity-foundation/api/file/index';\nlet VUE;\nexport default {\n  name: 'StudyEmployment',\n  components: {\n    [Card.name]: Card,\n    [Button.name]: Button,\n    [Upload.name]: Upload,\n    [Table.name]: Table,\n    [TableColumn.name]: TableColumn,\n    [Input.name]: Input,\n    [Select.name]: Select,\n    [Option.name]: Option,\n    PreviewImage\n  },\n  props: {\n    studentData: {\n      type: Object,\n      default: () => ({})\n    }\n  },\n  data() {\n    return {\n      loading: false,\n      type: 1,\n      isTableEdit: false,\n      StudyEmployment: {\n        currentSchool: '', // 就读学校\n        currentGrade: '', // 就读年级\n        currentClass: '', // 班级名称\n        teacherName: '', // 班主任名称\n        teacherIphone: '', // 班主任联系方式\n        currentGradeValue: '' //选中的年级\n      },\n      workEmployment: {\n        workUnit: '', // 工作单位\n        post: '' // 职务\n      },\n      GradeList: [], // 年级列表\n      employMentData: {}, //学习就业数据\n      tableHeader: [\n        {\n          name: '语文',\n          type: 'chinese'\n        },\n        {\n          name: '数学',\n          type: 'mathematics'\n        },\n        {\n          name: '英语',\n          type: 'foreignLanguages'\n        },\n        {\n          name: '科学',\n          type: 'science'\n        },\n        {\n          name: '社会',\n          type: 'sociology'\n        },\n        {\n          name: '物理',\n          type: 'physics'\n        },\n        {\n          name: '化学',\n          type: 'chemistry'\n        },\n        {\n          name: '生物',\n          type: 'biology'\n        },\n        {\n          name: '政治',\n          type: 'politics'\n        },\n        {\n          name: '历史',\n          type: 'history'\n        },\n        {\n          name: '地理',\n          type: 'geography'\n        },\n        {\n          name: '技术',\n          type: 'technology'\n        }\n      ], // 动态学科表头\n      tableData: [] // 表格数据\n    };\n  },\n  beforeCreate() {\n    VUE = this;\n  },\n  filters: {\n    total(val) {\n      let total = 0;\n      VUE.tableHeader.forEach(item => {\n        total += Number(val[item.type]);\n      });\n      // VUE.$set(val, 'totalScore', total.toFixed(2));\n      // return total.toFixed(2);\n      VUE.$set(val, 'totalScore', Math.round(total.toFixed(2) * 100) / 100);\n      return Math.round(total.toFixed(2) * 100) / 100;\n    }\n  },\n  mounted() {\n    this.initData();\n  },\n  methods: {\n    initData() {\n      this.loading = true;\n      getStudyDeatil({ studentBaseId: this.studentData.id }).then(res => {\n        this.employMentData = res.data;\n        this.StudyEmployment.currentSchool = res.data ? res.data.school : '';\n        this.StudyEmployment.currentGradeValue = res.data ? res.data.grade : '';\n        this.StudyEmployment.currentClass = res.data ? res.data.className : '';\n        this.StudyEmployment.teacherName = res.data ? res.data.headmaster : '';\n        this.StudyEmployment.teacherIphone = res.data ? res.data.phone : '';\n        this.workEmployment.workUnit = res.data ? res.data.workAddress : '';\n        this.workEmployment.post = res.data ? res.data.position : '';\n        this.tableData = res.data ? res.data.studentHistoryAchievementList : [];\n        // this.employMentData['studentHistoryAchievementList'] = this\n        //   .employMentData\n        //   ? this.employMentData.studentHistoryAchievementList\n        //   : [];\n        if (\n          this.employMentData &&\n          this.employMentData.studentHistoryAchievementList.length > 0\n        ) {\n          this.employMentData.studentHistoryAchievementList.forEach(item => {\n            let honor = [];\n            honor = item.honorUrl ? item.honorUrl.split(',') : [];\n            this.$set(item, 'honor', honor);\n          });\n        }\n        this.loading = false;\n        this.getGradeList();\n      });\n    },\n    closed() {\n      this.initData();\n    },\n    /**\n     * 获取年级列表\n     */\n    getGradeList() {\n      getSchoolType().then(res => {\n        this.GradeList = res.data;\n        this.GradeList.forEach(item => {\n          if (item.value === this.StudyEmployment.currentGradeValue) {\n            this.StudyEmployment.currentGrade = item.label;\n          }\n        });\n      });\n    },\n    /**\n     * 导出成绩表格\n     */\n    exportAchievement() {\n      exportStudentScore({ informationId: this.employMentData.id }).then(\n        res => {\n          const blob = new Blob([res], {\n            type: 'application/vnd.ms-excel'\n          });\n          let link = document.createElement('a');\n          link.href = URL.createObjectURL(blob);\n          link.setAttribute('download', '学生成绩.xls');\n          link.click();\n          link = null;\n          this.$message.success('下载成功');\n        }\n      );\n    },\n    /**\n     * 导入成绩模板\n     */\n    downloadTemplate() {\n      exportStudentTemplate().then(res => {\n        const blob = new Blob([res], {\n          type: 'application/vnd.ms-excel'\n        });\n        let link = document.createElement('a');\n        link.href = URL.createObjectURL(blob);\n        link.setAttribute('download', '导入学生成绩模板.xls');\n        link.click();\n        link = null;\n        this.$message.success('下载成功');\n      });\n    },\n    /**\n     * 导入成绩表格\n     */\n    tableEdit() {\n      this.isTableEdit = true;\n      console.log('表格编辑');\n    },\n    /**\n     * 取消修改\n     */\n    cancel() {\n      this.isTableEdit = false;\n      this.initData();\n    },\n    /**\n     * 保存成绩表格\n     */\n    preservation() {\n      this.loading = true;\n      for (let i = 0; i < this.tableData.length; i++) {\n        for (let j = i + 1; j < this.tableData.length; j++) {\n          // 相邻元素两两对比，元素交换，大的元素交换到后面\n          if (this.tableData[i].semester === this.tableData[j].semester) {\n            this.$message.error('学期名称必须唯一');\n            this.loading = false;\n            this.isTableEdit = true;\n            return false;\n          }\n        }\n      }\n      let params = {\n        studentBaseId: this.studentData.id,\n        id: this.employMentData ? this.employMentData.id : ''\n      };\n      if (this.studentData.studentStatus === '0') {\n        if (!this.StudyEmployment.currentSchool) {\n          this.$message.error('请填写在读学校');\n          this.loading = false;\n          this.isTableEdit = true;\n          return false;\n        }\n        if (!this.StudyEmployment.currentGradeValue) {\n          this.$message.error('请选择在读年级');\n          this.loading = false;\n          this.isTableEdit = true;\n          return false;\n        }\n        if (!this.StudyEmployment.currentClass) {\n          this.$message.error('请填写班级名称');\n          this.loading = false;\n          this.isTableEdit = true;\n          return false;\n        }\n        if (!this.StudyEmployment.teacherName) {\n          this.$message.error('请填写班主任姓名');\n          this.loading = false;\n          this.isTableEdit = true;\n          return false;\n        }\n        let regTel = /^1[3-9]\\d{9}$/;\n        if (!this.StudyEmployment.teacherIphone) {\n          this.$message.error('请填写班主任联系方式');\n          this.loading = false;\n          this.isTableEdit = true;\n          return false;\n        } else if (!regTel.test(this.StudyEmployment.teacherIphone)) {\n          this.$message.error('请正确填写手机号码！');\n          this.loading = false;\n          this.isTableEdit = true;\n          return false;\n        }\n        params.school = this.StudyEmployment.currentSchool;\n        params.className = this.StudyEmployment.currentClass;\n        params.phone = this.StudyEmployment.teacherIphone;\n        params.headmaster = this.StudyEmployment.teacherName;\n        params.grade = this.StudyEmployment.currentGradeValue;\n      } else {\n        if (!this.workEmployment.workUnit) {\n          this.$message.error('请填写工作单位');\n          this.loading = false;\n          this.isTableEdit = true;\n          return false;\n        }\n        if (!this.workEmployment.post) {\n          this.$message.error('请填写职务');\n          this.loading = false;\n          this.isTableEdit = true;\n          return false;\n        }\n        params.workAddress = this.workEmployment.workUnit;\n        params.position = this.workEmployment.post;\n      }\n      params.studentHistoryAchievementList = this.employMentData\n        ? this.employMentData.studentHistoryAchievementList\n        : [];\n      console.log(params);\n      updateOrAddSudentScore(params).then(res => {\n        this.$message.success('表格更新成功');\n        this.loading = false;\n        this.initData();\n      });\n      this.isTableEdit = false;\n    },\n    /**\n     * 上传图片限制\n     */\n    beforeAvatarUpload(file) {\n      const isLimt = file.size / 1024 / 1024;\n      if (!isLimt) {\n        this.$message.error('上传文件不能超过1M!');\n      }\n      return isLimt;\n    },\n    /**\n     * 导入学生成绩\n     */\n    ajaxUploadSingle(file) {\n      let formData = new FormData();\n      formData.append('file', file.file);\n      formData.append('informationId', this.employMentData.id);\n      importStudentScore(formData).then(res => {\n        this.initData();\n      });\n    },\n    /**\n     * 上传所获荣誉\n     */\n    uploadHonor(file, item) {\n      let formData = new FormData();\n      formData.append('file', file.file);\n      formData.append('appid', 'oss54y7iu');\n      formData.append('appsecret', '1k58q6iw');\n      ajaxUploadSingle(formData).then(res => {\n        let honorUrl = '';\n        honorUrl = item.honorUrl\n          ? `${item.honor},${res.data[0].url}`\n          : `${res.data[0].url}`;\n        this.$set(item, 'honorUrl', honorUrl);\n        item.honor.push(res.data[0].url);\n      });\n    },\n    /**\n     * 显示预览\n     * PerviewImage接收数组为json数组， 必须要imgUrl键名\n     */\n    showPreview(item, index) {\n      this.$refs.PerviewImg.show(item, index);\n    },\n    /**\n     * 返回\n     */\n    goBack() {\n      this.$router.push({ path: '/student/basic-info' });\n    },\n    // 监听输入类型只能为正整数和小数，第一位不能是.\n    proving(item, data, name) {\n      item = item\n        .replace(/[^\\d.]/g, '') // 清除“数字”和“.”以外的字符\n        .replace(/\\.{1,}/g, '.') // 只保留第一个. 清除多余的\n        .replace(/^\\./g, '') //保证第一个为数字而不是.\n        .replace('.', '$#$')\n        .replace(/\\./g, '')\n        .replace('$#$', '.')\n        .replace(/^(\\d+)\\.(\\d\\d).*$/, '$1.$2');\n      this.$set(data, name, item);\n    },\n    // 监听输入类型只能为正整数\n    provingNumber(item, data, name) {\n      item = item.replace(/\\D|^0/g, '');\n      this.$set(data, name, item);\n    }\n  }\n};\n</script>\n\n<style lang=\"less\" scoped>\n.StudyEmploymentBox {\n  min-height: 200px;\n  .studyBox,\n  .employmentBox {\n    display: flex;\n    > .Infobox {\n      width: 12%;\n      height: 40px;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      border: 1px solid #000;\n      margin-bottom: -1px;\n      margin-right: -1px;\n      .labelAntInput {\n        padding: 0 10px;\n        /deep/.el-input__inner {\n          height: 30px;\n        }\n      }\n    }\n  }\n  .achievementBox {\n    margin-top: 20px;\n    .achievementTip {\n      font-size: 16px;\n      font-weight: 900;\n    }\n    .btn {\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      margin-top: 20px;\n      padding-top: 20px;\n      border-top: 1px solid #ebebeb;\n    }\n    .tableBtn {\n      margin-top: 20px;\n      display: flex;\n      align-items: center;\n      justify-content: center;\n      .avatar-uploader {\n        padding: 0 10px;\n      }\n    }\n  }\n  .achievementTable {\n    margin-top: 20px;\n    .tableLabel {\n      overflow: hidden;\n      white-space: nowrap;\n      text-overflow: ellipsis;\n    }\n    .honor {\n      p {\n        color: #409eff;\n        cursor: pointer;\n      }\n    }\n    .honor.imgbox {\n      position: relative;\n      width: 60px;\n      height: 60px;\n      img {\n        width: 100%;\n        height: 100%;\n        cursor: pointer;\n      }\n      span {\n        position: absolute;\n        top: 0;\n        right: 0;\n        z-index: 2;\n        width: 28px;\n        height: 28px;\n        background: rgba(0, 0, 0, 0.5);\n        border-bottom-left-radius: 28px;\n        border-top-left-radius: 0px;\n        display: flex;\n        // align-items: center;\n        justify-content: center;\n        color: #fff;\n      }\n    }\n  }\n}\n</style>\n"]}]}