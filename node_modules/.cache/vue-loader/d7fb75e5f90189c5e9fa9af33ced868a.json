{"remainingRequest":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/fuyueyi/Desktop/practice/mutilwap/src/pages/teaching-points-h5/views/normal-examine/search.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/src/pages/teaching-points-h5/views/normal-examine/search.vue","mtime":1627979214413},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgY2xpc3QgZnJvbSAnLi9jb21wb25lbnRzL2xpc3QnOw0KaW1wb3J0IHsgZ2V0VGFibGVEYXRhLCBnZXRQcmVwYXJlTGlzdCB9IGZyb20gJy4uLy4uL2FwaS9iYXNlL3R5cGVzLWFsbCc7DQppbXBvcnQgeyBTZWFyY2gsIExpc3QsIFB1bGxSZWZyZXNoIH0gZnJvbSAndmFudCc7DQpleHBvcnQgZGVmYXVsdCB7DQogIG5hbWU6ICdub3JtYWxFeGFtaW5lU2VhcmNoJywNCiAgY29tcG9uZW50czogew0KICAgIFtTZWFyY2gubmFtZV06IFNlYXJjaCwNCiAgICBbTGlzdC5uYW1lXTogTGlzdCwNCiAgICBbUHVsbFJlZnJlc2gubmFtZV06IFB1bGxSZWZyZXNoLA0KICAgIGNsaXN0OiBjbGlzdA0KICB9LA0KICBkYXRhOiBmdW5jdGlvbigpIHsNCiAgICByZXR1cm4gew0KICAgICAgdGVhY2hlclRhYmxlRGF0YTogW10sDQogICAgICBhY3RpdmU6IHRoaXMuJHJvdXRlLnF1ZXJ5LmFjdGl2ZSwNCiAgICAgIHRlYWNoZXJOYW1lOiAnJywNCiAgICAgIHBhZ2VJbmZvOiB7DQogICAgICAgIC8v5aGr5oql5L+h5oGv5oC76aG15pWwDQogICAgICAgIHRvdGFsOiAwDQogICAgICB9LA0KICAgICAgcGFnaW5nUGFyYW1zOiB7DQogICAgICAgIC8v5aGr5oql5YiG6aG15Y+C5pWwDQogICAgICAgIGxpbWl0OiA4LA0KICAgICAgICBvZmZzZXQ6IDANCiAgICAgIH0sDQogICAgICBsb2FkaW5nOiBmYWxzZSwNCiAgICAgIGZpbmlzaGVkOiBmYWxzZSwNCiAgICAgIHJlZnJlc2hpbmc6IGZhbHNlLA0KICAgICAgZXJyb3I6IGZhbHNlDQogICAgfTsNCiAgfSwNCiAgY3JlYXRlZCgpIHsNCiAgICB0aGlzLmluaXQoKTsNCiAgfSwNCiAgY29tcHV0ZWQ6IHsNCiAgICBmaW5pc2hlZFRleHQoKSB7DQogICAgICBpZiAodGhpcy5wYWdlSW5mby50b3RhbCA9PT0gMCkgew0KICAgICAgICByZXR1cm4gJyc7DQogICAgICB9IGVsc2Ugew0KICAgICAgICByZXR1cm4gJ+ayoeacieabtOWkmuS6hic7DQogICAgICB9DQogICAgfQ0KICB9LA0KICBtZXRob2RzOiB7DQogICAgaW5pdCgpIHsNCiAgICAgIHRoaXMuJGRkLmJpei5uYXZpZ2F0aW9uLnNldFJpZ2h0KHsNCiAgICAgICAgc2hvdzogZmFsc2UgLy/mjqfliLbmjInpkq7mmL7npLrvvIwgdHJ1ZSDmmL7npLrvvIwgZmFsc2Ug6ZqQ6JeP77yMIOm7mOiupHRydWUNCiAgICAgIH0pOw0KICAgIH0sDQogICAgb25SZWZyZXNoKCkgew0KICAgICAgdGhpcy50ZWFjaGVyVGFibGVEYXRhID0gW107DQogICAgICB0aGlzLmZpbmlzaGVkID0gZmFsc2U7DQogICAgICB0aGlzLmxvYWRpbmcgPSB0cnVlOw0KICAgICAgdGhpcy5wYWdlSW5mby50b3RhbCA9IDA7DQogICAgICB0aGlzLnBhZ2luZ1BhcmFtcy5vZmZzZXQgPSAwOw0KICAgICAgdGhpcy5vbkxvYWQoKTsNCiAgICB9LA0KICAgIG9uTG9hZCgpIHsNCiAgICAgIGlmICh0aGlzLnJlZnJlc2hpbmcpIHsNCiAgICAgICAgdGhpcy50ZWFjaGVyVGFibGVEYXRhID0gW107DQogICAgICAgIHRoaXMucmVmcmVzaGluZyA9IGZhbHNlOw0KICAgICAgfQ0KICAgICAgdGhpcy5sb2FkaW5nID0gdHJ1ZTsNCiAgICAgIHRoaXMuZ2V0RGF0YSgpOw0KICAgIH0sDQogICAgLyoqDQogICAgICog6I635Y+W5YiX6KGo5pWw5o2uDQogICAgICovDQogICAgZ2V0RGF0YSgpIHsNCiAgICAgIGlmICh0aGlzLnBhZ2luZ1BhcmFtcy5vZmZzZXQgPiB0aGlzLnBhZ2VJbmZvLnRvdGFsKSByZXR1cm47DQogICAgICB0aGlzLmxvYWQgPSB0cnVlOw0KICAgICAgbGV0IHByb21pc2VEYXRhOw0KICAgICAgaWYgKHRoaXMuYWN0aXZlID09PSAn57uf6K6h5rGH5oC7Jykgew0KICAgICAgICBwcm9taXNlRGF0YSA9IGdldFRhYmxlRGF0YSh7DQogICAgICAgICAgdGVhY2hlck5hbWU6IHRoaXMudGVhY2hlck5hbWUsDQogICAgICAgICAgLi4udGhpcy5wYWdpbmdQYXJhbXMNCiAgICAgICAgfSk7DQogICAgICB9IGVsc2Ugew0KICAgICAgICBsZXQgdHlwZTsNCiAgICAgICAgc3dpdGNoICh0aGlzLmFjdGl2ZSkgew0KICAgICAgICAgIGNhc2UgJ+Wkh+ivvic6DQogICAgICAgICAgICB0eXBlID0gMTsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgIGNhc2UgJ+aUueS9nCc6DQogICAgICAgICAgICB0eXBlID0gMjsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgIGNhc2UgJ+WQrOivvuiusOW9lSc6DQogICAgICAgICAgICB0eXBlID0gMzsNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgIGRlZmF1bHQ6DQogICAgICAgICAgICBicmVhazsNCiAgICAgICAgfQ0KICAgICAgICBwcm9taXNlRGF0YSA9IGdldFByZXBhcmVMaXN0KHsNCiAgICAgICAgICB0ZWFjaGVyTmFtZTogdGhpcy50ZWFjaGVyTmFtZSwNCiAgICAgICAgICAuLi50aGlzLnBhZ2luZ1BhcmFtcywNCiAgICAgICAgICB0eXBlDQogICAgICAgIH0pOw0KICAgICAgfQ0KICAgICAgcHJvbWlzZURhdGENCiAgICAgICAgLnRoZW4oKHsgZGF0YSB9KSA9PiB7DQogICAgICAgICAgaWYgKGRhdGEuY3VycmVudCA9PSAxICYmIGRhdGEucmVjb3Jkcy5sZW5ndGggPT0gMCkgew0KICAgICAgICAgICAgdGhpcy50ZWFjaGVyVGFibGVEYXRhID0gW107DQogICAgICAgICAgICB0aGlzLmZpbmlzaGVkID0gdHJ1ZTsNCiAgICAgICAgICB9DQogICAgICAgICAgdGhpcy50ZWFjaGVyVGFibGVEYXRhID0gdGhpcy50ZWFjaGVyVGFibGVEYXRhLmNvbmNhdChkYXRhLnJlY29yZHMpOw0KICAgICAgICAgIHRoaXMucGFnZUluZm8udG90YWwgPSBkYXRhLnRvdGFsIHx8IDA7DQogICAgICAgICAgaWYgKHRoaXMucGFnZUluZm8udG90YWwgPD0gZGF0YS5jdXJyZW50ICogZGF0YS5zaXplKSB7DQogICAgICAgICAgICB0aGlzLmZpbmlzaGVkID0gdHJ1ZTsNCiAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgdGhpcy5wYWdpbmdQYXJhbXMub2Zmc2V0ID0NCiAgICAgICAgICAgICAgKE1hdGguZmxvb3IodGhpcy5wYWdpbmdQYXJhbXMub2Zmc2V0IC8gdGhpcy5wYWdpbmdQYXJhbXMubGltaXQpICsNCiAgICAgICAgICAgICAgICAxKSAqDQogICAgICAgICAgICAgIHRoaXMucGFnaW5nUGFyYW1zLmxpbWl0Ow0KICAgICAgICAgIH0NCiAgICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZTsNCiAgICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAgICAgICAgIHRoaXMubG9hZCA9IGZhbHNlOw0KICAgICAgICAgIH0pOw0KICAgICAgICB9KQ0KICAgICAgICAuY2F0Y2goKCkgPT4gew0KICAgICAgICAgIHRoaXMudGVhY2hlclRhYmxlRGF0YSA9IFtdOw0KICAgICAgICAgIHRoaXMuZmluaXNoZWQgPSB0cnVlOw0KICAgICAgICB9KTsNCiAgICB9DQogIH0NCn07DQo="},{"version":3,"sources":["search.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"search.vue","sourceRoot":"src/pages/teaching-points-h5/views/normal-examine","sourcesContent":["<template>\r\n  <div class=\"search-page\">\r\n    <p>\r\n      <van-search\r\n        v-model=\"teacherName\"\r\n        @search=\"onRefresh\"\r\n        shape=\"round\"\r\n        background=\"#F6F6F6\"\r\n        placeholder=\"请输入教师姓名\"\r\n      />\r\n    </p>\r\n    <div class=\"list-content\">\r\n      <van-pull-refresh v-model=\"refreshing\" @refresh=\"onRefresh\">\r\n        <van-list\r\n          v-model=\"loading\"\r\n          :finished=\"finished\"\r\n          :offset=\"20\"\r\n          :error.sync=\"error\"\r\n          error-text=\"请求失败，点击重新加载\"\r\n          :finished-text=\"finishedText\"\r\n          @load=\"onLoad\"\r\n        >\r\n          <dl>\r\n            <clist\r\n              :finished=\"finished\"\r\n              :active=\"active\"\r\n              :teacherTableData=\"teacherTableData\"\r\n            ></clist>\r\n          </dl>\r\n        </van-list>\r\n      </van-pull-refresh>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport clist from './components/list';\r\nimport { getTableData, getPrepareList } from '../../api/base/types-all';\r\nimport { Search, List, PullRefresh } from 'vant';\r\nexport default {\r\n  name: 'normalExamineSearch',\r\n  components: {\r\n    [Search.name]: Search,\r\n    [List.name]: List,\r\n    [PullRefresh.name]: PullRefresh,\r\n    clist: clist\r\n  },\r\n  data: function() {\r\n    return {\r\n      teacherTableData: [],\r\n      active: this.$route.query.active,\r\n      teacherName: '',\r\n      pageInfo: {\r\n        //填报信息总页数\r\n        total: 0\r\n      },\r\n      pagingParams: {\r\n        //填报分页参数\r\n        limit: 8,\r\n        offset: 0\r\n      },\r\n      loading: false,\r\n      finished: false,\r\n      refreshing: false,\r\n      error: false\r\n    };\r\n  },\r\n  created() {\r\n    this.init();\r\n  },\r\n  computed: {\r\n    finishedText() {\r\n      if (this.pageInfo.total === 0) {\r\n        return '';\r\n      } else {\r\n        return '没有更多了';\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    init() {\r\n      this.$dd.biz.navigation.setRight({\r\n        show: false //控制按钮显示， true 显示， false 隐藏， 默认true\r\n      });\r\n    },\r\n    onRefresh() {\r\n      this.teacherTableData = [];\r\n      this.finished = false;\r\n      this.loading = true;\r\n      this.pageInfo.total = 0;\r\n      this.pagingParams.offset = 0;\r\n      this.onLoad();\r\n    },\r\n    onLoad() {\r\n      if (this.refreshing) {\r\n        this.teacherTableData = [];\r\n        this.refreshing = false;\r\n      }\r\n      this.loading = true;\r\n      this.getData();\r\n    },\r\n    /**\r\n     * 获取列表数据\r\n     */\r\n    getData() {\r\n      if (this.pagingParams.offset > this.pageInfo.total) return;\r\n      this.load = true;\r\n      let promiseData;\r\n      if (this.active === '统计汇总') {\r\n        promiseData = getTableData({\r\n          teacherName: this.teacherName,\r\n          ...this.pagingParams\r\n        });\r\n      } else {\r\n        let type;\r\n        switch (this.active) {\r\n          case '备课':\r\n            type = 1;\r\n            break;\r\n          case '改作':\r\n            type = 2;\r\n            break;\r\n          case '听课记录':\r\n            type = 3;\r\n            break;\r\n          default:\r\n            break;\r\n        }\r\n        promiseData = getPrepareList({\r\n          teacherName: this.teacherName,\r\n          ...this.pagingParams,\r\n          type\r\n        });\r\n      }\r\n      promiseData\r\n        .then(({ data }) => {\r\n          if (data.current == 1 && data.records.length == 0) {\r\n            this.teacherTableData = [];\r\n            this.finished = true;\r\n          }\r\n          this.teacherTableData = this.teacherTableData.concat(data.records);\r\n          this.pageInfo.total = data.total || 0;\r\n          if (this.pageInfo.total <= data.current * data.size) {\r\n            this.finished = true;\r\n          } else {\r\n            this.pagingParams.offset =\r\n              (Math.floor(this.pagingParams.offset / this.pagingParams.limit) +\r\n                1) *\r\n              this.pagingParams.limit;\r\n          }\r\n          this.loading = false;\r\n          setTimeout(() => {\r\n            this.load = false;\r\n          });\r\n        })\r\n        .catch(() => {\r\n          this.teacherTableData = [];\r\n          this.finished = true;\r\n        });\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.search-page {\r\n  background: #f6f6f6;\r\n  height: 100%;\r\n  /deep/ .van-search__content {\r\n    background-color: #fff;\r\n  }\r\n  /deep/ .van-search {\r\n    height: 1.08rem;\r\n  }\r\n  .list-content {\r\n    position: absolute;\r\n    width: 100%;\r\n    height: calc(100% - 1.08rem);\r\n    overflow-y: auto;\r\n  }\r\n}\r\n</style>\r\n"]}]}