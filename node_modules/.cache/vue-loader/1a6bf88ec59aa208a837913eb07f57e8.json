{"remainingRequest":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/fuyueyi/Desktop/practice/mutilwap/src/components/common/CDynamicForm/components/DfSelect.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/src/components/common/CDynamicForm/components/DfSelect.vue","mtime":1627979214237},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IGdlbmVyYXRlVVVJRCB9IGZyb20gJ0AvcGx1Z2lucy9jb21tb24vZ2VuZXJhdGUnOwppbXBvcnQgeyBTZWxlY3QsIE9wdGlvbiB9IGZyb20gJ2VsZW1lbnQtdWknOwppbXBvcnQgZGZPcHRpb25zTWl4aW4gZnJvbSAnLi4vbWl4aW5zL2RmLW9wdGlvbnMtbWl4aW4nOwoKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdEZlNlbGVjdCcsCiAgbWl4aW5zOiBbZGZPcHRpb25zTWl4aW5dLAogIGNvbXBvbmVudHM6IHsKICAgIFtTZWxlY3QubmFtZV06IFNlbGVjdCwKICAgIFtPcHRpb24ubmFtZV06IE9wdGlvbgogIH0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHV1aWQ6IGdlbmVyYXRlVVVJRCgpCiAgICB9OwogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIC8v5bGV56S65LiL5ouJ5qGG5pys5paHdGlwCiAgICBsYWJlbFZhbCgpIHsKICAgICAgbGV0IHsgbW9kZWwgfSA9IHsgLi4udGhpcy5DRHluYW1pY0Zvcm0gfTsKICAgICAgbGV0IHsgbGFiZWxQcm9wIH0gPSB7IC4uLnRoaXMuY29uZmlnIH07CiAgICAgIC8v5peg5YC85LiN5bGV56S6CiAgICAgIGlmICh0aGlzLnZhbCAhPT0gZmFsc2UgJiYgIXRoaXMudmFsKSByZXR1cm4gJyc7CiAgICAgIGlmIChsYWJlbFByb3ApIHsKICAgICAgICByZXR1cm4gbW9kZWxbbGFiZWxQcm9wXTsKICAgICAgfQogICAgICBsZXQgcmVzID0gdGhpcy5vcHRpb25MaXN0LmZpbmQoaXRlbSA9PiBpdGVtW3RoaXMudmFsdWVLZXldID09PSB0aGlzLnZhbCk7CiAgICAgIGlmIChyZXMpIHsKICAgICAgICByZXR1cm4gcmVzW3RoaXMubGFiZWxLZXldOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiAnJzsKICAgICAgfQogICAgfSwKICAgIHBvcHBlckNsYXNzKCkgewogICAgICByZXR1cm4gJ2Ryb3Bkb3duLScgKyB0aGlzLmNvbmZpZy5wcm9wICsgJy0nICsgdGhpcy51dWlkOwogICAgfSwKICAgIHNjcm9sbEVsKCkgewogICAgICByZXR1cm4gJy4nICsgdGhpcy5wb3BwZXJDbGFzcyArICcgLmVsLXNlbGVjdC1kcm9wZG93bl9fd3JhcCc7CiAgICB9CiAgfSwKICB3YXRjaDogewogICAgLy/lgLzmuIXnqbrml7Ys5bCG44CQbGFiZWxQcm9w44CR5a+55bqU55qE5YC85riF56m6CiAgICB2YWwodmFsdWUpIHsKICAgICAgaWYgKHZhbHVlKSByZXR1cm47CiAgICAgIHRoaXMuY29uZmlnLmxhYmVsUHJvcCAmJgogICAgICAgIHRoaXMuJGVtaXQoJ2NoYW5nZS1sYWJlbCcsIHRoaXMuY29uZmlnLmxhYmVsUHJvcCwgJycpOwogICAgfQogIH0sCiAgY3JlYXRlZCgpIHt9LAogIG1ldGhvZHM6IHsKICAgIC8v5LiL5ouJ5qGG5Yy65Z+f5aSW5rua5Yqo77yM5bCG5LiL5ouJ5qGG6ZqQ6JePCiAgICBvbkNsb3NlRHJvcERvd24oZSwgZWwpIHsKICAgICAgbGV0IHNlbGVjdFJlZiA9IHRoaXMuJHJlZnNbJ3NlbGVjdCddOwogICAgICAvL+W9k+WJjee7keWumueahOa7muWKqOWMuuWfn+aYr+atpOS4i+aLieahhu+8jOW5tuS4lOS4i+aLieahhuaYvuekuuS6hu+8jOWImeWwhuWFtumakOiXjwogICAgICBpZiAodGhpcy5zY3JvbGxFbCA9PT0gZWwgJiYgc2VsZWN0UmVmICYmIHNlbGVjdFJlZi52aXNpYmxlKQogICAgICAgIHNlbGVjdFJlZi5ibHVyKCk7CiAgICB9LAogICAgLyoqCiAgICAgKiDlgLzmlLnlj5gKICAgICAqIC0g5aaC5p6c5pyJ6K6+572ubGFiZWxQcm9w6Ieq5Yqo5aGr5YWFCiAgICAgKiBAcGFyYW0geyp9IHZhbHVlIOWAvAogICAgICovCiAgICBvbkNoYW5nZSh2YWx1ZSkgewogICAgICBpZiAodGhpcy5jb25maWcubGFiZWxQcm9wKSB7CiAgICAgICAgbGV0IHJlczsKICAgICAgICAvL+WkmumAieS4i+aLiQogICAgICAgIGlmIChBcnJheS5pc0FycmF5KHZhbHVlKSkgewogICAgICAgICAgcmVzID0gW107CiAgICAgICAgICB2YWx1ZS5mb3JFYWNoKHZhbCA9PiB7CiAgICAgICAgICAgIGxldCB2ID0gdGhpcy5vcHRpb25MaXN0LmZpbmQoaXRlbSA9PiBpdGVtW3RoaXMudmFsdWVLZXldID09PSB2YWwpOwogICAgICAgICAgICB2ICYmIHJlcy5wdXNoKHZbdGhpcy5sYWJlbEtleV0pOwogICAgICAgICAgfSk7CiAgICAgICAgICB0aGlzLkNEeW5hbWljRm9ybS5tb2RlbFt0aGlzLmNvbmZpZy5sYWJlbFByb3BdID0gcmVzOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZXMgPSB0aGlzLm9wdGlvbkxpc3QuZmluZChpdGVtID0+IGl0ZW1bdGhpcy52YWx1ZUtleV0gPT09IHZhbHVlKTsKICAgICAgICAgIGlmIChyZXMpIHsKICAgICAgICAgICAgdGhpcy5DRHluYW1pY0Zvcm0ubW9kZWxbdGhpcy5jb25maWcubGFiZWxQcm9wXSA9IHJlc1t0aGlzLmxhYmVsS2V5XTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHRoaXMuQ0R5bmFtaWNGb3JtLm1vZGVsW3RoaXMuY29uZmlnLmxhYmVsUHJvcF0gPSAnJzsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9Cn07Cg=="},{"version":3,"sources":["DfSelect.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;AA2BA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"DfSelect.vue","sourceRoot":"src/components/common/CDynamicForm/components","sourcesContent":["<template>\n  <el-select\n    ref=\"select\"\n    :popper-class=\"popperClass\"\n    v-model=\"val\"\n    v-bind=\"attrs\"\n    v-on=\"events\"\n    v-scrolloutclose=\"{\n      el: scrollEl, //scroll滚动区域\n      handler: onCloseDropDown //触发事件\n    }\"\n    :title=\"labelVal\"\n    :loading=\"!!lastRequestSymbol\"\n    @change=\"onChange\"\n  >\n    <el-option\n      v-for=\"(item, index) in optionList\"\n      v-bind=\"item\"\n      :key=\"index\"\n      :value=\"item[valueKey]\"\n      :label=\"item[labelKey]\"\n    >\n    </el-option>\n  </el-select>\n</template>\n\n<script>\nimport { generateUUID } from '@/plugins/common/generate';\nimport { Select, Option } from 'element-ui';\nimport dfOptionsMixin from '../mixins/df-options-mixin';\n\nexport default {\n  name: 'DfSelect',\n  mixins: [dfOptionsMixin],\n  components: {\n    [Select.name]: Select,\n    [Option.name]: Option\n  },\n  data() {\n    return {\n      uuid: generateUUID()\n    };\n  },\n  computed: {\n    //展示下拉框本文tip\n    labelVal() {\n      let { model } = { ...this.CDynamicForm };\n      let { labelProp } = { ...this.config };\n      //无值不展示\n      if (this.val !== false && !this.val) return '';\n      if (labelProp) {\n        return model[labelProp];\n      }\n      let res = this.optionList.find(item => item[this.valueKey] === this.val);\n      if (res) {\n        return res[this.labelKey];\n      } else {\n        return '';\n      }\n    },\n    popperClass() {\n      return 'dropdown-' + this.config.prop + '-' + this.uuid;\n    },\n    scrollEl() {\n      return '.' + this.popperClass + ' .el-select-dropdown__wrap';\n    }\n  },\n  watch: {\n    //值清空时,将【labelProp】对应的值清空\n    val(value) {\n      if (value) return;\n      this.config.labelProp &&\n        this.$emit('change-label', this.config.labelProp, '');\n    }\n  },\n  created() {},\n  methods: {\n    //下拉框区域外滚动，将下拉框隐藏\n    onCloseDropDown(e, el) {\n      let selectRef = this.$refs['select'];\n      //当前绑定的滚动区域是此下拉框，并且下拉框显示了，则将其隐藏\n      if (this.scrollEl === el && selectRef && selectRef.visible)\n        selectRef.blur();\n    },\n    /**\n     * 值改变\n     * - 如果有设置labelProp自动填充\n     * @param {*} value 值\n     */\n    onChange(value) {\n      if (this.config.labelProp) {\n        let res;\n        //多选下拉\n        if (Array.isArray(value)) {\n          res = [];\n          value.forEach(val => {\n            let v = this.optionList.find(item => item[this.valueKey] === val);\n            v && res.push(v[this.labelKey]);\n          });\n          this.CDynamicForm.model[this.config.labelProp] = res;\n        } else {\n          res = this.optionList.find(item => item[this.valueKey] === value);\n          if (res) {\n            this.CDynamicForm.model[this.config.labelProp] = res[this.labelKey];\n          } else {\n            this.CDynamicForm.model[this.config.labelProp] = '';\n          }\n        }\n      }\n    }\n  }\n};\n</script>\n\n<style lang=\"less\" scoped></style>\n"]}]}