{"remainingRequest":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/fuyueyi/Desktop/practice/mutilwap/src/pages/charity-foundation/views/student/components/StudentEdit/index.vue?vue&type=style&index=0&id=ad5ae892&lang=less&scoped=true&","dependencies":[{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/src/pages/charity-foundation/views/student/components/StudentEdit/index.vue","mtime":1627979214292},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/less-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/style-resources-loader/lib/index.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgouaW1wb3J0LWRhdGEtY29udGVudCB7CiAgaDMgewogICAgZm9udC1zaXplOiAxNnB4OwogICAgY29sb3I6ICMzMDMxMzM7CiAgfQogIHAgewogICAgZm9udC1zaXplOiAxNHB4OwogICAgbWFyZ2luOiAxNXB4IDA7CiAgfQp9Ci5kZW1vLXJ1bGVGb3JtIHsKICBkaXNwbGF5OiBmbGV4OwogIGZsZXgtd3JhcDogd3JhcDsKICAvLyAvZGVlcC8uZWwtZm9ybS1pdGVtIHsKICAvLyAgIGZsZXg6IDE7CiAgLy8gfQogIC5mbGV4Ym94IHsKICAgIGZsZXg6IDE7CiAgfQogIC5GYW1pbHkgewogICAgd2lkdGg6IDEwMCU7CiAgICAvZGVlcC8uZWwtdGV4dGFyZWFfX2lubmVyIHsKICAgICAgaGVpZ2h0OiA4MHB4OwogICAgfQogIH0KICAudXBsb2FkIHsKICAgIC5hdmF0YXItdXBsb2FkZXIgL2RlZXAvLmVsLXVwbG9hZCB7CiAgICAgIGRpc3BsYXk6IGZsZXg7CiAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICAgIC51cGxvYWRJbWdCdG4gewogICAgICAgIGJvcmRlcjogMXB4IGRhc2hlZCAjZDlkOWQ5OwogICAgICAgIGJvcmRlci1yYWRpdXM6IDZweDsKICAgICAgICBjdXJzb3I6IHBvaW50ZXI7CiAgICAgICAgcG9zaXRpb246IHJlbGF0aXZlOwogICAgICAgIG92ZXJmbG93OiBoaWRkZW47CiAgICAgICAgLmF2YXRhci11cGxvYWRlci1pY29uIHsKICAgICAgICAgIGZvbnQtc2l6ZTogMjhweDsKICAgICAgICAgIGNvbG9yOiAjOGM5MzlkOwogICAgICAgICAgd2lkdGg6IDYwcHg7CiAgICAgICAgICBoZWlnaHQ6IDYwcHg7CiAgICAgICAgICBkaXNwbGF5OiBmbGV4OwogICAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgICAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOwogICAgICAgIH0KICAgICAgfQogICAgICAudXBsb2FkSW1nQnRuOmhvdmVyIHsKICAgICAgICBib3JkZXItY29sb3I6ICM0MDllZmY7CiAgICAgIH0KICAgICAgLmF2YXRhciB7CiAgICAgICAgb3ZlcmZsb3c6IGhpZGRlbjsKICAgICAgICBwb3NpdGlvbjogcmVsYXRpdmU7CiAgICAgICAgLnJlcG9ydGJveCB7CiAgICAgICAgICB3aWR0aDogNjBweDsKICAgICAgICAgIGhlaWdodDogNjBweDsKICAgICAgICB9CiAgICAgICAgaW1nIHsKICAgICAgICAgIHdpZHRoOiAxMDAlOwogICAgICAgICAgaGVpZ2h0OiAxMDAlOwogICAgICAgIH0KICAgICAgICAuZGV0ZWxlSW1nIHsKICAgICAgICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsKICAgICAgICAgIHRvcDogMDsKICAgICAgICAgIHJpZ2h0OiAwOwogICAgICAgICAgZm9udC1zaXplOiAyMHB4OwogICAgICAgICAgY29sb3I6ICMwMDA7CiAgICAgICAgfQogICAgICB9CiAgICAgIC51cGxvYWRCdG4gewogICAgICAgIG1hcmdpbi1sZWZ0OiAyMHB4OwogICAgICAgIHRleHQtZGVjb3JhdGlvbjogdW5kZXJsaW5lOwogICAgICAgIGNvbG9yOiAjNDA5ZWZmOwogICAgICAgIGN1cnNvcjogcG9pbnRlcjsKICAgICAgfQogICAgfQogIH0KICAuYnRuLWJveCB7CiAgICB3aWR0aDogMTAwJTsKICAgIC9kZWVwLy5lbC1idXR0b24gKyAuZWwtYnV0dG9uIHsKICAgICAgbWFyZ2luLWxlZnQ6IDEwJTsKICAgIH0KICB9Cn0KL2RlZXAvLmVsLWlucHV0IHsKICB3aWR0aDogMjE3cHg7Cn0K"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiuBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/pages/charity-foundation/views/student/components/StudentEdit","sourcesContent":["<template>\n  <el-dialog\n    :visible.sync=\"visible\"\n    v-loading=\"loading\"\n    :title=\"title || ''\"\n    center\n    :close-on-click-modal=\"false\"\n    :close-on-press-escape=\"false\"\n    v-on=\"$listeners\"\n    @closed=\"onClosed\"\n    :before-close=\"onBeforeCloseForm\"\n    width=\"60%\"\n  >\n    <el-form\n      :model=\"ruleForm\"\n      :rules=\"rules\"\n      ref=\"ruleForm\"\n      label-width=\"150px\"\n      class=\"demo-ruleForm\"\n    >\n      <el-form-item label=\"姓名：\" prop=\"name\" class=\"flexbox\">\n        <el-input v-model=\"ruleForm.name\" placeholder=\"请输入姓名\"></el-input>\n      </el-form-item>\n      <el-form-item label=\"身份证号：\" prop=\"cardCode\" class=\"flexbox\">\n        <el-input\n          v-model=\"ruleForm.cardCode\"\n          placeholder=\"请输入身份证号\"\n        ></el-input>\n      </el-form-item>\n      <el-form-item label=\"工程类型：\" prop=\"projectType\" class=\"flexbox\">\n        <el-select\n          v-model=\"ruleForm.projectType\"\n          placeholder=\"请选择工程类型\"\n          @focus=\"getProjectList\"\n        >\n          <el-option\n            v-for=\"(project, projectIndex) in projectList\"\n            :key=\"projectIndex\"\n            :label=\"project.label\"\n            :value=\"project.id\"\n          ></el-option>\n        </el-select>\n      </el-form-item>\n      <el-form-item label=\"性别：\" prop=\"sex\" class=\"flexbox\">\n        <el-select v-model=\"ruleForm.sex\" placeholder=\"请选择性别\">\n          <el-option label=\"男\" value=\"0\"></el-option>\n          <el-option label=\"女\" value=\"1\"></el-option>\n        </el-select>\n      </el-form-item>\n      <el-form-item label=\"民族：\" prop=\"nationId\" class=\"flexbox\">\n        <el-select\n          v-model=\"ruleForm.nationId\"\n          placeholder=\"请选择民族\"\n          @focus=\"getNationList\"\n        >\n          <el-option\n            v-for=\"(nation, nationIndex) in nationList\"\n            :key=\"nationIndex\"\n            :label=\"nation.name\"\n            :value=\"nation.id\"\n          ></el-option>\n        </el-select>\n      </el-form-item>\n      <el-form-item label=\"户籍所在地：\" prop=\"address\" class=\"flexbox\">\n        <el-cascader\n          :props=\"casProps\"\n          :options=\"residenceList\"\n          :key=\"casIndex\"\n          ref=\"cascader\"\n          v-model=\"ruleForm.address\"\n          placeholder=\"请选择户籍所在地\"\n          separator=\" \"\n        >\n        </el-cascader>\n      </el-form-item>\n      <el-form-item label=\"健康状况：\" prop=\"healthStatus\" class=\"flexbox\">\n        <el-select v-model=\"ruleForm.healthStatus\" placeholder=\"选择健康状况\">\n          <el-option label=\"优\" value=\"0\"></el-option>\n          <el-option label=\"良\" value=\"1\"></el-option>\n          <el-option label=\"中\" value=\"2\"></el-option>\n          <el-option label=\"差\" value=\"3\"></el-option>\n        </el-select>\n      </el-form-item>\n      <el-form-item label=\"阶段：\" prop=\"studentStatus\" class=\"flexbox\">\n        <el-select v-model=\"ruleForm.studentStatus\" placeholder=\"选择当前阶段\">\n          <el-option label=\"在读\" value=\"0\"></el-option>\n          <el-option label=\"就业\" value=\"1\"></el-option>\n          <el-option label=\"退回原籍\" value=\"2\"></el-option>\n          <el-option label=\"暂停资助\" value=\"3\"></el-option>\n        </el-select>\n      </el-form-item>\n      <el-form-item\n        label=\"进入幸福院时间：\"\n        prop=\"comeTime\"\n        class=\"flexbox\"\n        v-show=\"this.ruleForm.projectType !== 23\"\n      >\n        <el-date-picker\n          v-model=\"ruleForm.comeTime\"\n          type=\"date\"\n          :picker-options=\"pickerOptionsStart\"\n          @focus=\"firstTime\"\n          placeholder=\"请选择开始时间范围\"\n          value-format=\"yyyy-MM-dd\"\n        >\n        </el-date-picker>\n      </el-form-item>\n      <el-form-item\n        label=\"离开幸福院时间：\"\n        prop=\"leaveTime\"\n        class=\"flexbox\"\n        v-show=\"this.ruleForm.projectType !== 23\"\n      >\n        <el-date-picker\n          v-model=\"ruleForm.leaveTime\"\n          type=\"date\"\n          :picker-options=\"pickerOptionsEnd\"\n          @focus=\"secondTime\"\n          placeholder=\"请选择结束时间范围\"\n          value-format=\"yyyy-MM-dd\"\n        >\n        </el-date-picker>\n      </el-form-item>\n      <el-form-item label=\"监护人：\" prop=\"guardianName\" class=\"flexbox\">\n        <el-input\n          v-model=\"ruleForm.guardianName\"\n          placeholder=\"输入监护人姓名\"\n        ></el-input>\n      </el-form-item>\n      <el-form-item\n        label=\"监护人联系方式：\"\n        prop=\"guardianPhone\"\n        class=\"flexbox\"\n      >\n        <el-input\n          v-model=\"ruleForm.guardianPhone\"\n          placeholder=\"输入监护人联系方式\"\n        ></el-input>\n      </el-form-item>\n      <el-form-item\n        label=\"爱心妈妈姓名：\"\n        prop=\"helpMotherName\"\n        class=\"flexbox\"\n        v-show=\"this.ruleForm.projectType !== 23\"\n      >\n        <el-input\n          v-model=\"ruleForm.helpMotherName\"\n          placeholder=\"输入爱心妈妈姓名\"\n        ></el-input>\n      </el-form-item>\n      <el-form-item\n        label=\"爱心妈妈联系方式：\"\n        prop=\"helpMotherPhone\"\n        class=\"flexbox\"\n        v-show=\"this.ruleForm.projectType !== 23\"\n      >\n        <el-input\n          v-model=\"ruleForm.helpMotherPhone\"\n          placeholder=\"输入爱心妈妈联系方式\"\n        ></el-input>\n      </el-form-item>\n      <el-form-item label=\"家庭情况：\" prop=\"familyDetail\" class=\"Family\">\n        <el-input\n          type=\"textarea\"\n          v-model=\"ruleForm.familyDetail\"\n          maxlength=\"300\"\n          resize=\"none\"\n          placeholder=\"300字以内\"\n        ></el-input>\n      </el-form-item>\n      <el-form-item label=\"体检报告：\" prop=\"region\" class=\"upload\">\n        <el-upload\n          class=\"avatar-uploader\"\n          action=\"\"\n          :show-file-list=\"false\"\n          :multiple=\"false\"\n          :http-request=\"ajaxUploadSingle\"\n        >\n          <div class=\"avatar\" v-if=\"ruleForm.healthReport\">\n            <!-- <img :src=\"ruleForm.healthReport\" /> -->\n            <div\n              class=\"reportbox\"\n              v-if=\"\n                imgType === 'jpg' ||\n                  imgType === 'JPG' ||\n                  imgType === 'png' ||\n                  imgType === 'PNG' ||\n                  imgType === 'gif' ||\n                  imgType === 'GIF' ||\n                  imgType === 'jpeg' ||\n                  imgType === 'JPEG' ||\n                  imgType === 'bmp' ||\n                  imgType === 'BMP'\n              \"\n            >\n              <img\n                :src=\"ruleForm.healthReport ? ruleForm.healthReport : ''\"\n                alt=\"\"\n              />\n            </div>\n            <div v-else>\n              <p>{{ ruleForm.healthName }}</p>\n            </div>\n            <i\n              class=\"el-icon-circle-close deteleImg\"\n              @click.stop=\"deteleUpLoadImg\"\n            ></i>\n          </div>\n          <div class=\"uploadImgBtn\" v-if=\"!ruleForm.healthReport\">\n            <i class=\"el-icon-plus avatar-uploader-icon\"></i>\n          </div>\n          <p class=\"uploadBtn\" v-if=\"!ruleForm.healthReport\">点击上传</p>\n        </el-upload>\n      </el-form-item>\n      <el-form-item class=\"btn-box\">\n        <el-button type=\"primary\" @click=\"submitForm('ruleForm')\"\n          >保存</el-button\n        >\n        <el-button type=\"primary\" @click=\"resetForm('ruleForm')\"\n          >重置</el-button\n        >\n        <el-button type=\"primary\" @click=\"onClosed\">取消</el-button>\n      </el-form-item>\n    </el-form>\n  </el-dialog>\n</template>\n\n<script>\nimport axios from '@/plugins/axios';\nimport {\n  Radio,\n  Button,\n  Dialog,\n  FormItem,\n  Input,\n  Form,\n  Upload,\n  Option,\n  Select,\n  DatePicker,\n  Cascader\n} from 'element-ui';\nimport {\n  saveStudent,\n  updateStudentById,\n  getProvinceList,\n  getCityList,\n  getNationList\n} from '../../../../api/sutdent/index';\nimport { getProjectList } from '../../../../api/auth/index';\nimport { ajaxUploadSingle } from '@/pages/charity-foundation/api/file/index';\nexport default {\n  name: 'StudentEdit',\n  components: {\n    [Button.name]: Button,\n    [Dialog.name]: Dialog,\n    [Input.name]: Input,\n    [Radio.name]: Radio,\n    [FormItem.name]: FormItem,\n    [Form.name]: Form,\n    [Upload.name]: Upload,\n    [Option.name]: Option,\n    [Select.name]: Select,\n    [DatePicker.name]: DatePicker,\n    [Cascader.name]: Cascader\n  },\n  props: {\n    /**\n     * 成功回调\n     */\n    onSuccess: {\n      type: Function\n    }\n  },\n  data() {\n    let validateInput = (rule, value, callback) => {\n      if (!this.checkSpecialKey(value)) {\n        callback(new Error('不能含有特殊字符！！'));\n      } else {\n        callback();\n      }\n    };\n    return {\n      loading: false,\n      visible: false, // 是否显示模态框\n      title: '',\n      editItem: null,\n      imgType: '',\n      casIndex: 0,\n      ruleForm: {\n        name: '',\n        healthReport: '', // 体检报告图片\n        healthName: '',\n        cardCode: '', // 身份证号\n        projectType: '', // 工程类型\n        sex: '', // 性别\n        nationId: '', // 民族\n        address: null, // 户籍所在地\n        healthStatus: '', // 健康状况\n        studentStatus: '', // 阶段\n        comeTime: '', // 进入幸福院时间\n        leaveTime: '', // 离开幸福院时间：\n        guardianName: '', // 监护人\n        guardianPhone: '', // 监护人联系方式\n        helpMotherName: '', // 爱心妈妈姓名\n        helpMotherPhone: '', // 爱心妈妈联系方式\n        familyDetail: '' // 家庭情况\n      },\n      pickerOptionsStart: {\n        disabledDate(time) {\n          return time.getTime() > Date.now();\n        }\n      },\n      pickerOptionsEnd: {\n        disabledDate(time) {\n          return time.getTime() > Date.now();\n        }\n      },\n      residenceList: [],\n      casProps: {\n        value: 'id',\n        label: 'name',\n        lazy: true, // 此处必须为true\n        lazyLoad: (node, resolve) => {\n          if (node.data && node.data.levelId === '3') resolve(null);\n          if (node.data && node.data.id)\n            this.getChildProject(node.data, resolve);\n        }\n      },\n      rules: {\n        name: [\n          { required: true, message: '请输入您的姓名', trigger: 'change' },\n          { required: true, message: '请输入您的姓名', trigger: 'blur' },\n          {\n            min: 1,\n            max: 18,\n            message: '长度在 1 到 18 个字符',\n            trigger: 'change'\n          },\n          {\n            min: 1,\n            max: 18,\n            message: '长度在 1 到 18 个字符',\n            trigger: 'blur'\n          },\n          { validator: validateInput, trigger: 'change' },\n          { validator: validateInput, trigger: 'blur' }\n        ],\n        cardCode: [\n          { required: true, message: '请输入身份证号', trigger: 'change' },\n          { required: true, message: '请输入身份证号', trigger: 'blur' },\n          {\n            pattern: /(^\\d{8}(0\\d|10|11|12)([0-2]\\d|30|31)\\d{3}$)|(^\\d{6}(18|19|20)\\d{2}(0\\d|10|11|12)([0-2]\\d|30|31)\\d{3}(\\d|X|x)$)/,\n            message: '请输入正确的身份证号',\n            trigger: 'blur'\n          }\n        ],\n        projectType: [\n          {\n            required: true,\n            message: '请选择工程类型',\n            trigger: 'change'\n          }\n        ],\n        sex: [\n          {\n            required: true,\n            message: '请选择您的性别',\n            trigger: 'change'\n          }\n        ],\n        nationId: [\n          {\n            required: true,\n            message: '请选择民族',\n            trigger: 'change'\n          }\n        ],\n        address: [\n          {\n            required: true,\n            message: '请选择户籍所在地',\n            trigger: 'change'\n          }\n        ],\n        studentStatus: [\n          {\n            required: true,\n            message: '请选择当前阶段',\n            trigger: 'change'\n          }\n        ]\n      },\n      projectList: [], //工程列表\n      nationList: [] // 民族列表\n    };\n  },\n  watch: {},\n  created() {\n    this.initDialogFormData();\n  },\n  mounted() {\n    this.initData();\n  },\n  methods: {\n    /**\n     * 设置进入时间段不可用时间\n     */\n    firstTime() {\n      if (this.ruleForm.leaveTime) {\n        let data1 = new Date(this.ruleForm.leaveTime);\n        data1 =\n          data1.getFullYear() +\n          '-' +\n          (data1.getMonth() + 1) +\n          '-' +\n          data1.getDate() +\n          ' ' +\n          data1.getHours() +\n          ':' +\n          data1.getMinutes() +\n          ':' +\n          data1.getSeconds();\n        let data = new Date(data1).getTime();\n        this.pickerOptionsStart = {\n          disabledDate(time) {\n            if (time.getTime() >= data) return true;\n            return time.getTime() > Date.now();\n          }\n        };\n      } else {\n        this.pickerOptionsStart = {\n          disabledDate(time) {\n            return time.getTime() > Date.now();\n          }\n        };\n      }\n    },\n    /**\n     * 设置离开时间段不可用时间\n     */\n    secondTime() {\n      let _this = this;\n      if (this.ruleForm.comeTime) {\n        let data = new Date(`${this.ruleForm.comeTime} 00:00:00`).getTime();\n        this.pickerOptionsEnd = {\n          disabledDate(time) {\n            if (time.getTime() < data) {\n              return true;\n            } else if (time.getTime() == data) {\n              return false;\n            } else {\n              return time.getTime() > Date.now();\n            }\n          }\n        };\n      } else {\n        this.pickerOptionsEnd = {\n          disabledDate(time) {\n            return time.getTime() > Date.now();\n          }\n        };\n      }\n    },\n    // 正则验证\n    checkSpecialKey(str) {\n      let specialKey =\n        '\"\"[~!#$%^&*()=|{}\\':;\\'\\\\[\\\\]<>/?~！#￥……&*（）——|{}【】‘；：”“\\'。，、？]‘\\'\"\"';\n      for (let i = 0; i < str.length; i++) {\n        if (specialKey.indexOf(str.substr(i, 1)) != -1) {\n          return false;\n        }\n      }\n      return true;\n    },\n    /**\n     * 显示模态框动画结束\n     *  @param {Object}} editItem 修改项\n     */\n    show(editItem) {\n      this.editItem = JSON.parse(JSON.stringify(editItem));\n      this.title = this.editItem && this.editItem.isedit ? '编辑' : '新增';\n      this.$nextTick(() => {\n        this.$refs.ruleForm.clearValidate();\n      });\n      if (this.editItem.isedit) {\n        Object.keys(this.ruleForm).forEach(key => {\n          this.ruleForm[key] = this.editItem[key];\n        });\n      }\n      this.ruleForm.address = this.editItem.address\n        ? this.editItem.address.split(',').map(item => (item = Number(item)))\n        : [];\n      let type =\n        this.ruleForm && this.ruleForm.healthReport\n          ? this.ruleForm.healthReport.split('.')\n          : [];\n      this.imgType = type.length > 0 ? type[type.length - 1] : '';\n      this.visible = true;\n      this.getResidenceList();\n    },\n    /**\n     * 关闭模态框动画结束\n     */\n    onClosed() {\n      if (this.loading) return;\n      this.resetForm('ruleForm');\n      this.initDialogFormData();\n      this.visible = false;\n      this.$emit('close');\n    },\n    //关闭窗口前处理\n    onBeforeCloseForm(done) {\n      if (this.loading) return;\n      done();\n    },\n    //初始化新建表单的数据默认值\n    initDialogFormData() {\n      this.casIndex += 1;\n      this.ruleForm = {\n        name: '',\n        healthReport: '', // 体检报告图片\n        healthName: '',\n        cardCode: '', // 身份证号\n        projectType: '', // 工程类型\n        sex: '', // 性别\n        nationId: '', // 民族\n        address: null, // 户籍所在地\n        healthStatus: '', // 健康状况\n        studentStatus: '', // 阶段\n        comeTime: '', // 进入幸福院时间\n        leaveTime: '', // 离开幸福院时间：\n        guardianName: '', // 监护人\n        guardianPhone: '', // 监护人联系方式\n        helpMotherName: '', // 爱心妈妈姓名\n        helpMotherPhone: '', // 爱心妈妈联系方式\n        familyDetail: '' // 家庭情况\n      };\n      this.residenceList = [];\n      this.editItem = null;\n      this.pickerOptionsStart = {\n        disabledDate(time) {\n          return time.getTime() > Date.now();\n        }\n      };\n      this.pickerOptionsEnd = {\n        disabledDate(time) {\n          return time.getTime() > Date.now();\n        }\n      };\n      this.residenceList = [];\n    },\n    // 初始化数据\n    initData() {\n      this.loading = true;\n      Promise.all([\n        this.getProjectList(),\n        this.getNationList(),\n        this.getResidenceList()\n      ]).then(res => {\n        this.loading = false;\n      });\n    },\n    /**\n     * 保存表单\n     */\n    submitForm(formName) {\n      this.$refs[formName].validate(valid => {\n        if (valid) {\n          let params = null;\n          params = JSON.parse(JSON.stringify(this.ruleForm));\n          params.address = this.ruleForm.address.join(','); // 户籍所在地\n          if (params.projectType === 23) {\n            // 当工程类型是贫困英才，删除爱心妈妈姓名，爱心妈妈电话，进入幸福院时间，离开幸福院时间\n            params.helpMotherPhone = '';\n            params.helpMotherName = '';\n            params.comeTime = null;\n            params.leaveTime = null;\n          }\n          console.log(this.ruleForm, params, 'residence');\n          if (this.editItem.isedit) {\n            params.id = this.editItem.id;\n            updateStudentById(params).then(res => {\n              this.$message.success('修改成功');\n              this.onClosed();\n            });\n          } else {\n            saveStudent(params).then(res => {\n              this.$message.success('新增成功');\n              this.onClosed();\n            });\n          }\n        } else {\n          console.log('error submit!!');\n          return false;\n        }\n      });\n    },\n    /**\n     * 重置表单\n     */\n    resetForm(formName) {\n      this.$nextTick(() => {\n        this.$refs.ruleForm.clearValidate();\n      });\n      this.casIndex += 1;\n      if (this.editItem && this.editItem.isedit) {\n        Object.keys(this.ruleForm).forEach(key => {\n          this.ruleForm[key] = this.editItem[key];\n        });\n      } else {\n        this.ruleForm = {\n          name: '',\n          healthReport: '', // 体检报告图片\n          healthName: '',\n          cardCode: '', // 身份证号\n          projectType: '', // 工程类型\n          sex: '', // 性别\n          nationId: '', // 民族\n          address: null, // 户籍所在地\n          healthStatus: '', // 健康状况\n          studentStatus: '', // 阶段\n          comeTime: '', // 进入幸福院时间\n          leaveTime: '', // 离开幸福院时间：\n          guardianName: '', // 监护人\n          guardianPhone: '', // 监护人联系方式\n          helpMotherName: '', // 爱心妈妈姓名\n          helpMotherPhone: '', // 爱心妈妈联系方式\n          familyDetail: '' // 家庭情况\n        };\n        this.$nextTick(() => {\n          this.$refs.ruleForm.clearValidate();\n        });\n      }\n      this.ruleForm.address =\n        this.editItem && this.editItem.address\n          ? this.editItem.address.split(',').map(item => (item = Number(item)))\n          : [];\n      this.visible = true;\n      this.getResidenceList();\n    },\n    /**\n     * 删除提交的图片\n     */\n    deteleUpLoadImg() {\n      this.ruleForm.healthName = '';\n      this.ruleForm.healthReport = '';\n    },\n    // 获取工程列表\n    getProjectList() {\n      this.projectList = [];\n      getProjectList().then(res => {\n        this.projectList = res.data;\n      });\n    },\n    // 获取民族列表\n    getNationList() {\n      this.nationList = [];\n      getNationList().then(res => {\n        this.nationList = res.data;\n      });\n    },\n    // 获取省级列表\n    async getResidenceList() {\n      let _this = this;\n      await getProvinceList().then(async res => {\n        _this.$set(\n          _this,\n          'residenceList',\n          _this.editItem &&\n            _this.editItem.address &&\n            _this.editItem.address.length > 0\n            ? await _this.loadOptions(res.data || [])\n            : res.data\n        );\n      });\n    },\n    //递归加载子类目\n    async loadOptions(list) {\n      let _this = this;\n      let fItem = list.find(item => _this.editItem.address.includes(item.id));\n      if (fItem) {\n        await getCityList({ provinceId: fItem.id }).then(async res => {\n          list.forEach(item2 => {\n            if (item2.levelId === '3') {\n              item2['leaf'] = true;\n            }\n          });\n          _this.$set(\n            fItem,\n            'children',\n            res.data ? await _this.loadOptions(res.data) : []\n          );\n        });\n      }\n      return list;\n    },\n    // 获取子层数据\n    getChildProject(data, resolve) {\n      let params = {\n        provinceId: data.id\n      };\n      let childProjects = null;\n      getCityList(params).then(res => {\n        if (Array.isArray(res.data) && res.data.length > 0) {\n          childProjects = res.data;\n          childProjects.forEach(item => {\n            if (item.levelId === '3') {\n              item['leaf'] = true;\n            }\n          });\n        }\n        resolve(childProjects);\n      });\n    },\n    ajaxUploadSingle(file) {\n      let formData = new FormData();\n      formData.append('file', file.file);\n      formData.append('appid', 'oss54y7iu');\n      formData.append('appsecret', '1k58q6iw');\n      ajaxUploadSingle(formData).then(res => {\n        if (Number(res.code) === 8200) {\n          this.ruleForm.healthReport = res.data[0].url;\n          this.ruleForm.healthName = res.data[0].originalName;\n          let type =\n            this.ruleForm && this.ruleForm.healthReport\n              ? this.ruleForm.healthReport.split('.')\n              : [];\n          this.imgType = type.length > 0 ? type[type.length - 1] : '';\n        }\n      });\n    }\n  }\n};\n</script>\n\n<style lang=\"less\" scoped>\n.import-data-content {\n  h3 {\n    font-size: 16px;\n    color: #303133;\n  }\n  p {\n    font-size: 14px;\n    margin: 15px 0;\n  }\n}\n.demo-ruleForm {\n  display: flex;\n  flex-wrap: wrap;\n  // /deep/.el-form-item {\n  //   flex: 1;\n  // }\n  .flexbox {\n    flex: 1;\n  }\n  .Family {\n    width: 100%;\n    /deep/.el-textarea__inner {\n      height: 80px;\n    }\n  }\n  .upload {\n    .avatar-uploader /deep/.el-upload {\n      display: flex;\n      align-items: center;\n      .uploadImgBtn {\n        border: 1px dashed #d9d9d9;\n        border-radius: 6px;\n        cursor: pointer;\n        position: relative;\n        overflow: hidden;\n        .avatar-uploader-icon {\n          font-size: 28px;\n          color: #8c939d;\n          width: 60px;\n          height: 60px;\n          display: flex;\n          align-items: center;\n          justify-content: center;\n        }\n      }\n      .uploadImgBtn:hover {\n        border-color: #409eff;\n      }\n      .avatar {\n        overflow: hidden;\n        position: relative;\n        .reportbox {\n          width: 60px;\n          height: 60px;\n        }\n        img {\n          width: 100%;\n          height: 100%;\n        }\n        .deteleImg {\n          position: absolute;\n          top: 0;\n          right: 0;\n          font-size: 20px;\n          color: #000;\n        }\n      }\n      .uploadBtn {\n        margin-left: 20px;\n        text-decoration: underline;\n        color: #409eff;\n        cursor: pointer;\n      }\n    }\n  }\n  .btn-box {\n    width: 100%;\n    /deep/.el-button + .el-button {\n      margin-left: 10%;\n    }\n  }\n}\n/deep/.el-input {\n  width: 217px;\n}\n</style>\n"]}]}