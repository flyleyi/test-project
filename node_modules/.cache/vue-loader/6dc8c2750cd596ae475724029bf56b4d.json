{"remainingRequest":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/fuyueyi/Desktop/practice/mutilwap/src/pages/teaching-points-h5/components/common/wangEdit.vue?vue&type=style&index=0&lang=less&","dependencies":[{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/src/pages/teaching-points-h5/components/common/wangEdit.vue","mtime":1627979214409},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/less-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/style-resources-loader/lib/index.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCg0KLmVkaXRvciB7DQogIHBvc2l0aW9uOiByZWxhdGl2ZTsNCiAgYm9yZGVyLXRvcDogMXB4IHNvbGlkICNjZGNkY2Q7DQogIC9kZWVwLyAudy1lLW1lbnUgew0KICAgIGZvbnQtc2l6ZTogMC4yOHJlbTsNCiAgICBwYWRkaW5nOiAwLjE2cmVtIDAuMjJyZW07DQogIH0NCiAgLnctZS10ZXh0LWNvbnRhaW5lciB7DQogICAgaGVpZ2h0OiAxMDAlOw0KICAgIG1pbi1oZWlnaHQ6IDVyZW07DQogICAgLnBsYWNlaG9sZGVyIHsNCiAgICAgIHRvcDogMDsNCiAgICB9DQogIH0NCn0NCi50b29sYmFyIHsNCiAgd2lkdGg6IDEwMCU7DQogIGhlaWdodDogMC45cmVtOw0KICBib3JkZXI6IDFweCBzb2xpZCAjY2RjZGNkOw0KICBiYWNrZ3JvdW5kOiAjZjFmMWYxOw0KICBwb3NpdGlvbjogYWJzb2x1dGU7DQogIGJvdHRvbTogMDsNCiAgYm94LXNpemluZzogYm9yZGVyLWJveDsNCiAgYm9yZGVyLXRvcDogMDsNCiAgLnctZS10b29sYmFyIHsNCiAgICBoZWlnaHQ6IDEwMCU7DQogICAgYm9yZGVyLXRvcDogMXB4IHNvbGlkICNjZGNkY2Q7DQogICAgLnctZS1tZW51IHsNCiAgICAgIHBvc2l0aW9uOiBpbml0aWFsOw0KICAgICAgd2lkdGg6IDAuOHJlbTsNCiAgICAgIGhlaWdodDogMC44cmVtOw0KICAgICAgLnctZS1wYW5lbC1jb250YWluZXIgew0KICAgICAgICB0b3A6IGF1dG87DQogICAgICAgIGJvdHRvbTogMC45cmVtOw0KICAgICAgICBsZWZ0OiAwICFpbXBvcnRhbnQ7DQogICAgICAgIG1hcmdpbi1sZWZ0OiAwICFpbXBvcnRhbnQ7DQogICAgICAgIHdpZHRoOiAxMDAlICFpbXBvcnRhbnQ7DQogICAgICAgIGJvcmRlcjogMC4wMnJlbSBzb2xpZCAjY2RjZGNkOw0KICAgICAgICBib3JkZXItYm90dG9tOiAwOw0KICAgICAgICBib3JkZXItbGVmdDogMDsNCiAgICAgICAgYm9yZGVyLXJpZ2h0OiAwOw0KICAgICAgICAudy1lLXBhbmVsLXRhYi10aXRsZSB7DQogICAgICAgICAgZGlzcGxheTogbm9uZTsNCiAgICAgICAgfQ0KICAgICAgfQ0KICAgIH0NCiAgICAudy1lLWRyb3BsaXN0IHsNCiAgICAgIHRvcDogYXV0byAhaW1wb3J0YW50Ow0KICAgICAgYm90dG9tOiAwLjlyZW07DQogICAgICB3aWR0aDogMTAwJSAhaW1wb3J0YW50Ow0KICAgICAgYm9yZGVyOiAwLjAycmVtIHNvbGlkICNjY2M7DQogICAgICBib3JkZXItcmlnaHQ6IDA7DQogICAgICBib3JkZXItbGVmdDogMDsNCiAgICAgIGJvcmRlci1ib3R0b206IDA7DQogICAgICAudy1lLWRwLXRpdGxlIHsNCiAgICAgICAgYm9yZGVyLWJvdHRvbTogMC4wMnJlbSBzb2xpZCAjY2NjOw0KICAgICAgfQ0KICAgICAgdWwudy1lLWxpc3Qgew0KICAgICAgICBkaXNwbGF5OiBmbGV4Ow0KICAgICAgICBhbGlnbi1pdGVtczogY2VudGVyOw0KICAgICAgICBwYWRkaW5nOiAwLjFyZW0gMC4zcmVtOw0KICAgICAgICBmbGV4LXdyYXA6IHdyYXA7DQogICAgICAgIGxpLnctZS1pdGVtIHsNCiAgICAgICAgICBwYWRkaW5nLXJpZ2h0OiAwLjJyZW07DQogICAgICAgIH0NCiAgICAgIH0NCiAgICB9DQogIH0NCn0NCi5lZGl0b3ItdGV4dCB7DQogIGJvcmRlcjogMXB4IHNvbGlkICNjZGNkY2Q7DQogIGJvcmRlci10b3A6IDA7DQogIHRleHQtYWxpZ246IGxlZnQ7DQogIHBhZGRpbmctYm90dG9tOiAwLjlyZW07DQogIHAgew0KICAgIG1hcmdpbjogMCAhaW1wb3J0YW50Ow0KICB9DQp9DQovZGVlcC8gLnctZS10ZXh0LWNvbnRhaW5lciB7DQogIHotaW5kZXg6IDAgIWltcG9ydGFudDsNCn0NCi9kZWVwLyAudG9vbGJhciAudy1lLW1lbnUgew0KICB6LWluZGV4OiAyICFpbXBvcnRhbnQ7DQp9DQoudy1lLXRleHQgcCwNCi53LWUtdGV4dCBoMSwNCi53LWUtdGV4dCBoMiwNCi53LWUtdGV4dCBoMywNCi53LWUtdGV4dCBoNCwNCi53LWUtdGV4dCBoNSwNCi53LWUtdGV4dCB0YWJsZSwNCi53LWUtdGV4dCBwcmUgew0KICBtYXJnaW46IDAgIWltcG9ydGFudDsNCn0NCg=="},{"version":3,"sources":["wangEdit.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6KA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"wangEdit.vue","sourceRoot":"src/pages/teaching-points-h5/components/common","sourcesContent":["<template lang=\"html\">\r\n  <div class=\"editor\">\r\n    <div ref=\"toolbar\" class=\"toolbar\"></div>\r\n    <div ref=\"editor\" class=\"editor-text\"></div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport E from 'wangeditor';\r\nexport default {\r\n  name: 'editoritem',\r\n  data() {\r\n    return {\r\n      // uploadPath,\r\n      baseUpload: {},\r\n      editor: null,\r\n      info_: null,\r\n      isChange: false\r\n    };\r\n  },\r\n  model: {\r\n    prop: 'value',\r\n    event: 'change'\r\n  },\r\n  props: {\r\n    value: {\r\n      type: String,\r\n      default: ''\r\n    },\r\n    isClear: {\r\n      type: Boolean,\r\n      default: false\r\n    }\r\n  },\r\n  watch: {\r\n    isClear(val) {\r\n      // 触发清除文本域内容\r\n      if (val) {\r\n        this.editor.txt.clear();\r\n        this.info_ = null;\r\n      }\r\n    },\r\n    value: function(value) {\r\n      if (!this.isChange) {\r\n        this.editor.txt.html(this.value);\r\n      } else {\r\n        if (value !== this.editor.txt.html()) {\r\n          this.editor.txt.html(this.value);\r\n        }\r\n      }\r\n      this.isChange = false;\r\n    }\r\n    //value为编辑框输入的内容，这里我监听了一下值，当父组件调用得时候，如果给value赋值了，子组件将会显示父组件赋给的值\r\n  },\r\n  async mounted() {\r\n    await this.$store.dispatch('getUploadInfo');\r\n    this.baseUpload = this.$store.getters.baseUpload;\r\n    this.seteditor();\r\n    this.editor.txt.html(this.value);\r\n  },\r\n  methods: {\r\n    stopEditor() {\r\n      console.log('ss');\r\n      this.editor.$textElem.attr('contenteditable', false);\r\n    },\r\n    seteditor() {\r\n      // http://192.168.2.125:8080/admin/storage/create\r\n      this.editor = new E(this.$refs.toolbar, this.$refs.editor);\r\n      this.editor.config.uploadImgShowBase64 = false; // base 64 存储图片\r\n      this.editor.config.uploadImgServer = '/k12/oss/uploadFile'; // 配置服务器端地址\r\n      // this.editor.config.uploadImgHeaders = {}// 自定义 header\r\n      this.editor.config.uploadFileName = 'file'; // 后端接受上传文件的参数名\r\n      this.editor.config.uploadImgMaxSize = 2 * 1024 * 1024; // 将图片大小限制为 2M\r\n      this.editor.config.uploadImgMaxLength = 1; // 限制一次最多上传 3 张图片\r\n      this.editor.config.uploadImgTimeout = 3 * 60 * 1000; // 设置超时时间\r\n\r\n      let that = this;\r\n      this.editor.config.customUploadImg = function(resultFiles, insertImgFn) {\r\n        // resultFiles 是 input 中选中的文件列表\r\n        // insertImgFn 是获取图片 url 后，插入到编辑器的方法\r\n        // console.log('resultFiles', resultFiles);\r\n        resultFiles.forEach(item => {\r\n          let fd = new FormData();\r\n          fd.append('key', that.baseUpload.dir + item.name);\r\n          fd.append('ossAccessKeyId', that.baseUpload.accessid);\r\n          fd.append('policy', that.baseUpload.policy);\r\n          fd.append('signature', that.baseUpload.signature);\r\n          fd.append('success_action_status', '200');\r\n          fd.append('dir', that.baseUpload.dir);\r\n          fd.append('callback', that.baseUpload.callback);\r\n          fd.append('file', item);\r\n          that\r\n            .axios({\r\n              url: that.baseUpload.host,\r\n              method: 'POST',\r\n              data: fd\r\n            })\r\n            .then(res => {\r\n              let data = res.data;\r\n              // data.url = res.data.resourceUrl;\r\n              data.url = res.data.resourceUrl;\r\n              // this.formData.fileList.push(res.data); //这里上传到指定的图片服务器，成功后会返回图片的url\r\n\r\n              // 上传图片，返回结果，将图片插入到编辑器中\r\n              insertImgFn(data.url);\r\n            })\r\n            .catch(err => {});\r\n        });\r\n      };\r\n\r\n      // 配置菜单\r\n      this.editor.config.menus = [\r\n        'head', // 标题\r\n        'bold', // 粗体\r\n        'fontSize', // 字号\r\n        // 'fontName', // 字体\r\n        // 'italic', // 斜体\r\n        // 'underline', // 下划线\r\n        // 'strikeThrough', // 删除线\r\n        'foreColor', // 文字颜色\r\n        // 'backColor', // 背景颜色\r\n        // 'link', // 插入链接\r\n        // 'list', // 列表\r\n        // 'justify', // 对齐方式\r\n        // 'quote', // 引用\r\n        // 'emoticon', // 表情\r\n        'image' // 插入图片\r\n        // 'table', // 表格\r\n        // 'video', // 插入视频\r\n        // 'code', // 插入代码\r\n        // 'undo', // 撤销\r\n        // 'redo', // 重复\r\n        // 'fullscreen' // 全屏\r\n      ];\r\n\r\n      this.editor.config.uploadImgHooks = {\r\n        fail: (xhr, editor, result) => {\r\n          // 插入图片失败回调\r\n        },\r\n        success: (xhr, editor, result) => {\r\n          // 图片上传成功回调\r\n        },\r\n        timeout: (xhr, editor) => {\r\n          // 网络超时的回调\r\n        },\r\n        error: (xhr, editor) => {\r\n          // 图片上传错误的回调\r\n        },\r\n        customInsert: (insertImg, result, editor) => {\r\n          // 图片上传成功，插入图片的回调\r\n          //result为上传图片成功的时候返回的数据，这里我打印了一下发现后台返回的是data：[{url:\"路径的形式\"},...]\r\n          // insertImg()\r\n          //循环插入图片\r\n          // for (let i = 0; i < 1; i++) {\r\n          //   console.log(result)\r\n          let url = result.data.resourceUrl;\r\n          insertImg(url);\r\n          // }\r\n        }\r\n      };\r\n      this.editor.config.onchange = html => {\r\n        this.isChange = true;\r\n        this.info_ = html; // 绑定当前逐渐地值\r\n        this.$emit('change', this.info_); // 将内容同步到父组件中\r\n      };\r\n      // 创建富文本编辑器\r\n      this.editor.create();\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style lang=\"less\">\r\n.editor {\r\n  position: relative;\r\n  border-top: 1px solid #cdcdcd;\r\n  /deep/ .w-e-menu {\r\n    font-size: 0.28rem;\r\n    padding: 0.16rem 0.22rem;\r\n  }\r\n  .w-e-text-container {\r\n    height: 100%;\r\n    min-height: 5rem;\r\n    .placeholder {\r\n      top: 0;\r\n    }\r\n  }\r\n}\r\n.toolbar {\r\n  width: 100%;\r\n  height: 0.9rem;\r\n  border: 1px solid #cdcdcd;\r\n  background: #f1f1f1;\r\n  position: absolute;\r\n  bottom: 0;\r\n  box-sizing: border-box;\r\n  border-top: 0;\r\n  .w-e-toolbar {\r\n    height: 100%;\r\n    border-top: 1px solid #cdcdcd;\r\n    .w-e-menu {\r\n      position: initial;\r\n      width: 0.8rem;\r\n      height: 0.8rem;\r\n      .w-e-panel-container {\r\n        top: auto;\r\n        bottom: 0.9rem;\r\n        left: 0 !important;\r\n        margin-left: 0 !important;\r\n        width: 100% !important;\r\n        border: 0.02rem solid #cdcdcd;\r\n        border-bottom: 0;\r\n        border-left: 0;\r\n        border-right: 0;\r\n        .w-e-panel-tab-title {\r\n          display: none;\r\n        }\r\n      }\r\n    }\r\n    .w-e-droplist {\r\n      top: auto !important;\r\n      bottom: 0.9rem;\r\n      width: 100% !important;\r\n      border: 0.02rem solid #ccc;\r\n      border-right: 0;\r\n      border-left: 0;\r\n      border-bottom: 0;\r\n      .w-e-dp-title {\r\n        border-bottom: 0.02rem solid #ccc;\r\n      }\r\n      ul.w-e-list {\r\n        display: flex;\r\n        align-items: center;\r\n        padding: 0.1rem 0.3rem;\r\n        flex-wrap: wrap;\r\n        li.w-e-item {\r\n          padding-right: 0.2rem;\r\n        }\r\n      }\r\n    }\r\n  }\r\n}\r\n.editor-text {\r\n  border: 1px solid #cdcdcd;\r\n  border-top: 0;\r\n  text-align: left;\r\n  padding-bottom: 0.9rem;\r\n  p {\r\n    margin: 0 !important;\r\n  }\r\n}\r\n/deep/ .w-e-text-container {\r\n  z-index: 0 !important;\r\n}\r\n/deep/ .toolbar .w-e-menu {\r\n  z-index: 2 !important;\r\n}\r\n.w-e-text p,\r\n.w-e-text h1,\r\n.w-e-text h2,\r\n.w-e-text h3,\r\n.w-e-text h4,\r\n.w-e-text h5,\r\n.w-e-text table,\r\n.w-e-text pre {\r\n  margin: 0 !important;\r\n}\r\n</style>\r\n"]}]}