{"remainingRequest":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/src/pages/bonus-tool-admin/views/taskDetail/NotCompleteList.vue?vue&type=style&index=0&lang=less&","dependencies":[{"path":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/src/pages/bonus-tool-admin/views/taskDetail/NotCompleteList.vue","mtime":1645176309691},{"path":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/node_modules/less-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/node_modules/style-resources-loader/lib/index.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKLm5vdC1jb21wbGV0ZUxpc3QgewogIC5ib251cy1ib3ggewogICAgLmVsLWJ1dHRvbi0tcHJpbWFyeSB7CiAgICAgIG1pbi13aWR0aDogMCAhaW1wb3J0YW50OwogICAgICBwYWRkaW5nOiAzcHggOHB4ICFpbXBvcnRhbnQ7CiAgICB9CiAgfQp9Cg=="},{"version":3,"sources":["NotCompleteList.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"NotCompleteList.vue","sourceRoot":"src/pages/bonus-tool-admin/views/taskDetail","sourcesContent":["<template>\n  <!-- 任务详情查看，已办结 -->\n  <div class=\"app-container not-completeList\">\n    <div class=\"common-title\">{{ taskName }}</div>\n    <div class=\"common-container\">\n      <c-table v-loading=\"loading\" :headers=\"headers\" :data=\"tableData\" border>\n        <template slot=\"column|btns\" slot-scope=\"{ row }\">\n          <el-button\n            v-if=\"row.taskProgress === '1'\"\n            size=\"small\"\n            type=\"blue\"\n            icon=\"custom-check-icon\"\n            @click=\"onJump(row)\"\n            >查看</el-button\n          >\n          <el-button\n            v-if=\"row.taskProgress === '1'\"\n            size=\"small\"\n            type=\"red\"\n            icon=\"custom-repulse-icon\"\n            @click=\"onRepulse(row)\"\n            >打回</el-button\n          >\n          <span v-if=\"row.taskProgress !== '1'\">-</span>\n        </template>\n        <template slot=\"column|bonus\" slot-scope=\"{ row }\">\n          <div\n            class=\"bonus-box\"\n            style=\"display:flex;justify-content:space-between;align-items:center\"\n          >\n            <span>{{\n              row.bonus\n                ? formatAmountValue(row.bonus)\n                : formatNullValue(row.bonus)\n            }}</span>\n            <el-button type=\"primary\" size=\"mini\" @click=\"onEdit(row)\"\n              >修改</el-button\n            >\n          </div>\n        </template>\n      </c-table>\n    </div>\n    <el-dialog\n      title=\"奖金池额度修改为：\"\n      :visible.sync=\"dialogVisible\"\n      width=\"30%\"\n    >\n      <el-input\n        :value=\"bonus\"\n        @input=\"bonusChange\"\n        :maxlength=\"9\"\n        placeholder=\"请输入内容\"\n      ></el-input>\n      <span slot=\"footer\" class=\"dialog-footer\">\n        <el-button @click=\"dialogVisible = false\">取 消</el-button>\n        <el-button type=\"primary\" @click=\"onUpdateBonus()\">确 定</el-button>\n      </span>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport { Button, Dialog } from 'element-ui';\nimport CTable from '@/components/common/CTable';\nimport {\n  getTaskDetailList,\n  repulseSchool,\n  updateBonus\n} from '../../api/taskDetail/index';\nimport { formatNullValue, formatAmountValue } from '../../plugins/vue-filters';\nexport default {\n  name: 'NotCompleteList',\n  components: { [Button.name]: Button, CTable, [Dialog.name]: Dialog },\n  props: {},\n  data() {\n    const askProgressObj = {\n      0: '未提交',\n      1: '已提交',\n      2: '已打回'\n    };\n    return {\n      formatNullValue: formatNullValue,\n      formatAmountValue: formatAmountValue,\n      loading: true,\n      headers: [\n        {\n          label: '序号',\n          type: 'index',\n          width: 80\n        },\n        {\n          label: '校方名称',\n          prop: 'schoolName'\n        },\n        {\n          label: '奖金池额度',\n          prop: 'bonus',\n          colType: 'column',\n          slotName: 'bonus'\n        },\n        {\n          label: '当前进度',\n          prop: 'taskProgress',\n          formatter: row => {\n            return askProgressObj[row.taskProgress];\n          }\n        },\n        {\n          label: '操作',\n          prop: 'handle',\n          colType: 'column',\n          slotName: 'btns'\n        }\n      ],\n      tableData: [],\n      dialogVisible: false,\n      bonus: 0,\n      currentId: ''\n    };\n  },\n  computed: {\n    taskName() {\n      // 任务名\n      return this.$route.query.taskName;\n    }\n  },\n  watch: {},\n  created() {\n    this.getTaskDetailList();\n  },\n\n  mounted() {},\n  methods: {\n    bonusChange(val) {\n      if (val === '') {\n        this.bonus = '';\n        return;\n      }\n      if (/^[1-9]\\d*$/.test(val)) {\n        this.bonus = val;\n      }\n    },\n    onUpdateBonus() {\n      updateBonus({ id: this.currentId, bonus: this.bonus }).then(res => {\n        if (res.status === 200) {\n          this.dialogVisible = false;\n          this.$message.success(res.message);\n          this.getTaskDetailList();\n        }\n      });\n    },\n    onEdit(row) {\n      console.log(row);\n      if (row.taskProgress == 1) {\n        //已提交\n        this.$message.warning('该校已提交任务，请打回后修改奖金池额度！');\n      } else {\n        //未提交/已打回\n        this.dialogVisible = true;\n        this.bonus = row.bonus;\n        this.currentId = row.id;\n      }\n    },\n    /**\n     * 获取任务详情-未办结列表数据\n     */\n    getTaskDetailList() {\n      getTaskDetailList({ taskName: this.taskName })\n        .then(({ data }) => {\n          console.log(data);\n          this.tableData = data;\n        })\n        .finally(() => {\n          this.loading = false;\n        });\n    },\n    /**\n     * 打回\n     */\n    onRepulse(row) {\n      this.$confirm('打回后，用户需重新提交！', '提醒', {\n        confirmButtonText: '确认',\n        cancelButtonText: '取消',\n        center: true,\n        showClose: false\n      }).then(() => {\n        repulseSchool({ taskId: row.id }).then(() => {\n          this.getTaskDetailList();\n          this.$message({\n            type: 'success',\n            message: '操作成功!'\n          });\n        });\n      });\n    },\n    /**\n     * 查看\n     */\n    onJump(row) {\n      this.$router.push({\n        path: '/task-detial/single',\n        query: {\n          taskName: row.name,\n          schoolName: row.schoolName,\n          bonus: row.bonus\n        }\n      });\n    }\n  }\n};\n</script>\n\n<style lang=\"less\">\n.not-completeList {\n  .bonus-box {\n    .el-button--primary {\n      min-width: 0 !important;\n      padding: 3px 8px !important;\n    }\n  }\n}\n</style>\n"]}]}