{"remainingRequest":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/src/pages/bonus-tool-admin/views/newTask/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/src/pages/bonus-tool-admin/views/newTask/index.vue","mtime":1627979214256},{"path":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IEZvcm0sIEZvcm1JdGVtLCBJbnB1dCB9IGZyb20gJ2VsZW1lbnQtdWknOwppbXBvcnQgQ1RhYmxlIGZyb20gJ0AvY29tcG9uZW50cy9jb21tb24vQ1RhYmxlJzsKaW1wb3J0IENob29zZVJvbGUgZnJvbSAnLi9jb21wb25lbnRzL0Nob29zZVJvbGUudnVlJzsKaW1wb3J0IHsgcmVsZWFzZVRhc2sgfSBmcm9tICcuLi8uLi9hcGkvdGFzay9pbmRleCc7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnTmV3VGFzaycsCiAgY29tcG9uZW50czogewogICAgW0Zvcm0ubmFtZV06IEZvcm0sCiAgICBbRm9ybUl0ZW0ubmFtZV06IEZvcm1JdGVtLAogICAgW0lucHV0Lm5hbWVdOiBJbnB1dCwKICAgIENob29zZVJvbGUsCiAgICBDVGFibGUKICB9LAogIHByb3BzOiB7fSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgZGF0YUxvYWRpbmc6IGZhbHNlLCAvLyDmlbDmja7mj5DkuqTml7Zsb2FkaW5nCiAgICAgIGZvcm1EYXRhOiB7fSwgLy8g5o+Q5Lqk5pWw5o2uCiAgICAgIGlzUmVsZWFzZWQ6IGZhbHNlLCAvLyDpu5jorqTov5jmnKrlj5HluIMKICAgICAgaGVhZGVyczogWwogICAgICAgIHsKICAgICAgICAgIGxhYmVsOiAn5bqP5Y+3JywKICAgICAgICAgIHR5cGU6ICdpbmRleCcsCiAgICAgICAgICB3aWR0aDogODAKICAgICAgICB9LAogICAgICAgIHsKICAgICAgICAgIGxhYmVsOiAn5qCh5pa55ZCN56ewJywKICAgICAgICAgIHByb3A6ICdzY2hvb2xOYW1lJwogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgbGFiZWw6ICflhbPogZTotKblj7cnLAogICAgICAgICAgcHJvcDogJ2Fzc29jaWF0ZWRBY2NvdW50JwogICAgICAgIH0sCiAgICAgICAgewogICAgICAgICAgbGFiZWw6ICflpZbph5HmsaDpop3luqYnLAogICAgICAgICAgcHJvcDogJ2JvbnVzJywKICAgICAgICAgIGNvbFR5cGU6ICdjb2x1bW4nLAogICAgICAgICAgc2xvdE5hbWU6ICdib251cycKICAgICAgICB9CiAgICAgIF0KICAgIH07CiAgfSwKICBjb21wdXRlZDogewogICAgdGFza05hbWUoKSB7CiAgICAgIHJldHVybiB0aGlzLiRyb3V0ZS5xdWVyeS50YXNrTmFtZTsKICAgIH0KICB9LAogIHdhdGNoOiB7fSwKICBjcmVhdGVkKCkge30sCiAgbW91bnRlZCgpIHt9LAogIG1ldGhvZHM6IHsKICAgIC8qKgogICAgICog6KeS6Imy6YCJ5oupCiAgICAgKi8KICAgIG9uQ2hvb3NlUm9sZSgpIHsKICAgICAgaWYgKCF0aGlzLmlzUmVsZWFzZWQpIHsKICAgICAgICB0aGlzLiRyZWZzLmNob29zZVJvbGUuc2hvdygpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuJGFsZXJ0KCflt7Llj5HluIPvvIzkuI3lj6/ph43lpI3mk43kvZzvvIEnLCAn5o+Q6YaSJywgewogICAgICAgICAgY2FuY2VsQnV0dG9uVGV4dDogJ+ehruWumicsCiAgICAgICAgICBjZW50ZXI6IHRydWUsCiAgICAgICAgICBzaG93Q2xvc2U6IGZhbHNlCiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sCiAgICAvKioKICAgICAqIOiOt+WPluWtpuagoQogICAgICovCiAgICBnZXRDaGVja2VkU2Nob29sKHZhbCkgewogICAgICB0aGlzLiRzZXQodGhpcy5mb3JtRGF0YSwgJ3RhYmxlRGF0YScsIHZhbCk7CiAgICB9LAogICAgLyoqCiAgICAgKiDlj5HluIMKICAgICAqLwogICAgb25SZWxlYXNlKCkgewogICAgICBpZiAodGhpcy5mb3JtRGF0YS50YWJsZURhdGEgJiYgdGhpcy5mb3JtRGF0YS50YWJsZURhdGEubGVuZ3RoID4gMCkgewogICAgICAgIGxldCByZWcgPSAvXigwfFsxLTldWzAtOV17MCw4fSkkLzsKICAgICAgICBsZXQgZGF0YSA9IFtdOwogICAgICAgIGxldCBib29sID0gdGhpcy5mb3JtRGF0YS50YWJsZURhdGEuZXZlcnkoaXRlbSA9PiB7CiAgICAgICAgICBpZiAoCiAgICAgICAgICAgIGl0ZW0uYm9udXMgPT09IG51bGwgfHwKICAgICAgICAgICAgKHR5cGVvZiBpdGVtLmJvbnVzID09PSAnc3RyaW5nJyAmJiBpdGVtLmJvbnVzLmxlbmd0aCA9PT0gMCkKICAgICAgICAgICkgewogICAgICAgICAgICB0aGlzLiRhbGVydCgn5aWW6YeR5rGg6aKd5bqm5LiN5Y+v5Li656m677yBJywgJ+aPkOmGkicsIHsKICAgICAgICAgICAgICBjYW5jZWxCdXR0b25UZXh0OiAn56Gu5a6aJywKICAgICAgICAgICAgICBjZW50ZXI6IHRydWUsCiAgICAgICAgICAgICAgc2hvd0Nsb3NlOiBmYWxzZQogICAgICAgICAgICB9KTsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgfQogICAgICAgICAgbGV0IGJvbnVzID0gTnVtYmVyKHRoaXMuZGVsY29tbWFmeShpdGVtLmJvbnVzKSk7CiAgICAgICAgICBpZiAoIXJlZy50ZXN0KGJvbnVzKSkgewogICAgICAgICAgICB0aGlzLiRhbGVydCgn5aWW6YeR5rGg6aKd5bqm6ZyA5ZyoMC05OSw5OTksOTk55LmL6Ze077yBJywgJ+aPkOmGkicsIHsKICAgICAgICAgICAgICBjYW5jZWxCdXR0b25UZXh0OiAn56Gu5a6aJywKICAgICAgICAgICAgICBjZW50ZXI6IHRydWUsCiAgICAgICAgICAgICAgc2hvd0Nsb3NlOiBmYWxzZQogICAgICAgICAgICB9KTsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgfQogICAgICAgICAgZGF0YS5wdXNoKHsKICAgICAgICAgICAgLi4uaXRlbSwKICAgICAgICAgICAgYm9udXM6IGJvbnVzCiAgICAgICAgICB9KTsKICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0pOwogICAgICAgIGJvb2wgJiYKICAgICAgICAgIHRoaXMuJGNvbmZpcm0oCiAgICAgICAgICAgICfnoa7lrprlj5HluIPor6Xku7vliqHoh7PlkITljZXkvY3vvJ88YnI+5Y+R5biD5ZCO5aWW6YeR5rGg6aKd5bqm5bCG5peg5rOV5L+u5pS5JywKICAgICAgICAgICAgJ+aPkOmGkicsCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICBjb25maXJtQnV0dG9uVGV4dDogJ+ehruiupCcsCiAgICAgICAgICAgICAgY2FuY2VsQnV0dG9uVGV4dDogJ+WPlua2iCcsCiAgICAgICAgICAgICAgY2VudGVyOiB0cnVlLAogICAgICAgICAgICAgIHNob3dDbG9zZTogZmFsc2UsCiAgICAgICAgICAgICAgZGFuZ2Vyb3VzbHlVc2VIVE1MU3RyaW5nOiB0cnVlCiAgICAgICAgICAgIH0KICAgICAgICAgICkudGhlbigoKSA9PiB7CiAgICAgICAgICAgIHRoaXMuZGF0YUxvYWRpbmcgPSB0cnVlOwogICAgICAgICAgICByZWxlYXNlVGFzayhkYXRhKS50aGVuKCgpID0+IHsKICAgICAgICAgICAgICB0aGlzLiRtZXNzYWdlKHsKICAgICAgICAgICAgICAgIHR5cGU6ICdzdWNjZXNzJywKICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICflj5HluIPmiJDlip8hJwogICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgIHRoaXMuZGF0YUxvYWRpbmcgPSBmYWxzZTsKICAgICAgICAgICAgICB0aGlzLmlzUmVsZWFzZWQgPSB0cnVlOwogICAgICAgICAgICB9KTsKICAgICAgICAgIH0pOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuJGFsZXJ0KCfor7flhYjpgInmi6nlj4LkuI7op5LoibLvvIEnLCAn5o+Q6YaSJywgewogICAgICAgICAgY2FuY2VsQnV0dG9uVGV4dDogJ+ehruWumicsCiAgICAgICAgICBjZW50ZXI6IHRydWUsCiAgICAgICAgICBzaG93Q2xvc2U6IGZhbHNlCiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sCiAgICAvKioKICAgICAqIOmHkeminea3u+WKoOWNg+WIhuS9jQogICAgICovCiAgICBjb21kaWZ5KG4pIHsKICAgICAgaWYgKCFuKSByZXR1cm4gbjsKICAgICAgbGV0IHN0ciA9IG4uc3BsaXQoJy4nKTsKICAgICAgbGV0IHJlID0gL1xkezEsM30oPz0oXGR7M30pKyQpL2c7CiAgICAgIGxldCBuMSA9IHN0clswXS5yZXBsYWNlKHJlLCAnJCYsJyk7CiAgICAgIHJldHVybiBzdHIubGVuZ3RoID4gMSAmJiBzdHJbMV0gPyBgJHtuMX0uJHtzdHJbMV19YCA6IGAke24xfWA7CiAgICB9LAogICAgLyoqCiAgICAgKiDph5Hpop3liKDpmaTljYPliIbkvY0KICAgICAqLwogICAgZGVsY29tbWFmeShudW0pIHsKICAgICAgaWYgKCFudW0pIHJldHVybiBudW07CiAgICAgIG51bSA9IG51bS50b1N0cmluZygpOwogICAgICBudW0gPSBudW0ucmVwbGFjZSgvLC9naSwgJycpOwogICAgICByZXR1cm4gbnVtOwogICAgfSwKICAgIC8qKgogICAgICog5aSx54SmaW5wdXQKICAgICAqLwogICAgYmx1cklucHV0KGVsLCByb3csIGluZGV4KSB7CiAgICAgIGxldCBpbnB1dFZhbCA9IGVsLnRhcmdldC52YWx1ZSB8fCAnJzsKICAgICAgdGhpcy5mb3JtRGF0YS50YWJsZURhdGFbaW5kZXhdLmJvbnVzID0gdGhpcy5jb21kaWZ5KAogICAgICAgIHRoaXMuZGVsY29tbWFmeShpbnB1dFZhbCkKICAgICAgKTsKICAgIH0sCiAgICAvKioKICAgICAqIOiBmueEpmlucHV0CiAgICAgKi8KICAgIGZvdWN1c0lucHV0KGVsLCByb3csIGluZGV4KSB7CiAgICAgIGxldCBpbnB1dFZhbCA9IGVsLnRhcmdldC52YWx1ZSB8fCAnJzsKICAgICAgdGhpcy5mb3JtRGF0YS50YWJsZURhdGFbaW5kZXhdLmJvbnVzID0gdGhpcy5kZWxjb21tYWZ5KGlucHV0VmFsKTsKICAgIH0KICB9Cn07Cg=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/pages/bonus-tool-admin/views/newTask","sourcesContent":["<template>\n  <!-- 新建任务 -->\n  <div>\n    <div class=\"app-container\">\n      <div class=\"common-title\">{{ taskName }}</div>\n      <div class=\"common-container\">\n        <!-- 头部 -->\n        <div class=\"common-header\">\n          <div class=\"common-header-left\">\n            <el-button\n              type=\"primary\"\n              size=\"medium\"\n              @click=\"onChooseRole\"\n              class=\"common-btn my-btn\"\n            >\n              参与角色选择\n            </el-button>\n            <el-button\n              type=\"primary\"\n              size=\"medium\"\n              @click=\"onRelease\"\n              :disabled=\"isReleased\"\n            >\n              发布\n            </el-button>\n          </div>\n          <div class=\"common-header-right\"></div>\n        </div>\n        <div>\n          <el-form\n            v-loading=\"dataLoading\"\n            ref=\"elForm\"\n            :model=\"formData\"\n            size=\"mini\"\n          >\n            <c-table :headers=\"headers\" :data=\"formData.tableData\" border>\n              <template slot=\"column|bonus\" slot-scope=\"{ row, $index }\">\n                <el-form-item\n                  :prop=\"`tableData.${$index}.bonus`\"\n                  :key=\"`tableData.${$index}.bonus`\"\n                >\n                  <el-input\n                    v-model=\"row.bonus\"\n                    maxlength=\"8\"\n                    placeholder=\"手动输入\"\n                    :disabled=\"isReleased\"\n                    @blur=\"blurInput($event, row, $index)\"\n                    @focus=\"foucusInput($event, row, $index)\"\n                  ></el-input>\n                </el-form-item>\n              </template>\n            </c-table>\n          </el-form>\n        </div>\n      </div>\n      <choose-role\n        ref=\"chooseRole\"\n        :task-name=\"taskName\"\n        @checkedSchool=\"getCheckedSchool\"\n      ></choose-role>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { Form, FormItem, Input } from 'element-ui';\nimport CTable from '@/components/common/CTable';\nimport ChooseRole from './components/ChooseRole.vue';\nimport { releaseTask } from '../../api/task/index';\nexport default {\n  name: 'NewTask',\n  components: {\n    [Form.name]: Form,\n    [FormItem.name]: FormItem,\n    [Input.name]: Input,\n    ChooseRole,\n    CTable\n  },\n  props: {},\n  data() {\n    return {\n      dataLoading: false, // 数据提交时loading\n      formData: {}, // 提交数据\n      isReleased: false, // 默认还未发布\n      headers: [\n        {\n          label: '序号',\n          type: 'index',\n          width: 80\n        },\n        {\n          label: '校方名称',\n          prop: 'schoolName'\n        },\n        {\n          label: '关联账号',\n          prop: 'associatedAccount'\n        },\n        {\n          label: '奖金池额度',\n          prop: 'bonus',\n          colType: 'column',\n          slotName: 'bonus'\n        }\n      ]\n    };\n  },\n  computed: {\n    taskName() {\n      return this.$route.query.taskName;\n    }\n  },\n  watch: {},\n  created() {},\n  mounted() {},\n  methods: {\n    /**\n     * 角色选择\n     */\n    onChooseRole() {\n      if (!this.isReleased) {\n        this.$refs.chooseRole.show();\n      } else {\n        this.$alert('已发布，不可重复操作！', '提醒', {\n          cancelButtonText: '确定',\n          center: true,\n          showClose: false\n        });\n      }\n    },\n    /**\n     * 获取学校\n     */\n    getCheckedSchool(val) {\n      this.$set(this.formData, 'tableData', val);\n    },\n    /**\n     * 发布\n     */\n    onRelease() {\n      if (this.formData.tableData && this.formData.tableData.length > 0) {\n        let reg = /^(0|[1-9][0-9]{0,8})$/;\n        let data = [];\n        let bool = this.formData.tableData.every(item => {\n          if (\n            item.bonus === null ||\n            (typeof item.bonus === 'string' && item.bonus.length === 0)\n          ) {\n            this.$alert('奖金池额度不可为空！', '提醒', {\n              cancelButtonText: '确定',\n              center: true,\n              showClose: false\n            });\n            return false;\n          }\n          let bonus = Number(this.delcommafy(item.bonus));\n          if (!reg.test(bonus)) {\n            this.$alert('奖金池额度需在0-99,999,999之间！', '提醒', {\n              cancelButtonText: '确定',\n              center: true,\n              showClose: false\n            });\n            return false;\n          }\n          data.push({\n            ...item,\n            bonus: bonus\n          });\n          return true;\n        });\n        bool &&\n          this.$confirm(\n            '确定发布该任务至各单位？<br>发布后奖金池额度将无法修改',\n            '提醒',\n            {\n              confirmButtonText: '确认',\n              cancelButtonText: '取消',\n              center: true,\n              showClose: false,\n              dangerouslyUseHTMLString: true\n            }\n          ).then(() => {\n            this.dataLoading = true;\n            releaseTask(data).then(() => {\n              this.$message({\n                type: 'success',\n                message: '发布成功!'\n              });\n              this.dataLoading = false;\n              this.isReleased = true;\n            });\n          });\n      } else {\n        this.$alert('请先选择参与角色！', '提醒', {\n          cancelButtonText: '确定',\n          center: true,\n          showClose: false\n        });\n      }\n    },\n    /**\n     * 金额添加千分位\n     */\n    comdify(n) {\n      if (!n) return n;\n      let str = n.split('.');\n      let re = /\\d{1,3}(?=(\\d{3})+$)/g;\n      let n1 = str[0].replace(re, '$&,');\n      return str.length > 1 && str[1] ? `${n1}.${str[1]}` : `${n1}`;\n    },\n    /**\n     * 金额删除千分位\n     */\n    delcommafy(num) {\n      if (!num) return num;\n      num = num.toString();\n      num = num.replace(/,/gi, '');\n      return num;\n    },\n    /**\n     * 失焦input\n     */\n    blurInput(el, row, index) {\n      let inputVal = el.target.value || '';\n      this.formData.tableData[index].bonus = this.comdify(\n        this.delcommafy(inputVal)\n      );\n    },\n    /**\n     * 聚焦input\n     */\n    foucusInput(el, row, index) {\n      let inputVal = el.target.value || '';\n      this.formData.tableData[index].bonus = this.delcommafy(inputVal);\n    }\n  }\n};\n</script>\n\n<style lang=\"less\" scoped>\n// 去掉input边框线\n/deep/.el-input__inner {\n  border: 0;\n}\n// 去掉form-item的下边距\n/deep/ .el-form-item--mini.el-form-item {\n  margin-bottom: 0;\n}\n.my-btn {\n  width: 118px;\n}\n</style>\n"]}]}