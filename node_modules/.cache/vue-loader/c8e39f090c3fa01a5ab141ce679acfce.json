{"remainingRequest":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/fuyueyi/Desktop/practice/mutilwap/src/pages/logistics-data/views/UserManage/user-permission.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/src/pages/logistics-data/views/UserManage/user-permission.vue","mtime":1627979214320},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgYXhpb3MgZnJvbSAnQC9wbHVnaW5zL2F4aW9zJzsNCmltcG9ydCB7IEJ1dHRvbiwgQ2hlY2tib3gsIFRyZWUgfSBmcm9tICdlbGVtZW50LXVpJzsNCg0KZXhwb3J0IGRlZmF1bHQgew0KICBuYW1lOiAndXNlclBlcm1pc3Npb24nLA0KICAvLyDms6jlhoznu4Tku7YNCiAgY29tcG9uZW50czogew0KICAgIFtCdXR0b24ubmFtZV06IEJ1dHRvbiwNCiAgICBbQ2hlY2tib3gubmFtZV06IENoZWNrYm94LA0KICAgIFtUcmVlLm5hbWVdOiBUcmVlDQogIH0sDQogIHByb3BzOiB7DQogICAgLyoqDQogICAgICog5pyN5Yqh5Zmo57G75Z6LDQogICAgICovDQogICAgc2VydmVyVHlwZTogew0KICAgICAgdHlwZTogU3RyaW5nLA0KICAgICAgZGVmYXVsdDogJycNCiAgICB9DQogIH0sDQogIC8vIOWumuS5ieaVsOaNrg0KICBkYXRhKCkgew0KICAgIHJldHVybiB7DQogICAgICBjb25maXJtTG9hZGluZzogZmFsc2UsIC8v5Yqg6L2954q25oCBDQogICAgICBjaGVja0FsbDogZmFsc2UsIC8v5piv5ZCm5YWo6YCJDQogICAgICBmb3JtRGF0YTogew0KICAgICAgICAvL+ivpuaDheS/oeaBrw0KICAgICAgICBzdGFmZkluZm86IHsNCiAgICAgICAgICAvL+eUqOaIt+S/oeaBrw0KICAgICAgICAgIHN0YWZmTmFtZTogJycsDQogICAgICAgICAgc3RhZmZDb2RlOiAnJw0KICAgICAgICB9LA0KICAgICAgICB0cmVlOiBbXSAvL+agkeW9ouaVsOaNrg0KICAgICAgfSwNCiAgICAgIGRlZmF1bHRQcm9wczogew0KICAgICAgICAvL+abtOaUuXRyZWXplK7lgLzlkI0NCiAgICAgICAgY2hpbGRyZW46ICdjaGlsZHJlbicsDQogICAgICAgIGxhYmVsOiAnbmFtZScNCiAgICAgIH0sDQogICAgICBzYXZhRGF0YTogew0KICAgICAgICAvL+S/neWtmOaVsOaNrg0KICAgICAgICBzdGFmZkNvZGU6IHRoaXMuJHJvdXRlLnF1ZXJ5LnN0YWZmQ29kZSwNCiAgICAgICAgYXV0aExpc3Q6IFtdDQogICAgICB9LA0KICAgICAgc2VsZWN0SWRzOiBbXSAvL+WbnuaYvmlk5pWw57uEDQogICAgfTsNCiAgfSwNCiAgLy8g6K6h566X5bGe5oCnDQogIGNvbXB1dGVkOiB7fSwNCiAgLy8g5L6m5ZCs5ZmoDQogIHdhdGNoOiB7DQogICAgJyRyb3V0ZS5xdWVyeScobm93LCBvbGQpIHsNCiAgICAgIGlmICghbm93LnN0YWZmQ29kZSB8fCAhdGhpcy5zZWxlY3RJZHMpIHsNCiAgICAgICAgcmV0dXJuOw0KICAgICAgfQ0KICAgICAgdGhpcy5jaGVja0FsbCA9IGZhbHNlOw0KICAgICAgdGhpcy5nZXREYXRhKCk7DQogICAgfQ0KICB9LA0KICAvLyDliJvlu7rlrozmiJDpkqnlrZANCiAgY3JlYXRlZCgpIHsNCiAgICB0aGlzLmdldERhdGEoKTsNCiAgfSwNCiAgLy8g5oyC5Zyo5a6M5oiQ6ZKp5a2QDQogIG1vdW50ZWQoKSB7fSwNCiAgLy8g5pa55rOV5a6a5LmJDQogIG1ldGhvZHM6IHsNCiAgICBnZXREYXRhKCkgew0KICAgICAgYXhpb3MoDQogICAgICAgIHsNCiAgICAgICAgICB1cmw6ICcvZGVwYXJ0bWVudC90cmVlNFNjaG9vbCcNCiAgICAgICAgfSwNCiAgICAgICAgdGhpcy5zZXJ2ZXJUeXBlDQogICAgICApDQogICAgICAgIC50aGVuKHJlcyA9PiB7DQogICAgICAgICAgdGhpcy5mb3JtRGF0YS50cmVlID0gcmVzLmRhdGE7DQogICAgICAgICAgLy90aGlzLnNlbGVjdElkcyA9IHRoaXMuZmluZFBhdGhCeUxlYWZJZCh0aGlzLmZvcm1EYXRhLm9yZ1RyZWVJbmZvKQ0KICAgICAgICAgIHJldHVybiBheGlvcygNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgdXJsOiBgL3VzZXJNYW5hZ2Uvc2VsZWN0VXNlckF1dGgvJHt0aGlzLiRyb3V0ZS5xdWVyeS5zdGFmZkNvZGV9YA0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIHRoaXMuc2VydmVyVHlwZQ0KICAgICAgICAgICk7DQogICAgICAgIH0pDQogICAgICAgIC50aGVuKHJlcyA9PiB7DQogICAgICAgICAgdGhpcy5mb3JtRGF0YS5zdGFmZkluZm8gPSByZXMuZGF0YS5zdGFmZkluZm8gfHwge307DQogICAgICAgICAgdGhpcy5zZWxlY3RJZHMgPSByZXMuZGF0YS5zdGFmZkF1dGhTZXQgfHwgW107DQogICAgICAgICAgdGhpcy4kcmVmcy50cmVlLnNldENoZWNrZWRLZXlzKHRoaXMuc2VsZWN0SWRzKTsNCiAgICAgICAgfSk7DQogICAgfSwNCiAgICBzYXZlUGVybWlzc2lvbigpIHsNCiAgICAgIC8v5L+d5a2Y5p2D6ZmQDQogICAgICB0aGlzLmNvbmZpcm1Mb2FkaW5nID0gdHJ1ZTsNCiAgICAgIGxldCBzYXZhRGF0YSA9IHsNCiAgICAgICAgLi4udGhpcy5zYXZhRGF0YSwNCiAgICAgICAgLi4udGhpcy5mb3JtRGF0YS5zdGFmZkluZm8NCiAgICAgIH07DQogICAgICBheGlvcw0KICAgICAgICAucG9zdCgnL3VzZXJNYW5hZ2UvZWRpdFVzZXJBdXRoJywgc2F2YURhdGEsIHt9LCB0aGlzLnNlcnZlclR5cGUpDQogICAgICAgIC50aGVuKCh7IGRhdGEgfSkgPT4gew0KICAgICAgICAgIHRoaXMuY29uZmlybUxvYWRpbmcgPSBmYWxzZTsNCiAgICAgICAgICB0aGlzLiRtZXNzYWdlKHsNCiAgICAgICAgICAgIHR5cGU6ICdzdWNjZXNzJywNCiAgICAgICAgICAgIG1lc3NhZ2U6ICfphY3nva7miJDlip8nDQogICAgICAgICAgfSk7DQogICAgICAgICAgdGhpcy5nb0JhY2soKTsNCiAgICAgICAgfSkNCiAgICAgICAgLmNhdGNoKCgpID0+IHsNCiAgICAgICAgICB0aGlzLmNvbmZpcm1Mb2FkaW5nID0gZmFsc2U7DQogICAgICAgIH0pOw0KICAgIH0sDQogICAgZ29CYWNrKCkgew0KICAgICAgLy/ov5Tlm57nlKjmiLfnrqHnkIbliJfooajpobUNCiAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsNCiAgICAgICAgbmFtZTogJ0JVc2VyTWFuYWdlJw0KICAgICAgfSk7DQogICAgfSwNCiAgICBjaGFuZ2UoKSB7DQogICAgICAvL+iKgueCueWPmOWMluaXtg0KICAgICAgdGhpcy5zYXZhRGF0YS5hdXRoTGlzdCA9IHRoaXMuJHJlZnMudHJlZS5nZXRDaGVja2VkS2V5cygpOyAvLy5qb2luKCcsJykNCiAgICB9LA0KICAgIGhhbmRsZUNoZWNrQWxsQ2hhbmdlKHZhbCkgew0KICAgICAgLy/lhajpgInmiJbogIXlj5bmtojlhajpgIkNCiAgICAgIGlmICh0aGlzLmNoZWNrQWxsKSB7DQogICAgICAgIHRoaXMuJHJlZnMudHJlZS5zZXRDaGVja2VkTm9kZXModGhpcy5mb3JtRGF0YS50cmVlKTsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIHRoaXMuJHJlZnMudHJlZS5zZXRDaGVja2VkS2V5cyhbXSk7DQogICAgICB9DQogICAgICB0aGlzLnNhdmFEYXRhLmF1dGhMaXN0ID0gdGhpcy4kcmVmcy50cmVlLmdldENoZWNrZWRLZXlzKCk7IC8vLmpvaW4oJywnKQ0KICAgIH0sDQogICAgZmluZFBhdGhCeUxlYWZJZChub2Rlcykgew0KICAgICAgLy/pgInkuK3oioLngrnlm57mmL7nrZvpgIlpZCBub2Rlc+aJgOacieiKgueCuSDov5Tlm55pZOaVsOe7hA0KICAgICAgdmFyIGlkQXJyID0gW107DQogICAgICBub2Rlcy5mb3JFYWNoKChpdGVtLCBpLCBhcnIpID0+IHsNCiAgICAgICAgaXRlbS5jaGlsZGxpc3QuZm9yRWFjaCgoaXRlbTIsIGosIGFycjIpID0+IHsNCiAgICAgICAgICBpdGVtMi5jaGlsZGxpc3QuZm9yRWFjaCgoaXRlbTMsIGssIGFycjMpID0+IHsNCiAgICAgICAgICAgIGlmIChpdGVtMy5jaGVja2VkID09ICcxJykgew0KICAgICAgICAgICAgICBpZEFyci5wdXNoKGl0ZW0zLmlkKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICB9KTsNCiAgICAgICAgfSk7DQogICAgICB9KTsNCiAgICAgIHJldHVybiBpZEFycjsNCiAgICB9DQogIH0NCn07DQo="},{"version":3,"sources":["user-permission.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2CA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"user-permission.vue","sourceRoot":"src/pages/logistics-data/views/UserManage","sourcesContent":["<template>\r\n  <!-- 分配数据配置页面 -->\r\n  <div class=\"userPermission\">\r\n    <div class=\"userPermission-main \">\r\n      <div class=\"f-c userPermission-main-info\">\r\n        <div class=\"f-l\">姓名：{{ formData.staffInfo.staffName }}</div>\r\n        <div class=\"f-l\">工号：{{ formData.staffInfo.staffCode }}</div>\r\n      </div>\r\n    </div>\r\n    <div class=\"userPermission-btns\">\r\n      <el-button size=\"medium\" icon=\"el-icon-d-arrow-left\" @click=\"goBack\"\r\n        >返回</el-button\r\n      >\r\n      <el-button\r\n        size=\"medium\"\r\n        type=\"primary\"\r\n        @click=\"savePermission\"\r\n        v-loading=\"confirmLoading\"\r\n        >确认</el-button\r\n      >\r\n    </div>\r\n    <div class=\"userPermission-checkbox\">\r\n      <el-checkbox\r\n        v-model=\"checkAll\"\r\n        class=\"userPermission-checkbox-all\"\r\n        @change=\"handleCheckAllChange\"\r\n        >全选</el-checkbox\r\n      >\r\n      <el-tree\r\n        :data=\"formData.tree\"\r\n        @check=\"change\"\r\n        :props=\"defaultProps\"\r\n        :default-checked-keys=\"selectIds\"\r\n        node-key=\"id\"\r\n        ref=\"tree\"\r\n        class=\"userPermission-checkbox-tree\"\r\n        show-checkbox\r\n      ></el-tree>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from '@/plugins/axios';\r\nimport { Button, Checkbox, Tree } from 'element-ui';\r\n\r\nexport default {\r\n  name: 'userPermission',\r\n  // 注册组件\r\n  components: {\r\n    [Button.name]: Button,\r\n    [Checkbox.name]: Checkbox,\r\n    [Tree.name]: Tree\r\n  },\r\n  props: {\r\n    /**\r\n     * 服务器类型\r\n     */\r\n    serverType: {\r\n      type: String,\r\n      default: ''\r\n    }\r\n  },\r\n  // 定义数据\r\n  data() {\r\n    return {\r\n      confirmLoading: false, //加载状态\r\n      checkAll: false, //是否全选\r\n      formData: {\r\n        //详情信息\r\n        staffInfo: {\r\n          //用户信息\r\n          staffName: '',\r\n          staffCode: ''\r\n        },\r\n        tree: [] //树形数据\r\n      },\r\n      defaultProps: {\r\n        //更改tree键值名\r\n        children: 'children',\r\n        label: 'name'\r\n      },\r\n      savaData: {\r\n        //保存数据\r\n        staffCode: this.$route.query.staffCode,\r\n        authList: []\r\n      },\r\n      selectIds: [] //回显id数组\r\n    };\r\n  },\r\n  // 计算属性\r\n  computed: {},\r\n  // 侦听器\r\n  watch: {\r\n    '$route.query'(now, old) {\r\n      if (!now.staffCode || !this.selectIds) {\r\n        return;\r\n      }\r\n      this.checkAll = false;\r\n      this.getData();\r\n    }\r\n  },\r\n  // 创建完成钩子\r\n  created() {\r\n    this.getData();\r\n  },\r\n  // 挂在完成钩子\r\n  mounted() {},\r\n  // 方法定义\r\n  methods: {\r\n    getData() {\r\n      axios(\r\n        {\r\n          url: '/department/tree4School'\r\n        },\r\n        this.serverType\r\n      )\r\n        .then(res => {\r\n          this.formData.tree = res.data;\r\n          //this.selectIds = this.findPathByLeafId(this.formData.orgTreeInfo)\r\n          return axios(\r\n            {\r\n              url: `/userManage/selectUserAuth/${this.$route.query.staffCode}`\r\n            },\r\n            this.serverType\r\n          );\r\n        })\r\n        .then(res => {\r\n          this.formData.staffInfo = res.data.staffInfo || {};\r\n          this.selectIds = res.data.staffAuthSet || [];\r\n          this.$refs.tree.setCheckedKeys(this.selectIds);\r\n        });\r\n    },\r\n    savePermission() {\r\n      //保存权限\r\n      this.confirmLoading = true;\r\n      let savaData = {\r\n        ...this.savaData,\r\n        ...this.formData.staffInfo\r\n      };\r\n      axios\r\n        .post('/userManage/editUserAuth', savaData, {}, this.serverType)\r\n        .then(({ data }) => {\r\n          this.confirmLoading = false;\r\n          this.$message({\r\n            type: 'success',\r\n            message: '配置成功'\r\n          });\r\n          this.goBack();\r\n        })\r\n        .catch(() => {\r\n          this.confirmLoading = false;\r\n        });\r\n    },\r\n    goBack() {\r\n      //返回用户管理列表页\r\n      this.$router.push({\r\n        name: 'BUserManage'\r\n      });\r\n    },\r\n    change() {\r\n      //节点变化时\r\n      this.savaData.authList = this.$refs.tree.getCheckedKeys(); //.join(',')\r\n    },\r\n    handleCheckAllChange(val) {\r\n      //全选或者取消全选\r\n      if (this.checkAll) {\r\n        this.$refs.tree.setCheckedNodes(this.formData.tree);\r\n      } else {\r\n        this.$refs.tree.setCheckedKeys([]);\r\n      }\r\n      this.savaData.authList = this.$refs.tree.getCheckedKeys(); //.join(',')\r\n    },\r\n    findPathByLeafId(nodes) {\r\n      //选中节点回显筛选id nodes所有节点 返回id数组\r\n      var idArr = [];\r\n      nodes.forEach((item, i, arr) => {\r\n        item.childlist.forEach((item2, j, arr2) => {\r\n          item2.childlist.forEach((item3, k, arr3) => {\r\n            if (item3.checked == '1') {\r\n              idArr.push(item3.id);\r\n            }\r\n          });\r\n        });\r\n      });\r\n      return idArr;\r\n    }\r\n  }\r\n};\r\n</script>\r\n\r\n<style lang=\"less\" scoped>\r\n.f-l {\r\n  float: left;\r\n}\r\n.f-c:after {\r\n  visibility: hidden;\r\n  display: block;\r\n  font-size: 0;\r\n  content: ' ';\r\n  clear: both;\r\n  height: 0;\r\n}\r\n.userPermission {\r\n  background: #fff;\r\n  border-radius: 2px;\r\n  padding: 38px 32px;\r\n\r\n  font-family: 'PingFangSC-Medium', 'PingFang SC';\r\n  &-main {\r\n    padding-top: 13px;\r\n    &-info {\r\n      font-size: 15px;\r\n      font-weight: 500;\r\n      color: rgba(0, 0, 0, 0.85);\r\n      line-height: 33px;\r\n      div {\r\n        margin-right: 42px;\r\n      }\r\n    }\r\n  }\r\n  &-btns {\r\n    margin: 17px 0 32px;\r\n    button {\r\n      width: 88px;\r\n      margin-right: 30px;\r\n    }\r\n  }\r\n  &-checkbox {\r\n    margin-left: 18px;\r\n    &-all {\r\n      margin: 0 0 6px 6px;\r\n    }\r\n    /deep/.el-checkbox__label {\r\n      font-size: 12px;\r\n      color: #303133;\r\n    }\r\n    /deep/.el-tree-node__label {\r\n      font-size: 12px;\r\n      color: #303133;\r\n    }\r\n    /deep/ .el-tree-node:focus > .el-tree-node__content {\r\n      background-color: #fff;\r\n    }\r\n    /deep/ .el-tree-node__content:hover {\r\n      background-color: #fff;\r\n    }\r\n  }\r\n}\r\n</style>\r\n"]}]}