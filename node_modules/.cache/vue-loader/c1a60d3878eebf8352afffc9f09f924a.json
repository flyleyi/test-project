{"remainingRequest":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/src/pages/catering/views/order/NewOrder/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/src/pages/catering/views/order/NewOrder/index.vue","mtime":1645178321129},{"path":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgeyBmb3JtYXRJbnB1dCB9IGZyb20gJy4uLy4uL0Jhc2ljRGF0YS8vdXRpbHMuanMnOw0KaW1wb3J0IERlY2ltYWwgZnJvbSAnZGVjaW1hbC5qcyc7DQppbXBvcnQgQ0R5bmFtaWNGb3JtIGZyb20gJ0AvY29tcG9uZW50cy9jb21tb24vQ0R5bmFtaWNGb3JtJzsNCi8vIGltcG9ydCBCVGFibGUgZnJvbSAnQC9jb21wb25lbnRzL2J1c2luZXNzL0JUYWJsZSc7DQppbXBvcnQgbWVhbERheUxpc3QgZnJvbSAnLi9kYXRhJzsNCmltcG9ydCBDVGFibGUgZnJvbSAnQC9jb21wb25lbnRzL2NvbW1vbi9DVGFibGUnOw0KaW1wb3J0IHsNCiAgYmFzZVRyZWVXaXRoUG93ZXJTY2hvb2wsDQogIG9yZGVyU3RhdGlzdGljcywNCiAgZ2V0T3JkZXJEZXRhaWwsDQogIG9yZGVyQ29udGVudEZvclNlbGVjdCwNCiAgb3JkZXJDb250ZW50Rm9yU2VsZWN0SW5ncmVkaWVudCwNCiAgZGVsZXRlT3JkZXIsDQogIGRlbGV0ZU9yZGVyQ29udGVudCwNCiAgc2F2ZU9yZGVyQW5kQ29udGVudCwNCiAgYXBwcm92ZU9yZGVyLA0KICBvcmRlckNvbnRlbnRGb3JQYWdlLA0KICBzYXZlT3JkZXJCYXNlDQp9IGZyb20gJy4uLy4uLy4uL2FwaS9vcmRlci9pbmRleCc7DQppbXBvcnQgeyBnZXRJbmdyZWRpZW50VHJlZSB9IGZyb20gJy4uLy4uLy4uL2FwaS9CYXNlRGF0YS9pbmRleC5qcyc7DQppbXBvcnQgeyBoYW5kbGVNZWFsRGF0YSB9IGZyb20gJ0AvcGFnZXMvY2F0ZXJpbmcvcGx1Z2lucy9jb21tb24vdXRpbHMnOw0KaW1wb3J0IHsgY3V0TWF0Y2hTdGFuZGFyZExpc3QgfSBmcm9tICcuLi8uLi8uLi9hcGkvY3Jvd2QnOw0KDQpsZXQgaW5pdFN0YXRpc3RpY3NJbmZvID0gew0KICBjb250ZW50TnVtOiAnMC4wMCcsIC8v6K6i5Y2V5YaF5a655pWw6YePDQogIGNsZWFuVmVnZXRhYmxlV2VpZ2h0OiAnMC4wMCcsIC8v5YeA6I+c6YeN6YePDQogIG9yaWdpbmFsVmVnZXRhYmxlV2VpZ2h0OiAnMC4wMCcsIC8v5q+b6I+c5pWw6YePDQogIGNvc3RQcmljZTogJzAuMDAnLCAvL+aIkOacrOS7tw0KICBzZWxsaW5nUHJpY2U6ICcwLjAwJyAvL+WUruS7tw0KfTsNCg0KZXhwb3J0IGRlZmF1bHQgew0KICBjb21wb25lbnRzOiB7DQogICAgQ0R5bmFtaWNGb3JtLA0KICAgIC8vIEJUYWJsZSwNCiAgICBDVGFibGUNCiAgfSwNCiAgLy8g5a6a5LmJ5bGe5oCnDQogIGRhdGEoKSB7DQogICAgY29uc3QgdGFicyA9IFsNCiAgICAgIC8vIHsNCiAgICAgIC8vICAgbGFiZWw6ICfoj5zosLHph4fotK0nLA0KICAgICAgLy8gICBuYW1lOiAnbWVudScNCiAgICAgIC8vIH0sDQogICAgICB7DQogICAgICAgIGxhYmVsOiAn6I+c5ZOBJywNCiAgICAgICAgbmFtZTogJ2Rpc2gnDQogICAgICB9LA0KICAgICAgew0KICAgICAgICBsYWJlbDogJ+mjn+adkCcsDQogICAgICAgIG5hbWU6ICdpbmdyZWRpZW50cycNCiAgICAgIH0NCiAgICBdOw0KICAgIGNvbnN0IGRpYWxvZ1RhYnMgPSBbDQogICAgICAvLyB7DQogICAgICAvLyAgIGxhYmVsOiAn6I+c6LCxJywNCiAgICAgIC8vICAgbmFtZTogJ21lbnUnDQogICAgICAvLyB9LA0KICAgICAgew0KICAgICAgICBsYWJlbDogJ+iPnOWTgScsDQogICAgICAgIG5hbWU6ICdkaXNoJw0KICAgICAgfSwNCiAgICAgIHsNCiAgICAgICAgbGFiZWw6ICfpo5/mnZAnLA0KICAgICAgICBuYW1lOiAnaW5ncmVkaWVudHMnDQogICAgICB9DQogICAgXTsNCiAgICBjb25zdCB0YWJzS2V5TmFtZSA9IHsNCiAgICAgIG1lbnU6ICfoj5zosLEnLA0KICAgICAgZGlzaDogJ+iPnOWTgScsDQogICAgICBpbmdyZWRpZW50czogJ+mjn+adkCcNCiAgICB9Ow0KICAgIHJldHVybiB7DQogICAgICAvL+W9k+WJjeWunuS+iw0KICAgICAgY3VycmVudHZtOiB0aGlzLA0KICAgICAgZm9ybURhdGE6IHt9LA0KICAgICAgYXJlYUxpc3Q6IFtdLA0KICAgICAgY2l0eUxpc3Q6IFtdLA0KICAgICAgb3JkZXJTZWFyY2hUeHQ6ICcnLA0KICAgICAgZGlzdHJpY3RMaXN0OiBbXSwNCiAgICAgIHNjaG9vbExpc3Q6IFtdLA0KICAgICAgZGlzdHJpY3RDb2RlOiBudWxsLA0KICAgICAgZGlhbG9nVmlzaWJsZTogZmFsc2UsDQogICAgICBkaWFsb2dEYXRlVmlzaWJsZTogZmFsc2UsDQogICAgICBmb3JtQXR0cnM6IHsNCiAgICAgICAgaW5saW5lOiB0cnVlLA0KICAgICAgICBzaXplOiAnc21hbGwnDQogICAgICB9LA0KICAgICAgdGFiczogdGFicywNCiAgICAgIHRhYnNLZXlOYW1lOiB0YWJzS2V5TmFtZSwNCiAgICAgIGRpYWxvZ1RhYnM6IGRpYWxvZ1RhYnMsDQogICAgICBvdXRPZlN0b2NrU3RhdHVzOiBbDQogICAgICAgIHsNCiAgICAgICAgICBsYWJlbDogJ+WFqOmDqCcsDQogICAgICAgICAgdmFsdWU6ICcnDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICBsYWJlbDogJ+e8uui0pycsDQogICAgICAgICAgdmFsdWU6IDENCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgIGxhYmVsOiAnIOaciei0pycsDQogICAgICAgICAgdmFsdWU6IDANCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgIC8vIHVuc2VsZWN0VGFibGVEYXRhOiBbXSwNCiAgICAgIC8vIHNlbGVjdGVkVGFibGVEYXRhOiBbXSwNCiAgICAgIGFjdGl2ZU5hbWU6IHRhYnNbMF0ubmFtZSwNCiAgICAgIGRpYWxvZ0FjdGl2ZU5hbWU6IGRpYWxvZ1RhYnNbMF0ubmFtZSwNCiAgICAgIGRpYWxvZ0RhdGFVblNlbGVjdE9iajogew0KICAgICAgICBtZW51OiBbXSwNCiAgICAgICAgZGlzaDogW10sDQogICAgICAgIGluZ3JlZGllbnRzOiBbXQ0KICAgICAgfSwNCiAgICAgIGRpYWxvZ0RhdGFTZWxlY3RlZE9iajogew0KICAgICAgICBtZW51OiBbXSwNCiAgICAgICAgZGlzaDogW10sDQogICAgICAgIGluZ3JlZGllbnRzOiBbXQ0KICAgICAgfSwNCiAgICAgIGRpYWxvZ1Vuc2VsZWN0SW5wdXQ6ICcnLA0KICAgICAgZGlhbG9nU2VsZWN0ZWRJbnB1dDogJycsDQogICAgICBvcmRlcklkOiBudWxsLA0KICAgICAgLy/mk43kvZznsbvlnosNCiAgICAgIG9wZXJhVHlwZTogbnVsbCwNCiAgICAgIC8vIG9yZGVySWQ6IDMzLA0KICAgICAgcXVlcnlPYmplY3Q6IHsNCiAgICAgICAgaW5ncmVkaWVudHM6IDEsDQogICAgICAgIGRpc2g6IDIsDQogICAgICAgIG1lbnU6IDMNCiAgICAgIH0sDQogICAgICBkZXRhaWxJbmZvOiB7fSwNCiAgICAgIHN0YXRpc3RpY3NJbmZvOiBpbml0U3RhdGlzdGljc0luZm8sDQogICAgICBpbml0U3RhdGlzdGljc0luZm86IGluaXRTdGF0aXN0aWNzSW5mbywNCiAgICAgIC8vIG1lYWxUeXBlTGlzdDogdGhpcy4kRCgnTUVBTF9UWVBFJyksDQogICAgICBtZWFsVHlwZUxpc3Q6IFsNCiAgICAgICAgew0KICAgICAgICAgIGxhYmVsOiAn5pep6aSQJywNCiAgICAgICAgICB2YWx1ZTogMQ0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgbGFiZWw6ICfljYjppJAnLA0KICAgICAgICAgIHZhbHVlOiAyDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICBsYWJlbDogJ+aZmumkkCcsDQogICAgICAgICAgdmFsdWU6IDMNCiAgICAgICAgfQ0KICAgICAgXSwNCiAgICAgIC8v5pe26Ze06YCJ5oup5YiX6KGoDQogICAgICB0aW1lTGlzdDogWw0KICAgICAgICB7DQogICAgICAgICAgbGFiZWw6ICcwNDowMCcsDQogICAgICAgICAgdmFsdWU6ICcwNDowMCcNCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgIGxhYmVsOiAnMDY6MDAnLA0KICAgICAgICAgIHZhbHVlOiAnMDY6MDAnDQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICBsYWJlbDogJzE1OjAwJywNCiAgICAgICAgICB2YWx1ZTogJzE1OjAwJw0KICAgICAgICB9DQogICAgICBdLA0KICAgICAgd2Vla0xpc3Q6IFsNCiAgICAgICAgJ+aYn+acn+S4gCcsDQogICAgICAgICfmmJ/mnJ/kuownLA0KICAgICAgICAn5pif5pyf5LiJJywNCiAgICAgICAgJ+aYn+acn+WbmycsDQogICAgICAgICfmmJ/mnJ/kupQnLA0KICAgICAgICAn5pif5pyf5YWtJywNCiAgICAgICAgJ+aYn+acn+aXpScNCiAgICAgIF0sDQogICAgICBvcmRlclJlbWFyazogJycsDQogICAgICBpc0VtcHR5OiBmYWxzZSwgLy/mmK/lkKbkuLrnqboNCiAgICAgIC8v5by55qGG5ZCN56ew77yI5Yik5pat5by55qGG6KGo5qC877yJDQogICAgICBkaWFsb2dOYW1lOiAnJywNCiAgICAgIG1lYWxEYXlMaXN0OiBtZWFsRGF5TGlzdCwNCiAgICAgIGRpYWxvZ1RpdGxlOiAnJywNCiAgICAgIGRpYWxvZ0RhdGVSYW5nZTogJycsDQogICAgICAvL+e8uui0p+eKtuaAgQ0KICAgICAgb3V0T2ZTdG9ja1N0YXR1OiAnJywNCiAgICAgIC8v6LCD5paZ5piv5ZCm5LiL5Y2VDQogICAgICBpbmNsdWRpbmdEaXNoZXNTZWFzb25pbmc6IDAsDQogICAgICAvL+aYr+WQpuesrOS4gOasoeWIneWni+WMluWcsOWMug0KICAgICAgaXNGaXJzdEluaXQ6IHRydWUsDQogICAgICBzZWxlY3RlZEluZ3JlZGllbnRMaXN0OiBbXSwgLy/po5/mnZDlvLnmoYblj7PkvqfpgInkuK3mlbDmja4NCiAgICAgIGxlZnRJbmdyZWRpZW50RGF0YTogW10sIC8v6aOf5p2Q5by55qGG5bem5L6n5bGV56S65pWw5o2u5YyF5ousdGFi5bGV56S6DQogICAgICBsZWZ0SW5ncmVkaWVudERhdGFMaXN0OiBbXSwgLy8g6aOf5p2Q5by55qGG5bem5L6n5omA5pyJ6aOf5p2Q5pWw5o2uDQogICAgICBzaWRlQWN0aXZlOiBmYWxzZQ0KICAgICAgLy8gcGlja2VyT3B0aW9uczogew0KICAgICAgLy8gICBkaXNhYmxlZERhdGUodGltZSkgew0KICAgICAgLy8gICAgIHJldHVybiB0aW1lLmdldFRpbWUoKSA8IERhdGUubm93KCk7DQogICAgICAvLyAgIH0NCiAgICAgIC8vIH0NCiAgICB9Ow0KICB9LA0KICBmaWx0ZXJzOiB7DQogICAgZmlsdGVyV2VpZ2h0KGl0ZW0pIHsNCiAgICAgIGlmIChpdGVtLnBhY2tOdW0gPT0gbnVsbCB8fCBpdGVtLnBhY2tOdW0gPT0gJycgfHwgIWl0ZW0ubmV0V2VpZ2h0KSB7DQogICAgICAgIHJldHVybiAnLSc7DQogICAgICB9IGVsc2Ugew0KICAgICAgICByZXR1cm4gK25ldyBEZWNpbWFsKCtpdGVtLnBhY2tOdW0pLm11bChuZXcgRGVjaW1hbCgraXRlbS5uZXRXZWlnaHQpKTsNCiAgICAgIH0NCiAgICB9LA0KICAgIGZpbHRlckNvc3RQcmljZShpdGVtLCB2bSkgew0KICAgICAgaWYgKA0KICAgICAgICBpdGVtLnF1YW50aXR5ID09IG51bGwgfHwNCiAgICAgICAgaXRlbS5xdWFudGl0eSA9PSAnJyB8fA0KICAgICAgICAodm0uaW5jbHVkaW5nRGlzaGVzU2Vhc29uaW5nICYmICFpdGVtLmNvc3RQcmljZSkgfHwNCiAgICAgICAgKCF2bS5pbmNsdWRpbmdEaXNoZXNTZWFzb25pbmcgJiYgIWl0ZW0uZXhjbHVkaW5nU2Vhc29uaW5nQ29zdFByaWNlKQ0KICAgICAgKSB7DQogICAgICAgIHJldHVybiAnLSc7DQogICAgICB9IGVsc2Ugew0KICAgICAgICBjb25zdCBwcmljZSA9IHZtLmluY2x1ZGluZ0Rpc2hlc1NlYXNvbmluZw0KICAgICAgICAgID8gaXRlbS5jb3N0UHJpY2UNCiAgICAgICAgICA6IGl0ZW0uZXhjbHVkaW5nU2Vhc29uaW5nQ29zdFByaWNlOw0KICAgICAgICByZXR1cm4gK25ldyBEZWNpbWFsKCtpdGVtLnF1YW50aXR5KS5tdWwobmV3IERlY2ltYWwoK3ByaWNlKSk7DQogICAgICB9DQogICAgfSwNCiAgICBmaWx0ZXJTZWxsaW5nUHJpY2UoaXRlbSkgew0KICAgICAgaWYgKGl0ZW0ucXVhbnRpdHkgPT0gbnVsbCB8fCBpdGVtLnF1YW50aXR5ID09ICcnIHx8ICFpdGVtLnNlbGxpbmdQcmljZSkgew0KICAgICAgICByZXR1cm4gJy0nOw0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgcmV0dXJuICtuZXcgRGVjaW1hbCgraXRlbS5xdWFudGl0eSkubXVsKA0KICAgICAgICAgIG5ldyBEZWNpbWFsKCtpdGVtLnNlbGxpbmdQcmljZSkNCiAgICAgICAgKTsNCiAgICAgIH0NCiAgICB9LA0KICAgIGZpbHRlckNsZWFuVmVnZXRhYmxlUHJpY2UoaXRlbSkgew0KICAgICAgaWYgKA0KICAgICAgICBpdGVtLnBhY2tOdW0gPT0gbnVsbCB8fA0KICAgICAgICBpdGVtLnBhY2tOdW0gPT0gJycgfHwNCiAgICAgICAgIWl0ZW0uY2xlYW5WZWdldGFibGVQcmljZQ0KICAgICAgKSB7DQogICAgICAgIHJldHVybiAnLSc7DQogICAgICB9IGVsc2Ugew0KICAgICAgICByZXR1cm4gK25ldyBEZWNpbWFsKCtpdGVtLnBhY2tOdW0pLm11bCgNCiAgICAgICAgICBuZXcgRGVjaW1hbCgraXRlbS5jbGVhblZlZ2V0YWJsZVByaWNlKQ0KICAgICAgICApOw0KICAgICAgfQ0KICAgIH0sDQogICAgZmlsdGVyT3JpZ2luYWxWZWdldGFibGVQcmljZShpdGVtKSB7DQogICAgICBpZiAoDQogICAgICAgIGl0ZW0ucGFja051bSA9PSBudWxsIHx8DQogICAgICAgIGl0ZW0ucGFja051bSA9PSAnJyB8fA0KICAgICAgICAhaXRlbS5uZXRXZWlnaHQgfHwNCiAgICAgICAgIWl0ZW0ub3JpZ2luYWxWZWdldGFibGVQcmljZQ0KICAgICAgKSB7DQogICAgICAgIHJldHVybiAnLSc7DQogICAgICB9IGVsc2Ugew0KICAgICAgICByZXR1cm4gK25ldyBEZWNpbWFsKCtpdGVtLnBhY2tOdW0pDQogICAgICAgICAgLm11bCgraXRlbS5uZXRXZWlnaHQpDQogICAgICAgICAgLm11bChuZXcgRGVjaW1hbCgraXRlbS5vcmlnaW5hbFZlZ2V0YWJsZVByaWNlKSk7DQogICAgICB9DQogICAgfSwNCiAgICBmaWx0ZXJJbmdyZWRpZW50c0Nvc3RQcmljZShpdGVtKSB7DQogICAgICBpZiAoDQogICAgICAgIGl0ZW0ucGFja051bSA9PSBudWxsIHx8DQogICAgICAgIGl0ZW0ucGFja051bSA9PSAnJyB8fA0KICAgICAgICAhaXRlbS5uZXRXZWlnaHQgfHwNCiAgICAgICAgIWl0ZW0uY3V0TWF0Y2hTdGFuZGFyZElkIHx8DQogICAgICAgIChpdGVtLmN1dE1hdGNoU3RhbmRhcmRJZCA9PT0gMTAgJiYgIWl0ZW0ub3JpZ2luYWxWZWdldGFibGVQcmljZSkgfHwNCiAgICAgICAgKGl0ZW0uY3V0TWF0Y2hTdGFuZGFyZElkICE9PSAxMCAmJiAhaXRlbS5jbGVhblZlZ2V0YWJsZVByaWNlKQ0KICAgICAgKSB7DQogICAgICAgIHJldHVybiAnLSc7DQogICAgICB9IGVsc2Ugew0KICAgICAgICBjb25zdCBwcmljZSA9DQogICAgICAgICAgaXRlbS5jdXRNYXRjaFN0YW5kYXJkSWQgPT09IDEwDQogICAgICAgICAgICA/IGl0ZW0ub3JpZ2luYWxWZWdldGFibGVQcmljZQ0KICAgICAgICAgICAgOiBpdGVtLmNsZWFuVmVnZXRhYmxlUHJpY2U7DQogICAgICAgIHJldHVybiAoK25ldyBEZWNpbWFsKCtpdGVtLnBhY2tOdW0pDQogICAgICAgICAgLm11bCgraXRlbS5uZXRXZWlnaHQpDQogICAgICAgICAgLm11bChuZXcgRGVjaW1hbCgrcHJpY2UpKSkudG9GaXhlZCgyKTsNCiAgICAgIH0NCiAgICB9LA0KICAgIC8v5pep6aSQ55So6aSQ5pel5pyfKzHlpKnvvIzljYjppJDmmZrppJDnlKjppJDml6XmnJ/kuLrlvZPlpKkNCiAgICBmaWx0ZXJEaXNoTWVhbERhdGUoaXRlbSwgdm0pIHsNCiAgICAgIGlmICghaXRlbS5tZWFsVHlwZSB8fCAhaXRlbS5hcnJpdmFsRGF0ZSkgew0KICAgICAgICByZXR1cm4gJy0nOw0KICAgICAgfQ0KICAgICAgY29uc3Qgd2Vla0xpc3QgPSBbJ+WRqOaXpScsICflkajkuIAnLCAn5ZGo5LqMJywgJ+WRqOS4iScsICflkajlm5snLCAn5ZGo5LqUJywgJ+WRqOWFrSddOw0KICAgICAgbGV0IGRhdGU7DQogICAgICBsZXQgdGltZVN0YW1wOw0KICAgICAgaWYgKGl0ZW0ubWVhbFR5cGUgPT0gMSkgew0KICAgICAgICB0aW1lU3RhbXAgPSBuZXcgRGF0ZShpdGVtLmFycml2YWxEYXRlKS5nZXRUaW1lKCkgKyAxMDAwICogMzYwMCAqIDI0Ow0KICAgICAgICBkYXRlID0NCiAgICAgICAgICB2bS5mb3JtYXRlRGF0ZSh0aW1lU3RhbXApICsNCiAgICAgICAgICAnICcgKw0KICAgICAgICAgIHdlZWtMaXN0W25ldyBEYXRlKHRpbWVTdGFtcCkuZ2V0RGF5KCldOw0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgdGltZVN0YW1wID0gbmV3IERhdGUoaXRlbS5hcnJpdmFsRGF0ZSkuZ2V0VGltZSgpOw0KICAgICAgICBkYXRlID0NCiAgICAgICAgICB2bS5mb3JtYXRlRGF0ZSh0aW1lU3RhbXApICsNCiAgICAgICAgICAnICcgKw0KICAgICAgICAgIHdlZWtMaXN0W25ldyBEYXRlKHRpbWVTdGFtcCkuZ2V0RGF5KCldOw0KICAgICAgfQ0KICAgICAgaXRlbS5tZWFsRGF0ZSA9IHZtLmZvcm1hdGVEYXRlKHRpbWVTdGFtcCk7DQogICAgICByZXR1cm4gZGF0ZTsNCiAgICB9LA0KICAgIGZpbHRlckluZ3JlZGllbnRNZWFsRGF0ZShpdGVtLCB2bSkgew0KICAgICAgaWYgKCFpdGVtLmFycml2YWxEYXRlKSB7DQogICAgICAgIHJldHVybiAnLSc7DQogICAgICB9DQogICAgICBjb25zdCB3ZWVrTGlzdCA9IFsn5ZGo5pelJywgJ+WRqOS4gCcsICflkajkuownLCAn5ZGo5LiJJywgJ+WRqOWbmycsICflkajkupQnLCAn5ZGo5YWtJ107DQogICAgICBsZXQgdGltZVN0YW1wID0gbmV3IERhdGUoaXRlbS5hcnJpdmFsRGF0ZSkuZ2V0VGltZSgpOw0KICAgICAgaXRlbS5tZWFsRGF0ZSA9IHZtLmZvcm1hdGVEYXRlKHRpbWVTdGFtcCk7DQogICAgICBsZXQgZGF0ZSA9DQogICAgICAgIHZtLmZvcm1hdGVEYXRlKHRpbWVTdGFtcCkgKw0KICAgICAgICAnICcgKw0KICAgICAgICB3ZWVrTGlzdFtuZXcgRGF0ZSh0aW1lU3RhbXApLmdldERheSgpXTsNCiAgICAgIHJldHVybiBkYXRlOw0KICAgIH0NCiAgfSwNCiAgLy8g6K6h566X5bGe5oCn77yM5Lya55uR5ZCs5L6d6LWW5bGe5oCn5YC86ZqP5LmL5Y+Y5YyWDQogIGNvbXB1dGVkOiB7DQogICAgZXhwYW5kSGVhZGVycygpIHsNCiAgICAgIGxldCBsaXN0ID0gdGhpcy53ZWVrTGlzdC5tYXAoaXRlbSA9PiB7DQogICAgICAgIHJldHVybiB7DQogICAgICAgICAgbGFiZWw6IGl0ZW0sDQogICAgICAgICAgcHJvcDogaXRlbSwNCiAgICAgICAgICBjb2xUeXBlOiAnY29sdW1uJw0KICAgICAgICB9Ow0KICAgICAgfSk7DQogICAgICBsaXN0LnVuc2hpZnQoew0KICAgICAgICBsYWJlbDogJycsDQogICAgICAgIHByb3A6ICdtZWFsVHlwZVN0cmluZycNCiAgICAgIH0pOw0KICAgICAgcmV0dXJuIGxpc3Q7DQogICAgfSwNCiAgICBkaWFsb2dTZWxlY3RlZEhlYWRlcnMoKSB7DQogICAgICBsZXQgaGVhZGVycyA9IFtdOw0KICAgICAgc3dpdGNoICh0aGlzLmFjdGl2ZU5hbWUpIHsNCiAgICAgICAgY2FzZSAnbWVudSc6DQogICAgICAgICAgaGVhZGVycyA9IFsNCiAgICAgICAgICAgIC8vIHsNCiAgICAgICAgICAgIC8vICAgdHlwZTogJ3NlbGVjdGlvbicNCiAgICAgICAgICAgIC8vIH0sDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgIGxhYmVsOiAn566A5ou8JywNCiAgICAgICAgICAgICAgcHJvcDogJ3BpbnlpbkhlYWRlcicNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgIGxhYmVsOiAn6I+c6LCx5ZCN56ewJywNCiAgICAgICAgICAgICAgcHJvcDogJ3JlbGF0aW9uTmFtZScNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgIGxhYmVsOiAn6YCC55So5Lq6576kJywNCiAgICAgICAgICAgICAgcHJvcDogJ2Nyb3dkTmFtZXMnDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICBsYWJlbDogJ+aVsOmHj++8iOS7ve+8iScsDQogICAgICAgICAgICAgIHByb3A6ICdxdWFudGl0eScsDQogICAgICAgICAgICAgIGNvbFR5cGU6ICdjb2x1bW4nLA0KICAgICAgICAgICAgICBzbG90TmFtZTogJ3F1YW50aXR5SW50ZWdlcicNCiAgICAgICAgICAgIH0NCiAgICAgICAgICBdOw0KICAgICAgICAgIGJyZWFrOw0KICAgICAgICBjYXNlICdkaXNoJzoNCiAgICAgICAgICBoZWFkZXJzID0gWw0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICBsYWJlbDogJ+iPnOWTgeWQjeensCcsDQogICAgICAgICAgICAgIHByb3A6ICdyZWxhdGlvbk5hbWUnDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICBsYWJlbDogJ+aVsOmHj++8iOS7ve+8iScsDQogICAgICAgICAgICAgIHByb3A6ICdxdWFudGl0eScsDQogICAgICAgICAgICAgIGNvbFR5cGU6ICdjb2x1bW4nLA0KICAgICAgICAgICAgICBzbG90TmFtZTogJ3F1YW50aXR5SW50ZWdlcicsDQogICAgICAgICAgICAgIHdpZHRoOiAxNDANCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgIGxhYmVsOiAn5pON5L2cJywNCiAgICAgICAgICAgICAgY29sVHlwZTogJ2NvbHVtbicsDQogICAgICAgICAgICAgIHNsb3ROYW1lOiAnb3BlYXJ0aW9uJywNCiAgICAgICAgICAgICAgd2lkdGg6ICc4MCcNCiAgICAgICAgICAgIH0NCiAgICAgICAgICBdOw0KICAgICAgICAgIGJyZWFrOw0KICAgICAgICBjYXNlICdpbmdyZWRpZW50cyc6DQogICAgICAgICAgaGVhZGVycyA9IFsNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgbGFiZWw6ICfpo5/mnZDlkI3np7AnLA0KICAgICAgICAgICAgICBwcm9wOiAncmVsYXRpb25OYW1lJw0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgbGFiZWw6ICfmlbDph48nLA0KICAgICAgICAgICAgICBjb2xUeXBlOiAnY29sdW1uJywNCiAgICAgICAgICAgICAgc2xvdE5hbWU6ICdwYWNrTnVtJywNCiAgICAgICAgICAgICAgd2lkdGg6ICcxODAnDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICBsYWJlbDogJ+aTjeS9nCcsDQogICAgICAgICAgICAgIGNvbFR5cGU6ICdjb2x1bW4nLA0KICAgICAgICAgICAgICBzbG90TmFtZTogJ29wZWFydGlvbicsDQogICAgICAgICAgICAgIHdpZHRoOiAnODAnDQogICAgICAgICAgICB9DQogICAgICAgICAgICAvLyB7DQogICAgICAgICAgICAvLyAgIGxhYmVsOiAn5pWw6YeP77yIa2fvvIknLA0KICAgICAgICAgICAgLy8gICBwcm9wOiAncXVhbnRpdHknLA0KICAgICAgICAgICAgLy8gICBjb2xUeXBlOiAnY29sdW1uJywNCiAgICAgICAgICAgIC8vICAgc2xvdE5hbWU6ICdxdWFudGl0eURlY2ltYWwnDQogICAgICAgICAgICAvLyB9DQogICAgICAgICAgXTsNCiAgICAgICAgICBicmVhazsNCiAgICAgICAgZGVmYXVsdDoNCiAgICAgICAgICBicmVhazsNCiAgICAgIH0NCiAgICAgIHJldHVybiBoZWFkZXJzOw0KICAgIH0sDQogICAgZGlhbG9nSGVhZGVycygpIHsNCiAgICAgIGxldCBoZWFkZXJzID0gW107DQogICAgICBzd2l0Y2ggKHRoaXMuZGlhbG9nTmFtZSkgew0KICAgICAgICBjYXNlICdtZW51JzoNCiAgICAgICAgICBoZWFkZXJzID0gWw0KICAgICAgICAgICAgLy8gew0KICAgICAgICAgICAgLy8gICB0eXBlOiAnc2VsZWN0aW9uJw0KICAgICAgICAgICAgLy8gfSwNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgdHlwZTogJ2V4cGFuZCcsDQogICAgICAgICAgICAgIGNvbFR5cGU6ICdjb2x1bW4nLA0KICAgICAgICAgICAgICBzbG90TmFtZTogJ2V4cGFuZFRhYmxlJw0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgbGFiZWw6ICfnroDmi7wnLA0KICAgICAgICAgICAgICBwcm9wOiAncGlueWluSGVhZGVyJw0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgbGFiZWw6ICfoj5zosLHlkI3np7AnLA0KICAgICAgICAgICAgICBwcm9wOiAncmVsYXRpb25OYW1lJw0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgbGFiZWw6ICfpgILnlKjkurrnvqQnLA0KICAgICAgICAgICAgICBwcm9wOiAnY3Jvd2ROYW1lcycNCiAgICAgICAgICAgIH0NCiAgICAgICAgICBdOw0KICAgICAgICAgIGJyZWFrOw0KICAgICAgICBjYXNlICdkaXNoJzoNCiAgICAgICAgICBoZWFkZXJzID0gWw0KICAgICAgICAgICAgLy8gew0KICAgICAgICAgICAgLy8gICB0eXBlOiAnc2VsZWN0aW9uJw0KICAgICAgICAgICAgLy8gfSwNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgbGFiZWw6ICfnroDmi7wnLA0KICAgICAgICAgICAgICBwcm9wOiAncGlueWluSGVhZGVyJw0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgbGFiZWw6ICfoj5zlk4HlkI3np7AnLA0KICAgICAgICAgICAgICBwcm9wOiAncmVsYXRpb25OYW1lJywNCiAgICAgICAgICAgICAgY29sVHlwZTogJ2NvbHVtbicNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgIGxhYmVsOiAn6I+c57O7JywNCiAgICAgICAgICAgICAgcHJvcDogJ2Rpc2hlc1N0eWxlTmFtZScNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgIGxhYmVsOiAn5Lq6576kJywNCiAgICAgICAgICAgICAgcHJvcDogJ2Nyb3dkTmFtZXMnDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICBsYWJlbDogJ+aIkOacrOWPguiAg+S7t++8iOWFg++8iScsDQogICAgICAgICAgICAgIHByb3A6ICdjb3N0UHJpY2UnLA0KICAgICAgICAgICAgICB3aWR0aDogJzEyMCcNCiAgICAgICAgICAgIH0NCiAgICAgICAgICBdOw0KICAgICAgICAgIGJyZWFrOw0KICAgICAgICBjYXNlICdpbmdyZWRpZW50cyc6DQogICAgICAgICAgaGVhZGVycyA9IFsNCiAgICAgICAgICAgIC8vIHsNCiAgICAgICAgICAgIC8vICAgdHlwZTogJ3NlbGVjdGlvbicNCiAgICAgICAgICAgIC8vIH0sDQogICAgICAgICAgICAvLyB7DQogICAgICAgICAgICAvLyAgIGxhYmVsOiAn566A5ou8JywNCiAgICAgICAgICAgIC8vICAgcHJvcDogJ3BpbnlpbkhlYWRlcicNCiAgICAgICAgICAgIC8vIH0sDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgIGxhYmVsOiAn6aOf5p2Q5ZCN56ewJywNCiAgICAgICAgICAgICAgcHJvcDogJ3JlbGF0aW9uTmFtZScsDQogICAgICAgICAgICAgIGNvbFR5cGU6ICdjb2x1bW4nLA0KICAgICAgICAgICAgICBzbG90TmFtZTogJ25hbWVhbmRqaWFucGluJw0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgbGFiZWw6ICfljZXkvY0nLA0KICAgICAgICAgICAgICBwcm9wOiAncGFja1VuaXQnLA0KICAgICAgICAgICAgICB3aWR0aDogNjANCiAgICAgICAgICAgIH0NCiAgICAgICAgICBdOw0KICAgICAgICAgIGJyZWFrOw0KICAgICAgICBkZWZhdWx0Og0KICAgICAgICAgIGJyZWFrOw0KICAgICAgfQ0KICAgICAgcmV0dXJuIGhlYWRlcnM7DQogICAgfSwNCiAgICBoZWFkZXJzKCkgew0KICAgICAgbGV0IGhlYWRlcnMgPSBbXTsNCiAgICAgIHN3aXRjaCAodGhpcy5hY3RpdmVOYW1lKSB7DQogICAgICAgIGNhc2UgJ21lbnUnOg0KICAgICAgICAgIGhlYWRlcnMgPSBbDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgIGxhYmVsOiAn566A5ou8JywNCiAgICAgICAgICAgICAgcHJvcDogJ3BpbnlpbkhlYWRlcicNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgIGxhYmVsOiAn6I+c6LCx5ZCN56ewJywNCiAgICAgICAgICAgICAgcHJvcDogJ3JlbGF0aW9uTmFtZScNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgIGxhYmVsOiAn6YCC55So5Lq6576kJywNCiAgICAgICAgICAgICAgcHJvcDogJ2Nyb3dkTmFtZXMnDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICBsYWJlbDogJ+aVsOmHj++8iOS7ve+8iScsDQogICAgICAgICAgICAgIHByb3A6ICdxdWFudGl0eScNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgIGxhYmVsOiAn5oiQ5pys5Y+C6ICD5Lu377yI5YWD77yJJywNCiAgICAgICAgICAgICAgcHJvcDogJ2Nvc3RQcmljZScsDQogICAgICAgICAgICAgIC8vIHdpZHRoOiAxMDAsDQogICAgICAgICAgICAgIC8vIGFsaWduOiAncmlnaHQnLA0KICAgICAgICAgICAgICB3aWR0aDogJzEyMCcsDQogICAgICAgICAgICAgIGNvbFR5cGU6ICdjb2x1bW4nDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICBsYWJlbDogJ+WUruS7t++8iOWFg++8iScsDQogICAgICAgICAgICAgIHByb3A6ICdzZWxsaW5nUHJpY2UnLA0KICAgICAgICAgICAgICAvLyB3aWR0aDogMTAwLA0KICAgICAgICAgICAgICAvLyBhbGlnbjogJ3JpZ2h0JywNCiAgICAgICAgICAgICAgY29sVHlwZTogJ2NvbHVtbicNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgIGxhYmVsOiAn5pON5L2cJywNCiAgICAgICAgICAgICAgY29sVHlwZTogJ2J0bnMnLA0KICAgICAgICAgICAgICAvLyBmaXhlZDogJ3JpZ2h0JywNCiAgICAgICAgICAgICAgd2lkdGg6ICcxMjBweCcsDQogICAgICAgICAgICAgIGJ0bnM6IFsNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICBsYWJlbDogJ+e8lui+kScsDQogICAgICAgICAgICAgICAgICB0eXBlOiAndGV4dCcsDQogICAgICAgICAgICAgICAgICBzaXplOiAnbWluaScsDQogICAgICAgICAgICAgICAgICBjbGljazogdGhpcy5lZGl0Q3Jvd2QNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgIGxhYmVsOiAn5Yig6ZmkJywNCiAgICAgICAgICAgICAgICAgIHR5cGU6ICd0ZXh0JywNCiAgICAgICAgICAgICAgICAgIHNpemU6ICdtaW5pJywNCiAgICAgICAgICAgICAgICAgIGNsaWNrOiB0aGlzLmRlbGV0ZUNyb3dkDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICBdDQogICAgICAgICAgICB9DQogICAgICAgICAgXTsNCiAgICAgICAgICBicmVhazsNCiAgICAgICAgY2FzZSAnZGlzaCc6DQogICAgICAgICAgaGVhZGVycyA9IFsNCiAgICAgICAgICAgIC8vIHsNCiAgICAgICAgICAgIC8vICAgbGFiZWw6ICfnroDmi7wnLA0KICAgICAgICAgICAgLy8gICBwcm9wOiAncGlueWluSGVhZGVyJw0KICAgICAgICAgICAgLy8gfSwNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgbGFiZWw6ICfluo/lj7cnLA0KICAgICAgICAgICAgICBhbGlnbjogJ2NlbnRlcicsDQogICAgICAgICAgICAgIHR5cGU6ICdpbmRleCcNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgIGxhYmVsOiAn55So6aSQ5pel5pyfJywNCiAgICAgICAgICAgICAgY29sVHlwZTogJ2NvbHVtbicsDQogICAgICAgICAgICAgIHNsb3ROYW1lOiAnbWVhbERhdGUnDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICBsYWJlbDogJ+iPnOWTgeWQjeensCcsDQogICAgICAgICAgICAgIHByb3A6ICdyZWxhdGlvbk5hbWUnLA0KICAgICAgICAgICAgICBjb2xUeXBlOiAnY29sdW1uJw0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgbGFiZWw6ICfoj5zns7snLA0KICAgICAgICAgICAgICBwcm9wOiAnZGlzaGVzU3R5bGVOYW1lJw0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgbGFiZWw6ICfkurrnvqQnLA0KICAgICAgICAgICAgICBwcm9wOiAnY3Jvd2ROYW1lcycNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgIGxhYmVsOiAn6aSQ5YirJywNCiAgICAgICAgICAgICAgcHJvcDogJ21lYWxUeXBlJywNCiAgICAgICAgICAgICAgY29sVHlwZTogJ2NvbHVtbicsDQogICAgICAgICAgICAgIHdpZHRoOiAnMTAwcHgnDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICBsYWJlbDogJ+aVsOmHj++8iOS7ve+8iScsDQogICAgICAgICAgICAgIHByb3A6ICdxdWFudGl0eScsDQogICAgICAgICAgICAgIGNvbFR5cGU6ICdjb2x1bW4nLA0KICAgICAgICAgICAgICBzbG90TmFtZTogJ3F1YW50aXR5SW50ZWdlcicsDQogICAgICAgICAgICAgIHdpZHRoOiAnMTAwcHgnDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICBsYWJlbDogJ+WIsOi0p+aXtumXtCcsDQogICAgICAgICAgICAgIGNvbFR5cGU6ICdjb2x1bW4nLA0KICAgICAgICAgICAgICBzbG90TmFtZTogJ2Fycml2YWxEYXRlJywNCiAgICAgICAgICAgICAgd2lkdGg6ICcyNTBweCcNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgIGxhYmVsOiAn5oiQ5pys5Y+C6ICD5Lu377yI5YWD77yJJywNCiAgICAgICAgICAgICAgcHJvcDogJ2Nvc3RQcmljZScsDQogICAgICAgICAgICAgIHdpZHRoOiAxMjAsDQogICAgICAgICAgICAgIC8vIGFsaWduOiAncmlnaHQnLA0KICAgICAgICAgICAgICBjb2xUeXBlOiAnY29sdW1uJw0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgbGFiZWw6ICfllK7ku7fvvIjlhYPvvIknLA0KICAgICAgICAgICAgICBwcm9wOiAnc2VsbGluZ1ByaWNlJywNCiAgICAgICAgICAgICAgd2lkdGg6IDEwMCwNCiAgICAgICAgICAgICAgLy8gYWxpZ246ICdyaWdodCcsDQogICAgICAgICAgICAgIGNvbFR5cGU6ICdjb2x1bW4nDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICBsYWJlbDogJ+aTjeS9nCcsDQogICAgICAgICAgICAgIGNvbFR5cGU6ICdidG5zJywNCiAgICAgICAgICAgICAgLy8gZml4ZWQ6ICdyaWdodCcsDQogICAgICAgICAgICAgIHdpZHRoOiAnMTIwcHgnLA0KICAgICAgICAgICAgICBidG5zOiBbDQogICAgICAgICAgICAgICAgLy8gew0KICAgICAgICAgICAgICAgIC8vICAgbGFiZWw6ICfnvJbovpEnLA0KICAgICAgICAgICAgICAgIC8vICAgdHlwZTogJ3RleHQnLA0KICAgICAgICAgICAgICAgIC8vICAgc2l6ZTogJ21pbmknLA0KICAgICAgICAgICAgICAgIC8vICAgY2xpY2s6IHRoaXMuZWRpdENyb3dkDQogICAgICAgICAgICAgICAgLy8gfSwNCiAgICAgICAgICAgICAgICB7DQogICAgICAgICAgICAgICAgICBsYWJlbDogJ+WIoOmZpCcsDQogICAgICAgICAgICAgICAgICB0eXBlOiAndGV4dCcsDQogICAgICAgICAgICAgICAgICBzaXplOiAnbWluaScsDQogICAgICAgICAgICAgICAgICBjbGljazogdGhpcy5kZWxldGVDcm93ZA0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgXQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgIF07DQogICAgICAgICAgYnJlYWs7DQogICAgICAgIGNhc2UgJ2luZ3JlZGllbnRzJzoNCiAgICAgICAgICBoZWFkZXJzID0gWw0KICAgICAgICAgICAgLy8gew0KICAgICAgICAgICAgLy8gICBsYWJlbDogJ+eugOaLvCcsDQogICAgICAgICAgICAvLyAgIHByb3A6ICdwaW55aW5IZWFkZXInDQogICAgICAgICAgICAvLyB9LA0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICBsYWJlbDogJ+W6j+WPtycsDQogICAgICAgICAgICAgIGFsaWduOiAnY2VudGVyJywNCiAgICAgICAgICAgICAgdHlwZTogJ2luZGV4Jw0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgbGFiZWw6ICfnlKjppJDml6XmnJ8nLA0KICAgICAgICAgICAgICBjb2xUeXBlOiAnY29sdW1uJywNCiAgICAgICAgICAgICAgc2xvdE5hbWU6ICdpbmdyZWRpZW50RGF0ZScNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgIGxhYmVsOiAn6aOf5p2Q5ZCN56ewJywNCiAgICAgICAgICAgICAgcHJvcDogJ3JlbGF0aW9uTmFtZScsDQogICAgICAgICAgICAgIGNvbFR5cGU6ICdjb2x1bW4nDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgLy8gew0KICAgICAgICAgICAgLy8gICBsYWJlbDogJ+WIh+mFjeagh+WHhu+8iOmVvyrlrr0q6auYL2Nt77yJJywNCiAgICAgICAgICAgIC8vICAgY29sVHlwZTogJ2NvbHVtbicsDQogICAgICAgICAgICAvLyAgIHNsb3ROYW1lOiAnY3V0TWF0Y2hTdGFuZGFyZElkJywNCiAgICAgICAgICAgIC8vICAgd2lkdGg6ICcxODAnDQogICAgICAgICAgICAvLyB9LA0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICBsYWJlbDogJ+aVsOmHjycsDQogICAgICAgICAgICAgIGNvbFR5cGU6ICdjb2x1bW4nLA0KICAgICAgICAgICAgICBzbG90TmFtZTogJ3BhY2tOdW0nLA0KICAgICAgICAgICAgICB3aWR0aDogJzE2MCcNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgIGxhYmVsOiAn5YeA6YeN77yIa2fvvIknLA0KICAgICAgICAgICAgICBwcm9wOiAnbmV0V2VpZ2h0JywNCiAgICAgICAgICAgICAgd2lkdGg6ICcxMDAnDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgew0KICAgICAgICAgICAgICBsYWJlbDogJ+aAu+mHjemHj++8iGtn77yJJywNCiAgICAgICAgICAgICAgY29sVHlwZTogJ2NvbHVtbicsDQogICAgICAgICAgICAgIHNsb3ROYW1lOiAncXVhbnRpdHlBbGwnLA0KICAgICAgICAgICAgICB3aWR0aDogJzEwMCcNCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgIGxhYmVsOiAn5Yiw6LSn5pe26Ze0JywNCiAgICAgICAgICAgICAgY29sVHlwZTogJ2NvbHVtbicsDQogICAgICAgICAgICAgIHNsb3ROYW1lOiAnYXJyaXZhbERhdGUnLA0KICAgICAgICAgICAgICB3aWR0aDogJzI1MHB4Jw0KICAgICAgICAgICAgfSwNCiAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgbGFiZWw6ICfmiJDmnKzlj4LogIPku7fvvIjlhYPvvIknLA0KICAgICAgICAgICAgICBwcm9wOiAnIGNvc3RQcmljZScsDQogICAgICAgICAgICAgIHdpZHRoOiAnMTIwJywNCiAgICAgICAgICAgICAgY29sVHlwZTogJ2NvbHVtbicsDQogICAgICAgICAgICAgIHNsb3ROYW1lOiAnaW5ncmVkaWVudHNDb3N0UHJpY2UnDQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgLy8gew0KICAgICAgICAgICAgLy8gICBsYWJlbDogJ+WHgOiPnOS7t+agvO+8iOWFg++8iScsDQogICAgICAgICAgICAvLyAgIHByb3A6ICdjbGVhblZlZ2V0YWJsZVByaWNlJywNCiAgICAgICAgICAgIC8vICAgd2lkdGg6ICcxMTAnLA0KICAgICAgICAgICAgLy8gICBjb2xUeXBlOiAnY29sdW1uJw0KICAgICAgICAgICAgLy8gfSwNCiAgICAgICAgICAgIC8vIHsNCiAgICAgICAgICAgIC8vICAgbGFiZWw6ICfmr5voj5zku7fmoLzvvIjlhYPvvIknLA0KICAgICAgICAgICAgLy8gICBwcm9wOiAnb3JpZ2luYWxWZWdldGFibGVQcmljZScsDQogICAgICAgICAgICAvLyAgIHdpZHRoOiAnMTEwJywNCiAgICAgICAgICAgIC8vICAgY29sVHlwZTogJ2NvbHVtbicNCiAgICAgICAgICAgIC8vIH0sDQogICAgICAgICAgICB7DQogICAgICAgICAgICAgIGxhYmVsOiAn5pON5L2cJywNCiAgICAgICAgICAgICAgY29sVHlwZTogJ2J0bnMnLA0KICAgICAgICAgICAgICAvLyBmaXhlZDogJ3JpZ2h0JywNCiAgICAgICAgICAgICAgd2lkdGg6ICcxMjBweCcsDQogICAgICAgICAgICAgIGJ0bnM6IFsNCiAgICAgICAgICAgICAgICAvLyB7DQogICAgICAgICAgICAgICAgLy8gICBsYWJlbDogJ+e8lui+kScsDQogICAgICAgICAgICAgICAgLy8gICB0eXBlOiAndGV4dCcsDQogICAgICAgICAgICAgICAgLy8gICBzaXplOiAnbWluaScsDQogICAgICAgICAgICAgICAgLy8gICBjbGljazogdGhpcy5lZGl0Q3Jvd2QNCiAgICAgICAgICAgICAgICAvLyB9LA0KICAgICAgICAgICAgICAgIHsNCiAgICAgICAgICAgICAgICAgIGxhYmVsOiAn5Yig6ZmkJywNCiAgICAgICAgICAgICAgICAgIHR5cGU6ICd0ZXh0JywNCiAgICAgICAgICAgICAgICAgIHNpemU6ICdtaW5pJywNCiAgICAgICAgICAgICAgICAgIGNsaWNrOiB0aGlzLmRlbGV0ZUNyb3dkDQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICBdDQogICAgICAgICAgICB9DQogICAgICAgICAgXTsNCiAgICAgICAgICBicmVhazsNCiAgICAgICAgZGVmYXVsdDoNCiAgICAgICAgICBicmVhazsNCiAgICAgIH0NCiAgICAgIHJldHVybiBoZWFkZXJzOw0KICAgIH0sDQogICAgZm9ybUl0ZW1zKCkgew0KICAgICAgcmV0dXJuIFsNCiAgICAgICAgew0KICAgICAgICAgIHR5cGU6ICdzZWxlY3QnLA0KICAgICAgICAgIGxhYmVsOiAn6K6i5Y2V5Yib5bu657uZJywNCiAgICAgICAgICBwcm9wOiAncHJvdmluY2VDb2RlJywNCiAgICAgICAgICB2YWx1ZUtleTogJ2NvZGUnLA0KICAgICAgICAgIGxhYmVsS2V5OiAnbmFtZScsDQogICAgICAgICAgLy8gbGFiZWxQcm9wOiAncHJvdmluY2VOYW1lJywNCg0KICAgICAgICAgIG9wdGlvbnM6IHRoaXMuYXJlYUxpc3QsDQogICAgICAgICAgYXR0cnM6IHsNCiAgICAgICAgICAgIHBsYWNlaG9sZGVyOiAn55yB5Lu9JywNCiAgICAgICAgICAgIGNsZWFyYWJsZTogdHJ1ZQ0KICAgICAgICAgIH0NCiAgICAgICAgICAvLyBhamF4OiBtb2RlbCA9PiB7DQogICAgICAgICAgLy8gICByZXR1cm4gYmFzZVRyZWUoKTsNCiAgICAgICAgICAvLyB9DQogICAgICAgIH0sDQogICAgICAgIHsNCiAgICAgICAgICB0eXBlOiAnc2VsZWN0JywNCiAgICAgICAgICAvLyBsYWJlbDogJ+WcsOe6p+W4gu+8micsDQogICAgICAgICAgcHJvcDogJ2NpdHlDb2RlJywNCiAgICAgICAgICBwYXJlbnRQcm9wOiAncHJvdmluY2VDb2RlJywNCiAgICAgICAgICAvLyBsYWJlbFByb3A6ICdjaXR5TmFtZScsDQogICAgICAgICAgdmFsdWVLZXk6ICdjb2RlJywNCiAgICAgICAgICBsYWJlbEtleTogJ25hbWUnLA0KICAgICAgICAgIGF0dHJzOiB7DQogICAgICAgICAgICBwbGFjZWhvbGRlcjogJ+WcsOe6p+W4gicsDQogICAgICAgICAgICBjbGVhcmFibGU6IHRydWUNCiAgICAgICAgICB9LA0KICAgICAgICAgIC8vIG9wdGlvbnM6IHRoaXMuY2l0eUxpc3QsDQogICAgICAgICAgYWpheDogbW9kZWwgPT4gew0KICAgICAgICAgICAgbGV0IHJlc3VsdCA9IHRoaXMuZ2V0Q2l0eUxpc3QobW9kZWwucHJvdmluY2VDb2RlKTsNCiAgICAgICAgICAgIGlmICgNCiAgICAgICAgICAgICAgIXRoaXMub3JkZXJJZCAmJg0KICAgICAgICAgICAgICB0aGlzLiRoYXMoWydvcmRlci1kZWZhdWx0LWZpcnN0J10pICYmDQogICAgICAgICAgICAgIHJlc3VsdCAmJg0KICAgICAgICAgICAgICByZXN1bHQubGVuZ3RoICYmDQogICAgICAgICAgICAgIHRoaXMuaXNGaXJzdEluaXQNCiAgICAgICAgICAgICkgew0KICAgICAgICAgICAgICAvLyBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAgICAgICAgICAgdGhpcy4kcmVmcy5jRHluYW1pY0Zvcm0uc2V0TW9kZWxEYXRhKCdjaXR5Q29kZScsIHJlc3VsdFswXS5jb2RlKTsNCiAgICAgICAgICAgICAgLy8gfSk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7DQogICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0KTsNCiAgICAgICAgICAgIH0pOw0KICAgICAgICAgIH0NCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgIHR5cGU6ICdzZWxlY3QnLA0KICAgICAgICAgIC8vIGxhYmVsOiAn5Yy6L+WOv++8micsDQogICAgICAgICAgcHJvcDogJ2Rpc3RyaWN0Q29kZScsDQogICAgICAgICAgcGFyZW50UHJvcDogJ2NpdHlDb2RlJywNCiAgICAgICAgICBhdHRyczogew0KICAgICAgICAgICAgcGxhY2Vob2xkZXI6ICfljLov5Y6/JywNCiAgICAgICAgICAgIGNsZWFyYWJsZTogdHJ1ZQ0KICAgICAgICAgIH0sDQogICAgICAgICAgLy8gbGFiZWxQcm9wOiAnZGlzdHJpY3ROYW1lJywNCiAgICAgICAgICAvLyBvcHRpb25zOiB0aGlzLmRpc3RyaWN0TGlzdCwNCiAgICAgICAgICB2YWx1ZUtleTogJ2NvZGUnLA0KICAgICAgICAgIGxhYmVsS2V5OiAnbmFtZScsDQogICAgICAgICAgYWpheDogbW9kZWwgPT4gew0KICAgICAgICAgICAgbGV0IHJlc3VsdCA9IHRoaXMuZ2V0Q291bnR5TGlzdChtb2RlbC5jaXR5Q29kZSk7DQogICAgICAgICAgICBpZiAodGhpcy5vcmRlcklkKSB7DQogICAgICAgICAgICAgIHRoaXMuJHJlZnMuYlRhYmxlICYmDQogICAgICAgICAgICAgICAgdGhpcy4kcmVmcy5iVGFibGVbMF0gJiYNCiAgICAgICAgICAgICAgICB0aGlzLiRyZWZzLmJUYWJsZVswXS5hamF4R2V0VGFibGVEYXRhQnlQYWdlKCk7DQogICAgICAgICAgICAgIHRoaXMub3JkZXJTdGF0aXN0aWNzKCk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBpZiAoDQogICAgICAgICAgICAgICF0aGlzLm9yZGVySWQgJiYNCiAgICAgICAgICAgICAgdGhpcy4kaGFzKFsnb3JkZXItZGVmYXVsdC1maXJzdCddKSAmJg0KICAgICAgICAgICAgICByZXN1bHQgJiYNCiAgICAgICAgICAgICAgcmVzdWx0Lmxlbmd0aCAmJg0KICAgICAgICAgICAgICB0aGlzLmlzRmlyc3RJbml0DQogICAgICAgICAgICApIHsNCiAgICAgICAgICAgICAgLy8gc2V0VGltZW91dCgoKSA9PiB7DQogICAgICAgICAgICAgIHRoaXMuJHJlZnMuY0R5bmFtaWNGb3JtLnNldE1vZGVsRGF0YSgNCiAgICAgICAgICAgICAgICAnZGlzdHJpY3RDb2RlJywNCiAgICAgICAgICAgICAgICByZXN1bHRbMF0uY29kZQ0KICAgICAgICAgICAgICApOw0KICAgICAgICAgICAgICAvLyB9KTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHsNCiAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQpOw0KICAgICAgICAgICAgfSk7DQogICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgdHlwZTogJ3NlbGVjdCcsDQogICAgICAgICAgLy8gbGFiZWw6ICfljLov5Y6/77yaJywNCiAgICAgICAgICBwcm9wOiAnc2Nob29sQ29kZScsDQogICAgICAgICAgcGFyZW50UHJvcDogJ2Rpc3RyaWN0Q29kZScsDQogICAgICAgICAgYXR0cnM6IHsNCiAgICAgICAgICAgIHBsYWNlaG9sZGVyOiAn5a2m5qChJywNCiAgICAgICAgICAgIGNsZWFyYWJsZTogdHJ1ZQ0KICAgICAgICAgIH0sDQogICAgICAgICAgLy8gbGFiZWxQcm9wOiAnZGlzdHJpY3ROYW1lJywNCiAgICAgICAgICAvLyBvcHRpb25zOiB0aGlzLmRpc3RyaWN0TGlzdCwNCiAgICAgICAgICB2YWx1ZUtleTogJ2lkJywNCiAgICAgICAgICBsYWJlbEtleTogJ25hbWUnLA0KICAgICAgICAgIGFqYXg6IG1vZGVsID0+IHsNCiAgICAgICAgICAgIGxldCByZXN1bHQgPSB0aGlzLmdldFNjaG9vbExpc3QobW9kZWwuZGlzdHJpY3RDb2RlKTsNCiAgICAgICAgICAgIGlmICgNCiAgICAgICAgICAgICAgIXRoaXMub3JkZXJJZCAmJg0KICAgICAgICAgICAgICB0aGlzLiRoYXMoWydvcmRlci1kZWZhdWx0LWZpcnN0J10pICYmDQogICAgICAgICAgICAgIHJlc3VsdCAmJg0KICAgICAgICAgICAgICByZXN1bHQubGVuZ3RoICYmDQogICAgICAgICAgICAgIHRoaXMuaXNGaXJzdEluaXQNCiAgICAgICAgICAgICkgew0KICAgICAgICAgICAgICAvLyBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAgICAgICAgICAgdGhpcy4kcmVmcy5jRHluYW1pY0Zvcm0uc2V0TW9kZWxEYXRhKCdzY2hvb2xDb2RlJywgcmVzdWx0WzBdLmlkKTsNCiAgICAgICAgICAgICAgLy8gfSk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7DQogICAgICAgICAgICAgIHJlc29sdmUocmVzdWx0KTsNCiAgICAgICAgICAgIH0pOw0KICAgICAgICAgIH0NCiAgICAgICAgfSwNCiAgICAgICAgew0KICAgICAgICAgIHR5cGU6ICdzZWxlY3QnLA0KICAgICAgICAgIC8vIGxhYmVsOiAn5Yy6L+WOv++8micsDQogICAgICAgICAgcHJvcDogJ3NjaG9vbEJyYW5jaENvZGUnLA0KICAgICAgICAgIHBhcmVudFByb3A6ICdzY2hvb2xDb2RlJywNCiAgICAgICAgICBhdHRyczogew0KICAgICAgICAgICAgcGxhY2Vob2xkZXI6ICflrabpg6gnLA0KICAgICAgICAgICAgY2xlYXJhYmxlOiB0cnVlDQogICAgICAgICAgfSwNCiAgICAgICAgICAvLyBsYWJlbFByb3A6ICdkaXN0cmljdE5hbWUnLA0KICAgICAgICAgIC8vIG9wdGlvbnM6IHRoaXMuZGlzdHJpY3RMaXN0LA0KICAgICAgICAgIHZhbHVlS2V5OiAnaWQnLA0KICAgICAgICAgIGxhYmVsS2V5OiAnbmFtZScsDQogICAgICAgICAgYWpheDogbW9kZWwgPT4gew0KICAgICAgICAgICAgbGV0IHJlc3VsdCA9IHRoaXMuZ2V0U2Nob29sQnJhbmNoTGlzdChtb2RlbC5zY2hvb2xDb2RlKTsNCiAgICAgICAgICAgIGlmICgNCiAgICAgICAgICAgICAgIXRoaXMub3JkZXJJZCAmJg0KICAgICAgICAgICAgICB0aGlzLiRoYXMoWydvcmRlci1kZWZhdWx0LWZpcnN0J10pICYmDQogICAgICAgICAgICAgIHJlc3VsdCAmJg0KICAgICAgICAgICAgICByZXN1bHQubGVuZ3RoICYmDQogICAgICAgICAgICAgIHRoaXMuaXNGaXJzdEluaXQNCiAgICAgICAgICAgICkgew0KICAgICAgICAgICAgICAvLyBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAgICAgICAgICAgdGhpcy4kcmVmcy5jRHluYW1pY0Zvcm0uc2V0TW9kZWxEYXRhKA0KICAgICAgICAgICAgICAgICdzY2hvb2xCcmFuY2hDb2RlJywNCiAgICAgICAgICAgICAgICByZXN1bHRbMF0uaWQNCiAgICAgICAgICAgICAgKTsNCiAgICAgICAgICAgICAgdGhpcy5pc0ZpcnN0SW5pdCA9IGZhbHNlOw0KICAgICAgICAgICAgICAvLyB9KTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHsNCiAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHQpOw0KICAgICAgICAgICAgfSk7DQogICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgdHlwZTogJ3NlbGVjdCcsDQogICAgICAgICAgcHJvcDogJ29yZGVyU3RhdHVzJywNCiAgICAgICAgICBsYWJlbDogJ+iuouWNleaAp+i0qCcsDQogICAgICAgICAgYXR0cnM6IHsNCiAgICAgICAgICAgIHBsYWNlaG9sZGVyOiAn6K6i5Y2V5oCn6LSoJywNCiAgICAgICAgICAgIGNsZWFyYWJsZTogdHJ1ZQ0KICAgICAgICAgIH0sDQogICAgICAgICAgb3B0aW9uczogdGhpcy4kRCgnT1JERVJfVFlQRScpDQogICAgICAgICAgLy8gb3B0aW9uczogWw0KICAgICAgICAgIC8vICAgew0KICAgICAgICAgIC8vICAgICBsYWJlbDogJ+W4uOinhCcsDQogICAgICAgICAgLy8gICAgIHZhbHVlOiAxDQogICAgICAgICAgLy8gICB9LA0KICAgICAgICAgIC8vICAgew0KICAgICAgICAgIC8vICAgICBsYWJlbDogJ+e0p+aApScsDQogICAgICAgICAgLy8gICAgIHZhbHVlOiAyDQogICAgICAgICAgLy8gICB9DQogICAgICAgICAgLy8gXQ0KICAgICAgICB9DQogICAgICAgIC8vIHsNCiAgICAgICAgLy8gICB0eXBlOiAnZGF0ZS1waWNrZXInLA0KICAgICAgICAvLyAgIHByb3A6ICdhcnJpdmFsRGF0ZScsDQogICAgICAgIC8vICAgbGFiZWw6ICforqLljZXlvIDlp4vphY3pgIHml6XmnJ8nLA0KICAgICAgICAvLyAgIGF0dHJzOiB7DQogICAgICAgIC8vICAgICBwbGFjZWhvbGRlcjogJ+W8gOWni+mFjemAgeaXpeacnycsDQogICAgICAgIC8vICAgICAndmFsdWUtZm9ybWF0JzogJ3l5eXktTU0tZGQnLA0KICAgICAgICAvLyAgICAgJ3BpY2tlci1vcHRpb25zJzogew0KICAgICAgICAvLyAgICAgICBkaXNhYmxlZERhdGU6IHRpbWUgPT4gew0KICAgICAgICAvLyAgICAgICAgIGlmICh0aGlzLmZvcm1EYXRhLm9yZGVyU3RhdHVzID09IDMpIHsNCiAgICAgICAgLy8gICAgICAgICAgIHJldHVybiB0aW1lLmdldFRpbWUoKSA+PSBEYXRlLm5vdygpOw0KICAgICAgICAvLyAgICAgICAgIH0gZWxzZSB7DQogICAgICAgIC8vICAgICAgICAgICByZXR1cm4gdGltZS5nZXRUaW1lKCkgPCBEYXRlLm5vdygpOw0KICAgICAgICAvLyAgICAgICAgIH0NCiAgICAgICAgLy8gICAgICAgfQ0KICAgICAgICAvLyAgICAgfQ0KICAgICAgICAvLyAgIH0NCiAgICAgICAgLy8gfQ0KICAgICAgXTsNCiAgICB9LA0KICAgIGJUYWJsZUZvcm1JdGVtcygpIHsNCiAgICAgIHJldHVybiBbDQogICAgICAgIHsNCiAgICAgICAgICB0eXBlOiAnaW5wdXQnLA0KICAgICAgICAgIHByb3A6ICduYW1lT3JQaW55aW5IZWFkZXInLA0KICAgICAgICAgIGF0dHJzOiB7DQogICAgICAgICAgICBwbGFjZWhvbGRlcjogJ+WQjeensOeugOaLvCcNCiAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgIF07DQogICAgfSwNCiAgICAvL+aWsOWinuW8ueeql+acqumAieaLqeihqOagvA0KICAgIHVuc2VsZWN0VGFibGVEYXRhKCkgew0KICAgICAgaWYgKCF0aGlzLmRpYWxvZ1Vuc2VsZWN0SW5wdXQudHJpbSgpKSB7DQogICAgICAgIHJldHVybiB0aGlzLmRpYWxvZ0RhdGFVblNlbGVjdE9ialt0aGlzLmRpYWxvZ05hbWVdOw0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0RmlsdGVyRGF0YSgNCiAgICAgICAgICB0aGlzLmRpYWxvZ0RhdGFVblNlbGVjdE9ialt0aGlzLmRpYWxvZ05hbWVdLA0KICAgICAgICAgIHRoaXMuZGlhbG9nVW5zZWxlY3RJbnB1dC50cmltKCkNCiAgICAgICAgKTsNCiAgICAgIH0NCiAgICB9LA0KDQogICAgdW5zZWxlY3RMZWZ0SW5ncmVkaWVudERhdGEoKSB7DQogICAgICBpZiAoIXRoaXMuZGlhbG9nVW5zZWxlY3RJbnB1dC50cmltKCkpIHsNCiAgICAgICAgcmV0dXJuIHRoaXMubGVmdEluZ3JlZGllbnREYXRhOw0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0RmlsdGVyTGlzdCgNCiAgICAgICAgICB0aGlzLmxlZnRJbmdyZWRpZW50RGF0YSwNCiAgICAgICAgICB0aGlzLmRpYWxvZ1Vuc2VsZWN0SW5wdXQudHJpbSgpDQogICAgICAgICk7DQogICAgICB9DQogICAgfSwNCiAgICAvL+aWsOWinuW3sumAieaLqeihqOagvOaVsOaNrg0KICAgIHNlbGVjdGVkVGFibGVEYXRhKCkgew0KICAgICAgaWYgKHRoaXMub3V0T2ZTdG9ja1N0YXR1ID09PSAnJykgew0KICAgICAgICByZXR1cm4gdGhpcy5kaWFsb2dEYXRhU2VsZWN0ZWRPYmpbdGhpcy5hY3RpdmVOYW1lXTsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIHJldHVybiB0aGlzLmRpYWxvZ0RhdGFTZWxlY3RlZE9ialt0aGlzLmFjdGl2ZU5hbWVdLmZpbHRlcihpdGVtID0+IHsNCiAgICAgICAgICByZXR1cm4gaXRlbS5vdXRPZlN0b2NrID09IHRoaXMub3V0T2ZTdG9ja1N0YXR1Ow0KICAgICAgICB9KTsNCiAgICAgIH0NCiAgICB9DQogIH0sDQoNCiAgLy8g55uR5o6nZGF0YeS4reeahOaVsOaNruWPmOWMlg0KICB3YXRjaDogew0KICAgICdmb3JtRGF0YS5vcmRlclN0YXR1cyc6IGZ1bmN0aW9uKG5ld1ZhbCwgb2xkVmFsKSB7DQogICAgICBpZiAobmV3VmFsICE9IG9sZFZhbCkgew0KICAgICAgICB0aGlzLmluaXREYXRlKCk7DQogICAgICB9DQogICAgfSwNCiAgICAnZm9ybURhdGEuZGlzdHJpY3RDb2RlJzogZnVuY3Rpb24obmV3VmFsLCBvbGRWYWwpIHsNCiAgICAgIGlmIChuZXdWYWwgIT0gb2xkVmFsKSB7DQogICAgICAgIHRoaXMuZGlhbG9nRGF0YVNlbGVjdGVkT2JqWydkaXNoJ10gPSBbXTsNCiAgICAgICAgdGhpcy5kaWFsb2dEYXRhU2VsZWN0ZWRPYmpbJ2luZ3JlZGllbnRzJ10gPSBbXTsNCiAgICAgIH0NCiAgICB9DQogIH0sDQogIC8vIOaWueazlembhuWQiA0KICBtZXRob2RzOiB7DQogICAgZm9ybWF0SW5wdXQsDQogICAgY2hhbmdlRGF0ZSh2YWx1ZSkgew0KICAgICAgaWYgKHZhbHVlKSB7DQogICAgICAgIHRoaXMuc2VsZWN0ZWRUYWJsZURhdGEuZm9yRWFjaChpdGVtID0+IHsNCiAgICAgICAgICBpZiAoIWl0ZW0uYXJyaXZhbERhdGUpIHsNCiAgICAgICAgICAgIC8vIGl0ZW0uYXJyaXZhbERhdGUgPSB2YWx1ZTsNCiAgICAgICAgICAgIHRoaXMuJHNldChpdGVtLCAnYXJyaXZhbERhdGUnLCB2YWx1ZSk7DQogICAgICAgICAgfQ0KICAgICAgICB9KTsNCiAgICAgIH0NCiAgICB9LA0KICAgIGNoYW5nZVRpbWUodmFsdWUpIHsNCiAgICAgIGlmICh2YWx1ZSkgew0KICAgICAgICB0aGlzLnNlbGVjdGVkVGFibGVEYXRhLmZvckVhY2goaXRlbSA9PiB7DQogICAgICAgICAgaWYgKCFpdGVtLmFycml2YWxUaW1lKSB7DQogICAgICAgICAgICB0aGlzLiRzZXQoaXRlbSwgJ2Fycml2YWxUaW1lJywgdmFsdWUpOw0KICAgICAgICAgIH0NCiAgICAgICAgfSk7DQogICAgICB9DQogICAgfSwNCiAgICBkaXNhYmxlZERhdGUodGltZSkgew0KICAgICAgaWYgKHRoaXMuZm9ybURhdGEub3JkZXJTdGF0dXMgPT0gMykgew0KICAgICAgICByZXR1cm4gdGltZS5nZXRUaW1lKCkgPiBEYXRlLm5vdygpIC0gMzYwMCAqIDEwMDAgKiAyNDsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIHJldHVybiB0aW1lLmdldFRpbWUoKSA8PSBEYXRlLm5vdygpIC0gMzYwMCAqIDEwMDAgKiAyNDsNCiAgICAgIH0NCiAgICB9LA0KICAgIGJhc2VUcmVlV2l0aFBvd2VyU2Nob29sKCkgew0KICAgICAgcmV0dXJuIGJhc2VUcmVlV2l0aFBvd2VyU2Nob29sKCkudGhlbihyZXMgPT4gew0KICAgICAgICB0aGlzLmFyZWFMaXN0ID0gcmVzLmRhdGEgfHwgW107DQogICAgICAgIGlmICgNCiAgICAgICAgICAhdGhpcy5vcmRlcklkICYmDQogICAgICAgICAgdGhpcy4kaGFzKFsnb3JkZXItZGVmYXVsdC1maXJzdCddKSAmJg0KICAgICAgICAgIHRoaXMuYXJlYUxpc3QubGVuZ3RoDQogICAgICAgICkgew0KICAgICAgICAgIHRoaXMuJHJlZnMuY0R5bmFtaWNGb3JtLnNldE1vZGVsRGF0YSgNCiAgICAgICAgICAgICdwcm92aW5jZUNvZGUnLA0KICAgICAgICAgICAgdGhpcy5hcmVhTGlzdFswXS5jb2RlDQogICAgICAgICAgKTsNCiAgICAgICAgfQ0KICAgICAgICByZXR1cm47DQogICAgICB9KTsNCiAgICB9LA0KICAgIGdldEN1dE1hdGNoU3RhbmRhcmRMaXN0KCkgew0KICAgICAgcmV0dXJuIGN1dE1hdGNoU3RhbmRhcmRMaXN0KCkNCiAgICAgICAgLnRoZW4ocmVzID0+IHsNCiAgICAgICAgICB0aGlzLmN1dE1hdGNoU3RhbmRhcmRMaXN0ID0gcmVzLmRhdGEgfHwgW107DQogICAgICAgIH0pDQogICAgICAgIC5jYXRjaCgoKSA9PiB7DQogICAgICAgICAgdGhpcy5jdXRNYXRjaFN0YW5kYXJkTGlzdCA9IFtdOw0KICAgICAgICB9KTsNCiAgICB9LA0KICAgIGdldENpdHlMaXN0KHByb3ZpbmNlQ29kZSkgew0KICAgICAgbGV0IGNpdHlMaXN0ID0gW107DQogICAgICBpZiAoIXByb3ZpbmNlQ29kZSkgew0KICAgICAgICByZXR1cm4gY2l0eUxpc3Q7DQogICAgICB9IGVsc2Ugew0KICAgICAgICBjaXR5TGlzdCA9IHRoaXMuYXJlYUxpc3QuZmluZChpdGVtID0+IGl0ZW0uY29kZSA9PT0gcHJvdmluY2VDb2RlKQ0KICAgICAgICAgIC5jaGlsZExpc3Q7DQogICAgICB9DQogICAgICB0aGlzLmNpdHlMaXN0ID0gY2l0eUxpc3Q7DQogICAgICByZXR1cm4gY2l0eUxpc3Q7DQogICAgfSwNCiAgICBnZXRDb3VudHlMaXN0KGNpdHlDb2RlKSB7DQogICAgICBsZXQgZGlzdHJpY3RMaXN0ID0gW107DQogICAgICBpZiAoIWNpdHlDb2RlKSB7DQogICAgICAgIHJldHVybiBkaXN0cmljdExpc3Q7DQogICAgICB9IGVsc2Ugew0KICAgICAgICBkaXN0cmljdExpc3QgPSB0aGlzLmNpdHlMaXN0LmZpbmQoaXRlbSA9PiBpdGVtLmNvZGUgPT09IGNpdHlDb2RlKQ0KICAgICAgICAgIC5jaGlsZExpc3Q7DQogICAgICB9DQogICAgICB0aGlzLmRpc3RyaWN0TGlzdCA9IGRpc3RyaWN0TGlzdDsNCiAgICAgIHJldHVybiBkaXN0cmljdExpc3Q7DQogICAgfSwNCiAgICBnZXRTY2hvb2xMaXN0KGRpc3RyaWN0Q29kZSkgew0KICAgICAgbGV0IHNjaG9vbExpc3QgPSBbXTsNCiAgICAgIGlmICghZGlzdHJpY3RDb2RlKSB7DQogICAgICAgIHJldHVybiBzY2hvb2xMaXN0Ow0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgc2Nob29sTGlzdCA9IHRoaXMuZGlzdHJpY3RMaXN0LmZpbmQoaXRlbSA9PiBpdGVtLmNvZGUgPT09IGRpc3RyaWN0Q29kZSkNCiAgICAgICAgICAuc2Nob29sTGlzdDsNCiAgICAgIH0NCiAgICAgIHRoaXMuc2Nob29sTGlzdCA9IHNjaG9vbExpc3Q7DQogICAgICByZXR1cm4gc2Nob29sTGlzdDsNCiAgICB9LA0KICAgIGdldFNjaG9vbEJyYW5jaExpc3Qoc2Nob29sQ29kZSkgew0KICAgICAgbGV0IHNjaG9vbEJyYW5jaExpc3QgPSBbXTsNCiAgICAgIGlmICghc2Nob29sQ29kZSkgew0KICAgICAgICByZXR1cm4gc2Nob29sQnJhbmNoTGlzdDsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIHNjaG9vbEJyYW5jaExpc3QgPSB0aGlzLnNjaG9vbExpc3QuZmluZChpdGVtID0+IGl0ZW0uaWQgPT09IHNjaG9vbENvZGUpDQogICAgICAgICAgLnNjaG9vbEJyYW5jaFJlc3BEdG9MaXN0Ow0KICAgICAgfQ0KICAgICAgcmV0dXJuIHNjaG9vbEJyYW5jaExpc3Q7DQogICAgfSwNCiAgICBoYW5kbGVUYWJDbGljaygpIHsNCiAgICAgIHRoaXMub3V0T2ZTdG9ja1N0YXR1ID0gJyc7DQogICAgfSwNCiAgICBoYW5kbGVEaWFsb2dUYWJDbGljaygpIHsNCiAgICAgIHRoaXMuZGlhbG9nVW5zZWxlY3RJbnB1dCA9ICcnOw0KICAgICAgdGhpcy5kaWFsb2dTZWxlY3RlZElucHV0ID0gJyc7DQogICAgICB0aGlzLnJlc2V0TGlzdFNlbGVjdGVkKHRoaXMuZGlhbG9nRGF0YVVuU2VsZWN0T2JqW3RoaXMuZGlhbG9nQWN0aXZlTmFtZV0pOw0KICAgICAgdGhpcy5yZXNldExpc3RTZWxlY3RlZCh0aGlzLmRpYWxvZ0RhdGFTZWxlY3RlZE9ialt0aGlzLmRpYWxvZ0FjdGl2ZU5hbWVdKTsNCiAgICAgIGlmICghdGhpcy5kaWFsb2dEYXRhVW5TZWxlY3RPYmpbdGhpcy5kaWFsb2dBY3RpdmVOYW1lXS5sZW5ndGgpIHsNCiAgICAgICAgdGhpcy5vcmRlckNvbnRlbnRGb3JTZWxlY3QoMCk7DQogICAgICB9DQogICAgICAvLyBpZiAoIXRoaXMuZGlhbG9nRGF0YVNlbGVjdGVkT2JqW3RoaXMuZGlhbG9nQWN0aXZlTmFtZV0ubGVuZ3RoKSB7DQogICAgICAvLyAgIHRoaXMub3JkZXJDb250ZW50Rm9yU2VsZWN0KDEpOw0KICAgICAgLy8gfQ0KICAgIH0sDQogICAgZmV0Y2hUYWJsZURhdGEoZm9ybSkgew0KICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKHJlc29sdmUgPT4gew0KICAgICAgICByZXNvbHZlKHRoaXMuZGlhbG9nRGF0YVNlbGVjdGVkT2JqW3RoaXMuYWN0aXZlTmFtZV0pOw0KICAgICAgfSk7DQogICAgICAvLyBpZiAoIXRoaXMuZm9ybURhdGEuZGlzdHJpY3RDb2RlICYmICF0aGlzLmRpc3RyaWN0Q29kZSkgew0KICAgICAgLy8gICByZXR1cm4gbmV3IFByb21pc2UocmVzb2x2ZSA9PiByZXNvbHZlKHt9KSk7DQogICAgICAvLyB9DQogICAgICAvLyBsZXQgcGFyYW1zID0gT2JqZWN0LmFzc2lnbih7fSwgZm9ybSwgew0KICAgICAgLy8gICBkaXN0cmljdENvZGU6IHRoaXMuZm9ybURhdGEuZGlzdHJpY3RDb2RlIHx8IHRoaXMuZGlzdHJpY3RDb2RlIHx8ICcnLA0KICAgICAgLy8gICBvcmRlcklkOiB0aGlzLm9yZGVySWQsDQogICAgICAvLyAgIHF1ZXJ5VHlwZTogdGhpcy5xdWVyeU9iamVjdFt0aGlzLmFjdGl2ZU5hbWVdDQogICAgICAvLyB9KTsNCiAgICAgIC8vIHJldHVybiBvcmRlckNvbnRlbnRGb3JQYWdlKHBhcmFtcykudGhlbihyZXMgPT4gew0KICAgICAgLy8gICBpZiAocmVzLmRhdGEgJiYgcmVzLmRhdGEucmVjb3JkcyAmJiByZXMuZGF0YS5yZWNvcmRzLmxlbmd0aCkgew0KICAgICAgLy8gICAgIHRoaXMuZW1wdHkgPSBmYWxzZTsNCiAgICAgIC8vICAgfSBlbHNlIHsNCiAgICAgIC8vICAgICB0aGlzLmVtcHR5ID0gdHJ1ZTsNCiAgICAgIC8vICAgfQ0KICAgICAgLy8gICByZXR1cm4gbmV3IFByb21pc2UocmVzb2x2ZSA9PiByZXNvbHZlKHJlcykpOw0KICAgICAgLy8gfSk7DQogICAgfSwNCiAgICAvL+iOt+WPluiuouWNleWIl+ihqA0KICAgIG9yZGVyQ29udGVudEZvclBhZ2UodGFiTmFtZSkgew0KICAgICAgbGV0IHBhcmFtcyA9IHsNCiAgICAgICAgb2Zmc2V0OiAwLA0KICAgICAgICBsaW1pdDogMTAwMDAsDQogICAgICAgIGRpc3RyaWN0Q29kZTogdGhpcy5mb3JtRGF0YS5kaXN0cmljdENvZGUgfHwgdGhpcy5kaXN0cmljdENvZGUgfHwgJycsDQogICAgICAgIG9yZGVySWQ6IHRoaXMub3JkZXJJZCwNCiAgICAgICAgcXVlcnlUeXBlOiB0aGlzLnF1ZXJ5T2JqZWN0W3RhYk5hbWVdDQogICAgICB9Ow0KICAgICAgcmV0dXJuIG9yZGVyQ29udGVudEZvclBhZ2UocGFyYW1zKS50aGVuKHJlcyA9PiB7DQogICAgICAgIGlmIChyZXMuZGF0YSAmJiByZXMuZGF0YS5yZWNvcmRzKSB7DQogICAgICAgICAgbGV0IHJlc3VsdCA9IHJlcy5kYXRhLnJlY29yZHMgfHwgW107DQoNCiAgICAgICAgICBpZiAodGFiTmFtZSA9PT0gJ2Rpc2gnKSB7DQogICAgICAgICAgICByZXN1bHQuZm9yRWFjaChpdGVtID0+IHsNCiAgICAgICAgICAgICAgaXRlbS5xdWFudGl0eSA9IHBhcnNlSW50KGl0ZW0ucXVhbnRpdHkpIHx8IDA7DQogICAgICAgICAgICB9KTsNCg0KICAgICAgICAgICAgLy8g6K6+572u6YeN5paw5LiL5Y2V6aG16Z2i5omT5byA6KeE5YiZ77ya5YWo6YOo6aOf5p2Q5LiL5Y2V77yM5YiZ6buY6K6k5omT5byA6aOf5p2Q6aG16Z2i44CC5LuF6I+c5ZOB77yM5YiZ5omT5byA6I+c5ZOB6aG16Z2iLuiLpeS4pOiAhemDveacie+8jOWImeaJk+W8gOiPnOWTgeWNs+WPrw0KICAgICAgICAgICAgLy8gaWYgKHRoaXMub3BlcmFUeXBlID09ICdjb3B5Jykgew0KICAgICAgICAgICAgaWYgKHJlc3VsdC5sZW5ndGggPiAwKSB7DQogICAgICAgICAgICAgIHRoaXMuYWN0aXZlTmFtZSA9ICdkaXNoJzsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgIHRoaXMuYWN0aXZlTmFtZSA9ICdpbmdyZWRpZW50cyc7DQogICAgICAgICAgICB9DQogICAgICAgICAgICAvLyB9DQogICAgICAgICAgfQ0KDQogICAgICAgICAgaWYgKHRoaXMub3BlcmFUeXBlID09ICdjb3B5Jykgew0KICAgICAgICAgICAgLy8g6YeN5paw5LiL5Y2V55qE6aG16Z2i5pe26Ze05riF56m6DQogICAgICAgICAgICByZXN1bHQgPSByZXN1bHQubWFwKGl0ZW0gPT4gew0KICAgICAgICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgICAgIC4uLml0ZW0sDQogICAgICAgICAgICAgICAgYXJyaXZhbERhdGU6ICcnLA0KICAgICAgICAgICAgICAgIGFycml2YWxUaW1lOiAnJw0KICAgICAgICAgICAgICB9Ow0KICAgICAgICAgICAgfSk7DQogICAgICAgICAgfQ0KICAgICAgICAgIHRoaXMuZGlhbG9nRGF0YVNlbGVjdGVkT2JqW3RhYk5hbWVdID0gcmVzdWx0Ow0KICAgICAgICB9DQogICAgICB9KTsNCiAgICB9LA0KICAgIGVkaXRDcm93ZChyb3cpIHsNCiAgICAgIHRoaXMuZGlhbG9nQWN0aXZlTmFtZSA9IHRoaXMuYWN0aXZlTmFtZTsNCiAgICAgIHRoaXMuYWRkT3JkZXJDb250ZW50KCdlZGl0Jyk7DQogICAgfSwNCiAgICBkZWxldGVDcm93ZChyb3csIGluZGV4KSB7DQogICAgICB0aGlzLiRjb25maXJtKCfmmK/lkKbliKDpmaTor6XooYw/JywgJ+aPkOekuicsIHsNCiAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICfnoa7lrponLA0KICAgICAgICBjYW5jZWxCdXR0b25UZXh0OiAn5Y+W5raIJywNCiAgICAgICAgdHlwZTogJ3dhcm5pbmcnDQogICAgICB9KQ0KICAgICAgICAudGhlbigoKSA9PiB7DQogICAgICAgICAgdGhpcy5kaWFsb2dEYXRhU2VsZWN0ZWRPYmpbdGhpcy5hY3RpdmVOYW1lXS5zcGxpY2UoaW5kZXgsIDEpOw0KICAgICAgICAgIHRoaXMud2FybmluZygn5Yig6Zmk5oiQ5Yqf77yBJyk7DQogICAgICAgICAgLy8gZGVsZXRlT3JkZXJDb250ZW50KHsNCiAgICAgICAgICAvLyAgIG9yZGVyQ29udGVudElkOiByb3cub3JkZXJDb250ZW50SWQNCiAgICAgICAgICAvLyB9KS50aGVuKHJlcyA9PiB7DQogICAgICAgICAgLy8gICB0aGlzLndhcm5pbmcoJ+WIoOmZpOaIkOWKn++8gScpOw0KICAgICAgICAgIC8vICAgdGhpcy5vcmRlclN0YXRpc3RpY3MoKTsNCiAgICAgICAgICAvLyAgIHRoaXMuJHJlZnMuYlRhYmxlICYmDQogICAgICAgICAgLy8gICAgIHRoaXMuJHJlZnMuYlRhYmxlWzBdICYmDQogICAgICAgICAgLy8gICAgIHRoaXMuJHJlZnMuYlRhYmxlWzBdLmFqYXhHZXRUYWJsZURhdGFCeVBhZ2UoKTsNCiAgICAgICAgICAvLyB9KTsNCiAgICAgICAgfSkNCiAgICAgICAgLmNhdGNoKCgpID0+IHt9KTsNCiAgICB9LA0KICAgIG9yZGVyU3RhdGlzdGljcygpIHsNCiAgICAgIGxldCBpbml0U3RhdGlzdGljc0luZm8gPSB0aGlzLmluaXRTdGF0aXN0aWNzSW5mbzsNCiAgICAgIGlmICghdGhpcy5vcmRlcklkKSB7DQogICAgICAgIHRoaXMuc3RhdGlzdGljc0luZm8gPSBpbml0U3RhdGlzdGljc0luZm87DQogICAgICAgIHJldHVybjsNCiAgICAgIH0NCiAgICAgIG9yZGVyU3RhdGlzdGljcyh7DQogICAgICAgIG9yZGVySWQ6IHRoaXMub3JkZXJJZCwNCiAgICAgICAgZGlzdHJpY3RDb2RlOiB0aGlzLmZvcm1EYXRhLmRpc3RyaWN0Q29kZSB8fCB0aGlzLmRpc3RyaWN0Q29kZSB8fCAnJw0KICAgICAgfSkudGhlbihyZXMgPT4gew0KICAgICAgICB0aGlzLnN0YXRpc3RpY3NJbmZvID0gcmVzLmRhdGEgfHwgaW5pdFN0YXRpc3RpY3NJbmZvOw0KICAgICAgfSk7DQogICAgfSwNCiAgICBvcmRlckNvbnRlbnRGb3JTZWxlY3QoaXNTZWxlY3RlZCwgdGFiTmFtZSkgew0KICAgICAgaWYgKCF0aGlzLm9yZGVySWQgJiYgaXNTZWxlY3RlZCkgew0KICAgICAgICB0aGlzLmRpYWxvZ0RhdGFTZWxlY3RlZE9ialt0aGlzLmRpYWxvZ0FjdGl2ZU5hbWVdID0gW107DQogICAgICAgIHJldHVybjsNCiAgICAgIH0NCiAgICAgIG9yZGVyQ29udGVudEZvclNlbGVjdCh7DQogICAgICAgIG9yZGVySWQ6IHRoaXMub3JkZXJJZCwNCiAgICAgICAgZGVwdElkOiB0aGlzLmZvcm1EYXRhLnNjaG9vbEJyYW5jaENvZGUsDQogICAgICAgIHF1ZXJ5VHlwZToNCiAgICAgICAgICAodGFiTmFtZSAmJiB0aGlzLnF1ZXJ5T2JqZWN0W3RhYk5hbWVdKSB8fA0KICAgICAgICAgIHRoaXMucXVlcnlPYmplY3RbdGhpcy5kaWFsb2dBY3RpdmVOYW1lXSwNCiAgICAgICAgaXNTZWxlY3RlZDogaXNTZWxlY3RlZCwNCiAgICAgICAgZGlzdHJpY3RDb2RlOiB0aGlzLmZvcm1EYXRhLmRpc3RyaWN0Q29kZSB8fCB0aGlzLmRpc3RyaWN0Q29kZQ0KICAgICAgfSkudGhlbihyZXMgPT4gew0KICAgICAgICBsZXQgcmVzdWx0ID0gcmVzLmRhdGEgfHwgW107DQogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgcmVzdWx0Lmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgcmVzdWx0W2ldLmN1c3RvbUlkID0gcmVzdWx0Lmxlbmd0aCAtIDEgLSBpOw0KICAgICAgICAgIHJlc3VsdFtpXS5zZWxlY3RlZCA9IGZhbHNlOw0KICAgICAgICAgIGlmICh0aGlzLmRpYWxvZ05hbWUgPT09ICdtZW51Jykgew0KICAgICAgICAgICAgcmVzdWx0W2ldLmV4cGFuZFRhYmxlRGF0YSA9IHRoaXMuaGFuZGxlTWVhbERhdGEoDQogICAgICAgICAgICAgIHJlc3VsdFtpXS5tZWFsRGF5TGlzdA0KICAgICAgICAgICAgKTsNCiAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgaWYgKCFpc1NlbGVjdGVkKSB7DQogICAgICAgICAgdGhpcy5kaWFsb2dEYXRhVW5TZWxlY3RPYmpbdGhpcy5hY3RpdmVOYW1lXSA9IHJlc3VsdDsNCiAgICAgICAgICB0aGlzLiRzZXQodGhpcy5kaWFsb2dEYXRhVW5TZWxlY3RPYmosIHRhYk5hbWUsIHJlc3VsdCk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgdGhpcy5kaWFsb2dEYXRhU2VsZWN0ZWRPYmpbdGhpcy5hY3RpdmVOYW1lXSA9IHJlc3VsdDsNCiAgICAgICAgfQ0KICAgICAgfSk7DQogICAgfSwNCiAgICBhZGRPcmRlckNvbnRlbnQodGFiTmFtZSkgew0KICAgICAgdGhpcy5kaWFsb2dOYW1lID0gdGFiTmFtZTsNCiAgICAgIHRoaXMuZGlhbG9nVmlzaWJsZSA9IHRydWU7DQogICAgICBpZiAodGFiTmFtZSA9PT0gJ21lbnUnKSB7DQogICAgICAgIHRoaXMuZGlhbG9nVGl0bGUgPSAn5byV55SoJyArIHRoaXMudGFic0tleU5hbWVbdGFiTmFtZV07DQogICAgICB9IGVsc2Ugew0KICAgICAgICB0aGlzLmRpYWxvZ1RpdGxlID0gJ+a3u+WKoCcgKyB0aGlzLnRhYnNLZXlOYW1lW3RhYk5hbWVdOw0KICAgICAgfQ0KICAgICAgaWYgKHRhYk5hbWUgPT0gJ2luZ3JlZGllbnRzJykgew0KICAgICAgICB0aGlzLmdldEluZ3JlZGllbnRUcmVlKCk7DQogICAgICB9IGVsc2Ugew0KICAgICAgICB0aGlzLm9yZGVyQ29udGVudEZvclNlbGVjdCgwLCB0YWJOYW1lKTsNCiAgICAgIH0NCiAgICAgIC8vIHRoaXMub3JkZXJDb250ZW50Rm9yU2VsZWN0KDAsIHRhYk5hbWUpOw0KICAgICAgLy8g6YeN572u6aOf5p2Q5re75Yqg5by55qGG6YCJ5Lit5pWw5o2uDQogICAgICB0aGlzLnNlbGVjdGVkSW5ncmVkaWVudExpc3QgPSBbXTsNCiAgICAgIC8vIGlmICh0eXBlID09ICdlZGl0JykgICB7DQogICAgICAvLyBsZXQga2V5cyA9IE9iamVjdC5rZXlzKHRoaXMucXVlcnlPYmplY3QpOw0KICAgICAgLy8gZm9yIChsZXQgaSA9IDA7IGkgPCBrZXlzLmxlbmd0aDsgaSsrKSB7DQogICAgICAvLyAgIHRoaXMub3JkZXJDb250ZW50Rm9yU2VsZWN0KDEsIGtleXNbaV0pOw0KICAgICAgLy8gfQ0KICAgICAgLy8gfQ0KICAgIH0sDQogICAgZW1wdHlPcmRlckNvbnRlbnQoKSB7DQogICAgICB0aGlzLiRjb25maXJtKA0KICAgICAgICBg5piv5ZCm5riF56m65omA5pyJJHt0aGlzLnRhYnNLZXlOYW1lW3RoaXMuYWN0aXZlTmFtZV19P2AsDQogICAgICAgICfmj5DnpLonLA0KICAgICAgICB7DQogICAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICfnoa7lrponLA0KICAgICAgICAgIGNhbmNlbEJ1dHRvblRleHQ6ICflj5bmtognLA0KICAgICAgICAgIHR5cGU6ICd3YXJuaW5nJw0KICAgICAgICB9DQogICAgICApDQogICAgICAgIC50aGVuKCgpID0+IHsNCiAgICAgICAgICB0aGlzLmRpYWxvZ0RhdGFTZWxlY3RlZE9ialt0aGlzLmFjdGl2ZU5hbWVdID0gW107DQogICAgICAgIH0pDQogICAgICAgIC5jYXRjaCgoKSA9PiB7fSk7DQogICAgfSwNCiAgICBzYXZlVG9EcmFmdCgpIHsNCiAgICAgIHRoaXMuc2F2ZU9yZGVyQmFzZSgpLnRoZW4ocmVzID0+IHsNCiAgICAgICAgdGhpcy53YXJuaW5nKCfkv53lrZjmiJDlip8nLCAnc3VjY2VzcycpOw0KICAgICAgfSk7DQogICAgfSwNCiAgICBwcmV2aWV3QW5kU3VibWl0KCkgew0KICAgICAgdGhpcy5zYXZlT3JkZXJBbmRDb250ZW50KCkudGhlbihyZXMgPT4gew0KICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7DQogICAgICAgICAgcGF0aDogJy9vcmRlci9wcmV2aWV3JywNCiAgICAgICAgICBxdWVyeTogew0KICAgICAgICAgICAgb3JkZXJJZDogdGhpcy5vcmRlcklkLA0KICAgICAgICAgICAgb3BlcmFUeXBlOiAncHJldmlldycNCiAgICAgICAgICB9DQogICAgICAgIH0pOw0KICAgICAgfSk7DQogICAgfSwNCiAgICAvL+S/neWtmOiuouWNlQ0KICAgIHNhdmVPcmRlckJhc2UoKSB7DQogICAgICBjb25zdCB7DQogICAgICAgIHNjaG9vbEJyYW5jaENvZGUsDQogICAgICAgIGFycml2YWxEYXRlLA0KICAgICAgICBvcmRlclN0YXR1cywNCiAgICAgICAgcHJvdmluY2VDb2RlLA0KICAgICAgICBjaXR5Q29kZSwNCiAgICAgICAgc2Nob29sQ29kZSwNCiAgICAgICAgZGlzdHJpY3RDb2RlDQogICAgICB9ID0gdGhpcy5mb3JtRGF0YTsNCiAgICAgIGlmICghc2Nob29sQnJhbmNoQ29kZSkgew0KICAgICAgICB0aGlzLndhcm5pbmcoJ+ivt+mAieaLqeWtpumDqCcpOw0KICAgICAgICByZXR1cm47DQogICAgICB9DQogICAgICBpZiAoIW9yZGVyU3RhdHVzKSB7DQogICAgICAgIHRoaXMud2FybmluZygn6K+36YCJ5oup6K6i5Y2V5oCn6LSoJyk7DQogICAgICAgIHJldHVybjsNCiAgICAgIH0NCiAgICAgIGNvbnN0IHBhcmFtcyA9IHsNCiAgICAgICAgb3JkZXJJZDogdGhpcy5vcmRlcklkLA0KICAgICAgICB0eXBlOiBvcmRlclN0YXR1cywNCiAgICAgICAgZGVwdElkOiBzY2hvb2xCcmFuY2hDb2RlLA0KICAgICAgICBwYXJlbnREZXB0SWQ6IHNjaG9vbENvZGUsDQogICAgICAgIGFycml2YWxUaW1lOiBhcnJpdmFsRGF0ZSwNCiAgICAgICAgcmVtYXJrczogdGhpcy5vcmRlclJlbWFyaywNCiAgICAgICAgcHJvdmluY2VDb2RlLA0KICAgICAgICBjaXR5Q29kZSwNCiAgICAgICAgZGlzdHJpY3RDb2RlLA0KICAgICAgICBpbmNsdWRpbmdEaXNoZXNTZWFzb25pbmc6IHRoaXMuaW5jbHVkaW5nRGlzaGVzU2Vhc29uaW5nDQogICAgICB9Ow0KICAgICAgcmV0dXJuIHNhdmVPcmRlckJhc2UocGFyYW1zKTsNCiAgICB9LA0KICAgIGFzeW5jIHNlbGVjdFRvUmlnaHQoKSB7DQogICAgICBjb25zdCBsaXN0ID0gdGhpcy5sZWZ0SW5ncmVkaWVudERhdGFMaXN0Ow0KICAgICAgdmFyIHNlbGVjdGVkTGlzdCA9IGxpc3QuZmlsdGVyKGl0ZW0gPT4gaXRlbS5zZWxlY3RlZCk7DQogICAgICBjb25zdCByZXBlYXRMaXN0ID0gdGhpcy5oYW5kbGVTZWxlY3RSZXBlYXQoDQogICAgICAgIHNlbGVjdGVkTGlzdCwNCiAgICAgICAgdGhpcy5zZWxlY3RlZEluZ3JlZGllbnRMaXN0DQogICAgICApOw0KICAgICAgaWYgKHJlcGVhdExpc3QubGVuZ3RoKSB7DQogICAgICAgIGxldCB0aXBzTWVzc2FnZUNvbnRlbnQgPSAnJzsNCiAgICAgICAgcmVwZWF0TGlzdC5mb3JFYWNoKGl0ZW0gPT4gew0KICAgICAgICAgIHRpcHNNZXNzYWdlQ29udGVudCArPSBgPGRpdj4kew0KICAgICAgICAgICAgaXRlbS5yZWxhdGlvbk5hbWUNCiAgICAgICAgICB95bey5re75Yqg6L+HJHtpdGVtLnBhY2tOdW0gfHwgJzAnfSR7aXRlbS5wYWNrVW5pdH08L2Rpdj5gOw0KICAgICAgICB9KTsNCiAgICAgICAgY29uc3QgdGlwc01lc3NhZ2UgPSBgDQogICAgICAgICAgICA8ZGl2IGNsYXNzPSd0aXBzLWNvbnRlbnQtbWVzc2FhZ2UnPuaciemHjeWkjea3u+WKoOmjn+adkCzor7fnm7TmjqXlnKjlj7PkvqfpnaLmnb/kuK3orr7nva7mlbDph4/vvIE8L2Rpdj4NCiAgICAgICAgICAgIDxkaXYgY2xhc3M9J3RpcHMtY29udGVudC1ib3gnPg0KICAgICAgICAgICAgJHt0aXBzTWVzc2FnZUNvbnRlbnR9DQogICAgICAgICAgICA8L2Rpdj4NCiAgICAgICAgICBgOw0KICAgICAgICBhd2FpdCB0aGlzLiRjb25maXJtKHRpcHNNZXNzYWdlLCAn5o+Q6YaSJywgew0KICAgICAgICAgIGN1c3RvbUNsYXNzOiAnb3JkZXItdGlwcy1tZXNzYWdlJywNCiAgICAgICAgICBkYW5nZXJvdXNseVVzZUhUTUxTdHJpbmc6IHRydWUsDQogICAgICAgICAgY2xvc2VPbkNsaWNrTW9kYWw6IGZhbHNlLA0KICAgICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAn56Gu5a6aJywNCiAgICAgICAgICBjYW5jZWxCdXR0b25UZXh0OiAn5Y+W5raIJw0KICAgICAgICAgIC8vIHR5cGU6ICd3YXJuaW5nJw0KICAgICAgICB9KQ0KICAgICAgICAgIC50aGVuKCgpID0+IHsNCiAgICAgICAgICAgIC8vIOWOu+mZpOW3puS+p+mAieS4reebuOWvueWPs+S+p+mHjeWkjeeahOaVsOaNrg0KICAgICAgICAgICAgbGV0IHJlcGVhdExpc3RJZCA9IHJlcGVhdExpc3QubWFwKGl0ZW0gPT4gaXRlbS5yZWxhdGlvbklkKTsNCiAgICAgICAgICAgIHNlbGVjdGVkTGlzdCA9IHNlbGVjdGVkTGlzdC5maWx0ZXIoaXRlbSA9PiB7DQogICAgICAgICAgICAgIHJldHVybiAhcmVwZWF0TGlzdElkLmluY2x1ZGVzKGl0ZW0ucmVsYXRpb25JZCk7DQogICAgICAgICAgICB9KTsNCiAgICAgICAgICB9KQ0KICAgICAgICAgIC5jYXRjaCgoKSA9PiB7DQogICAgICAgICAgICBzZWxlY3RlZExpc3QgPSBbXTsNCiAgICAgICAgICB9KTsNCiAgICAgIH0NCiAgICAgIGZvciAobGV0IGkgPSBzZWxlY3RlZExpc3QubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHsNCiAgICAgICAgdGhpcy5zZWxlY3RlZEluZ3JlZGllbnRMaXN0LnVuc2hpZnQoDQogICAgICAgICAgT2JqZWN0LmFzc2lnbih7fSwgc2VsZWN0ZWRMaXN0W2ldLCB7DQogICAgICAgICAgICBjdXN0b21JZDoNCiAgICAgICAgICAgICAgKHRoaXMuc2VsZWN0ZWRJbmdyZWRpZW50TGlzdFswXSAmJg0KICAgICAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRJbmdyZWRpZW50TGlzdFswXS5jdXN0b21JZCArIDEpIHx8DQogICAgICAgICAgICAgIDAsDQogICAgICAgICAgICBzZWxlY3RlZDogZmFsc2UsDQogICAgICAgICAgICBwYWNrTnVtOiAxDQogICAgICAgICAgfSkNCiAgICAgICAgKTsNCiAgICAgIH0NCiAgICAgIC8v5riF5qWa6YCJ5Lit54q25oCBDQogICAgICAvLyB0aGlzLiRyZWZzWyd1bnNlbGVjdFRhYmxlJ10uJHJlZnNbJ3RhYmxlJ10uY2xlYXJTZWxlY3Rpb24oKTsNCiAgICAgIGxldCByZWZBcnIgPSB0aGlzLiRyZWZzWyd1bnNlbGVjdFRhYmxlJ107DQogICAgICByZWZBcnIuZm9yRWFjaChpdGVtID0+IHsNCiAgICAgICAgaXRlbS4kcmVmc1sndGFibGUnXS5jbGVhclNlbGVjdGlvbigpOw0KICAgICAgfSk7DQogICAgICB0aGlzLnJlc2V0TGlzdFNlbGVjdGVkKGxpc3QpOw0KICAgIH0sDQogICAgc2VsZWN0VG9MZWZ0KCkgew0KICAgICAgbGV0IGxpc3QgPSB0aGlzLmRpYWxvZ0RhdGFTZWxlY3RlZE9ialt0aGlzLmRpYWxvZ0FjdGl2ZU5hbWVdOw0KICAgICAgdGhpcy5kaWFsb2dEYXRhU2VsZWN0ZWRPYmpbdGhpcy5kaWFsb2dBY3RpdmVOYW1lXSA9IGxpc3QuZmlsdGVyKA0KICAgICAgICBpdGVtID0+ICFpdGVtLnNlbGVjdGVkDQogICAgICApOw0KICAgICAgdGhpcy4kcmVmc1snc2VsZWN0ZWRUYWJsZSddWzBdLiRyZWZzWyd0YWJsZSddLmNsZWFyU2VsZWN0aW9uKCk7DQogICAgfSwNCiAgICBpbmdyZWRpZW50Um93Q2xpY2socm93KSB7DQogICAgICBpZiAocm93LnNlbGVjdGVkKSB7DQogICAgICAgIHJldHVybjsNCiAgICAgIH0NCiAgICAgIGNvbnN0IGl0ZW0gPSB0aGlzLmxlZnRJbmdyZWRpZW50RGF0YUxpc3QuZmluZCgNCiAgICAgICAgaXRlbSA9Pg0KICAgICAgICAgIGl0ZW0ucmVsYXRpb25JZCA9PT0gcm93LnJlbGF0aW9uSWQgJiYNCiAgICAgICAgICBpdGVtLnByaW1hcnlDbGFzc2lmaWNhdGlvbk5hbWUgPT09IHJvdy5wcmltYXJ5Q2xhc3NpZmljYXRpb25OYW1lDQogICAgICApOw0KICAgICAgLy8gaXRlbS5zZWxlY3RlZCA9ICFpdGVtLnNlbGVjdGVkOw0KICAgICAgdGhpcy5zZWxlY3RlZEluZ3JlZGllbnRMaXN0LnVuc2hpZnQoDQogICAgICAgIE9iamVjdC5hc3NpZ24oe30sIHJvdywgew0KICAgICAgICAgIHBhY2tOdW06IDENCiAgICAgICAgfSkNCiAgICAgICk7DQogICAgICBpdGVtLnNlbGVjdGVkID0gdHJ1ZTsNCiAgICB9LA0KICAgIHVuc2VsZWN0VGFibGVSb3dDbGljayhyb3csIGNvbHVtbiwgZXZlbnQpIHsNCiAgICAgIGNvbnN0IGluZGV4ID0gdGhpcy5kaWFsb2dEYXRhVW5TZWxlY3RPYmpbdGhpcy5kaWFsb2dOYW1lXS5maW5kSW5kZXgoDQogICAgICAgIGl0ZW0gPT4gaXRlbS5jdXN0b21JZCA9PT0gcm93LmN1c3RvbUlkDQogICAgICApOw0KICAgICAgY29uc3Qgc3RhdHVzID0gIXRoaXMuZGlhbG9nRGF0YVVuU2VsZWN0T2JqW3RoaXMuZGlhbG9nTmFtZV1baW5kZXhdDQogICAgICAgIC5zZWxlY3RlZDsNCiAgICAgIGlmICh0aGlzLmRpYWxvZ05hbWUgPT09ICdtZW51Jykgew0KICAgICAgICB0aGlzLnJlc2V0TGlzdFNlbGVjdGVkKHRoaXMuZGlhbG9nRGF0YVVuU2VsZWN0T2JqW3RoaXMuZGlhbG9nTmFtZV0pOw0KICAgICAgICB0aGlzLmRpYWxvZ0RhdGFVblNlbGVjdE9ialt0aGlzLmRpYWxvZ05hbWVdW2luZGV4XS5zZWxlY3RlZCA9IHN0YXR1czsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIHRoaXMuZGlhbG9nRGF0YVVuU2VsZWN0T2JqW3RoaXMuZGlhbG9nTmFtZV1baW5kZXhdLnNlbGVjdGVkID0gc3RhdHVzOw0KICAgICAgfQ0KICAgICAgLy8gdGhpcy5kaWFsb2dEYXRhVW5TZWxlY3RPYmpbdGhpcy5kaWFsb2dBY3RpdmVOYW1lXSA9IEpTT04ucGFyc2UoDQogICAgICAvLyAgIEpTT04uc3RyaW5naWZ5KHRoaXMuZGlhbG9nRGF0YVVuU2VsZWN0T2JqW3RoaXMuZGlhbG9nQWN0aXZlTmFtZV0pDQogICAgICAvLyApOw0KICAgICAgLy/ngrnlh7vliIfmjaLpgInkuK3nirbmgIENCiAgICAgIC8vIHRoaXMuJG5leHRUaWNrKCgpID0+IHsNCiAgICAgIC8vICAgdGhpcy4kcmVmc1sndW5zZWxlY3RUYWJsZSddWzBdLiRyZWZzWyd0YWJsZSddLnRvZ2dsZVJvd1NlbGVjdGlvbigNCiAgICAgIC8vICAgICByb3csDQogICAgICAvLyAgICAgc3RhdHVzDQogICAgICAvLyAgICk7DQogICAgICAvLyB9KTsNCiAgICB9LA0KICAgIC8v5Y2V5Liq6YCJ5Lit77yIdHlwZTogc2VsZWN0aW9u77yJ5pqC5pe25LiN55SoDQogICAgdW5zZWxlY3RUYWJsZVJvd1NlbGVjdChzZWxlY3Rpb24sIHJvdykgew0KICAgICAgLy8gcm93LnNlbGVjdGVkID0gIXJvdy5zZWxlY3RlZDsNCiAgICB9LA0KICAgIC8v5YWo6YCJ77yIdHlwZTogc2VsZWN0aW9u77yJ5pqC5pe25LiN55SoDQogICAgdW5zZWxlY3RUYWJsZVJvd1NlbGVjdEFsbChzZWxlY3Rpb24sIHR5cGUpIHsNCiAgICAgIGxldCBoYXNBbGxTZWxlY3RlZCA9IHNlbGVjdGlvbi5ldmVyeShpdGVtID0+IGl0ZW0uc2VsZWN0ZWQpOw0KICAgICAgaWYgKCFzZWxlY3Rpb24ubGVuZ3RoKSB7DQogICAgICAgIGhhc0FsbFNlbGVjdGVkID0gdHJ1ZTsNCiAgICAgIH0NCiAgICAgIGlmICh0eXBlID09PSAndW5zZWxlY3QnKSB7DQogICAgICAgIHRoaXMuZGlhbG9nRGF0YVVuU2VsZWN0T2JqW3RoaXMuZGlhbG9nQWN0aXZlTmFtZV0uZm9yRWFjaChpdGVtID0+IHsNCiAgICAgICAgICBpZiAoaGFzQWxsU2VsZWN0ZWQpIHsNCiAgICAgICAgICAgIGl0ZW0uc2VsZWN0ZWQgPSBmYWxzZTsNCiAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgaXRlbS5zZWxlY3RlZCA9IHRydWU7DQogICAgICAgICAgfQ0KICAgICAgICB9KTsNCiAgICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gJ3NlbGVjdGVkJykgew0KICAgICAgICB0aGlzLmRpYWxvZ0RhdGFTZWxlY3RlZE9ialt0aGlzLmRpYWxvZ0FjdGl2ZU5hbWVdLmZvckVhY2goaXRlbSA9PiB7DQogICAgICAgICAgaWYgKGhhc0FsbFNlbGVjdGVkKSB7DQogICAgICAgICAgICBpdGVtLnNlbGVjdGVkID0gZmFsc2U7DQogICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIGl0ZW0uc2VsZWN0ZWQgPSB0cnVlOw0KICAgICAgICAgIH0NCiAgICAgICAgfSk7DQogICAgICB9DQogICAgfSwNCiAgICBzZWxlY3RlZFRhYmxlUm93Q2xpY2socm93LCBjb2x1bW4sIGV2ZW50KSB7DQogICAgICBjb25zdCBpbmRleCA9IHRoaXMuZGlhbG9nRGF0YVNlbGVjdGVkT2JqW3RoaXMuZGlhbG9nQWN0aXZlTmFtZV0uZmluZEluZGV4KA0KICAgICAgICBpdGVtID0+IGl0ZW0uY3VzdG9tSWQgPT09IHJvdy5jdXN0b21JZA0KICAgICAgKTsNCiAgICAgIGNvbnN0IHN0YXR1cyA9ICF0aGlzLmRpYWxvZ0RhdGFTZWxlY3RlZE9ialt0aGlzLmRpYWxvZ0FjdGl2ZU5hbWVdW2luZGV4XQ0KICAgICAgICAuc2VsZWN0ZWQ7DQogICAgICB0aGlzLmRpYWxvZ0RhdGFTZWxlY3RlZE9ialt0aGlzLmRpYWxvZ0FjdGl2ZU5hbWVdWw0KICAgICAgICBpbmRleA0KICAgICAgXS5zZWxlY3RlZCA9IHN0YXR1czsNCiAgICAgIC8vIHRoaXMuZGlhbG9nRGF0YVNlbGVjdGVkT2JqW3RoaXMuZGlhbG9nQWN0aXZlTmFtZV0gPSBKU09OLnBhcnNlKA0KICAgICAgLy8gICBKU09OLnN0cmluZ2lmeSh0aGlzLmRpYWxvZ0RhdGFTZWxlY3RlZE9ialt0aGlzLmRpYWxvZ0FjdGl2ZU5hbWVdKQ0KICAgICAgLy8gKTsNCiAgICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHsNCiAgICAgICAgdGhpcy4kcmVmc1snc2VsZWN0ZWRUYWJsZSddWzBdLiRyZWZzWyd0YWJsZSddLnRvZ2dsZVJvd1NlbGVjdGlvbigNCiAgICAgICAgICByb3csDQogICAgICAgICAgc3RhdHVzDQogICAgICAgICk7DQogICAgICB9KTsNCiAgICB9LA0KICAgIC8v5by55qGG6YCJ5oup54q25oCBDQogICAgZ2V0Um93Q3VzdG9tTmFtZShyb3csIHJvd0luZGV4KSB7DQogICAgICBpZiAocm93LnJvdy5zZWxlY3RlZCkgew0KICAgICAgICByZXR1cm4gJ3RhYmxlLXNlbGVjdGVkIHRhYmxlLWl0ZW0nOw0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgcmV0dXJuICd0YWJsZS1pdGVtJzsNCiAgICAgIH0NCiAgICB9LA0KICAgIC8v57y66LSn5ZWG5ZOB5qCH5rOoDQogICAgZ2V0Um93Q3VzdG9tTmFtZVN0YXR1cyh7IHJvdywgcm93SW5kZXggfSkgew0KICAgICAgaWYgKHJvdy5vdXRPZlN0b2NrKSB7DQogICAgICAgIHJldHVybiAndGFibGUtbm8tcHJvZHVjdGlvbic7DQogICAgICB9IGVsc2Ugew0KICAgICAgICByZXR1cm4gJyc7DQogICAgICB9DQogICAgfSwNCiAgICAvL+a3u+WKoOihqOagvOaVsOaNrg0KICAgIGRpYWxvZ0NvbmZpcm0oKSB7DQogICAgICBsZXQgc2VsZWN0TGlzdCA9IFtdOw0KICAgICAgaWYgKHRoaXMuZGlhbG9nTmFtZSA9PT0gJ2luZ3JlZGllbnRzJykgew0KICAgICAgICAvLyDpo5/mnZDpgInkuK3mlbDmja7mjInlj7PkvqfpgInkuK3lsZXnpLoNCiAgICAgICAgc2VsZWN0TGlzdCA9IHRoaXMuc2VsZWN0ZWRJbmdyZWRpZW50TGlzdDsNCg0KICAgICAgICAvLyDmoKHpqozpgInkuK3po5/mnZDmlbDph4/pnZ7nqboNCiAgICAgICAgbGV0IGFyciA9IHNlbGVjdExpc3QuZmlsdGVyKGl0ZW0gPT4gIWl0ZW0ucGFja051bSk7DQogICAgICAgIGlmIChhcnIubGVuZ3RoID4gMCkgew0KICAgICAgICAgIHRoaXMud2FybmluZygn6K+35aGr5YaZ6aOf5p2Q5pWw6YeP77yBJyk7DQogICAgICAgICAgcmV0dXJuOw0KICAgICAgICB9DQogICAgICB9IGVsc2Ugew0KICAgICAgICBzZWxlY3RMaXN0ID0gdGhpcy5kaWFsb2dEYXRhVW5TZWxlY3RPYmpbdGhpcy5kaWFsb2dOYW1lXS5maWx0ZXIoDQogICAgICAgICAgaXRlbSA9PiBpdGVtLnNlbGVjdGVkDQogICAgICAgICk7DQogICAgICB9DQogICAgICBpZiAoIXNlbGVjdExpc3QubGVuZ3RoKSB7DQogICAgICAgIHRoaXMud2FybmluZyhg6K+36YCJ5oupJHt0aGlzLnRhYnNLZXlOYW1lW3RoaXMuZGlhbG9nTmFtZV19YCk7DQogICAgICAgIHJldHVybjsNCiAgICAgIH0NCiAgICAgIC8v6aOf5p2Q6buY6K6k5YiH6YWN5qCH5YeG5Li65q+b6I+cDQogICAgICBpZiAodGhpcy5kaWFsb2dOYW1lID09PSAnaW5ncmVkaWVudHMnKSB7DQogICAgICAgIHNlbGVjdExpc3QuZm9yRWFjaChpdGVtID0+IHsNCiAgICAgICAgICAvLyBpdGVtLmN1dE1hdGNoU3RhbmRhcmRJZCA9IDEwOw0KICAgICAgICAgIHRoaXMuJHNldChpdGVtLCAnY3V0TWF0Y2hTdGFuZGFyZElkJywgMTApOw0KICAgICAgICB9KTsNCiAgICAgICAgLy8NCiAgICAgICAgY29uc3QgaGFzQWRkSW5ncmVkaWVudExpc3QgPSB0aGlzLmRpYWxvZ0RhdGFTZWxlY3RlZE9ialsNCiAgICAgICAgICB0aGlzLmRpYWxvZ05hbWUNCiAgICAgICAgXTsNCiAgICAgICAgY29uc3QgcmVwZWF0TGlzdCA9IHRoaXMuaGFuZGxlU2VsZWN0UmVwZWF0KA0KICAgICAgICAgIHNlbGVjdExpc3QsDQogICAgICAgICAgaGFzQWRkSW5ncmVkaWVudExpc3QNCiAgICAgICAgKTsNCiAgICAgICAgaWYgKHJlcGVhdExpc3QubGVuZ3RoKSB7DQogICAgICAgICAgbGV0IHRpcHNNZXNzYWdlQ29udGVudCA9ICcnOw0KICAgICAgICAgIHJlcGVhdExpc3QuZm9yRWFjaChpdGVtID0+IHsNCiAgICAgICAgICAgIHRpcHNNZXNzYWdlQ29udGVudCArPSBgPGRpdj4kew0KICAgICAgICAgICAgICBpdGVtLnJlbGF0aW9uTmFtZQ0KICAgICAgICAgICAgfeW3sua3u+WKoOi/hyR7aXRlbS5wYWNrTnVtIHx8ICcwJ30ke2l0ZW0ucGFja1VuaXR9PC9kaXY+YDsNCiAgICAgICAgICB9KTsNCiAgICAgICAgICBjb25zdCB0aXBzTWVzc2FnZSA9IGANCiAgICAgICAgICAgIDxkaXYgY2xhc3M9J3RpcHMtY29udGVudC1tZXNzYWFnZSc+5pyJ6YeN5aSN5re75Yqg6aOf5p2Q77yM5piv5ZCm56Gu6K6k57un57ut5re75Yqg77yfPC9kaXY+DQogICAgICAgICAgICA8ZGl2IGNsYXNzPSd0aXBzLWNvbnRlbnQtYm94Jz4NCiAgICAgICAgICAgICR7dGlwc01lc3NhZ2VDb250ZW50fQ0KICAgICAgICAgICAgPC9kaXY+DQogICAgICAgICAgICA8ZGl2IGNsYXNzPSd0aXBzLWNvbnRlbnQtaW5mbyc+54K55Ye744CQ5Y676YeN5re75Yqg44CR77yM5Y+q5re75Yqg5paw5aKe55qE6aOf5p2Q77yM54K55Ye744CQ5YWo6YOo5re75Yqg44CR5YiZ5re75Yqg5omA5pyJ6YCJ5oup55qE6aOf5p2QPC9kaXY+DQogICAgICAgICAgYDsNCiAgICAgICAgICB0aGlzLiRjb25maXJtKHRpcHNNZXNzYWdlLCAn5o+Q6YaSJywgew0KICAgICAgICAgICAgY3VzdG9tQ2xhc3M6ICdvcmRlci10aXBzLW1lc3NhZ2UnLA0KICAgICAgICAgICAgZGFuZ2Vyb3VzbHlVc2VIVE1MU3RyaW5nOiB0cnVlLA0KICAgICAgICAgICAgY2xvc2VPbkNsaWNrTW9kYWw6IGZhbHNlLA0KICAgICAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICflhajpg6jmt7vliqAnLA0KICAgICAgICAgICAgY2FuY2VsQnV0dG9uVGV4dDogJ+WOu+mHjea3u+WKoCcNCiAgICAgICAgICAgIC8vIHR5cGU6ICd3YXJuaW5nJw0KICAgICAgICAgIH0pDQogICAgICAgICAgICAudGhlbigoKSA9PiB7DQogICAgICAgICAgICAgIHRoaXMuZGlhbG9nRGF0YVNlbGVjdGVkT2JqW3RoaXMuZGlhbG9nTmFtZV0udW5zaGlmdCgNCiAgICAgICAgICAgICAgICAuLi5zZWxlY3RMaXN0DQogICAgICAgICAgICAgICk7DQogICAgICAgICAgICAgIHRoaXMuY2xvc2VEaWFsb2coKTsNCiAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgfSkNCiAgICAgICAgICAgIC5jYXRjaCgoKSA9PiB7DQogICAgICAgICAgICAgIHNlbGVjdExpc3QgPSBzZWxlY3RMaXN0LmZpbHRlcihpdGVtID0+IHsNCiAgICAgICAgICAgICAgICByZXR1cm4gIX5yZXBlYXRMaXN0LmZpbmRJbmRleCgNCiAgICAgICAgICAgICAgICAgIGl0ID0+IGl0LnJlbGF0aW9uSWQgPT09IGl0ZW0ucmVsYXRpb25JZA0KICAgICAgICAgICAgICAgICk7DQogICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICB0aGlzLmRpYWxvZ0RhdGFTZWxlY3RlZE9ialt0aGlzLmRpYWxvZ05hbWVdLnVuc2hpZnQoDQogICAgICAgICAgICAgICAgLi4uc2VsZWN0TGlzdA0KICAgICAgICAgICAgICApOw0KICAgICAgICAgICAgICB0aGlzLmNsb3NlRGlhbG9nKCk7DQogICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgIH0pOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgIHRoaXMuZGlhbG9nRGF0YVNlbGVjdGVkT2JqW3RoaXMuZGlhbG9nTmFtZV0udW5zaGlmdCguLi5zZWxlY3RMaXN0KTsNCiAgICAgICAgICB0aGlzLmNsb3NlRGlhbG9nKCk7DQogICAgICAgIH0NCiAgICAgIH0gZWxzZSB7DQogICAgICAgIGlmICh0aGlzLmRpYWxvZ05hbWUgPT0gJ2Rpc2gnKSB7DQogICAgICAgICAgdGhpcy5zZXREaXNoUmVwZWF0KCdkaXNoJywgc2VsZWN0TGlzdCk7DQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgdGhpcy5kaWFsb2dEYXRlVmlzaWJsZSA9IHRydWU7DQogICAgICAgICAgdGhpcy5kaWFsb2dEYXRhU2VsZWN0ZWRPYmpbdGhpcy5kaWFsb2dOYW1lXS51bnNoaWZ0KC4uLnNlbGVjdExpc3QpOw0KICAgICAgICB9DQogICAgICB9DQogICAgfSwNCiAgICAvLyDoj5zlk4Hph43lpI0NCiAgICBzZXREaXNoUmVwZWF0KHR5cGUsIHNlbGVjdExpc3QpIHsNCiAgICAgIGNvbnN0IGhhc0FkZERpc2hMaXN0ID0gdGhpcy5kaWFsb2dEYXRhU2VsZWN0ZWRPYmpbdHlwZV07DQogICAgICBjb25zdCByZXBlYXRMaXN0ID0gdGhpcy5oYW5kbGVTZWxlY3RSZXBlYXQoc2VsZWN0TGlzdCwgaGFzQWRkRGlzaExpc3QpOw0KICAgICAgaWYgKHJlcGVhdExpc3QubGVuZ3RoKSB7DQogICAgICAgIGxldCB0aXBzTWVzc2FnZUNvbnRlbnQgPSAnJzsNCiAgICAgICAgcmVwZWF0TGlzdC5mb3JFYWNoKGl0ZW0gPT4gew0KICAgICAgICAgIGxldCBwYXJhbSA9ICcnOw0KICAgICAgICAgIGlmIChpdGVtLnF1YW50aXR5KSB7DQogICAgICAgICAgICBwYXJhbSA9ICflt7Lmt7vliqDov4cnICsgaXRlbS5xdWFudGl0eSArICfku70nOw0KICAgICAgICAgIH0NCiAgICAgICAgICB0aXBzTWVzc2FnZUNvbnRlbnQgKz0gYDxkaXY+JHtpdGVtLnJlbGF0aW9uTmFtZX0gJHtwYXJhbX08L2Rpdj5gOw0KICAgICAgICB9KTsNCiAgICAgICAgY29uc3QgdGlwc01lc3NhZ2UgPSBgDQogICAgICAgICAgICA8ZGl2IGNsYXNzPSd0aXBzLWNvbnRlbnQtbWVzc2FhZ2UnPuaciemHjeWkjea3u+WKoOiPnOWTge+8jOaYr+WQpuehruiupOe7p+e7rea3u+WKoO+8nzwvZGl2Pg0KICAgICAgICAgICAgPGRpdiBjbGFzcz0ndGlwcy1jb250ZW50LWJveCc+DQogICAgICAgICAgICAke3RpcHNNZXNzYWdlQ29udGVudH0NCiAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICAgICAgPGRpdiBjbGFzcz0ndGlwcy1jb250ZW50LWluZm8nPueCueWHu+OAkOWOu+mHjea3u+WKoOOAke+8jOWPqua3u+WKoOaWsOWinueahOiPnOWTge+8jOeCueWHu+OAkOWFqOmDqOa3u+WKoOOAkeWImea3u+WKoOaJgOaciemAieaLqeeahOiPnOWTgTwvZGl2Pg0KICAgICAgICAgIGA7DQogICAgICAgIHRoaXMuJGNvbmZpcm0odGlwc01lc3NhZ2UsICfmj5DphpInLCB7DQogICAgICAgICAgY3VzdG9tQ2xhc3M6ICdvcmRlci10aXBzLW1lc3NhZ2UnLA0KICAgICAgICAgIGRhbmdlcm91c2x5VXNlSFRNTFN0cmluZzogdHJ1ZSwNCiAgICAgICAgICBjbG9zZU9uQ2xpY2tNb2RhbDogZmFsc2UsDQogICAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICflhajpg6jmt7vliqAnLA0KICAgICAgICAgIGNhbmNlbEJ1dHRvblRleHQ6ICfljrvph43mt7vliqAnDQogICAgICAgICAgLy8gdHlwZTogJ3dhcm5pbmcnDQogICAgICAgIH0pDQogICAgICAgICAgLnRoZW4oKCkgPT4gew0KICAgICAgICAgICAgdGhpcy5kaWFsb2dEYXRhU2VsZWN0ZWRPYmpbdHlwZV0udW5zaGlmdCguLi5zZWxlY3RMaXN0KTsNCiAgICAgICAgICAgIHRoaXMuY2xvc2VEaWFsb2coKTsNCiAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICB9KQ0KICAgICAgICAgIC5jYXRjaCgoKSA9PiB7DQogICAgICAgICAgICBzZWxlY3RMaXN0ID0gc2VsZWN0TGlzdC5maWx0ZXIoaXRlbSA9PiB7DQogICAgICAgICAgICAgIHJldHVybiAhfnJlcGVhdExpc3QuZmluZEluZGV4KA0KICAgICAgICAgICAgICAgIGl0ID0+IGl0LnJlbGF0aW9uSWQgPT09IGl0ZW0ucmVsYXRpb25JZA0KICAgICAgICAgICAgICApOw0KICAgICAgICAgICAgfSk7DQogICAgICAgICAgICB0aGlzLmRpYWxvZ0RhdGFTZWxlY3RlZE9ialt0eXBlXS51bnNoaWZ0KC4uLnNlbGVjdExpc3QpOw0KICAgICAgICAgICAgdGhpcy5jbG9zZURpYWxvZygpOw0KICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgIH0pOw0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgdGhpcy5kaWFsb2dEYXRhU2VsZWN0ZWRPYmpbdHlwZV0udW5zaGlmdCguLi5zZWxlY3RMaXN0KTsNCiAgICAgICAgdGhpcy5jbG9zZURpYWxvZygpOw0KICAgICAgfQ0KICAgIH0sDQogICAgLy/ojrflj5bpo5/mnZDph43lpI3lhoXlrrkNCiAgICBoYW5kbGVTZWxlY3RSZXBlYXQoc2VsZWN0TGlzdCwgaGFzQWRkTGlzdCkgew0KICAgICAgY29uc3QgcmVwZWF0TGlzdCA9IFtdOw0KICAgICAgaGFzQWRkTGlzdC5mb3JFYWNoKGl0ZW0gPT4gew0KICAgICAgICBpZiAoDQogICAgICAgICAgc2VsZWN0TGlzdC5maW5kKGl0ID0+IHsNCiAgICAgICAgICAgIHJldHVybiBpdC5yZWxhdGlvbklkID09PSBpdGVtLnJlbGF0aW9uSWQ7DQogICAgICAgICAgfSkNCiAgICAgICAgKSB7DQogICAgICAgICAgcmVwZWF0TGlzdC5wdXNoKGl0ZW0pOw0KICAgICAgICB9DQogICAgICB9KTsNCiAgICAgIHJldHVybiByZXBlYXRMaXN0Ow0KICAgIH0sDQogICAgLy/kv53lrZjorqLljZXlhoXlrrkNCiAgICBzYXZlT3JkZXJBbmRDb250ZW50KCkgew0KICAgICAgbGV0IGtleXMgPSBPYmplY3Qua2V5cyh0aGlzLmRpYWxvZ0RhdGFTZWxlY3RlZE9iaik7DQogICAgICBsZXQgb3JkZXJDb250ZW50QWRkUmVxRHRvTGlzdCA9IFtdOw0KICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBrZXlzLmxlbmd0aDsgaSsrKSB7DQogICAgICAgIGxldCBvcmRlckNvbnRlbnRSZXFEdG9MaXN0ID0gW107DQogICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgdGhpcy5kaWFsb2dEYXRhU2VsZWN0ZWRPYmpba2V5c1tpXV0ubGVuZ3RoOyBqKyspIHsNCiAgICAgICAgICBpZiAoDQogICAgICAgICAgICBrZXlzW2ldID09ICdkaXNoJyAmJg0KICAgICAgICAgICAgIXRoaXMuZGlhbG9nRGF0YVNlbGVjdGVkT2JqW2tleXNbaV1dW2pdLm1lYWxUeXBlDQogICAgICAgICAgKSB7DQogICAgICAgICAgICB0aGlzLndhcm5pbmcoJ+ivt+mAieaLqemkkOWIqycpOw0KICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgIH0NCiAgICAgICAgICBpZiAoDQogICAgICAgICAgICBrZXlzW2ldID09ICdpbmdyZWRpZW50cycgJiYNCiAgICAgICAgICAgICF0aGlzLmRpYWxvZ0RhdGFTZWxlY3RlZE9ialtrZXlzW2ldXVtqXS5jdXRNYXRjaFN0YW5kYXJkSWQNCiAgICAgICAgICApIHsNCiAgICAgICAgICAgIHRoaXMud2FybmluZygn6K+36YCJ5oup5YiH6YWN5qCH5YeGJyk7DQogICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgfQ0KICAgICAgICAgIGlmICgNCiAgICAgICAgICAgIChrZXlzW2ldID09PSAnZGlzaCcgJiYNCiAgICAgICAgICAgICAgIXRoaXMuZGlhbG9nRGF0YVNlbGVjdGVkT2JqW2tleXNbaV1dW2pdLnF1YW50aXR5KSB8fA0KICAgICAgICAgICAgKGtleXNbaV0gPT09ICdpbmdyZWRpZW50cycgJiYNCiAgICAgICAgICAgICAgIXRoaXMuZGlhbG9nRGF0YVNlbGVjdGVkT2JqW2tleXNbaV1dW2pdLnBhY2tOdW0pDQogICAgICAgICAgKSB7DQogICAgICAgICAgICB0aGlzLndhcm5pbmcoJ+ivt+i+k+WFpeaVsOmHjycpOw0KICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgIH0NCiAgICAgICAgICBpZiAoDQogICAgICAgICAgICAhdGhpcy5kaWFsb2dEYXRhU2VsZWN0ZWRPYmpba2V5c1tpXV1bal0uYXJyaXZhbERhdGUgfHwNCiAgICAgICAgICAgICF0aGlzLmRpYWxvZ0RhdGFTZWxlY3RlZE9ialtrZXlzW2ldXVtqXS5hcnJpdmFsVGltZQ0KICAgICAgICAgICkgew0KICAgICAgICAgICAgdGhpcy53YXJuaW5nKCfor7fpgInmi6nliLDotKfml7bpl7QnKTsNCiAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICB9DQogICAgICAgICAgLy8gaWYgKHRoaXMuZGlhbG9nRGF0YVNlbGVjdGVkT2JqW2tleXNbaV1dW2pdLm91dE9mU3RvY2sgPT09IDEpIHsNCiAgICAgICAgICAvLyAgIHRoaXMud2FybmluZygn6K6i5Y2V5Lit5ZCr5pyJ57y66LSn5ZWG5ZOBJyk7DQogICAgICAgICAgLy8gICByZXR1cm47DQogICAgICAgICAgLy8gfQ0KICAgICAgICAgIG9yZGVyQ29udGVudFJlcUR0b0xpc3QucHVzaCh0aGlzLmRpYWxvZ0RhdGFTZWxlY3RlZE9ialtrZXlzW2ldXVtqXSk7DQogICAgICAgIH0NCiAgICAgICAgb3JkZXJDb250ZW50QWRkUmVxRHRvTGlzdC5wdXNoKHsNCiAgICAgICAgICB0eXBlOiB0aGlzLnF1ZXJ5T2JqZWN0W2tleXNbaV1dLA0KICAgICAgICAgIG9yZGVyQ29udGVudFJlcUR0b0xpc3QNCiAgICAgICAgfSk7DQogICAgICB9DQogICAgICBsZXQgaXNFbXB0eSA9IG9yZGVyQ29udGVudEFkZFJlcUR0b0xpc3QuZXZlcnkoaXRlbSA9PiB7DQogICAgICAgIHJldHVybiAhaXRlbS5vcmRlckNvbnRlbnRSZXFEdG9MaXN0Lmxlbmd0aDsNCiAgICAgIH0pOw0KICAgICAgaWYgKGlzRW1wdHkpIHsNCiAgICAgICAgdGhpcy53YXJuaW5nKCfor7fmt7vliqDorqLljZXlhoXlrrknKTsNCiAgICAgICAgcmV0dXJuOw0KICAgICAgfQ0KICAgICAgY29uc3Qgew0KICAgICAgICBzY2hvb2xCcmFuY2hDb2RlLA0KICAgICAgICBhcnJpdmFsRGF0ZSwNCiAgICAgICAgb3JkZXJTdGF0dXMsDQogICAgICAgIHByb3ZpbmNlQ29kZSwNCiAgICAgICAgY2l0eUNvZGUsDQogICAgICAgIHNjaG9vbENvZGUsDQogICAgICAgIGRpc3RyaWN0Q29kZQ0KICAgICAgfSA9IHRoaXMuZm9ybURhdGE7DQogICAgICBjb25zdCBwYXJhbXMgPSB7DQogICAgICAgIG9yZGVySWQ6IHRoaXMub3BlcmFUeXBlID09PSAnY29weScgPyBudWxsIDogdGhpcy5vcmRlcklkLA0KICAgICAgICB0eXBlOiBvcmRlclN0YXR1cywNCiAgICAgICAgZGVwdElkOiBzY2hvb2xCcmFuY2hDb2RlLA0KICAgICAgICBwYXJlbnREZXB0SWQ6IHNjaG9vbENvZGUsDQogICAgICAgIC8vIGFycml2YWxUaW1lOiBhcnJpdmFsRGF0ZSwNCiAgICAgICAgcmVtYXJrczogdGhpcy5vcmRlclJlbWFyaywNCiAgICAgICAgaW5jbHVkaW5nRGlzaGVzU2Vhc29uaW5nOiB0aGlzLmluY2x1ZGluZ0Rpc2hlc1NlYXNvbmluZywNCiAgICAgICAgcHJvdmluY2VDb2RlLA0KICAgICAgICBjaXR5Q29kZSwNCiAgICAgICAgZGlzdHJpY3RDb2RlLA0KICAgICAgICBvcmRlckNvbnRlbnRBZGRSZXFEdG9MaXN0DQogICAgICB9Ow0KICAgICAgcmV0dXJuIHNhdmVPcmRlckFuZENvbnRlbnQocGFyYW1zKS50aGVuKHJlcyA9PiB7DQogICAgICAgIHRoaXMuZGlhbG9nVmlzaWJsZSA9IGZhbHNlOw0KICAgICAgICB0aGlzLndhcm5pbmcoJ+S/neWtmOaIkOWKnycsICdzdWNjZXNzJyk7DQogICAgICAgIGNvbnN0IHJlc0RhdGEgPSByZXMuZGF0YSB8fCB7fTsNCiAgICAgICAgdGhpcy5vcmRlcklkID0gcmVzRGF0YS5vcmRlcklkOw0KICAgICAgfSk7DQogICAgfSwNCiAgICAvL+aXpeacn+mAieaLqeW8ueeqlw0KICAgIGRpYWxvZ0RhdGVDb25maXJtKCkgew0KICAgICAgY29uc3QgbG9hZGluZyA9IHRoaXMuJGxvYWRpbmcoew0KICAgICAgICBsb2NrOiB0cnVlLA0KICAgICAgICB0ZXh0OiAnTG9hZGluZycsDQogICAgICAgIHNwaW5uZXI6ICdlbC1pY29uLWxvYWRpbmcnLA0KICAgICAgICBiYWNrZ3JvdW5kOiAncmdiYSgwLCAwLCAwLCAwLjcpJw0KICAgICAgfSk7DQogICAgICB0cnkgew0KICAgICAgICBjb25zdCB3ZWVrTGlzdCA9IHRoaXMuZGlhbG9nRGF0YVNlbGVjdGVkT2JqW3RoaXMuZGlhbG9nTmFtZV1bMF1bDQogICAgICAgICAgJ21lYWxEYXlMaXN0Jw0KICAgICAgICBdOw0KICAgICAgICAvL+aXpeacn+ebuOW3ruWkqeaVsA0KICAgICAgICBjb25zdCBkYXlOdW0gPQ0KICAgICAgICAgIChuZXcgRGF0ZSh0aGlzLmRpYWxvZ0RhdGVSYW5nZVsxXSkgLQ0KICAgICAgICAgICAgbmV3IERhdGUodGhpcy5kaWFsb2dEYXRlUmFuZ2VbMF0pKSAvDQogICAgICAgICAgICAxMDAwIC8NCiAgICAgICAgICAgIDM2MDAgLw0KICAgICAgICAgICAgMjQgKw0KICAgICAgICAgIDE7DQogICAgICAgIGNvbnN0IHN0YXJ0V2VlayA9IG5ldyBEYXRlKHRoaXMuZGlhbG9nRGF0ZVJhbmdlWzBdKS5nZXREYXkoKTsNCiAgICAgICAgbGV0IHN0YXJ0RGF5ID0gbmV3IERhdGUodGhpcy5kaWFsb2dEYXRlUmFuZ2VbMF0pLmdldFRpbWUoKTsNCiAgICAgICAgbGV0IHN0YXJ0SW5kZXg7DQogICAgICAgIGlmIChzdGFydFdlZWspIHsNCiAgICAgICAgICBzdGFydEluZGV4ID0gc3RhcnRXZWVrIC0gMTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICBzdGFydEluZGV4ID0gNjsNCiAgICAgICAgfQ0KICAgICAgICBjb25zdCBsaXN0ID0gW107DQogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZGF5TnVtOyBpKyspIHsNCiAgICAgICAgICBjb25zdCBtZWFsVHlwZUxpc3QgPSB3ZWVrTGlzdFtzdGFydEluZGV4XVsnbWVhbFR5cGVMaXN0J107DQogICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBtZWFsVHlwZUxpc3QubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgbWVhbFR5cGVMaXN0W2ldLmNvbnRlbnRMaXN0Lmxlbmd0aDsgaisrKSB7DQogICAgICAgICAgICAgIGNvbnN0IGl0ZW0gPSBtZWFsVHlwZUxpc3RbaV0uY29udGVudExpc3Rbal07DQogICAgICAgICAgICAgIC8v5pep6aSQ5YmN5LiA5aSpIDE1IOeCuemAge+8jOWNiOmkkOaZmumkkOW9k+WkqeS5neeCuemAgQ0KICAgICAgICAgICAgICBsaXN0LnB1c2goDQogICAgICAgICAgICAgICAgT2JqZWN0LmFzc2lnbih7fSwgaXRlbSwgew0KICAgICAgICAgICAgICAgICAgYXJyaXZhbERhdGU6DQogICAgICAgICAgICAgICAgICAgIGl0ZW0ubWVhbFR5cGUgPT09IDENCiAgICAgICAgICAgICAgICAgICAgICA/IHRoaXMuZm9ybWF0ZURhdGUoc3RhcnREYXkgLSAxMDAwICogMzYwMCAqIDI0KQ0KICAgICAgICAgICAgICAgICAgICAgIDogdGhpcy5mb3JtYXRlRGF0ZShzdGFydERheSksDQogICAgICAgICAgICAgICAgICBhcnJpdmFsVGltZTogdGhpcy5nZXRBcnJpdmFsVGltZShpdGVtLm1lYWxUeXBlKQ0KICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICAgICk7DQogICAgICAgICAgICB9DQogICAgICAgICAgfQ0KICAgICAgICAgIHN0YXJ0SW5kZXggPSBzdGFydEluZGV4ID09PSA2ID8gMCA6IHN0YXJ0SW5kZXggKyAxOw0KICAgICAgICAgIC8v5aSp5pWwKzEg5aSpDQogICAgICAgICAgc3RhcnREYXkgKz0gMzYwMCAqIDI0ICogMTAwMDsNCiAgICAgICAgfQ0KICAgICAgICAvLyB0aGlzLmRpYWxvZ0RhdGFTZWxlY3RlZE9ialsnZGlzaCddLnVuc2hpZnQoLi4ubGlzdCk7DQogICAgICAgIHRoaXMuc2V0RGlzaFJlcGVhdCgnZGlzaCcsIGxpc3QpOw0KICAgICAgICB0aGlzLmRpYWxvZ0RhdGFTZWxlY3RlZE9ialsnbWVudSddID0gW107DQogICAgICB9IGNhdGNoIChlcnIpIHsNCiAgICAgIH0gZmluYWxseSB7DQogICAgICAgIHRoaXMuY2xvc2VEYXRlRGlhbG9nKCk7DQogICAgICAgIGxvYWRpbmcuY2xvc2UoKTsNCiAgICAgIH0NCiAgICB9LA0KICAgIC8v6I635Y+W6YWN6YCB5pe26Ze0DQogICAgZ2V0QXJyaXZhbFRpbWUodHlwZSkgew0KICAgICAgbGV0IHRpbWUgPSAnJzsNCiAgICAgIHN3aXRjaCAodHlwZSkgew0KICAgICAgICBjYXNlIDE6DQogICAgICAgICAgdGltZSA9ICcxNTowMCc7DQogICAgICAgICAgYnJlYWs7DQogICAgICAgIGNhc2UgMjoNCiAgICAgICAgY2FzZSAzOg0KICAgICAgICAgIHRpbWUgPSAnMDY6MDAnOw0KICAgICAgICAgIGJyZWFrOw0KICAgICAgICBkZWZhdWx0Og0KICAgICAgICAgIGJyZWFrOw0KICAgICAgfQ0KICAgICAgcmV0dXJuIHRpbWU7DQogICAgfSwNCiAgICAvL+aIkOacrOS7t+iuoeeulyjmmoLml7bpmpDol48pDQogICAgaGFuZGxlSW5wdXROdW1iZXIoKSB7DQogICAgICAvLyBsZXQgcHJpY2VTdW0gPSAwOw0KICAgICAgLy8gY29uc3Qga2V5cyA9IE9iamVjdC5rZXlzKHRoaXMuZGlhbG9nRGF0YVNlbGVjdGVkT2JqKTsNCiAgICAgIC8vIGZvciAobGV0IGkgPSAwOyBpIDwga2V5cy5sZW5ndGg7IGkrKykgew0KICAgICAgLy8gICBmb3IgKGxldCBqID0gMDsgaiA8IHRoaXMuZGlhbG9nRGF0YVNlbGVjdGVkT2JqW2tleXNbaV1dLmxlbmd0aDsgaisrKSB7DQogICAgICAvLyAgICAgY29uc3QgaXRlbSA9IHRoaXMuZGlhbG9nRGF0YVNlbGVjdGVkT2JqW2tleXNbaV1dW2pdOw0KICAgICAgLy8gICAgIGlmIChrZXlzW2ldID09PSAnZGlzaCcpIHsNCiAgICAgIC8vICAgICAgIGlmIChpdGVtLnF1YW50aXR5ICYmIGl0ZW0uY29zdFByaWNlKSB7DQogICAgICAvLyAgICAgICAgIHByaWNlU3VtICs9IGl0ZW0ucXVhbnRpdHkgKiBpdGVtLmNvc3RQcmljZTsNCiAgICAgIC8vICAgICAgIH0NCiAgICAgIC8vICAgICB9IGVsc2UgaWYgKGtleXNbaV0gPT09ICdpbmdyZWRpZW50cycpIHsNCiAgICAgIC8vICAgICAgIGlmIChpdGVtLmN1dE1hdGNoU3RhbmRhcmRJZCkgew0KICAgICAgLy8gICAgICAgICBpZiAoaXRlbS5jdXRNYXRjaFN0YW5kYXJkSWQgPT09IDkpIHsNCiAgICAgIC8vICAgICAgICAgICBpZiAoaXRlbS5wYWNrTnVtICYmIGl0ZW0uY2xlYW5WZWdldGFibGVQcmljZSkgew0KICAgICAgLy8gICAgICAgICAgICAgcHJpY2VTdW0gKz0NCiAgICAgIC8vICAgICAgICAgICAgICAgaXRlbS5wYWNrTnVtICogaXRlbS5uZXRXZWlnaHQgKiBpdGVtLmNsZWFuVmVnZXRhYmxlUHJpY2U7DQogICAgICAvLyAgICAgICAgICAgfQ0KICAgICAgLy8gICAgICAgICB9IGVsc2Ugew0KICAgICAgLy8gICAgICAgICAgIGlmIChpdGVtLnBhY2tOdW0gJiYgaXRlbS5vcmlnaW5hbFZlZ2V0YWJsZVByaWNlKSB7DQogICAgICAvLyAgICAgICAgICAgICBwcmljZVN1bSArPQ0KICAgICAgLy8gICAgICAgICAgICAgICBpdGVtLnBhY2tOdW0gKiBpdGVtLm5ldFdlaWdodCAqIGl0ZW0ub3JpZ2luYWxWZWdldGFibGVQcmljZTsNCiAgICAgIC8vICAgICAgICAgICB9DQogICAgICAvLyAgICAgICAgIH0NCiAgICAgIC8vICAgICAgIH0NCiAgICAgIC8vICAgICB9DQogICAgICAvLyAgIH0NCiAgICAgIC8vIH0NCiAgICAgIC8vIHRoaXMuc3RhdGlzdGljc0luZm8uY29zdFByaWNlID0gcHJpY2VTdW0udG9GaXhlZCgyKTsNCiAgICB9LA0KICAgIC8v6YeN572u6YCJ5oup54q25oCBDQogICAgcmVzZXRMaXN0U2VsZWN0ZWQobGlzdCkgew0KICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aDsgaSsrKSB7DQogICAgICAgIGlmIChsaXN0W2ldLnNlbGVjdGVkKSB7DQogICAgICAgICAgbGlzdFtpXS5zZWxlY3RlZCA9IGZhbHNlOw0KICAgICAgICB9DQogICAgICB9DQogICAgfSwNCiAgICAvL+i/h+a7pOaVsOe7hO+8iOWQjeensOaIluiAheeugOaLvOi/h+a7pO+8iQ0KICAgIGdldEZpbHRlckRhdGEobGlzdCwgc3RyKSB7DQogICAgICBsZXQgZmlsdGVyTGlzdCA9IGxpc3QuZmlsdGVyKGl0ZW0gPT4gew0KICAgICAgICByZXR1cm4gKA0KICAgICAgICAgIH5pdGVtLnBpbnlpbkhlYWRlci5pbmRleE9mKHN0ci50b0xvY2FsZVVwcGVyQ2FzZSgpKSB8fA0KICAgICAgICAgIH5pdGVtLnJlbGF0aW9uTmFtZS5pbmRleE9mKHN0cikNCiAgICAgICAgKTsNCiAgICAgIH0pOw0KICAgICAgcmV0dXJuIGZpbHRlckxpc3Q7DQogICAgfSwNCg0KICAgIGdldEZpbHRlckxpc3QobGlzdCwgc3RyKSB7DQogICAgICBsZXQgYXJyID0gbGlzdC5tYXAoaXRlbSA9PiB7DQogICAgICAgIGxldCBuZXdDaGlsZHJlbiA9IGl0ZW0uY2hpbGRyZW4uZmlsdGVyKGVsID0+IHsNCiAgICAgICAgICByZXR1cm4gKA0KICAgICAgICAgICAgfmVsLnBpbnlpbkhlYWRlci5pbmRleE9mKHN0ci50b0xvY2FsZVVwcGVyQ2FzZSgpKSB8fA0KICAgICAgICAgICAgfmVsLnJlbGF0aW9uTmFtZS5pbmRleE9mKHN0cikNCiAgICAgICAgICApOw0KICAgICAgICB9KTsNCiAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICBuYW1lOiBpdGVtLm5hbWUsDQogICAgICAgICAgY2hpbGRyZW46IG5ld0NoaWxkcmVuDQogICAgICAgIH07DQogICAgICB9KTsNCg0KICAgICAgbGV0IGZpbHRlckxpc3QgPSBhcnIuZmlsdGVyKGl0ZW0gPT4gaXRlbS5jaGlsZHJlbi5sZW5ndGggPiAwKTsNCiAgICAgIHRoaXMuc2lkZUFjdGl2ZSA9IGZpbHRlckxpc3QubGVuZ3RoID4gMCA/IGZpbHRlckxpc3RbMF0ubmFtZSA6ICcnOw0KICAgICAgcmV0dXJuIGZpbHRlckxpc3Q7DQogICAgfSwNCiAgICBoYW5kbGVEaWFsb2dDbG9zZShkb25lKSB7DQogICAgICAvLyB0aGlzLmluaXREaWFsb2dEYXRhKCk7DQogICAgICBkb25lKCk7DQogICAgfSwNCiAgICBpbml0RGlhbG9nRGF0YSgpIHsNCiAgICAgIHRoaXMuZGlhbG9nRGF0YVVuU2VsZWN0T2JqID0gew0KICAgICAgICBtZW51OiBbXSwNCiAgICAgICAgZGlzaDogW10sDQogICAgICAgIGluZ3JlZGllbnRzOiBbXQ0KICAgICAgfTsNCiAgICAgIHRoaXMuZGlhbG9nRGF0YVNlbGVjdGVkT2JqID0gew0KICAgICAgICBtZW51OiBbXSwNCiAgICAgICAgZGlzaDogW10sDQogICAgICAgIGluZ3JlZGllbnRzOiBbXQ0KICAgICAgfTsNCiAgICAgIHRoaXMuZGlhbG9nVW5zZWxlY3RJbnB1dCA9ICcnOw0KICAgICAgdGhpcy5kaWFsb2dTZWxlY3RlZElucHV0ID0gJyc7DQogICAgfSwNCiAgICAvL+iOt+WPluiuouWNleivpuaDhe+8iOiuouWNleeahOecgeW4guWMuuaAp+i0qO+8iQ0KICAgIGdldE9yZGVyRGV0YWlsKCkgew0KICAgICAgcmV0dXJuIGdldE9yZGVyRGV0YWlsKHsgb3JkZXJJZDogdGhpcy5vcmRlcklkIH0pLnRoZW4ocmVzID0+IHsNCiAgICAgICAgY29uc3QgcmVzRGF0YSA9IHJlcy5kYXRhIHx8IHt9Ow0KICAgICAgICBjb25zdCB7DQogICAgICAgICAgcHJvdmluY2VDb2RlLA0KICAgICAgICAgIGNpdHlDb2RlLA0KICAgICAgICAgIGRpc3RyaWN0Q29kZSwNCiAgICAgICAgICBwYXJlbnREZXB0SWQsDQogICAgICAgICAgZGVwdElkLA0KICAgICAgICAgIGFycml2YWxUaW1lLA0KICAgICAgICAgIHR5cGUsDQogICAgICAgICAgcmVtYXJrcywNCiAgICAgICAgICBpbmNsdWRpbmdEaXNoZXNTZWFzb25pbmcNCiAgICAgICAgfSA9IHJlc0RhdGE7DQogICAgICAgIHRoaXMuZGlzdHJpY3RDb2RlID0gZGlzdHJpY3RDb2RlOw0KICAgICAgICAvL+e8lui+keaXtuWIneWni+WMluWMuuWfn+S/oeaBrw0KICAgICAgICB0aGlzLiRzZXQodGhpcy5mb3JtRGF0YSwgJ3Byb3ZpbmNlQ29kZScsIHByb3ZpbmNlQ29kZSk7DQogICAgICAgIHNldFRpbWVvdXQoKCkgPT4gew0KICAgICAgICAgIHRoaXMuJHNldCh0aGlzLmZvcm1EYXRhLCAnY2l0eUNvZGUnLCBjaXR5Q29kZSk7DQogICAgICAgIH0sIDApOw0KICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAgICAgICB0aGlzLiRzZXQodGhpcy5mb3JtRGF0YSwgJ2Rpc3RyaWN0Q29kZScsIGRpc3RyaWN0Q29kZSk7DQogICAgICAgIH0sIDApOw0KICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAgICAgICB0aGlzLiRzZXQodGhpcy5mb3JtRGF0YSwgJ3NjaG9vbENvZGUnLCBwYXJlbnREZXB0SWQpOw0KICAgICAgICB9LCAwKTsNCiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7DQogICAgICAgICAgdGhpcy4kc2V0KHRoaXMuZm9ybURhdGEsICdzY2hvb2xCcmFuY2hDb2RlJywgZGVwdElkKTsNCiAgICAgICAgfSwgMCk7DQogICAgICAgIHRoaXMuJHNldCh0aGlzLmZvcm1EYXRhLCAnb3JkZXJTdGF0dXMnLCB0eXBlICsgJycpOw0KICAgICAgICBzZXRUaW1lb3V0KCgpID0+IHsNCiAgICAgICAgICB0aGlzLiRzZXQoDQogICAgICAgICAgICB0aGlzLmZvcm1EYXRhLA0KICAgICAgICAgICAgJ2Fycml2YWxEYXRlJywNCiAgICAgICAgICAgIHRoaXMuZm9ybWF0ZURhdGUoYXJyaXZhbFRpbWUsIDMpDQogICAgICAgICAgKTsNCiAgICAgICAgfSwgMCk7DQogICAgICAgIHRoaXMuaW5jbHVkaW5nRGlzaGVzU2Vhc29uaW5nID0gaW5jbHVkaW5nRGlzaGVzU2Vhc29uaW5nOw0KICAgICAgICB0aGlzLm9yZGVyUmVtYXJrID0gcmVtYXJrczsNCiAgICAgICAgLy8gdGhpcy5mb3JtRGF0YS5wcm92aW5jZUNvZGUgPSBwcm92aW5jZUNvZGU7DQogICAgICAgIC8vIHRoaXMuZm9ybURhdGEuY2l0eUNvZGUgPSBjaXR5Q29kZTsNCiAgICAgICAgLy8gdGhpcy5mb3JtRGF0YS5wYXJlbnREZXB0SWQgPSBwYXJlbnREZXB0SWQ7DQogICAgICAgIC8vIHRoaXMuZm9ybURhdGEuZGVwdElkID0gZGVwdElkOw0KDQogICAgICAgIHJldHVybjsNCiAgICAgIH0pOw0KICAgIH0sDQogICAgaGFuZGxlTWVhbERhdGEsDQogICAgaW5pdERhdGUoKSB7DQogICAgICBsZXQga2V5cyA9IE9iamVjdC5rZXlzKHRoaXMuZGlhbG9nRGF0YVNlbGVjdGVkT2JqKTsNCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwga2V5cy5sZW5ndGg7IGkrKykgew0KICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHRoaXMuZGlhbG9nRGF0YVNlbGVjdGVkT2JqW2tleXNbaV1dLmxlbmd0aDsgaisrKSB7DQogICAgICAgICAgdGhpcy5kaWFsb2dEYXRhU2VsZWN0ZWRPYmpba2V5c1tpXV1bal0uYXJyaXZhbERhdGUgPSAnJzsNCiAgICAgICAgICB0aGlzLmRpYWxvZ0RhdGFTZWxlY3RlZE9ialtrZXlzW2ldXVtqXS5hcnJpdmFsVGltZSA9ICcnOw0KICAgICAgICB9DQogICAgICB9DQogICAgfSwNCiAgICBmb3JtYXRlRGF0ZSh0aW1lc3RhbXAsIHR5cGUgPSAxKSB7DQogICAgICBpZiAoIXRpbWVzdGFtcCkgew0KICAgICAgICByZXR1cm4gJy0nOw0KICAgICAgfQ0KICAgICAgbGV0IHRpbWUgPSBuZXcgRGF0ZSh0aW1lc3RhbXApOw0KICAgICAgbGV0IHllYXIgPSB0aW1lLmdldEZ1bGxZZWFyKCk7DQogICAgICBjb25zdCBtb250aCA9ICh0aW1lLmdldE1vbnRoKCkgKyAxKS50b1N0cmluZygpLnBhZFN0YXJ0KDIsICcwJyk7DQogICAgICBjb25zdCBkYXRlID0gdGltZQ0KICAgICAgICAuZ2V0RGF0ZSgpDQogICAgICAgIC50b1N0cmluZygpDQogICAgICAgIC5wYWRTdGFydCgyLCAnMCcpOw0KICAgICAgY29uc3QgaG91cnMgPSB0aW1lDQogICAgICAgIC5nZXRIb3VycygpDQogICAgICAgIC50b1N0cmluZygpDQogICAgICAgIC5wYWRTdGFydCgyLCAnMCcpOw0KICAgICAgY29uc3QgbWludXRlID0gdGltZQ0KICAgICAgICAuZ2V0TWludXRlcygpDQogICAgICAgIC50b1N0cmluZygpDQogICAgICAgIC5wYWRTdGFydCgyLCAnMCcpOw0KICAgICAgY29uc3Qgc2Vjb25kID0gdGltZQ0KICAgICAgICAuZ2V0U2Vjb25kcygpDQogICAgICAgIC50b1N0cmluZygpDQogICAgICAgIC5wYWRTdGFydCgyLCAnMCcpOw0KDQogICAgICByZXR1cm4geWVhciArICctJyArIG1vbnRoICsgJy0nICsgZGF0ZTsNCiAgICB9LA0KICAgIGNsb3NlRGlhbG9nKCkgew0KICAgICAgdGhpcy5kaWFsb2dWaXNpYmxlID0gZmFsc2U7DQogICAgICB0aGlzLmRpYWxvZ1Vuc2VsZWN0SW5wdXQgPSAnJzsNCiAgICAgIHRoaXMuZGlhbG9nRGF0YVVuU2VsZWN0T2JqW3RoaXMuZGlhbG9nTmFtZV0gPSBbXTsNCiAgICAgIHRoaXMuZGlhbG9nTmFtZSA9ICcnOw0KICAgIH0sDQogICAgY2xvc2VEYXRlRGlhbG9nKCkgew0KICAgICAgdGhpcy5kaWFsb2dEYXRlVmlzaWJsZSA9IGZhbHNlOw0KICAgICAgdGhpcy5kaWFsb2dEYXRlUmFuZ2UgPSAnJzsNCiAgICAgIHRoaXMuY2xvc2VEaWFsb2coKTsNCiAgICB9LA0KICAgIHdhcm5pbmcobWVzc2FnZSwgdHlwZSA9ICd3YXJuaW5nJykgew0KICAgICAgdGhpcy4kbWVzc2FnZSh7DQogICAgICAgIHNob3dDbG9zZTogdHJ1ZSwNCiAgICAgICAgbWVzc2FnZSwNCiAgICAgICAgdHlwZQ0KICAgICAgfSk7DQogICAgfSwNCiAgICBvbkRlbGV0ZShyb3cpIHsNCiAgICAgIGxldCBpbmRleCA9IHRoaXMuc2VsZWN0ZWRJbmdyZWRpZW50TGlzdC5maW5kSW5kZXgoDQogICAgICAgIGl0ZW0gPT4NCiAgICAgICAgICBpdGVtLnJlbGF0aW9uSWQgPT09IHJvdy5yZWxhdGlvbklkICYmDQogICAgICAgICAgaXRlbS5wcmltYXJ5Q2xhc3NpZmljYXRpb25OYW1lID09PSByb3cucHJpbWFyeUNsYXNzaWZpY2F0aW9uTmFtZQ0KICAgICAgKTsNCiAgICAgIHRoaXMuc2VsZWN0ZWRJbmdyZWRpZW50TGlzdC5zcGxpY2UoaW5kZXgsIDEpOw0KICAgICAgY29uc3QgbGlzdCA9IHRoaXMubGVmdEluZ3JlZGllbnREYXRhTGlzdDsNCiAgICAgIGxldCBsZWZ0SXRlbSA9IGxpc3QuZmluZCgNCiAgICAgICAgaXRlbSA9Pg0KICAgICAgICAgIGl0ZW0ucmVsYXRpb25JZCA9PT0gcm93LnJlbGF0aW9uSWQgJiYNCiAgICAgICAgICBpdGVtLnByaW1hcnlDbGFzc2lmaWNhdGlvbk5hbWUgPT09IHJvdy5wcmltYXJ5Q2xhc3NpZmljYXRpb25OYW1lDQogICAgICApOw0KICAgICAgbGVmdEl0ZW0uc2VsZWN0ZWQgPSBmYWxzZTsNCiAgICB9LA0KICAgIGdldEluZ3JlZGllbnRUcmVlKCkgew0KICAgICAgb3JkZXJDb250ZW50Rm9yU2VsZWN0SW5ncmVkaWVudCh7DQogICAgICAgIG9yZGVySWQ6IHRoaXMub3JkZXJJZCwNCiAgICAgICAgZGVwdElkOiB0aGlzLmZvcm1EYXRhLnNjaG9vbEJyYW5jaENvZGUsDQogICAgICAgIHF1ZXJ5VHlwZTogMSwNCiAgICAgICAgaXNTZWxlY3RlZDogMCwNCiAgICAgICAgZGlzdHJpY3RDb2RlOiB0aGlzLmZvcm1EYXRhLmRpc3RyaWN0Q29kZSB8fCB0aGlzLmRpc3RyaWN0Q29kZQ0KICAgICAgfSkudGhlbihyZXMgPT4gew0KICAgICAgICB0aGlzLmxlZnRJbmdyZWRpZW50RGF0YSA9IHRoaXMuZm9tYXRUcmVlRGF0YShyZXMuZGF0YSk7DQogICAgICB9KTsNCiAgICB9LA0KICAgIGZvbWF0VHJlZURhdGEob3JpZ2luRGF0YSkgew0KICAgICAgdGhpcy5sZWZ0SW5ncmVkaWVudERhdGFMaXN0ID0gW107DQogICAgICBsZXQgZGF0YSA9IFtdOw0KICAgICAgZm9yICh2YXIga2V5IGluIG9yaWdpbkRhdGEpIHsNCiAgICAgICAgZGF0YS5wdXNoKHsNCiAgICAgICAgICBuYW1lOiBrZXksDQogICAgICAgICAgY2hpbGRyZW46IG9yaWdpbkRhdGFba2V5XS5tYXAoaXRlbSA9PiB7DQogICAgICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgICAuLi5pdGVtLA0KICAgICAgICAgICAgICBzZWxlY3RlZDogZmFsc2UNCiAgICAgICAgICAgIH07DQogICAgICAgICAgfSkNCiAgICAgICAgfSk7DQogICAgICB9DQogICAgICBkYXRhLm1hcChpdGVtID0+IHsNCiAgICAgICAgdGhpcy5sZWZ0SW5ncmVkaWVudERhdGFMaXN0LnB1c2goLi4uaXRlbS5jaGlsZHJlbik7DQogICAgICB9KTsNCiAgICAgIHRoaXMuc2lkZUFjdGl2ZSA9IGRhdGFbMF0ubmFtZTsNCiAgICAgIHJldHVybiBkYXRhOw0KICAgIH0sDQoNCiAgICBoYW5kbGVJY29uKHR5cGUsIHJvdykgew0KICAgICAgaWYgKHR5cGUgPT09ICdtaW51cycpIHsNCiAgICAgICAgaWYgKHJvdy5wYWNrTnVtID4gMSkgew0KICAgICAgICAgIC8vIHJvdy5wYWNrTnVtID0gK25ldyBEZWNpbWFsKCtyb3cucGFja051bSkuc3ViKG5ldyBEZWNpbWFsKDEpKTsNCiAgICAgICAgICB0aGlzLiRzZXQoDQogICAgICAgICAgICByb3csDQogICAgICAgICAgICAncGFja051bScsDQogICAgICAgICAgICArbmV3IERlY2ltYWwoK3Jvdy5wYWNrTnVtKS5zdWIobmV3IERlY2ltYWwoMSkpDQogICAgICAgICAgKTsNCiAgICAgICAgfQ0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgdGhpcy4kc2V0KA0KICAgICAgICAgIHJvdywNCiAgICAgICAgICAncGFja051bScsDQogICAgICAgICAgK25ldyBEZWNpbWFsKCtyb3cucGFja051bSkuYWRkKG5ldyBEZWNpbWFsKDEpKQ0KICAgICAgICApOw0KICAgICAgICAvLyByb3cucGFja051bSA9ICtuZXcgRGVjaW1hbCgrcm93LnBhY2tOdW0pLmFkZChuZXcgRGVjaW1hbCgxKSk7DQogICAgICB9DQogICAgICBjb25zb2xlLmxvZyg1NTU1NTU1NSwgcm93LnBhY2tOdW0pOw0KICAgIH0NCiAgfSwNCiAgLy8g55Sf5ZG95ZGo5pyfIC0g5Yib5bu65a6M5oiQ77yI5Y+v5Lul6K6/6Zeu5b2T5YmNdGhpc+WunuS+i++8iQ0KICBjcmVhdGVkKCkgew0KICAgIGxldCBvcGVyYVR5cGUgPSB0aGlzLiRyb3V0ZS5wYXJhbXMub3BlcmFUeXBlOw0KICAgIGxldCBvcmRlcklkOw0KICAgIGlmIChvcGVyYVR5cGUgPT09ICdjb3B5Jykgew0KICAgICAgb3JkZXJJZCA9IHRoaXMuJHJvdXRlLnBhcmFtcy5vcmRlcklkOw0KICAgICAgdGhpcy5vcGVyYVR5cGUgPSBvcGVyYVR5cGU7DQogICAgfSBlbHNlIHsNCiAgICAgIG9yZGVySWQgPSB0aGlzLiRyb3V0ZS5xdWVyeS5vcmRlcklkOw0KICAgICAgdGhpcy5vcGVyYVR5cGUgPSB0aGlzLiRyb3V0ZS5xdWVyeS5vcGVyYVR5cGU7DQogICAgfQ0KDQogICAgdGhpcy5vcmRlcklkID0gb3JkZXJJZDsNCiAgICB0aGlzLmJhc2VUcmVlV2l0aFBvd2VyU2Nob29sKCkudGhlbihyZXMgPT4gew0KICAgICAgLy8gbGV0IG9yZGVySWQgPSB0aGlzLiRyb3V0ZS5xdWVyeS5vcmRlcklkOw0KICAgICAgLy8gdGhpcy5vcmRlcklkID0gb3JkZXJJZDsNCiAgICAgIGlmIChvcmRlcklkKSB7DQogICAgICAgIC8v6I635Y+W6K6i5Y2V5L+h5oGvDQogICAgICAgIHRoaXMuZ2V0T3JkZXJEZXRhaWwoKS50aGVuKHJlcyA9PiB7DQogICAgICAgICAgdGhpcy5vcmRlclN0YXRpc3RpY3MoKTsNCiAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMudGFicy5sZW5ndGg7IGkrKykgew0KICAgICAgICAgICAgdGhpcy5vcmRlckNvbnRlbnRGb3JQYWdlKHRoaXMudGFic1tpXS5uYW1lKTsNCiAgICAgICAgICB9DQogICAgICAgICAgLy8gdGhpcy4kcmVmcy5iVGFibGU7DQogICAgICAgICAgLy8gdGhpcy4kcmVmcy5iVGFibGVbMF0gJiYgdGhpcy4kcmVmcy5iVGFibGVbMF0uYWpheEdldFRhYmxlRGF0YUJ5UGFnZSgpOw0KICAgICAgICB9KTsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgIHRoaXMuJHNldCh0aGlzLmZvcm1EYXRhLCAnb3JkZXJTdGF0dXMnLCAnMScpOw0KICAgICAgfQ0KICAgIH0pOw0KICAgIHRoaXMuZ2V0Q3V0TWF0Y2hTdGFuZGFyZExpc3QoKTsNCiAgfSwNCiAgLy8g55Sf5ZG95ZGo5pyfIC0g5oyC6L295a6M5oiQ77yI5Y+v5Lul6K6/6ZeuRE9N5YWD57Sg77yJDQogIG1vdW50ZWQoKSB7fQ0KfTsNCg=="},null]}