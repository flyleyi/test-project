{"remainingRequest":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/fuyueyi/Desktop/practice/mutilwap/src/pages/executive-serveh5/views/filler/Fill.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/src/pages/executive-serveh5/views/filler/Fill.vue","mtime":1627979214302},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IGhhbmRsZVNlcnZlLCBnZXRTZXJ2ZURldGFpbCB9IGZyb20gJy4vLi4vLi4vYXBpL3NlcnZlLmpzJzsKaW1wb3J0IHsgZ2V0UGxhdGVMaXN0IH0gZnJvbSAnLi8uLi8uLi9hcGkvdXNlci5qcyc7CmltcG9ydCBheGlvcyBmcm9tICdheGlvcyc7CmltcG9ydCBjb25maWcgZnJvbSAnLi8uLi8uLi9jb25maWcnOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ2ZpbGwnLAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBzaG93VGlwczogdHJ1ZSwKICAgICAgc2VydmVOYW1lOiAnJywKICAgICAgYWRkQ29udGVudDogJycsCiAgICAgIGNhbkFwcGx5OiB0cnVlLAogICAgICBzZXJ2ZURldGFpbDoge30sCiAgICAgIGZpbGVMaXN0OiBbXSwKICAgICAgLy/mtYvor5XkuIrkvKDmlofku7blnLDlnYAKICAgICAgLy91cGxvYWRVcmw6ICdodHRwOi8vMTcyLjE3LjE1LjQyOjc1MDEvb3NzL21hdGVyaWFsL3NlcnZlL3VwbG9hZE1hdGVyaWFsJwogICAgICB1cGxvYWRVcmw6IGNvbmZpZy5VUExPQURfRklMRV9VUkwsCiAgICAgIGNvbmZpZzogY29uZmlnLAogICAgICBwbGF0ZUlkOiAnJywKICAgICAgcGxhdGVMaXN0OiBbXSwKICAgICAgc2hvd1BpY2tlcjogZmFsc2UsCiAgICAgIGNvbHVtbnM6IFtdLAogICAgICBwbGF0ZU5hbWU6ICcnCiAgICB9OwogIH0sCiAgY3JlYXRlZCgpIHsKICAgIHRoaXMuc2VydmVJZCA9IHRoaXMuJHJvdXRlLnF1ZXJ5LnNlcnZlSWQgfHwgJyc7CiAgICBpZiAodGhpcy5zZXJ2ZUlkKSB7CiAgICAgIHRoaXMuZ2V0U2VydmVEZXRhaWwodGhpcy5zZXJ2ZUlkKTsKICAgIH0gZWxzZSB7CiAgICAgIHRoaXMuZ2V0UGxhdGVMaXN0KCk7CiAgICB9CiAgfSwKICBtZXRob2RzOiB7CiAgICBjbG9zZVRpcHMoKSB7CiAgICAgIHRoaXMuc2hvd1RpcHMgPSBmYWxzZTsKICAgIH0sCiAgICBjYW5jZWxJbnB1dCgpIHsKICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcignYm9keScpLnNjcm9sbEludG9WaWV3KHRydWUpOwogICAgfSwKICAgIGdldFBsYXRlTGlzdCgpIHsKICAgICAgZ2V0UGxhdGVMaXN0KCkudGhlbihyZXMgPT4gewogICAgICAgIHRoaXMucGxhdGVMaXN0ID0gcmVzLmRhdGEgfHwgW107CiAgICAgICAgdGhpcy5jb2x1bW5zID0gdGhpcy5wbGF0ZUxpc3QubWFwKGl0ZW0gPT4gewogICAgICAgICAgcmV0dXJuIGAke2l0ZW0uY3lia05hbWV9LSR7aXRlbS5jb21wYW55fWA7CiAgICAgICAgfSk7CiAgICAgICAgaWYgKHRoaXMucGxhdGVMaXN0Lmxlbmd0aCA9PT0gMSkgewogICAgICAgICAgdGhpcy5wbGF0ZUlkID0gdGhpcy5wbGF0ZUxpc3RbMF0uaWQ7CiAgICAgICAgICB0aGlzLnBsYXRlTmFtZSA9IHRoaXMuY29sdW1uc1swXTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgaWYgKHRoaXMucGxhdGVJZCkgewogICAgICAgICAgICBjb25zdCBpbmRleCA9IHRoaXMucGxhdGVMaXN0LmZpbmRJbmRleCgKICAgICAgICAgICAgICBpdGVtID0+IGl0ZW0uaWQgPT0gdGhpcy5wbGF0ZUlkCiAgICAgICAgICAgICk7CiAgICAgICAgICAgIHRoaXMucGxhdGVOYW1lID0gdGhpcy5jb2x1bW5zW2luZGV4XTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIGdldFNlcnZlRGV0YWlsKGlkKSB7CiAgICAgIGdldFNlcnZlRGV0YWlsKGlkKS50aGVuKHJlcyA9PiB7CiAgICAgICAgdGhpcy5zZXJ2ZURldGFpbCA9IChyZXMgJiYgcmVzLmRhdGEpIHx8IHt9OwogICAgICAgIHRoaXMuZmlsZUxpc3QgPSB0aGlzLnNlcnZlRGV0YWlsLmF0dGFjaG1lbnRzIHx8IFtdOwogICAgICAgIHRoaXMuc2VydmVOYW1lID0gdGhpcy5zZXJ2ZURldGFpbC5zZXJ2ZU5hbWUgfHwgJyc7CiAgICAgICAgdGhpcy5hZGRDb250ZW50ID0gdGhpcy5zZXJ2ZURldGFpbC5zZXJ2ZURlc2MgfHwgJyc7CiAgICAgICAgdGhpcy5wbGF0ZUlkID0gdGhpcy5zZXJ2ZURldGFpbC5jeWJrTm8gfHwgJyc7CiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmZpbGVMaXN0Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICB0aGlzLmZpbGVMaXN0W2ldLm5hbWUgPSB0aGlzLmZpbGVMaXN0W2ldLmZpbGVOYW1lOwogICAgICAgICAgaWYgKHRoaXMuZ2V0SXRlbVR5cGVJbWFnZSh0aGlzLmZpbGVMaXN0W2ldLm5hbWUpKSB7CiAgICAgICAgICAgIHRoaXMuZmlsZUxpc3RbaV0uaXNJbWFnZSA9IHRydWU7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHRoaXMuZ2V0UGxhdGVMaXN0KCk7CiAgICAgIH0pOwogICAgfSwKICAgIGFwcGx5U2VydmUoKSB7CiAgICAgIGNvbnN0IHsgc2VydmVOYW1lLCBhZGRDb250ZW50IH0gPSB0aGlzOwogICAgICBpZiAoIXNlcnZlTmFtZSkgewogICAgICAgIHRoaXMuJHRvYXN0KCfor7floavlhpnmnI3liqHmoIfpopgnKTsKICAgICAgICByZXR1cm47CiAgICAgIH0gZWxzZSBpZiAoc2VydmVOYW1lLmxlbmd0aCA8IDYgfHwgc2VydmVOYW1lLmxlbmd0aCA+IDIwKSB7CiAgICAgICAgdGhpcy4kdG9hc3QoJ+acjeWKoeagh+mimOivt+i+k+WFpSA2LTIwIOWtlycpOwogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBpZiAoYWRkQ29udGVudCAmJiAoYWRkQ29udGVudC5sZW5ndGggPCA2IHx8IGFkZENvbnRlbnQubGVuZ3RoID4gNTAwKSkgewogICAgICAgIHRoaXMuJHRvYXN0KCfmnI3liqHooaXlhYXor7fovpPlhaUgNi01MDAg5a2XJyk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGxldCBmaWxlcyA9IFtdOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmZpbGVMaXN0Lmxlbmd0aDsgaSsrKSB7CiAgICAgICAgZmlsZXMucHVzaCh7CiAgICAgICAgICBmaWxlTmFtZTogdGhpcy5maWxlTGlzdFtpXS5uYW1lIHx8ICcnLAogICAgICAgICAgdXJsOiB0aGlzLmZpbGVMaXN0W2ldLnVybCB8fCB0aGlzLmZpbGVMaXN0W2ldLnJlc3BvbnNlLmRhdGFbMF0udXJsCiAgICAgICAgfSk7CiAgICAgIH0KICAgICAgaWYgKCF0aGlzLmNhbkFwcGx5KSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGxldCBwYXJhbXMgPSB7CiAgICAgICAgaWQ6IHRoaXMuc2VydmVJZCwKICAgICAgICBwcm9jZXNzVHlwZTogMCwKICAgICAgICBzZXJ2ZU5hbWU6IHNlcnZlTmFtZS50cmltKCksCiAgICAgICAgc2VydmVEZXNjOiBhZGRDb250ZW50LnRyaW0oKSwKICAgICAgICBhdHRhY2htZW50czogZmlsZXMsCiAgICAgICAgY3lia05vOiB0aGlzLnBsYXRlSWQKICAgICAgfTsKICAgICAgdGhpcy5jYW5BcHBseSA9IGZhbHNlOwogICAgICBoYW5kbGVTZXJ2ZShwYXJhbXMpCiAgICAgICAgLnRoZW4ocmVzID0+IHsKICAgICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsKICAgICAgICAgICAgcGF0aDogJy9maWxsJwogICAgICAgICAgfSk7CiAgICAgICAgICB0aGlzLmNhbkFwcGx5ID0gdHJ1ZTsKICAgICAgICAgIHRoaXMuJHRvYXN0KCfmj5DkuqTmiJDlip8nKTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9KQogICAgICAgIC5jYXRjaChlID0+IHsKICAgICAgICAgIHRoaXMuY2FuQXBwbHkgPSB0cnVlOwogICAgICAgIH0pOwogICAgfSwKICAgIG9uQ29uZmlybSh2YWx1ZSwgaW5kZXgpIHsKICAgICAgdGhpcy5zaG93UGlja2VyID0gZmFsc2U7CiAgICAgIHRoaXMucGxhdGVJZCA9IHRoaXMucGxhdGVMaXN0W2luZGV4XS5pZDsKICAgICAgdGhpcy5wbGF0ZU5hbWUgPSB2YWx1ZTsKICAgIH0sCiAgICBvbk92ZXJzaXplKCkgewogICAgICB0aGlzLiR0b2FzdCgn5paH5Lu25aSn5bCP5LiN6IO96LaF6L+HIDUgTScpOwogICAgfSwKICAgIGJlZm9yZVJlYWQoZmlsZSkgewogICAgICBjb25zdCBmaWxlVHlwZSA9IFsnaW1hZ2UvZ2lmJywgJ2ltYWdlL2pwZWcnLCAnaW1hZ2UvcG5nJywgJ2ltYWdlL2pwZyddOwogICAgICBpZiAoIWZpbGVUeXBlLmluY2x1ZGVzKGZpbGUudHlwZSkpIHsKICAgICAgICB0aGlzLiR0b2FzdCgn5LuF5pSv5oyBIGpwZywgcG5nLCBqcGVnLCBnaWYg5qC85byP5Zu+54mH77yBJyk7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICAgIGlmIChmaWxlLnNpemUgLyAxMDI0IC8gMTAyNCA+IDUpIHsKICAgICAgICB0aGlzLiR0b2FzdCgn5paH5Lu25aSn5bCP5LiN6IO96LaF6L+HIDUgTScpOwogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQogICAgICBpZiAodGhpcy5maWxlTGlzdC5sZW5ndGggPj0gNSkgewogICAgICAgIHRoaXMuJHRvYXN0KCfmnIDlpJrkuIrkvKAgNSDlvKDlm77niYfvvIEnKTsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KICAgICAgcmV0dXJuIHRydWU7CiAgICB9LAogICAgYWZ0ZXJSZWFkKGZpbGUpIHsKICAgICAgZmlsZS5zdGF0dXMgPSAndXBsb2FkaW5nJzsKICAgICAgZmlsZS5tZXNzYWdlID0gJ+S4iuS8oOS4rSc7CiAgICAgIGxldCBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YSgpOwogICAgICBmb3JtRGF0YS5hcHBlbmQoJ2FwcGlkJywgY29uZmlnLmFwcGlkKTsKICAgICAgZm9ybURhdGEuYXBwZW5kKCdhcHBzZWNyZXQnLCBjb25maWcuYXBwc2VjcmV0KTsKICAgICAgZm9ybURhdGEuYXBwZW5kKCdmaWxlJywgdGhpcy5kYXRhVVJMdG9CbG9iKGZpbGUuY29udGVudCkpOwogICAgICBheGlvcyh7CiAgICAgICAgbWV0aG9kOiAnUE9TVCcsCiAgICAgICAgaGVhZGVyczogewogICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdtdWx0aXBhcnQvZm9ybS1kYXRhJwogICAgICAgIH0sCiAgICAgICAgZGF0YTogZm9ybURhdGEsCiAgICAgICAgLy/mtYvor5Xnjq/looMKICAgICAgICAvLyB1cmw6ICdodHRwOi8vMTcyLjE3LjE1LjQyOjc1MDEvb3NzL21hdGVyaWFsL3NlcnZlL3VwbG9hZE1hdGVyaWFsJwogICAgICAgIHVybDogdGhpcy51cGxvYWRVcmwKICAgICAgfSkudGhlbihyZXMgPT4gewogICAgICAgIGlmIChyZXMuZGF0YS5jb2RlID09IDgyMDApIHsKICAgICAgICAgIHRoaXMuZmlsZUxpc3RbdGhpcy5maWxlTGlzdC5sZW5ndGggLSAxXS5zdGF0dXMgPSAnc3VjY2Vzcyc7CiAgICAgICAgICB0aGlzLmZpbGVMaXN0W3RoaXMuZmlsZUxpc3QubGVuZ3RoIC0gMV0udXJsID0gcmVzLmRhdGEuZGF0YVswXS51cmw7CiAgICAgICAgICB0aGlzLmZpbGVMaXN0W3RoaXMuZmlsZUxpc3QubGVuZ3RoIC0gMV0ubmFtZSA9CiAgICAgICAgICAgIChmaWxlLmZpbGUgJiYgZmlsZS5maWxlLm5hbWUpIHx8ICcnOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLmZpbGVMaXN0W3RoaXMuZmlsZUxpc3QubGVuZ3RoIC0gMV0uc3RhdHVzID0gJ2ZhaWxlZCc7CiAgICAgICAgICB0aGlzLmZpbGVMaXN0W3RoaXMuZmlsZUxpc3QubGVuZ3RoIC0gMV0ubWVzc2FnZSA9ICfkuIrkvKDlpLHotKUnOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgZ2V0SXRlbVR5cGVJbWFnZShpdGVtKSB7CiAgICAgIGNvbnN0IG5hbWUgPSBpdGVtLmZpbGVOYW1lIHx8IGl0ZW0ubmFtZTsKICAgICAgY29uc3QgaW1hZ2VMaXN0ID0gWydqcGcnLCAncG5nJywgJ2dpZicsICdqcGVnJ107CiAgICAgIGNvbnN0IHR5cGUgPSB0aGlzLmdldEZpbGVUeXBlKG5hbWUpOwogICAgICBjb25zb2xlLmxvZygndHlwZScsIHR5cGUpOwogICAgICByZXR1cm4gaW1hZ2VMaXN0LmluY2x1ZGVzKHR5cGUudG9Mb3dlckNhc2UoKSk7CiAgICB9LAogICAgZ2V0RmlsZVR5cGUobmFtZSkgewogICAgICBpZiAoIW5hbWUpIHJldHVybiAncG5nJzsKICAgICAgcmV0dXJuIG5hbWUuc2xpY2UobmFtZS5sYXN0SW5kZXhPZignLicpICsgMSk7CiAgICB9LAogICAgb25DYW5jZWwoKSB7CiAgICAgIHRoaXMuc2hvd1BpY2tlciA9IGZhbHNlOwogICAgfSwKCiAgICBkYXRhVVJMdG9CbG9iKGRhdGF1cmwpIHsKICAgICAgdmFyIGFyciA9IGRhdGF1cmwuc3BsaXQoJywnKSwKICAgICAgICBtaW1lID0gYXJyWzBdLm1hdGNoKC86KC4qPyk7LylbMV0sCiAgICAgICAgYnN0ciA9IGF0b2IoYXJyWzFdKSwKICAgICAgICBuID0gYnN0ci5sZW5ndGgsCiAgICAgICAgdThhcnIgPSBuZXcgVWludDhBcnJheShuKTsKICAgICAgd2hpbGUgKG4tLSkgewogICAgICAgIHU4YXJyW25dID0gYnN0ci5jaGFyQ29kZUF0KG4pOwogICAgICB9CiAgICAgIHJldHVybiBuZXcgQmxvYihbdThhcnJdLCB7CiAgICAgICAgdHlwZTogbWltZQogICAgICB9KTsKICAgIH0KICB9Cn07Cg=="},{"version":3,"sources":["Fill.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Fill.vue","sourceRoot":"src/pages/executive-serveh5/views/filler","sourcesContent":["<template>\n  <div>\n    <div class=\"tips\" v-if=\"showTips\">\n      <div class=\"warning\"></div>\n      <div class=\"tips-item\">\n        <span class=\"tips-item-number\">1、</span>\n        需求指下属公司和机构在业务开展中遇到的问题或困难，所在板块内部无法自行消化解决，或集团总部能够更高效协调解决\n      </div>\n      <div class=\"tips-item\">\n        <span class=\"tips-item-number\">2、</span>\n        描述需求关键点即可，具体情况由抢单人与下单人详细对接；\n      </div>\n      <div class=\"tips-item\">\n        <span class=\"tips-item-number\">3、</span>\n        订单提交后，先由各版块总负责人或下属公司、机构负责人审核。审核通过后，方能进入总部高层抢单池\n      </div>\n      <van-icon name=\"cross\" @click=\"closeTips\" class=\"close-tips\" />\n    </div>\n    <div class=\"serve-company\">\n      <van-cell\n        v-if=\"plateList.length > 1\"\n        class=\"fill-content\"\n        is-link\n        @click=\"showPicker = true\"\n      >\n        <div :class=\"{ placeholder: !this.plateId }\">\n          {{ this.plateId ? this.plateName : '请选择所属公司' }}\n        </div>\n      </van-cell>\n    </div>\n    <van-popup v-model=\"showPicker\" position=\"bottom\">\n      <van-picker\n        title=\"所属公司\"\n        show-toolbar\n        :columns=\"columns\"\n        @confirm=\"onConfirm\"\n        @cancel=\"onCancel\"\n      />\n    </van-popup>\n    <div class=\"serve-name\">\n      <van-field\n        v-model=\"serveName\"\n        label=\"\"\n        @blur=\"cancelInput\"\n        maxlength=\"20\"\n        placeholder=\"一句话概括需求\"\n      />\n    </div>\n    <div class=\"serve-add\">\n      <van-field\n        type=\"textarea\"\n        v-model=\"addContent\"\n        @blur=\"cancelInput\"\n        placeholder=\"补充说明\"\n        maxlength=\"500\"\n      />\n    </div>\n    <div class=\"serve-file\">\n      <van-uploader\n        :max-size=\"5 * 1024 * 1024\"\n        accept=\"image/gif,image/jpeg,image/png,image/jpg\"\n        @oversize=\"onOversize\"\n        :beforeRead=\"beforeRead\"\n        :after-read=\"afterRead\"\n        v-model=\"fileList\"\n      >\n        <span class=\"serve-file-add\">\n          <van-icon class=\"plus\" name=\"plus\" />\n        </span>\n      </van-uploader>\n    </div>\n    <div class=\"apply-btn-wrapper\">\n      <div class=\"apply-btn\" @click=\"applyServe\">\n        下单\n      </div>\n    </div>\n  </div>\n</template>\n<script>\nimport { handleServe, getServeDetail } from './../../api/serve.js';\nimport { getPlateList } from './../../api/user.js';\nimport axios from 'axios';\nimport config from './../../config';\nexport default {\n  name: 'fill',\n  data() {\n    return {\n      showTips: true,\n      serveName: '',\n      addContent: '',\n      canApply: true,\n      serveDetail: {},\n      fileList: [],\n      //测试上传文件地址\n      //uploadUrl: 'http://172.17.15.42:7501/oss/material/serve/uploadMaterial'\n      uploadUrl: config.UPLOAD_FILE_URL,\n      config: config,\n      plateId: '',\n      plateList: [],\n      showPicker: false,\n      columns: [],\n      plateName: ''\n    };\n  },\n  created() {\n    this.serveId = this.$route.query.serveId || '';\n    if (this.serveId) {\n      this.getServeDetail(this.serveId);\n    } else {\n      this.getPlateList();\n    }\n  },\n  methods: {\n    closeTips() {\n      this.showTips = false;\n    },\n    cancelInput() {\n      document.querySelector('body').scrollIntoView(true);\n    },\n    getPlateList() {\n      getPlateList().then(res => {\n        this.plateList = res.data || [];\n        this.columns = this.plateList.map(item => {\n          return `${item.cybkName}-${item.company}`;\n        });\n        if (this.plateList.length === 1) {\n          this.plateId = this.plateList[0].id;\n          this.plateName = this.columns[0];\n        } else {\n          if (this.plateId) {\n            const index = this.plateList.findIndex(\n              item => item.id == this.plateId\n            );\n            this.plateName = this.columns[index];\n          }\n        }\n      });\n    },\n    getServeDetail(id) {\n      getServeDetail(id).then(res => {\n        this.serveDetail = (res && res.data) || {};\n        this.fileList = this.serveDetail.attachments || [];\n        this.serveName = this.serveDetail.serveName || '';\n        this.addContent = this.serveDetail.serveDesc || '';\n        this.plateId = this.serveDetail.cybkNo || '';\n        for (let i = 0; i < this.fileList.length; i++) {\n          this.fileList[i].name = this.fileList[i].fileName;\n          if (this.getItemTypeImage(this.fileList[i].name)) {\n            this.fileList[i].isImage = true;\n          }\n        }\n        this.getPlateList();\n      });\n    },\n    applyServe() {\n      const { serveName, addContent } = this;\n      if (!serveName) {\n        this.$toast('请填写服务标题');\n        return;\n      } else if (serveName.length < 6 || serveName.length > 20) {\n        this.$toast('服务标题请输入 6-20 字');\n        return;\n      }\n      if (addContent && (addContent.length < 6 || addContent.length > 500)) {\n        this.$toast('服务补充请输入 6-500 字');\n        return;\n      }\n      let files = [];\n\n      for (let i = 0; i < this.fileList.length; i++) {\n        files.push({\n          fileName: this.fileList[i].name || '',\n          url: this.fileList[i].url || this.fileList[i].response.data[0].url\n        });\n      }\n      if (!this.canApply) {\n        return;\n      }\n      let params = {\n        id: this.serveId,\n        processType: 0,\n        serveName: serveName.trim(),\n        serveDesc: addContent.trim(),\n        attachments: files,\n        cybkNo: this.plateId\n      };\n      this.canApply = false;\n      handleServe(params)\n        .then(res => {\n          this.$router.push({\n            path: '/fill'\n          });\n          this.canApply = true;\n          this.$toast('提交成功');\n          return;\n        })\n        .catch(e => {\n          this.canApply = true;\n        });\n    },\n    onConfirm(value, index) {\n      this.showPicker = false;\n      this.plateId = this.plateList[index].id;\n      this.plateName = value;\n    },\n    onOversize() {\n      this.$toast('文件大小不能超过 5 M');\n    },\n    beforeRead(file) {\n      const fileType = ['image/gif', 'image/jpeg', 'image/png', 'image/jpg'];\n      if (!fileType.includes(file.type)) {\n        this.$toast('仅支持 jpg, png, jpeg, gif 格式图片！');\n        return false;\n      }\n      if (file.size / 1024 / 1024 > 5) {\n        this.$toast('文件大小不能超过 5 M');\n        return false;\n      }\n      if (this.fileList.length >= 5) {\n        this.$toast('最多上传 5 张图片！');\n        return false;\n      }\n      return true;\n    },\n    afterRead(file) {\n      file.status = 'uploading';\n      file.message = '上传中';\n      let formData = new FormData();\n      formData.append('appid', config.appid);\n      formData.append('appsecret', config.appsecret);\n      formData.append('file', this.dataURLtoBlob(file.content));\n      axios({\n        method: 'POST',\n        headers: {\n          'Content-Type': 'multipart/form-data'\n        },\n        data: formData,\n        //测试环境\n        // url: 'http://172.17.15.42:7501/oss/material/serve/uploadMaterial'\n        url: this.uploadUrl\n      }).then(res => {\n        if (res.data.code == 8200) {\n          this.fileList[this.fileList.length - 1].status = 'success';\n          this.fileList[this.fileList.length - 1].url = res.data.data[0].url;\n          this.fileList[this.fileList.length - 1].name =\n            (file.file && file.file.name) || '';\n        } else {\n          this.fileList[this.fileList.length - 1].status = 'failed';\n          this.fileList[this.fileList.length - 1].message = '上传失败';\n        }\n      });\n    },\n    getItemTypeImage(item) {\n      const name = item.fileName || item.name;\n      const imageList = ['jpg', 'png', 'gif', 'jpeg'];\n      const type = this.getFileType(name);\n      console.log('type', type);\n      return imageList.includes(type.toLowerCase());\n    },\n    getFileType(name) {\n      if (!name) return 'png';\n      return name.slice(name.lastIndexOf('.') + 1);\n    },\n    onCancel() {\n      this.showPicker = false;\n    },\n\n    dataURLtoBlob(dataurl) {\n      var arr = dataurl.split(','),\n        mime = arr[0].match(/:(.*?);/)[1],\n        bstr = atob(arr[1]),\n        n = bstr.length,\n        u8arr = new Uint8Array(n);\n      while (n--) {\n        u8arr[n] = bstr.charCodeAt(n);\n      }\n      return new Blob([u8arr], {\n        type: mime\n      });\n    }\n  }\n};\n</script>\n<style lang=\"less\" scoped>\n.tips {\n  position: relative;\n  background: #fefcec;\n  box-sizing: border-box;\n  padding: 0.2rem 0.62rem;\n  color: #f86e21;\n  line-height: 0.32rem;\n  font-size: 0.28rem;\n}\n.tips-item {\n  padding-left: 0.36rem;\n  position: relative;\n}\n.tips-item-number {\n  position: absolute;\n  left: 0;\n}\n.warning {\n  width: 0.32rem;\n  height: 0.32rem;\n  border-radius: 50%;\n  background: #f86e21;\n  text-align: center;\n  position: absolute;\n  left: 0.2rem;\n}\n.warning::before {\n  content: '!';\n  font-size: 0.18rem;\n  color: #fff;\n}\n.close-tips {\n  position: absolute;\n  top: 0.2rem;\n  right: 0.2rem;\n}\n.serve-company {\n  margin-top: 0.2rem;\n}\n.serve-name {\n  height: 44px;\n  background: #fff;\n  margin-top: 0.2rem;\n  /deep/.van-field__control {\n    font-size: 0.28rem;\n    line-height: 24px;\n  }\n}\n.serve-add {\n  margin-top: 0.2rem;\n  // padding: 0.1rem 0;\n  /deep/.van-field__control {\n    height: 3.26rem;\n    background: #f6f6f6;\n    border-radius: 4px;\n    padding: 0.2rem;\n    font-size: 0.28rem;\n    line-height: 0.32rem;\n  }\n}\n.serve-file {\n  padding: 0.3rem;\n  background: #fff;\n  margin-top: 0.2rem;\n}\n.serve-file-add {\n  display: inline-block;\n  width: 1.58rem;\n  height: 1.58rem;\n  line-height: 1.58rem;\n  border: 1px solid #dddddd;\n  border-radius: 6px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n.plus {\n  font-size: 0.64rem;\n  color: #ccc;\n}\n.apply-btn-wrapper {\n  padding: 0.3rem;\n}\n.apply-btn {\n  height: 0.94rem;\n  line-height: 0.94rem;\n  text-align: center;\n  color: #fff;\n  border-radius: 0.1rem;\n  background: #ff9800;\n}\n.placeholder {\n  color: #c9cacd;\n}\n/deep/.van-field__control {\n  color: rgba(0, 0, 0, 0.64);\n}\n/deep/.close-tips {\n  color: rgba(0, 0, 0, 0.64);\n}\n/deep/.van-cell__value--alone {\n  color: rgba(0, 0, 0, 0.64);\n}\n</style>\n"]}]}