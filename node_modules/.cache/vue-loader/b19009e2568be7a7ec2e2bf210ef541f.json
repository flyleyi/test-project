{"remainingRequest":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/fuyueyi/Desktop/practice/mutilwap/src/pages/homework-admin/views/homework/uploadList.vue?vue&type=style&index=1&lang=css&","dependencies":[{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/src/pages/homework-admin/views/homework/uploadList.vue","mtime":1646020538169},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgouY29udGFpbmVyU3R5bGUgewogIG1hcmdpbjogMCBhdXRvOwogIG1heC13aWR0aDogMTIwMHB4OwogIGhlaWdodDogNjk0cHg7CiAgYmFja2dyb3VuZC1jb2xvcjogd2hpdGU7Cn0KLnVwbG9hZEJ1dHRvbkRpdlN0eWxlIHsKICBoZWlnaHQ6IDc1cHg7Cn0KLnNwYW5UaXRsZVN0eWxlIHsKICBtYXJnaW4tbGVmdDogMTZweDsKICBoZWlnaHQ6IDEycHg7CiAgbGluZS1oZWlnaHQ6IDc1cHg7CiAgY29sb3I6ICM5MDkwOTA7CiAgZm9udC1zaXplOiAxMjsKfQoubGlzdEl0ZW1TdHlsZSB7CiAgcGFkZGluZy1sZWZ0OiAyNHB4OwogIHBhZGRpbmctcmlnaHQ6IDI0cHg7CiAgbWF4LWhlaWdodDogNTU0cHg7CgogIG92ZXJmbG93LXg6IGhpZGRlbjsKICBvdmVyZmxvdy15OiBhdXRvOwp9CgouaXRlbVN0eWxlIHsKICBtYXJnaW4tYm90dG9tOiAxM3B4Owp9Ci5lbC1wYWdpbmF0aW9uIHsKICB0ZXh0LWFsaWduOiByaWdodDsKICBtYXJnaW4tcmlnaHQ6IDE5cHg7CiAgaGVpZ2h0OiAzMHB4OwogIC8qIG1hcmdpbi10b3A6IDEycHg7ICovCiAgcGFkZGluZzogMTdweCAwcHggMHB4IDBweDsKfQoKLnBhZ2luYXRpb25EaXZTdHlsZSB7CiAgaGVpZ2h0OiA2OHB4OwogIC8qIGJhY2tncm91bmQtY29sb3I6IHJlZDsgKi8KfQouZnVsbFNjcmVlblN0eWxlIHsKICAvKiBwb3NpdGlvbjogYWJzb2x1dGU7CiAgdG9wOiAwOwogIGxlZnQ6IDA7CiAgcmlnaHQ6IDA7CiAgYm90dG9tOiAwOwogIGJhY2tncm91bmQtY29sb3I6IHJnYmEoMCwgMCwgMCwgMC41KTsgKi8KICBwb3NpdGlvbjogZml4ZWQ7CiAgdG9wOiAwOwogIGxlZnQ6IDA7CiAgcmlnaHQ6IDA7CiAgYm90dG9tOiAwOwogIGJhY2tncm91bmQtY29sb3I6IHJnYmEoMCwgMCwgMCwgMC41KTsKICB6LWluZGV4OiAxMDA7Cn0KLnByb2dyZXNzQmFja2dyb3VuZERpdlN0eWxlIHsKICB3aWR0aDogMzgzcHg7CiAgaGVpZ2h0OiAxNDdweDsKICBib3JkZXItcmFkaXVzOiA4cHg7CiAgYmFja2dyb3VuZC1jb2xvcjogI2ZmZmZmZjsKICBwb3NpdGlvbjogYWJzb2x1dGU7CiAgbGVmdDogNTAlOwogIHRvcDogNTAlOwogIHRyYW5zZm9ybTogdHJhbnNsYXRlKC01MCUsIC01MCUpOwogIC8qIG1hcmdpbjogMCBhdXRvOwogIGRpc3BsYXk6IGZsZXg7CiAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7CiAgYWxpZ24taXRlbXM6IGNlbnRlcjsgKi8KfQoudXBsb2FkU3BhblN0eWxlIHsKICBkaXNwbGF5OiBmbGV4OwogIGp1c3RpZnktY29udGVudDogY2VudGVyOwogIG1hcmdpbi10b3A6IDMwcHg7CiAgY29sb3I6ICM0ODQ4NDg7CiAgZm9udC1zaXplOiAxNnB4OwogIGhlaWdodDogMTdweDsKICBmb250LWZhbWlseTogJ1BpbmdGYW5nU0MtU2VtaWJvbGQnOwp9Ci5wcm9ncmVzc1NwYW5TdHlsZSB7CiAgZGlzcGxheTogZmxleDsKICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsKICBtYXJnaW4tdG9wOiAxMXB4OwogIGNvbG9yOiAjMzE5NWRmOwogIGZvbnQtc2l6ZTogMTRweDsKICBoZWlnaHQ6IDE2cHg7CiAgZm9udC1mYW1pbHk6ICdQaW5nRmFuZ1NDLU1lZGl1bSc7Cn0K"},{"version":3,"sources":["uploadList.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkYA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"uploadList.vue","sourceRoot":"src/pages/homework-admin/views/homework","sourcesContent":["<template>\n  <div class=\"containerStyle\">\n    <div class=\"uploadButtonDivStyle\">\n      <el-upload\n        ref=\"upload\"\n        action=\"\"\n        :http-request=\"uploadHttp\"\n        multiple\n        accept=\".jpg,.png,.jpeg,.bmp\"\n        :data=\"dataObj\"\n        :limit=\"limitCount\"\n        :on-remove=\"uploadRemove\"\n        :on-success=\"uploadSuccess\"\n        :show-file-list=\"false\"\n        :on-exceed=\"uploadExceed\"\n        :on-change=\"uploadChange\"\n        :on-progress=\"uploadProgress\"\n        :on-error=\"uploadError\"\n        :before-upload=\"uploadBefore\"\n      >\n        <el-button type=\"primary\" size=\"small\" class=\"uploadButtonStyle\"\n          >上传作业\n        </el-button>\n\n        <span slot=\"tip\" class=\"spanTitleStyle\"\n          >支持拖动图片至页面进行上传</span\n        >\n      </el-upload>\n    </div>\n    <div class=\"listItemStyle\">\n      <upload-list-item\n        :id=\"item.homeworkId\"\n        class=\"itemStyle\"\n        @uploadDetailShow=\"lookforUpLoadDetail($event)\"\n        v-for=\"item in listData.list\"\n        :key=\"item.homeworkId\"\n        :dataObject=\"item\"\n      >\n      </upload-list-item>\n    </div>\n    <div class=\"paginationDivStyle\">\n      <el-pagination\n        :hide-on-single-page=\"value\"\n        :current-page=\"currentPage\"\n        :page-size=\"pageSize\"\n        layout=\"total, prev, pager, next, jumper\"\n        :total=\"total\"\n        @current-change=\"handleCurrentChange\"\n      >\n      </el-pagination>\n    </div>\n\n    <div v-show=\"isLoading\" class=\"fullScreenStyle\">\n      <div class=\"progressBackgroundDivStyle\">\n        <span class=\"uploadSpanStyle\">努力上传中</span>\n        <el-progress\n          :percentage=\"percentage\"\n          :format=\"format\"\n          :stroke-width=\"14\"\n          color=\"#4EB4FF\"\n        ></el-progress>\n        <span class=\"progressSpanStyle\">上传进度：{{ percentage }}%</span>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { Input, Pagination, Upload, Progress } from 'element-ui';\nimport uploadListItem from './Components/UploadListItem';\nimport Cookie from 'js-cookie';\n// import acions from '../../api/upload/index';\nimport {\n  getUploadParameter,\n  uploadPic,\n  finishUpload,\n  uploadList\n} from '../../api/upload/index';\n// const OSS = require('ali-oss');\n\nexport default {\n  name: 'DynamicFormPage',\n  components: {\n    uploadListItem,\n    ElPagination: Pagination,\n    ElProgress: Progress,\n    ElUpload: Upload,\n    [Input.name]: Input\n  },\n  data() {\n    return {\n      percentage: 0,\n      limitCount: 300,\n      isLoading: false, //正在上传\n      uploadCount: 0, //记录每次上传时的上传数量\n      uploadTotal: 0, //记录这次上传总共多少数量\n      visible: false, // 是否可见\n      value: false,\n      dataObj: {},\n      finishUploadList: [],\n      pageNum: 1,\n      pageSize: 10,\n      total: 100,\n      currentPage: 1,\n      listData: []\n    };\n  },\n  computed: {\n    percentageComputed: function() {\n      // return !isNaN((this.uploadCount / this.uploadTotal) * 100);\n      return this.uploadTotal > 0\n        ? parseInt(this.uploadCount / this.uploadTotal) * 100\n        : 0;\n    }\n  },\n  mounted() {},\n  async created() {\n    await this.getlist();\n  },\n  methods: {\n    handleCurrentChange(val) {\n      console.log(`当前页: ${val}`);\n      this.pageNum = val;\n      this.getlist();\n    },\n    handleSizeChange() {},\n    getlist() {\n      console.log('请求开始');\n      uploadList({\n        pageNum: this.pageNum,\n        pageSize: this.pageSize,\n        schoolId: Cookie.get('schoolId'),\n        tenantId: Cookie.get('tenantId')\n      }).then(res => {\n        console.log('res=', res);\n        // if (res.data.success) {\n        //   this.listData = res.data.data;\n        //   console.log('listData=', this.listData);\n        //   this.total = this.listData.total;\n        //   this.pageNum = this.listData.page;\n        //   this.pageSize = this.listData.pageSize;\n        // }\n        if (res.success) {\n          this.listData = res.data;\n          console.log('listData=', this.listData);\n          this.total = this.listData.total;\n          this.pageNum = this.listData.page;\n          this.pageSize = this.listData.pageSize;\n        }\n      });\n    },\n    lookforUpLoadDetail(data) {\n      let homeworkStatus = 0;\n      if (data.status == 1) {\n        homeworkStatus = 1;\n      }\n      console.log('data.detailList', data.detailList);\n      this.$router.push({\n        name: 'UpLoadDetail',\n        query: {\n          homeworkStatus: homeworkStatus,\n          detailList: data.detailList,\n          homeworkId: data.id\n        }\n      });\n    },\n    uploadRemove() {\n      console.log('handleRemove');\n    },\n    uploadSuccess(response, file, fileList) {\n      this.uploadCount++;\n      this.changeProgress();\n      console.log('response++++', response);\n      this.finishUploadList.push({ fileName: response.data });\n\n      console.log('uploadCount===', this.uploadCount);\n      console.log('handleSuccess');\n      console.log('fileList====', fileList);\n      if (fileList.length == this.uploadCount) {\n        console.log('全部上传成功');\n        this.uploadCount = 0;\n        let upload = this.$refs.upload;\n        if (upload) {\n          upload.clearFiles();\n          this.isLoading = false;\n        }\n\n        console.log('finishUploadList++++', this.finishUploadList);\n        console.log('schoolId+' + Cookie.get('schoolId'));\n        console.log('tenantId+' + Cookie.get('tenantId'));\n\n        if (this.finishUploadList.length > 0) {\n          finishUpload({\n            list: this.finishUploadList,\n            schoolId: Cookie.get('schoolId'),\n            tenantId: Cookie.get('tenantId')\n          }).then(res => {\n            this.finishUploadList = [];\n            console.log('finishLog = ', res);\n            if (!res.success) {\n              this.$message({\n                type: 'error',\n                message: '上传失败',\n                showClose: true,\n                offset: 80\n              });\n            } else {\n              //重新刷新列表\n              this.getlist();\n            }\n          });\n        }\n      }\n    },\n\n    uploadExceed() {\n      console.log('handleExceed');\n      this.$message({\n        type: 'warning',\n        message: '上传数量不能超过' + this.limitCount + '个',\n        showClose: true,\n        offset: 80\n      });\n    },\n    uploadChange(file, fileList) {\n      //文件状态改变时的钩子，添加文件、上传成功和上传失败时都会被调用\n      // console.log('hanldeChange==', fileList);\n      // console.log('hanldeChange==', fileList.length);\n      this.uploadTotal = fileList.length;\n    },\n    uploadProgress() {\n      //文件上传时\n      console.log('handleProgress');\n    },\n    uploadHttp(file, fileList) {\n      console.log('uploadHttpfileList====', file.file.name);\n      const fileSuffix = file.file.name.substring(\n        file.file.name.lastIndexOf('.') + 1\n      );\n      console.log('fileSuffix====', fileSuffix);\n\n      if (!this.isLoading) {\n        this.isLoading = true;\n      }\n      console.log('uploadHttp+++' + file.file);\n      return getUploadParameter({\n        fileType: fileSuffix\n      }).then(res => {\n        console.log(res);\n        console.log('res+++' + res.success);\n\n        if (res.success) {\n          console.log('uploadPic+++' + file.file);\n\n          return uploadPic(file.file, res.data);\n        }\n      });\n    },\n    uploadError(err, file, fileList) {\n      console.log('handleError');\n      this.uploadCount++;\n      this.changeProgress();\n      console.log('uploadCount===', this.uploadCount);\n      if (fileList.length == this.uploadCount) {\n        console.log('在失败方法内全部上传成功');\n        this.uploadCount = 0;\n        if (this.finishUploadList.length > 0) {\n          finishUpload({ list: this.finishUploadList }).then(res => {\n            this.finishUploadList = [];\n            if (!res.success) {\n              this.$message({\n                type: 'error',\n                message: '上传失败',\n                showClose: true,\n                offset: 80\n              });\n            } else {\n              //重新刷新列表\n              this.getlist();\n            }\n          });\n        }\n\n        let upload = this.$refs.upload;\n        if (upload) {\n          upload.clearFiles();\n          this.isLoading = false;\n        }\n      }\n    },\n    uploadBefore(file, fileList) {\n      console.log('uploadBefore=====');\n      const fileSuffix = file.name.substring(file.name.lastIndexOf('.') + 1);\n      const whiteList = ['png', 'jpg', 'jpeg', 'bmp'];\n      let lowerFileSuffix = fileSuffix.toLowerCase();\n      if (whiteList.indexOf(lowerFileSuffix) === -1) {\n        this.$message({\n          type: 'error',\n          message: '请选择“jpg、png、jpeg、bmp”的图片上传',\n          showClose: true,\n          offset: 80\n        });\n        this.fileList = [];\n        return false;\n      }\n\n      if (file.name.length > 100) {\n        this.$message({\n          type: 'error',\n          message: '图片名称不能超过100字',\n          showClose: true,\n          offset: 80\n        });\n        return false;\n      }\n\n      const isLt2M = file.size / 1024 / 1024 < 100;\n      if (!isLt2M) {\n        this.$message({\n          type: 'error',\n          message: '上传文件不能超过100MB',\n          showClose: true,\n          offset: 80\n        });\n        return false;\n      }\n    },\n    format(percentage) {\n      return '';\n    },\n    changeProgress() {\n      this.percentage =\n        this.uploadTotal > 0\n          ? parseInt((this.uploadCount / this.uploadTotal) * 100)\n          : 0;\n    }\n  }\n};\n</script>\n\n<style lang=\"less\" scoped>\n// .el-button {\n//   height: 34px !important;\n//   width: 106px !important;\n//   margin: 20px 0px 0px 24px !important;\n// }\n/deep/.el-progress-bar__outer {\n  width: 305px;\n  margin-top: 29px;\n  margin-left: 39px;\n}\n\n.uploadButtonStyle {\n  height: 34px;\n  width: 106px;\n  margin: 20px 0px 0px 24px;\n}\n\n/deep/ .el-pager li.active {\n  // color: #3195df;\n  color: white;\n  background-color: #3195df;\n}\n\n/deep/ .el-pager li:hover {\n  color: #3195df;\n}\n\n/deep/.el-pagination button:hover {\n  color: #3195df;\n}\n\n/deep/.el-pager li {\n  padding: 0 10px;\n  background: #fff;\n  font-size: 14px;\n  min-width: 24px;\n  height: 28px;\n  line-height: 28px;\n  box-sizing: border-box;\n  text-align: center;\n  font-family: 'PingFangSC-Regular';\n}\n</style>\n\n<style>\n.containerStyle {\n  margin: 0 auto;\n  max-width: 1200px;\n  height: 694px;\n  background-color: white;\n}\n.uploadButtonDivStyle {\n  height: 75px;\n}\n.spanTitleStyle {\n  margin-left: 16px;\n  height: 12px;\n  line-height: 75px;\n  color: #909090;\n  font-size: 12;\n}\n.listItemStyle {\n  padding-left: 24px;\n  padding-right: 24px;\n  max-height: 554px;\n\n  overflow-x: hidden;\n  overflow-y: auto;\n}\n\n.itemStyle {\n  margin-bottom: 13px;\n}\n.el-pagination {\n  text-align: right;\n  margin-right: 19px;\n  height: 30px;\n  /* margin-top: 12px; */\n  padding: 17px 0px 0px 0px;\n}\n\n.paginationDivStyle {\n  height: 68px;\n  /* background-color: red; */\n}\n.fullScreenStyle {\n  /* position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background-color: rgba(0, 0, 0, 0.5); */\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background-color: rgba(0, 0, 0, 0.5);\n  z-index: 100;\n}\n.progressBackgroundDivStyle {\n  width: 383px;\n  height: 147px;\n  border-radius: 8px;\n  background-color: #ffffff;\n  position: absolute;\n  left: 50%;\n  top: 50%;\n  transform: translate(-50%, -50%);\n  /* margin: 0 auto;\n  display: flex;\n  justify-content: center;\n  align-items: center; */\n}\n.uploadSpanStyle {\n  display: flex;\n  justify-content: center;\n  margin-top: 30px;\n  color: #484848;\n  font-size: 16px;\n  height: 17px;\n  font-family: 'PingFangSC-Semibold';\n}\n.progressSpanStyle {\n  display: flex;\n  justify-content: center;\n  margin-top: 11px;\n  color: #3195df;\n  font-size: 14px;\n  height: 16px;\n  font-family: 'PingFangSC-Medium';\n}\n</style>\n"]}]}