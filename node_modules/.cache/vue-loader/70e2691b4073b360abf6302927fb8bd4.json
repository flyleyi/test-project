{"remainingRequest":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/fuyueyi/Desktop/practice/mutilwap/src/pages/jx-questionnaire-h5/views/survey-parent/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/src/pages/jx-questionnaire-h5/views/survey-parent/index.vue","mtime":1645178321142},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBEcmFmdExpc3QgZnJvbSAnLi9jb21wb25lbnRzL0RyYWZ0TGlzdC52dWUnOwppbXBvcnQgeyBMaXN0IH0gZnJvbSAndmFudCc7CmltcG9ydCB7IG1hcFN0YXRlIH0gZnJvbSAndnVleCc7CmltcG9ydCB7IGdldFN1cnZleUxpc3QgfSBmcm9tICcuLi8uLi9hcGkvc3VydmV5JzsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdTdXJ2ZXlQYXJlbnQnLAogIGNvbXBvbmVudHM6IHsKICAgIFtMaXN0Lm5hbWVdOiBMaXN0LAogICAgRHJhZnRMaXN0CiAgfSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgdGFiTGlzdDogWyflvoXmj5DkuqQnLCAn5bey5o+Q5LqkJ10sCiAgICAgIHRhYklkeDogMCwgLy8g5b2T5YmNdGFi5LiL5qCHCiAgICAgIHBhZ2U6IDAsCiAgICAgIGxvYWRpbmc6IGZhbHNlLAogICAgICBmaW5pc2hlZDogZmFsc2UsCiAgICAgIHdhaXRpbmdMaXN0OiBbXSwgLy8g5b6F5o+Q5Lqk5YiX6KGoCiAgICAgIHN1Ykxpc3Q6IFtdIC8vIOW3suaPkOS6pOWIl+ihqAogICAgfTsKICB9LAogIGNvbXB1dGVkOiB7CiAgICAuLi5tYXBTdGF0ZSgndXNlcicsIFsnd2VjaGF0VXNlcklkJywgJ2NsYXNzSWQnLCAncm9sZScsICdzdHVkZW50SWQnXSkKICB9LAogIC8vIGJlZm9yZVJvdXRlRW50ZXIodG8sIGZyb20sIG5leHQpIHsKICAvLyAgIGlmIChmcm9tLm5hbWUgPT0gJ1N1cnZleVN1Ym1pdCcpIHsKICAvLyAgICAgLy8g6L+Z5LiqbmFtZeaYr+S4i+S4gOe6p+mhtemdoueahOi3r+eUsW5hbWUKICAvLyAgICAgdG8ubWV0YS5pc0JhY2sgPSB0cnVlOyAvLyDorr7nva7kuLp0cnVl6K+05piO5L2g5piv6L+U5Zue5Yiw6L+Z5Liq6aG16Z2i77yM6ICM5LiN5piv6YCa6L+H6Lez6L2s5LuO5YW25LuW6aG16Z2i6L+b5YWl5Yiw6L+Z5Liq6aG16Z2iCiAgLy8gICB9CiAgLy8gICBuZXh0KCk7CiAgLy8gfSwKICBjcmVhdGVkKCkgewogICAgdGhpcy5sb2FkTW9yZSgpOwogIH0sCiAgLy8gYWN0aXZhdGVkKCkgewogIC8vICAgaWYgKCF0aGlzLiRyb3V0ZS5tZXRhLmlzQmFjaykgewogIC8vICAgICB0aGlzLnRhYklkeCA9IDA7IC8vIOW9k+WJjXRhYuS4i+aghwogIC8vICAgICB0aGlzLnBhZ2UgPSAwOwogIC8vICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZTsKICAvLyAgICAgdGhpcy5maW5pc2hlZCA9IGZhbHNlOwogIC8vICAgICB0aGlzLndhaXRpbmdMaXN0ID0gW107IC8vIOW+heaPkOS6pOWIl+ihqAogIC8vICAgICB0aGlzLnN1Ykxpc3QgPSBbXTsgLy8g5bey5o+Q5Lqk5YiX6KGodGhpcy4KICAvLyAgICAgdGhpcy5sb2FkTW9yZSgpOwogIC8vICAgfQogIC8vICAgdGhpcy4kcm91dGUubWV0YS5pc0JhY2sgPSBmYWxzZTsgLy/or7fmsYLlrozlkI7ov5vooYzliJ3lp4vljJYKICAvLyB9LAogIG1ldGhvZHM6IHsKICAgIGxvYWRNb3JlKCkgewogICAgICB0aGlzLnBhZ2UgKz0gMTsgLy/pobXmlbArMQogICAgICB0aGlzLmdldExpc3QoKTsKICAgIH0sCiAgICAvLyDojrflj5bliJfooajmlbDmja4KICAgIGdldExpc3QoKSB7CiAgICAgIGxldCBwYXJhbXMgPSB7CiAgICAgICAgZnJvbTogJycsCiAgICAgICAgd2VjaGF0VXNlcklkOiB0aGlzLndlY2hhdFVzZXJJZCwKICAgICAgICBjbGFzc0lkczogdGhpcy5jbGFzc0lkLAogICAgICAgIHN0dWRlbnRJZDogdGhpcy5zdHVkZW50SWQsCiAgICAgICAgcm9sZTogdGhpcy5yb2xlLAogICAgICAgIGN1cnJlbnRQYWdlOiB0aGlzLnBhZ2UsCiAgICAgICAgcGFnZVNpemU6IDIwLAogICAgICAgIHR5cGVMaXN0OiB0aGlzLnRhYklkeCA9PSAnMCcgPyAxIDogMgogICAgICB9OwogICAgICBnZXRTdXJ2ZXlMaXN0KHBhcmFtcykKICAgICAgICAudGhlbihyZXMgPT4gewogICAgICAgICAgdGhpcy5wYWdlTG9hZGluZyA9IGZhbHNlOwogICAgICAgICAgaWYgKHBhcmFtcy50eXBlTGlzdCA9PSAxKSB7CiAgICAgICAgICAgIC8vIOW3suWPkeW4gwogICAgICAgICAgICB0aGlzLmhpZGRlbk51bSA9IHJlcy5kYXRhLmhpZGRlbk51bTsKICAgICAgICAgICAgdGhpcy53YWl0aW5nTGlzdCA9IHRoaXMud2FpdGluZ0xpc3QuY29uY2F0KHJlcy5kYXRhLmxpc3QpOwoKICAgICAgICAgICAgLy8g5Yqg6L2954q25oCB57uT5p2fCiAgICAgICAgICAgIHRoaXMubG9hZGluZyA9IGZhbHNlOwogICAgICAgICAgICAvLyDmlbDmja7lhajpg6jliqDovb3lrozmiJAKICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgIHRoaXMud2FpdGluZ0xpc3QubGVuZ3RoID49IHJlcy5kYXRhLnRvdGFsIHx8CiAgICAgICAgICAgICAgcmVzLmRhdGEubGlzdC5sZW5ndGggPT0gMAogICAgICAgICAgICApIHsKICAgICAgICAgICAgICB0aGlzLmZpbmlzaGVkID0gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIGlmIChwYXJhbXMudHlwZUxpc3QgPT0gMikgewogICAgICAgICAgICAvLyDojYnnqL/nrrEKICAgICAgICAgICAgdGhpcy5zdWJMaXN0ID0gdGhpcy5zdWJMaXN0LmNvbmNhdChyZXMuZGF0YS5saXN0KTsKCiAgICAgICAgICAgIC8vIOWKoOi9veeKtuaAgee7k+adnwogICAgICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZTsKICAgICAgICAgICAgLy8g5pWw5o2u5YWo6YOo5Yqg6L295a6M5oiQCiAgICAgICAgICAgIGlmICgKICAgICAgICAgICAgICB0aGlzLnN1Ykxpc3QubGVuZ3RoID49IHJlcy5kYXRhLnRvdGFsIHx8CiAgICAgICAgICAgICAgcmVzLmRhdGEubGlzdC5sZW5ndGggPT0gMAogICAgICAgICAgICApIHsKICAgICAgICAgICAgICB0aGlzLmZpbmlzaGVkID0gdHJ1ZTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0pCiAgICAgICAgLmNhdGNoKGVyciA9PiB7CiAgICAgICAgICB0aGlzLiR0b2FzdChlcnIubXNnKTsKICAgICAgICB9KTsKICAgIH0sCiAgICAvLyB0YWLliIfmjaIKICAgIGNoYW5nZVRhYihpZHgpIHsKICAgICAgaWYgKHRoaXMubG9hZGluZykgcmV0dXJuOwogICAgICB0aGlzLnRhYklkeCA9IGlkeDsKICAgICAgLy8g5pWw5o2u5Yid5aeL5YyWCiAgICAgIHRoaXMubG9hZGluZyA9IHRydWU7CiAgICAgIHRoaXMucGFnZSA9IDA7CiAgICAgIHRoaXMuZmluaXNoZWQgPSBmYWxzZTsKICAgICAgdGhpcy5zdWJMaXN0ID0gW107CiAgICAgIHRoaXMud2FpdGluZ0xpc3QgPSBbXTsKICAgICAgdGhpcy5sb2FkTW9yZSgpOwogICAgfSwKICAgIC8vIOWhq+aKpemXruWNtwogICAgZ29TdWJtaXQoaXRlbSkgewogICAgICBsZXQgeyBpZCwgc3R1ZGVudElkLCBpc01haW4sIHN0YXR1cyB9ID0gaXRlbTsKICAgICAgaWYgKHRoaXMudGFiSWR4ID09IDAgJiYgc3RhdHVzID09IDMpIHsKICAgICAgICB0aGlzLiR0b2FzdCgn6K+l6Zeu5Y235bey57uT5p2fJyk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGlmICh0aGlzLnRhYklkeCA9PSAxIHx8IGlzTWFpbiA9PSAwKSB7CiAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goewogICAgICAgICAgcGF0aDogYC9zdXJ2ZXktc3VibWl0LWRvbmU/c3VydmV5SWQ9JHtpZH0mc3R1ZGVudElkPSR7c3R1ZGVudElkfSZpc01haW49JHtpc01haW59YAogICAgICAgIH0pOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuJHJvdXRlci5wdXNoKHsKICAgICAgICAgIHBhdGg6IGAvc3VydmV5LXN1Ym1pdD9zdXJ2ZXlJZD0ke2lkfSZzdHVkZW50SWQ9JHtzdHVkZW50SWR9JnR5cGU9JHt0aGlzLnRhYklkeH0maXNNYWluPSR7aXNNYWlufWAKICAgICAgICB9KTsKICAgICAgfQogICAgfQogIH0KfTsK"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/pages/jx-questionnaire-h5/views/survey-parent","sourcesContent":["<!--  -->\n<template>\n  <div class=\"app\">\n    <!-- 顶部导航区 -->\n    <div class=\"top-container\">\n      <div class=\"tab\">\n        <div\n          class=\"tab-item\"\n          v-for=\"(item, index) in tabList\"\n          :key=\"index\"\n          @click=\"changeTab(index)\"\n        >\n          <div :style=\"tabIdx == index ? 'color:#5ECFA8' : ''\">\n            {{ item }}\n          </div>\n          <div :style=\"tabIdx == index ? 'background:#5ECFA8' : ''\"></div>\n        </div>\n      </div>\n    </div>\n    <!-- 列表 -->\n    <div class=\"content\">\n      <template v-if=\"tabIdx == 0\">\n        <van-list\n          v-model=\"loading\"\n          :immediate-check=\"false\"\n          :finished=\"finished\"\n          finished-text=\"\"\n          @load=\"loadMore\"\n          v-if=\"waitingList.length > 0\"\n        >\n          <draft-list :list=\"waitingList\" @goSubmit=\"goSubmit\"></draft-list>\n        </van-list>\n        <template v-if=\"waitingList.length == 0 && !loading\">\n          <div class=\"empty\">\n            <img\n              src=\"@/pages/jx-questionnaire-h5/assets/images/v1.0.0/empty.png\"\n            />\n            <div>还没有投票哦</div>\n          </div>\n        </template>\n      </template>\n      <template v-else-if=\"tabIdx == 1\">\n        <van-list\n          v-model=\"loading\"\n          :immediate-check=\"false\"\n          :finished=\"finished\"\n          finished-text=\"\"\n          @load=\"loadMore\"\n          v-if=\"subList.length > 0\"\n        >\n          <draft-list :list=\"subList\" @goSubmit=\"goSubmit\"></draft-list>\n        </van-list>\n        <template v-if=\"subList.length == 0 && !loading\">\n          <div class=\"empty\">\n            <img\n              src=\"@/pages/jx-questionnaire-h5/assets/images/v1.0.0/empty.png\"\n            />\n            <div>还没有投票哦</div>\n          </div>\n        </template>\n      </template>\n    </div>\n  </div>\n</template>\n\n<script>\nimport DraftList from './components/DraftList.vue';\nimport { List } from 'vant';\nimport { mapState } from 'vuex';\nimport { getSurveyList } from '../../api/survey';\nexport default {\n  name: 'SurveyParent',\n  components: {\n    [List.name]: List,\n    DraftList\n  },\n  data() {\n    return {\n      tabList: ['待提交', '已提交'],\n      tabIdx: 0, // 当前tab下标\n      page: 0,\n      loading: false,\n      finished: false,\n      waitingList: [], // 待提交列表\n      subList: [] // 已提交列表\n    };\n  },\n  computed: {\n    ...mapState('user', ['wechatUserId', 'classId', 'role', 'studentId'])\n  },\n  // beforeRouteEnter(to, from, next) {\n  //   if (from.name == 'SurveySubmit') {\n  //     // 这个name是下一级页面的路由name\n  //     to.meta.isBack = true; // 设置为true说明你是返回到这个页面，而不是通过跳转从其他页面进入到这个页面\n  //   }\n  //   next();\n  // },\n  created() {\n    this.loadMore();\n  },\n  // activated() {\n  //   if (!this.$route.meta.isBack) {\n  //     this.tabIdx = 0; // 当前tab下标\n  //     this.page = 0;\n  //     this.loading = false;\n  //     this.finished = false;\n  //     this.waitingList = []; // 待提交列表\n  //     this.subList = []; // 已提交列表this.\n  //     this.loadMore();\n  //   }\n  //   this.$route.meta.isBack = false; //请求完后进行初始化\n  // },\n  methods: {\n    loadMore() {\n      this.page += 1; //页数+1\n      this.getList();\n    },\n    // 获取列表数据\n    getList() {\n      let params = {\n        from: '',\n        wechatUserId: this.wechatUserId,\n        classIds: this.classId,\n        studentId: this.studentId,\n        role: this.role,\n        currentPage: this.page,\n        pageSize: 20,\n        typeList: this.tabIdx == '0' ? 1 : 2\n      };\n      getSurveyList(params)\n        .then(res => {\n          this.pageLoading = false;\n          if (params.typeList == 1) {\n            // 已发布\n            this.hiddenNum = res.data.hiddenNum;\n            this.waitingList = this.waitingList.concat(res.data.list);\n\n            // 加载状态结束\n            this.loading = false;\n            // 数据全部加载完成\n            if (\n              this.waitingList.length >= res.data.total ||\n              res.data.list.length == 0\n            ) {\n              this.finished = true;\n            }\n          } else if (params.typeList == 2) {\n            // 草稿箱\n            this.subList = this.subList.concat(res.data.list);\n\n            // 加载状态结束\n            this.loading = false;\n            // 数据全部加载完成\n            if (\n              this.subList.length >= res.data.total ||\n              res.data.list.length == 0\n            ) {\n              this.finished = true;\n            }\n          }\n        })\n        .catch(err => {\n          this.$toast(err.msg);\n        });\n    },\n    // tab切换\n    changeTab(idx) {\n      if (this.loading) return;\n      this.tabIdx = idx;\n      // 数据初始化\n      this.loading = true;\n      this.page = 0;\n      this.finished = false;\n      this.subList = [];\n      this.waitingList = [];\n      this.loadMore();\n    },\n    // 填报问卷\n    goSubmit(item) {\n      let { id, studentId, isMain, status } = item;\n      if (this.tabIdx == 0 && status == 3) {\n        this.$toast('该问卷已结束');\n        return;\n      }\n      if (this.tabIdx == 1 || isMain == 0) {\n        this.$router.push({\n          path: `/survey-submit-done?surveyId=${id}&studentId=${studentId}&isMain=${isMain}`\n        });\n      } else {\n        this.$router.push({\n          path: `/survey-submit?surveyId=${id}&studentId=${studentId}&type=${this.tabIdx}&isMain=${isMain}`\n        });\n      }\n    }\n  }\n};\n</script>\n<style lang=\"less\" scoped>\n.app {\n  .top-container {\n    width: 100%;\n    position: fixed;\n    top: 0;\n    left: 0;\n    z-index: 999;\n    .tab {\n      width: 100%;\n      height: 0.98rem;\n      background-color: #ffffff;\n      box-shadow: 0 0 0.1rem 0 rgba(0, 0, 0, 0.08);\n      display: flex;\n      .tab-item {\n        width: 50%;\n        height: 0.98rem;\n        font-size: 0.3rem;\n        font-family: PingFangSC-Medium, PingFang SC;\n        font-weight: 500;\n        color: rgba(0, 0, 0, 0.65);\n        display: flex;\n        flex-direction: column;\n        align-items: center;\n        & > div:first-child {\n          padding: 0.2rem 0;\n        }\n        & > div:nth-child(2) {\n          width: 0.48rem;\n          height: 0.06rem;\n          background: #ffffff;\n          border-radius: 0.06rem;\n        }\n      }\n    }\n  }\n  .content {\n    padding: 1.2rem 0 0.4rem 0;\n    height: calc(100vh - 1.6rem);\n    overflow: scroll;\n  }\n  .empty {\n    padding-top: 2rem;\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    align-items: center;\n    & > img {\n      height: 4rem;\n    }\n    & > div {\n      font-size: 0.26rem;\n      font-family: PingFangSC-Regular, PingFang SC;\n      color: rgba(0, 0, 0, 0.45);\n      padding-top: 0.2rem;\n    }\n  }\n}\n</style>\n"]}]}