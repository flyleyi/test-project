{"remainingRequest":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/src/pages/jx-questionnaire-h5/views/survey-parent/index.vue?vue&type=style&index=0&id=5767f45c&lang=less&scoped=true&","dependencies":[{"path":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/src/pages/jx-questionnaire-h5/views/survey-parent/index.vue","mtime":1645178321142},{"path":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/node_modules/less-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/node_modules/style-resources-loader/lib/index.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKLmFwcCB7CiAgLnRvcC1jb250YWluZXIgewogICAgd2lkdGg6IDEwMCU7CiAgICBwb3NpdGlvbjogZml4ZWQ7CiAgICB0b3A6IDA7CiAgICBsZWZ0OiAwOwogICAgei1pbmRleDogOTk5OwogICAgLnRhYiB7CiAgICAgIHdpZHRoOiAxMDAlOwogICAgICBoZWlnaHQ6IDAuOThyZW07CiAgICAgIGJhY2tncm91bmQtY29sb3I6ICNmZmZmZmY7CiAgICAgIGJveC1zaGFkb3c6IDAgMCAwLjFyZW0gMCByZ2JhKDAsIDAsIDAsIDAuMDgpOwogICAgICBkaXNwbGF5OiBmbGV4OwogICAgICAudGFiLWl0ZW0gewogICAgICAgIHdpZHRoOiA1MCU7CiAgICAgICAgaGVpZ2h0OiAwLjk4cmVtOwogICAgICAgIGZvbnQtc2l6ZTogMC4zcmVtOwogICAgICAgIGZvbnQtZmFtaWx5OiBQaW5nRmFuZ1NDLU1lZGl1bSwgUGluZ0ZhbmcgU0M7CiAgICAgICAgZm9udC13ZWlnaHQ6IDUwMDsKICAgICAgICBjb2xvcjogcmdiYSgwLCAwLCAwLCAwLjY1KTsKICAgICAgICBkaXNwbGF5OiBmbGV4OwogICAgICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47CiAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgICAgICAmID4gZGl2OmZpcnN0LWNoaWxkIHsKICAgICAgICAgIHBhZGRpbmc6IDAuMnJlbSAwOwogICAgICAgIH0KICAgICAgICAmID4gZGl2Om50aC1jaGlsZCgyKSB7CiAgICAgICAgICB3aWR0aDogMC40OHJlbTsKICAgICAgICAgIGhlaWdodDogMC4wNnJlbTsKICAgICAgICAgIGJhY2tncm91bmQ6ICNmZmZmZmY7CiAgICAgICAgICBib3JkZXItcmFkaXVzOiAwLjA2cmVtOwogICAgICAgIH0KICAgICAgfQogICAgfQogIH0KICAuY29udGVudCB7CiAgICBwYWRkaW5nOiAxLjJyZW0gMCAwLjRyZW0gMDsKICAgIGhlaWdodDogY2FsYygxMDB2aCAtIDEuNnJlbSk7CiAgICBvdmVyZmxvdzogc2Nyb2xsOwogIH0KICAuZW1wdHkgewogICAgcGFkZGluZy10b3A6IDJyZW07CiAgICBkaXNwbGF5OiBmbGV4OwogICAgZmxleC1kaXJlY3Rpb246IGNvbHVtbjsKICAgIGp1c3RpZnktY29udGVudDogY2VudGVyOwogICAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICAgICYgPiBpbWcgewogICAgICBoZWlnaHQ6IDRyZW07CiAgICB9CiAgICAmID4gZGl2IHsKICAgICAgZm9udC1zaXplOiAwLjI2cmVtOwogICAgICBmb250LWZhbWlseTogUGluZ0ZhbmdTQy1SZWd1bGFyLCBQaW5nRmFuZyBTQzsKICAgICAgY29sb3I6IHJnYmEoMCwgMCwgMCwgMC40NSk7CiAgICAgIHBhZGRpbmctdG9wOiAwLjJyZW07CiAgICB9CiAgfQp9Cg=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/pages/jx-questionnaire-h5/views/survey-parent","sourcesContent":["<!--  -->\n<template>\n  <div class=\"app\">\n    <!-- 顶部导航区 -->\n    <div class=\"top-container\">\n      <div class=\"tab\">\n        <div\n          class=\"tab-item\"\n          v-for=\"(item, index) in tabList\"\n          :key=\"index\"\n          @click=\"changeTab(index)\"\n        >\n          <div :style=\"tabIdx == index ? 'color:#5ECFA8' : ''\">\n            {{ item }}\n          </div>\n          <div :style=\"tabIdx == index ? 'background:#5ECFA8' : ''\"></div>\n        </div>\n      </div>\n    </div>\n    <!-- 列表 -->\n    <div class=\"content\">\n      <template v-if=\"tabIdx == 0\">\n        <van-list\n          v-model=\"loading\"\n          :immediate-check=\"false\"\n          :finished=\"finished\"\n          finished-text=\"\"\n          @load=\"loadMore\"\n          v-if=\"waitingList.length > 0\"\n        >\n          <draft-list :list=\"waitingList\" @goSubmit=\"goSubmit\"></draft-list>\n        </van-list>\n        <template v-if=\"waitingList.length == 0 && !loading\">\n          <div class=\"empty\">\n            <img\n              src=\"@/pages/jx-questionnaire-h5/assets/images/v1.0.0/empty.png\"\n            />\n            <div>还没有投票哦</div>\n          </div>\n        </template>\n      </template>\n      <template v-else-if=\"tabIdx == 1\">\n        <van-list\n          v-model=\"loading\"\n          :immediate-check=\"false\"\n          :finished=\"finished\"\n          finished-text=\"\"\n          @load=\"loadMore\"\n          v-if=\"subList.length > 0\"\n        >\n          <draft-list :list=\"subList\" @goSubmit=\"goSubmit\"></draft-list>\n        </van-list>\n        <template v-if=\"subList.length == 0 && !loading\">\n          <div class=\"empty\">\n            <img\n              src=\"@/pages/jx-questionnaire-h5/assets/images/v1.0.0/empty.png\"\n            />\n            <div>还没有投票哦</div>\n          </div>\n        </template>\n      </template>\n    </div>\n  </div>\n</template>\n\n<script>\nimport DraftList from './components/DraftList.vue';\nimport { List } from 'vant';\nimport { mapState } from 'vuex';\nimport { getSurveyList } from '../../api/survey';\nexport default {\n  name: 'SurveyParent',\n  components: {\n    [List.name]: List,\n    DraftList\n  },\n  data() {\n    return {\n      tabList: ['待提交', '已提交'],\n      tabIdx: 0, // 当前tab下标\n      page: 0,\n      loading: false,\n      finished: false,\n      waitingList: [], // 待提交列表\n      subList: [] // 已提交列表\n    };\n  },\n  computed: {\n    ...mapState('user', ['wechatUserId', 'classId', 'role', 'studentId'])\n  },\n  // beforeRouteEnter(to, from, next) {\n  //   if (from.name == 'SurveySubmit') {\n  //     // 这个name是下一级页面的路由name\n  //     to.meta.isBack = true; // 设置为true说明你是返回到这个页面，而不是通过跳转从其他页面进入到这个页面\n  //   }\n  //   next();\n  // },\n  created() {\n    this.loadMore();\n  },\n  // activated() {\n  //   if (!this.$route.meta.isBack) {\n  //     this.tabIdx = 0; // 当前tab下标\n  //     this.page = 0;\n  //     this.loading = false;\n  //     this.finished = false;\n  //     this.waitingList = []; // 待提交列表\n  //     this.subList = []; // 已提交列表this.\n  //     this.loadMore();\n  //   }\n  //   this.$route.meta.isBack = false; //请求完后进行初始化\n  // },\n  methods: {\n    loadMore() {\n      this.page += 1; //页数+1\n      this.getList();\n    },\n    // 获取列表数据\n    getList() {\n      let params = {\n        from: '',\n        wechatUserId: this.wechatUserId,\n        classIds: this.classId,\n        studentId: this.studentId,\n        role: this.role,\n        currentPage: this.page,\n        pageSize: 20,\n        typeList: this.tabIdx == '0' ? 1 : 2\n      };\n      getSurveyList(params)\n        .then(res => {\n          this.pageLoading = false;\n          if (params.typeList == 1) {\n            // 已发布\n            this.hiddenNum = res.data.hiddenNum;\n            this.waitingList = this.waitingList.concat(res.data.list);\n\n            // 加载状态结束\n            this.loading = false;\n            // 数据全部加载完成\n            if (\n              this.waitingList.length >= res.data.total ||\n              res.data.list.length == 0\n            ) {\n              this.finished = true;\n            }\n          } else if (params.typeList == 2) {\n            // 草稿箱\n            this.subList = this.subList.concat(res.data.list);\n\n            // 加载状态结束\n            this.loading = false;\n            // 数据全部加载完成\n            if (\n              this.subList.length >= res.data.total ||\n              res.data.list.length == 0\n            ) {\n              this.finished = true;\n            }\n          }\n        })\n        .catch(err => {\n          this.$toast(err.msg);\n        });\n    },\n    // tab切换\n    changeTab(idx) {\n      if (this.loading) return;\n      this.tabIdx = idx;\n      // 数据初始化\n      this.loading = true;\n      this.page = 0;\n      this.finished = false;\n      this.subList = [];\n      this.waitingList = [];\n      this.loadMore();\n    },\n    // 填报问卷\n    goSubmit(item) {\n      let { id, studentId, isMain, status } = item;\n      if (this.tabIdx == 0 && status == 3) {\n        this.$toast('该问卷已结束');\n        return;\n      }\n      if (this.tabIdx == 1 || isMain == 0) {\n        this.$router.push({\n          path: `/survey-submit-done?surveyId=${id}&studentId=${studentId}&isMain=${isMain}`\n        });\n      } else {\n        this.$router.push({\n          path: `/survey-submit?surveyId=${id}&studentId=${studentId}&type=${this.tabIdx}&isMain=${isMain}`\n        });\n      }\n    }\n  }\n};\n</script>\n<style lang=\"less\" scoped>\n.app {\n  .top-container {\n    width: 100%;\n    position: fixed;\n    top: 0;\n    left: 0;\n    z-index: 999;\n    .tab {\n      width: 100%;\n      height: 0.98rem;\n      background-color: #ffffff;\n      box-shadow: 0 0 0.1rem 0 rgba(0, 0, 0, 0.08);\n      display: flex;\n      .tab-item {\n        width: 50%;\n        height: 0.98rem;\n        font-size: 0.3rem;\n        font-family: PingFangSC-Medium, PingFang SC;\n        font-weight: 500;\n        color: rgba(0, 0, 0, 0.65);\n        display: flex;\n        flex-direction: column;\n        align-items: center;\n        & > div:first-child {\n          padding: 0.2rem 0;\n        }\n        & > div:nth-child(2) {\n          width: 0.48rem;\n          height: 0.06rem;\n          background: #ffffff;\n          border-radius: 0.06rem;\n        }\n      }\n    }\n  }\n  .content {\n    padding: 1.2rem 0 0.4rem 0;\n    height: calc(100vh - 1.6rem);\n    overflow: scroll;\n  }\n  .empty {\n    padding-top: 2rem;\n    display: flex;\n    flex-direction: column;\n    justify-content: center;\n    align-items: center;\n    & > img {\n      height: 4rem;\n    }\n    & > div {\n      font-size: 0.26rem;\n      font-family: PingFangSC-Regular, PingFang SC;\n      color: rgba(0, 0, 0, 0.45);\n      padding-top: 0.2rem;\n    }\n  }\n}\n</style>\n"]}]}