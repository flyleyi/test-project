{"remainingRequest":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/fuyueyi/Desktop/practice/mutilwap/src/pages/executive-serve/views/Home.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/src/pages/executive-serve/views/Home.vue","mtime":1627979214295},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KDQppbXBvcnQgeyBsb2dpbiwgZ2V0QXV0aCwgZ2V0UGxhdGVMaXN0IH0gZnJvbSAnLi8uLi9hcGkvdXNlcic7DQppbXBvcnQgY29uZmlnIGZyb20gJy4vLi4vY29uZmlnJzsNCmV4cG9ydCBkZWZhdWx0IHsNCiAgbmFtZTogJ0hvbWUnLA0KICBkYXRhKCkgew0KICAgIHJldHVybiB7DQogICAgICBwbGF0ZUlkOiBudWxsDQogICAgfTsNCiAgfSwNCiAgY3JlYXRlZCgpIHsNCiAgICBsZXQgc3RhZmZDb2RlID0gdGhpcy4kcm91dGUucXVlcnkuc3RhZmZDb2RlOw0KICAgIHRoaXMucGxhdGVJZCA9IHRoaXMuJHJvdXRlLnF1ZXJ5LnBsYXRlSWQgfHwgbnVsbDsNCiAgICBpZiAodGhpcy5wbGF0ZUlkKSB7DQogICAgICB0aGlzLmdldEF1dGgoKTsNCiAgICB9IGVsc2Ugew0KICAgICAgbGV0IHVzZXJuYW1lOw0KICAgICAgaWYgKGNvbmZpZy5OT0RFX0VOViA9PSAncHJvZHVjdGlvbicpIHsNCiAgICAgICAgdXNlcm5hbWUgPSBzdGFmZkNvZGU7DQogICAgICB9IGVsc2Ugew0KICAgICAgICB1c2VybmFtZSA9IHN0YWZmQ29kZSBeIDEwMDAwMDAwMDE7DQogICAgICB9DQogICAgICBsb2dpbih1c2VybmFtZSkNCiAgICAgICAgLnRoZW4ocmVzID0+IHsNCiAgICAgICAgICB0aGlzLmdldEF1dGgoKTsNCiAgICAgICAgICAvLyB0aGlzLmdldFBsYXRlTGlzdCgpDQogICAgICAgICAgLy8gICAudGhlbihyZXMgPT4gew0KICAgICAgICAgIC8vICAgICBjb25zdCBkYXRhID0gcmVzLmRhdGEgfHwgW107DQogICAgICAgICAgLy8gICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdwbGF0ZUxpc3QnLCBKU09OLnN0cmluZ2lmeShkYXRhKSk7DQogICAgICAgICAgLy8gICAgIHRoaXMuZ2V0QXV0aCgpOw0KICAgICAgICAgIC8vICAgfSkNCiAgICAgICAgICAvLyAgIC5jYXRjaChlID0+IHsNCiAgICAgICAgICAvLyAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3BsYXRlTGlzdCcsIFtdKTsNCiAgICAgICAgICAvLyAgIH0pOw0KICAgICAgICB9KQ0KICAgICAgICAuY2F0Y2goZSA9PiB7DQogICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3VzZXJJbmZvJywgJycpOw0KICAgICAgICAgIGNvbnNvbGUubG9nKGUpOw0KICAgICAgICAgIHRoaXMud2FybmluZygn5pqC5pyq5byA6YCa5p2D6ZmQJyk7DQogICAgICAgIH0pOw0KICAgIH0NCg0KICAgIC8vIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCd1c2VySW5mbycsIEpTT04uc3RyaW5naWZ5KHVzZXJJbmZvKSk7DQogICAgLy8gdGhpcy4kcm91dGVyLnJlcGxhY2Uoew0KICAgIC8vICAgcGF0aDogJy9maWxsJw0KICAgIC8vIH0pOw0KICB9LA0KICBtZXRob2RzOiB7DQogICAgZ2V0UGxhdGVMaXN0KCkgew0KICAgICAgcmV0dXJuIGdldFBsYXRlTGlzdCgpOw0KICAgIH0sDQogICAgZ2V0QXV0aCgpIHsNCiAgICAgIC8vIGxldCBwbGF0ZUlkID0gbnVsbDsNCiAgICAgIC8vIGlmICh0aGlzLnBsYXRlSWQpIHsNCiAgICAgIC8vICAgcGxhdGVJZCA9IHRoaXMucGxhdGVJZDsNCiAgICAgIC8vIH0gZWxzZSB7DQogICAgICAvLyAgIGxldCBwbGF0ZUxpc3QgPQ0KICAgICAgLy8gICAgIChsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgncGxhdGVMaXN0JykgJiYNCiAgICAgIC8vICAgICAgIEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3BsYXRlTGlzdCcpKSkgfHwNCiAgICAgIC8vICAgICBbXTsNCiAgICAgIC8vICAgcGxhdGVJZCA9IChwbGF0ZUxpc3RbMF0gJiYgcGxhdGVMaXN0WzBdLmlkKSB8fCAnJzsNCiAgICAgIC8vIH0NCiAgICAgIC8vIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCdwbGF0ZUlkJywgcGxhdGVJZCk7DQogICAgICBnZXRBdXRoKCkudGhlbihyZXMgPT4gew0KICAgICAgICBjb25zdCB7IGRhdGEgfSA9IHJlczsNCiAgICAgICAgY29uc3QgeyByb2xlcyB9ID0gZGF0YTsNCiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3VzZXJJbmZvJywgSlNPTi5zdHJpbmdpZnkoZGF0YSkpOw0KICAgICAgICB0aGlzLmdldERlZmF1bHRQYWdlKCk7DQogICAgICB9KTsNCiAgICB9LA0KICAgIGdldERlZmF1bHRQYWdlKCkgew0KICAgICAgY29uc3QgdXNlckluZm8gPQ0KICAgICAgICAobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3VzZXJJbmZvJykgJiYNCiAgICAgICAgICBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd1c2VySW5mbycpKSkgfHwNCiAgICAgICAge307DQogICAgICBjb25zdCByb2xlcyA9IHVzZXJJbmZvLnJvbGVzIHx8IFtdOw0KICAgICAgaWYgKHJvbGVzLmluY2x1ZGVzKCfloavmiqXkuronKSkgew0KICAgICAgICB0aGlzLiRyb3V0ZXIucmVwbGFjZSh7DQogICAgICAgICAgcGF0aDogJy9maWxsJw0KICAgICAgICB9KTsNCiAgICAgIH0gZWxzZSBpZiAocm9sZXMuaW5jbHVkZXMoJ+WuoeaguOS6uicpKSB7DQogICAgICAgIHRoaXMuJHJvdXRlci5yZXBsYWNlKHsNCiAgICAgICAgICBwYXRoOiAnL2NoZWNrJw0KICAgICAgICB9KTsNCiAgICAgIH0gZWxzZSBpZiAocm9sZXMuaW5jbHVkZXMoJ+WkhOeQhuS6uicpIHx8IHJvbGVzLmluY2x1ZGVzKCfnm5HnnaPkuronKSkgew0KICAgICAgICB0aGlzLiRyb3V0ZXIucmVwbGFjZSh7DQogICAgICAgICAgcGF0aDogJy9zdXBlcnZpc2UnDQogICAgICAgIH0pOw0KICAgICAgfQ0KICAgIH0sDQogICAgd2FybmluZyhtc2csIHR5cGUgPSAnd2FybmluZycpIHsNCiAgICAgIHRoaXMuJG1lc3NhZ2Uoew0KICAgICAgICBtZXNzYWdlOiBtc2csDQogICAgICAgIHR5cGU6IHR5cGUsDQogICAgICAgIHNob3dDbG9zZTogdHJ1ZQ0KICAgICAgfSk7DQogICAgfQ0KICB9DQp9Ow0K"},{"version":3,"sources":["Home.vue"],"names":[],"mappings":";;;;;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Home.vue","sourceRoot":"src/pages/executive-serve/views","sourcesContent":["<template>\r\n  <div class=\"home\"></div>\r\n</template>\r\n\r\n<script>\r\nimport { login, getAuth, getPlateList } from './../api/user';\r\nimport config from './../config';\r\nexport default {\r\n  name: 'Home',\r\n  data() {\r\n    return {\r\n      plateId: null\r\n    };\r\n  },\r\n  created() {\r\n    let staffCode = this.$route.query.staffCode;\r\n    this.plateId = this.$route.query.plateId || null;\r\n    if (this.plateId) {\r\n      this.getAuth();\r\n    } else {\r\n      let username;\r\n      if (config.NODE_ENV == 'production') {\r\n        username = staffCode;\r\n      } else {\r\n        username = staffCode ^ 1000000001;\r\n      }\r\n      login(username)\r\n        .then(res => {\r\n          this.getAuth();\r\n          // this.getPlateList()\r\n          //   .then(res => {\r\n          //     const data = res.data || [];\r\n          //     localStorage.setItem('plateList', JSON.stringify(data));\r\n          //     this.getAuth();\r\n          //   })\r\n          //   .catch(e => {\r\n          //     localStorage.setItem('plateList', []);\r\n          //   });\r\n        })\r\n        .catch(e => {\r\n          localStorage.setItem('userInfo', '');\r\n          console.log(e);\r\n          this.warning('暂未开通权限');\r\n        });\r\n    }\r\n\r\n    // localStorage.setItem('userInfo', JSON.stringify(userInfo));\r\n    // this.$router.replace({\r\n    //   path: '/fill'\r\n    // });\r\n  },\r\n  methods: {\r\n    getPlateList() {\r\n      return getPlateList();\r\n    },\r\n    getAuth() {\r\n      // let plateId = null;\r\n      // if (this.plateId) {\r\n      //   plateId = this.plateId;\r\n      // } else {\r\n      //   let plateList =\r\n      //     (localStorage.getItem('plateList') &&\r\n      //       JSON.parse(localStorage.getItem('plateList'))) ||\r\n      //     [];\r\n      //   plateId = (plateList[0] && plateList[0].id) || '';\r\n      // }\r\n      // localStorage.setItem('plateId', plateId);\r\n      getAuth().then(res => {\r\n        const { data } = res;\r\n        const { roles } = data;\r\n        localStorage.setItem('userInfo', JSON.stringify(data));\r\n        this.getDefaultPage();\r\n      });\r\n    },\r\n    getDefaultPage() {\r\n      const userInfo =\r\n        (localStorage.getItem('userInfo') &&\r\n          JSON.parse(localStorage.getItem('userInfo'))) ||\r\n        {};\r\n      const roles = userInfo.roles || [];\r\n      if (roles.includes('填报人')) {\r\n        this.$router.replace({\r\n          path: '/fill'\r\n        });\r\n      } else if (roles.includes('审核人')) {\r\n        this.$router.replace({\r\n          path: '/check'\r\n        });\r\n      } else if (roles.includes('处理人') || roles.includes('监督人')) {\r\n        this.$router.replace({\r\n          path: '/supervise'\r\n        });\r\n      }\r\n    },\r\n    warning(msg, type = 'warning') {\r\n      this.$message({\r\n        message: msg,\r\n        type: type,\r\n        showClose: true\r\n      });\r\n    }\r\n  }\r\n};\r\n</script>\r\n<style lang=\"less\" scoped>\r\n.home {\r\n  .triangletest {\r\n    .triangle(T);\r\n  }\r\n  .border {\r\n    position: relative;\r\n    width: 100px;\r\n    height: 100px;\r\n    .border(R, #0f0);\r\n  }\r\n}\r\n</style>\r\n"]}]}