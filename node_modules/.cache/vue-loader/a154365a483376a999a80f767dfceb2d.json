{"remainingRequest":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/fuyueyi/Desktop/practice/mutilwap/src/pages/charity-foundation/views/student/components/Agreement/index.vue?vue&type=style&index=0&id=16a49348&lang=less&scoped=true&","dependencies":[{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/src/pages/charity-foundation/views/student/components/Agreement/index.vue","mtime":1627979214291},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/less-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/style-resources-loader/lib/index.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgouQWdyZWVtZW50Qm94IHsKICAuQWdyZWVtZW50VGFibGUgewogICAgL2RlZXAvLmVsLWNhcmRfX2JvZHkgewogICAgICBkaXNwbGF5OiBmbGV4OwogICAgICBmbGV4LXdyYXA6IHdyYXA7CiAgICAgID4gZGl2IHsKICAgICAgICB3aWR0aDogMTIlOwogICAgICAgIGhlaWdodDogNDBweDsKICAgICAgICBkaXNwbGF5OiBmbGV4OwogICAgICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICAgICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7CiAgICAgICAgYm9yZGVyOiAxcHggc29saWQgIzAwMDsKICAgICAgICBtYXJnaW4tYm90dG9tOiAtMXB4OwogICAgICAgIG1hcmdpbi1yaWdodDogLTFweDsKICAgICAgfQogICAgICAuZmlsZUJveCB7CiAgICAgICAgY29sb3I6ICM0MDllZmY7CiAgICAgICAgY3Vyc29yOiBwb2ludGVyOwogICAgICAgIC5hdmF0YXItdXBsb2FkZXIgewogICAgICAgICAgb3ZlcmZsb3c6IGhpZGRlbjsKICAgICAgICAgIC9kZWVwLy5lbC11cGxvYWQgewogICAgICAgICAgICB3aWR0aDogMTAwJTsKICAgICAgICAgICAgb3ZlcmZsb3c6IGhpZGRlbjsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgLmZpbGVOYW1lIHsKICAgICAgICAgIG92ZXJmbG93OiBoaWRkZW47CiAgICAgICAgICB3aGl0ZS1zcGFjZTogbm93cmFwOwogICAgICAgICAgdGV4dC1vdmVyZmxvdzogZWxsaXBzaXM7CiAgICAgICAgICBwYWRkaW5nOiAwIDIwcHg7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfQp9Ci50YWJsZUJ0biB7CiAgbWFyZ2luLXRvcDogMjBweDsKICBkaXNwbGF5OiBmbGV4OwogIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7CiAgLmF2YXRhci11cGxvYWRlciB7CiAgICBwYWRkaW5nOiAwIDEwcHg7CiAgfQp9Cg=="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkYA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/pages/charity-foundation/views/student/components/Agreement","sourcesContent":["<template>\n  <div class=\"AgreementBox\" v-loading=\"loading\">\n    <el-Card class=\"AgreementTable\">\n      <div>学籍信息</div>\n      <div class=\"fileBox\">\n        <!-- <el-upload\n          v-if=\"!fileLists || !fileLists.studentInformationUrl\"\n          class=\"avatar-uploader\"\n          action=\"\"\n          :show-file-list=\"false\"\n          :multiple=\"false\"\n          :before-upload=\"beforeAvatarUpload\"\n          :http-request=\"\n            file => {\n              ajaxUploadSingle(file, 'studentInformation');\n            }\n          \"\n          accept=\".jpg,.jpeg,.png,.bmp,.doc,.docx,.xls,.xlsx,.wps,.pdf,.JPG,.JPEG,.PBG,.BMP,.DOC,.DOCX,.XLS,.XLSX,.WPS,.PDF\"\n        >\n          <p>协议文件</p>\n        </el-upload> -->\n        <!-- <p v-if=\"!fileLists || !fileLists.studentInformationUrl\">协议文件</p> -->\n        <p\n          class=\"fileName\"\n          @click=\"showPreview('studentInformation')\"\n          :title=\"\n            !fileLists || !fileLists.studentInformationUrl\n              ? ''\n              : fileLists.studentInformationName\n          \"\n        >\n          {{\n            !fileLists || !fileLists.studentInformationUrl\n              ? '协议文件'\n              : fileLists.studentInformationName\n          }}\n        </p>\n        <!-- <p class=\"fileName\" v-else @click=\"showPreview('studentInformation')\">\n          {{ fileLists.studentInformationName }}\n        </p> -->\n      </div>\n      <div>培养协议</div>\n      <div class=\"fileBox\">\n        <!-- <el-upload\n          v-if=\"!fileLists || !fileLists.developAgreementUrl\"\n          class=\"avatar-uploader\"\n          action=\"\"\n          :show-file-list=\"false\"\n          :multiple=\"false\"\n          :http-request=\"\n            file => {\n              ajaxUploadSingle(file, 'developAgreement');\n            }\n          \"\n          :before-upload=\"beforeAvatarUpload\"\n          accept=\".jpg,.jpeg,.png,.bmp,.doc,.docx,.xls,.xlsx,.wps,.pdf,.JPG,.JPEG,.PBG,.BMP,.DOC,.DOCX,.XLS,.XLSX,.WPS,.PDF\"\n        >\n          <p>协议文件</p>\n        </el-upload>\n        <p class=\"fileName\" v-else @click=\"showPreview('developAgreement')\">\n          {{ fileLists.developAgreementName }}\n        </p> -->\n        <p\n          class=\"fileName\"\n          @click=\"showPreview('developAgreement')\"\n          :title=\"\n            !fileLists || !fileLists.developAgreementUrl\n              ? ''\n              : fileLists.developAgreementName\n          \"\n        >\n          {{\n            !fileLists || !fileLists.developAgreementUrl\n              ? '协议文件'\n              : fileLists.developAgreementName\n          }}\n        </p>\n      </div>\n      <div>培养补充协议</div>\n      <div class=\"fileBox\">\n        <!-- <el-upload\n          v-if=\"!fileLists || !fileLists.developAgreementAddUrl\"\n          class=\"avatar-uploader\"\n          action=\"\"\n          :show-file-list=\"false\"\n          :multiple=\"false\"\n          :http-request=\"\n            file => {\n              ajaxUploadSingle(file, 'developAgreementAdd');\n            }\n          \"\n          :before-upload=\"beforeAvatarUpload\"\n          accept=\".jpg,.jpeg,.png,.bmp,.doc,.docx,.xls,.xlsx,.wps,.pdf,.JPG,.JPEG,.PBG,.BMP,.DOC,.DOCX,.XLS,.XLSX,.WPS,.PDF\"\n        >\n          <p>协议文件</p>\n        </el-upload>\n        <p class=\"fileName\" v-else @click=\"showPreview('developAgreementAdd')\">\n          {{ fileLists.developAgreementAddName }}\n        </p> -->\n        <p\n          class=\"fileName\"\n          @click=\"showPreview('developAgreementAdd')\"\n          :title=\"\n            !fileLists || !fileLists.developAgreementAddUrl\n              ? ''\n              : fileLists.developAgreementAddName\n          \"\n        >\n          {{\n            !fileLists || !fileLists.developAgreementAddUrl\n              ? '协议文件'\n              : fileLists.developAgreementAddName\n          }}\n        </p>\n      </div>\n      <div>终止培养协议</div>\n      <div class=\"fileBox\">\n        <!-- <el-upload\n          v-if=\"!fileLists || !fileLists.terminationDevelopAgreementUrl\"\n          class=\"avatar-uploader\"\n          action=\"\"\n          :show-file-list=\"false\"\n          :multiple=\"false\"\n          :http-request=\"\n            file => {\n              ajaxUploadSingle(file, 'terminationDevelopAgreement');\n            }\n          \"\n          :before-upload=\"beforeAvatarUpload\"\n          accept=\".jpg,.jpeg,.png,.bmp,.doc,.docx,.xls,.xlsx,.wps,.pdf,.JPG,.JPEG,.PBG,.BMP,.DOC,.DOCX,.XLS,.XLSX,.WPS,.PDF\"\n        >\n          <p>协议文件</p>\n        </el-upload>\n        <p\n          class=\"fileName\"\n          v-else\n          @click=\"showPreview('terminationDevelopAgreement')\"\n        >\n          {{ fileLists.terminationDevelopAgreementName }}\n        </p> -->\n        <p\n          class=\"fileName\"\n          @click=\"showPreview('terminationDevelopAgreement')\"\n          :title=\"\n            !fileLists || !fileLists.terminationDevelopAgreementUrl\n              ? ''\n              : fileLists.terminationDevelopAgreementName\n          \"\n        >\n          {{\n            !fileLists || !fileLists.terminationDevelopAgreementUrl\n              ? '协议文件'\n              : fileLists.terminationDevelopAgreementName\n          }}\n        </p>\n      </div>\n      <div>招募协议</div>\n      <div class=\"fileBox\">\n        <!-- <el-upload\n          v-if=\"!fileLists || !fileLists.recruitAgreementUrl\"\n          class=\"avatar-uploader\"\n          action=\"\"\n          :show-file-list=\"false\"\n          :multiple=\"false\"\n          :http-request=\"\n            file => {\n              ajaxUploadSingle(file, 'recruitAgreement');\n            }\n          \"\n          :before-upload=\"beforeAvatarUpload\"\n          accept=\".jpg,.jpeg,.png,.bmp,.doc,.docx,.xls,.xlsx,.wps,.pdf,.JPG,.JPEG,.PBG,.BMP,.DOC,.DOCX,.XLS,.XLSX,.WPS,.PDF\"\n        >\n          <p>协议文件</p>\n        </el-upload>\n        <p class=\"fileName\" v-else @click=\"showPreview('recruitAgreement')\">\n          {{ fileLists.recruitAgreementName }}\n        </p> -->\n        <p\n          class=\"fileName\"\n          @click=\"showPreview('recruitAgreement')\"\n          :title=\"\n            !fileLists || !fileLists.recruitAgreementUrl\n              ? ''\n              : fileLists.recruitAgreementName\n          \"\n        >\n          {{\n            !fileLists || !fileLists.recruitAgreementUrl\n              ? '协议文件'\n              : fileLists.recruitAgreementName\n          }}\n        </p>\n      </div>\n      <div>其他协议</div>\n      <div\n        class=\"fileBox\"\n        v-for=\"(files, indexs) in otherFileList\"\n        :key=\"indexs\"\n      >\n        <!-- <el-upload\n          v-if=\"!files.url && files\"\n          class=\"avatar-uploader\"\n          action=\"\"\n          :show-file-list=\"false\"\n          :multiple=\"false\"\n          :http-request=\"\n            file => {\n              ajaxUploadSingle(file, 'otherAgreement');\n            }\n          \"\n          :before-upload=\"beforeAvatarUpload\"\n          accept=\".jpg,.jpeg,.png,.bmp,.doc,.docx,.xls,.xlsx,.wps,.pdf,.JPG,.JPEG,.PBG,.BMP,.DOC,.DOCX,.XLS,.XLSX,.WPS,.PDF\"\n        >\n          <p>协议文件</p>\n        </el-upload>\n        <p\n          class=\"fileName\"\n          v-else\n          @click=\"showPreview('otherAgreement', indexs)\"\n        >\n          {{ files.name }}\n        </p> -->\n        <p\n          class=\"fileName\"\n          @click=\"showPreview('otherAgreement', indexs)\"\n          :title=\"!files.url && files ? '' : files.name\"\n        >\n          {{ !files.url && files ? '协议文件' : files.name }}\n        </p>\n      </div>\n      <div class=\"fileBox\" @click=\"addFile\">新增文件</div>\n    </el-Card>\n    <div class=\"tableBtn\">\n      <el-button type=\"primary\" size=\"small\" @click=\"goBack\">返回</el-button>\n    </div>\n    <preview-agreement\n      ref=\"perviewAgrem\"\n      @closed=\"closed\"\n      :studentData=\"studentData\"\n    ></preview-agreement>\n  </div>\n</template>\n\n<script>\nimport axios from '@/plugins/axios';\nimport { Card, Button, Upload } from 'element-ui';\nimport {\n  agreementDetail,\n  addStudentAgreement\n} from '@/pages/charity-foundation/api/sutdent/index';\nimport { ajaxUploadSingle } from '@/pages/charity-foundation/api/file/index';\nimport PreviewAgreement from '../PreviewAgreement/index';\nexport default {\n  name: 'Agreement',\n  components: {\n    [Card.name]: Card,\n    [Button.name]: Button,\n    [Upload.name]: Upload,\n    PreviewAgreement\n  },\n  props: {\n    studentData: {\n      type: Object,\n      default: () => ({})\n    }\n  },\n  data() {\n    return {\n      loading: false,\n      otherFileList: [], // 其他协议文件\n      fileLists: {}\n    };\n  },\n  mounted() {\n    this.initData();\n  },\n  methods: {\n    initData() {\n      this.loading = true;\n      agreementDetail({ studentBaseId: this.studentData.id }).then(res => {\n        this.fileLists = res.data;\n        let otherListUrl = []; // 存放分割后其他文件路径\n        let otherListName = []; // 存放分割后其他文件名称\n        let otherList = []; // 存放处理后数组\n        otherListUrl =\n          res.data && res.data.otherAgreementUrl\n            ? res.data.otherAgreementUrl.split(',')\n            : [];\n        otherListName =\n          res.data && res.data.otherAgreementName\n            ? res.data.otherAgreementName.split(',')\n            : [];\n        // if (Array.isArray(otherListUrl) && otherListUrl.length <= 0) {\n        //   // 如果没有默认加一个空的文件\n        //   otherList = [\n        //     {\n        //       url: '',\n        //       name: ''\n        //     }\n        //   ];\n        // } else {\n        otherListUrl.forEach((item, index) => {\n          otherList.push({\n            url: item,\n            name: otherListName[index]\n          });\n        });\n        // }\n        this.otherFileList = otherList;\n        this.loading = false;\n      });\n    },\n    /**\n     * 文件预览\n     */\n    showPreview(name, index) {\n      this.$refs.perviewAgrem.show(name, this.fileLists, index);\n    },\n    closed() {\n      this.initData();\n    },\n    /**\n     * 新增文件\n     */\n    addFile() {\n      if (this.otherFileList.length >= 10) {\n        this.$message.error('其他协议多于10个，请联系管理员');\n        return false;\n      }\n      this.otherFileList.push({});\n    },\n    // /**\n    //  * 上传图片限制\n    //  */\n    // beforeAvatarUpload(file) {\n    //   console.log(file, file, 'beforeAvatarUpload');\n    //   const isLt2M = file.size / 1024 / 1024;\n    //   if (!isLt2M) {\n    //     this.$message.error('上传头像图片大小不能超过 2MB!');\n    //   }\n    //   return isLt2M;\n    // },\n    // ajaxUploadSingle(file, name) {\n    //   let formData = new FormData();\n    //   formData.append('file', file.file);\n    //   formData.append('appid', 'ossako2ag');\n    //   formData.append('appsecret', 'is231968');\n    //   ajaxUploadSingle(formData).then(res => {\n    //     if (Number(res.code) === 8200) {\n    //       let params = {\n    //         studentBaseId: this.studentData.id,\n    //         id: this.fileLists && this.fileLists.id ? this.fileLists.id : ''\n    //       };\n    //       if (name === 'otherAgreement') {\n    //         let fileurl = '';\n    //         let filename = '';\n    //         this.otherFileList.forEach(item => {\n    //           fileurl += item.url ? `${item.url},` : '';\n    //           filename += item.name ? `${item.name},` : '';\n    //         });\n    //         fileurl += res.data[0].url;\n    //         filename += res.data[0].originalName;\n    //         console.log(fileurl, filename, 'otherAgreement');\n    //         params[`${name}Url`] = fileurl.substring(0, fileurl.length - 1);\n    //         params[`${name}Name`] = filename.substring(0, filename.length - 1);\n    //       } else {\n    //         params[`${name}Url`] = res.data[0].url;\n    //         params[`${name}Name`] = res.data[0].originalName;\n    //       }\n    //       addStudentAgreement(params).then(res => {\n    //         this.initData();\n    //       });\n    //     }\n    //   });\n    // },\n    /**\n     * 返回\n     */\n    goBack() {\n      this.$router.push({ path: '/student/basic-info' });\n    }\n  }\n};\n</script>\n\n<style lang=\"less\" scoped>\n.AgreementBox {\n  .AgreementTable {\n    /deep/.el-card__body {\n      display: flex;\n      flex-wrap: wrap;\n      > div {\n        width: 12%;\n        height: 40px;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        border: 1px solid #000;\n        margin-bottom: -1px;\n        margin-right: -1px;\n      }\n      .fileBox {\n        color: #409eff;\n        cursor: pointer;\n        .avatar-uploader {\n          overflow: hidden;\n          /deep/.el-upload {\n            width: 100%;\n            overflow: hidden;\n          }\n        }\n        .fileName {\n          overflow: hidden;\n          white-space: nowrap;\n          text-overflow: ellipsis;\n          padding: 0 20px;\n        }\n      }\n    }\n  }\n}\n.tableBtn {\n  margin-top: 20px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  .avatar-uploader {\n    padding: 0 10px;\n  }\n}\n</style>\n"]}]}