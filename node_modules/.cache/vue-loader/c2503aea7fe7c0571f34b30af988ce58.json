{"remainingRequest":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/src/pages/h5/views/sims/enrollFill/EnrollInfo.vue?vue&type=style&index=0&id=c0ff3994&lang=less&scoped=true&","dependencies":[{"path":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/src/pages/h5/views/sims/enrollFill/EnrollInfo.vue","mtime":1627979214309},{"path":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/node_modules/less-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/node_modules/style-resources-loader/lib/index.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgpAaW1wb3J0IHVybCgnLi4vYXNzZXRzL2xlc3MvZ2xvYmFsL2luZGV4Lmxlc3MnKTsKQGltcG9ydCAnLi9sZXNzL3NpbXMtZm9ybS5sZXNzJzsKLmFwcC1jb250YWluZXIgewogIHBhZGRpbmc6IDA7Cn0KLnRpdGxlIHsKICBmb250LXdlaWdodDogYm9sZDsKfQo="},{"version":3,"sources":["EnrollInfo.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsjBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"EnrollInfo.vue","sourceRoot":"src/pages/h5/views/sims/enrollFill","sourcesContent":["<template>\n  <div class=\"sims-app-container\">\n    <page-header :index=\"2\"></page-header>\n    <div class=\"sims-form-title\">\n      <span class=\"zh\">原就读信息</span>\n      <span class=\"en\">ORIGINAL STUDY INFORMATION</span>\n    </div>\n    <van-form class=\"sims-form\" ref=\"form\" label-align=\"right\">\n      <van-field label=\"原就读学校性质\" class=\"w-7em\">\n        <template #input>\n          <van-radio-group\n            v-model=\"formData.oriSchoolType\"\n            direction=\"horizontal\"\n          >\n            <van-radio name=\"0\">国内</van-radio>\n            <van-radio name=\"1\">国外</van-radio>\n          </van-radio-group>\n        </template>\n      </van-field>\n      <p class=\"sims-form-group-title\">原就读学校</p>\n      <van-field\n        readonly\n        clickable\n        name=\"area\"\n        :value=\"formData.pastSchoolAddress\"\n        :label=\"formData.oriSchoolType !== '1' ? '地区信息' : ' '\"\n        placeholder=\"地区信息\"\n        v-show=\"formData.oriSchoolType !== '1'\"\n        class=\"w-5em bg-blur\"\n        @click=\"showPastSchoolAddressPicker = true\"\n      >\n        <field-icon slot=\"right-icon\" icon=\"icon_location\" />\n      </van-field>\n      <van-popup v-model=\"showPastSchoolAddressPicker\" position=\"bottom\">\n        <van-area\n          :area-list=\"areaList\"\n          item-height=\"0.8rem\"\n          @confirm=\"onConfirmPastSchoolAddress\"\n          @cancel=\"showPastSchoolAddressPicker = false\"\n        />\n      </van-popup>\n      <van-field\n        v-model=\"formData.oriSchoolName\"\n        name=\"oriSchoolName\"\n        :label=\"formData.oriSchoolType !== '1' ? '学校名称' : ''\"\n        placeholder=\"请输入\"\n        class=\"w-5em bg-blur\"\n      />\n      <van-field\n        v-model=\"formData.oriSchoolClass\"\n        label=\"原就读班级\"\n        placeholder=\"请输入\"\n        class=\"w-5em\"\n      />\n      <van-field name=\"radio\" label=\"是否走读\" class=\"w-5em\">\n        <template #input>\n          <van-radio-group v-model=\"formData.isExtern\" direction=\"horizontal\">\n            <van-radio :name=\"true\">是</van-radio>\n            <van-radio :name=\"false\">否</van-radio>\n          </van-radio-group>\n        </template>\n      </van-field>\n      <!-- <c-select-picker\n        v-model=\"formData.signYearType\"\n        label=\"招生性质\"\n        value-key=\"value\"\n        text-key=\"label\"\n        :placeholder=\"'学年'\"\n        :options=\"schoolYearOptions\"\n      ></c-select-picker>\n      <c-select-picker\n        v-model=\"formData.signTermType\"\n        label=\" \"\n        value-key=\"value\"\n        text-key=\"label\"\n        :placeholder=\"'学期'\"\n        :options=\"termOptions\"\n      ></c-select-picker>\n      <c-select-picker\n        v-model=\"formData.enrollType\"\n        label=\" \"\n        value-key=\"value\"\n        text-key=\"label\"\n        :placeholder=\"'来源'\"\n        :options=\"computedSourceOptions\"\n      ></c-select-picker>\n      <c-select-picker\n        v-model=\"formData.campusCode\"\n        v-show=\"fieldVisible\"\n        label=\"校区\"\n        value-key=\"campusCode\"\n        text-key=\"campusName\"\n        @change=\"val => onSelectChange(val, 'campusName', 'campusName')\"\n        :options=\"campusOptions\"\n      ></c-select-picker>\n      <c-select-picker\n        v-model=\"formData.schoolCode\"\n        v-show=\"fieldVisible\"\n        label=\"学校\"\n        value-key=\"value\"\n        text-key=\"label\"\n        @change=\"val => onSelectChange(val, 'schoolName')\"\n        :options=\"schoolOptions\"\n      ></c-select-picker>\n      <c-select-picker\n        v-model=\"formData.departCode\"\n        v-show=\"fieldVisible\"\n        label=\"学部\"\n        value-key=\"value\"\n        text-key=\"label\"\n        @change=\"val => onSelectChange(val, 'departName')\"\n        :options=\"departOptions\"\n      ></c-select-picker>\n      <c-select-picker\n        v-model=\"formData.gradeCode\"\n        v-show=\"fieldVisible\"\n        label=\"年级\"\n        value-key=\"value\"\n        text-key=\"label\"\n        @change=\"val => onSelectChange(val, 'gradeName')\"\n        :options=\"gradeOptions\"\n      ></c-select-picker>\n      <c-select-picker\n        v-model=\"formData.classTypeCode\"\n        v-show=\"fieldVisible\"\n        label=\"班级类型\"\n        value-key=\"classTypeCode\"\n        text-key=\"classTypeName\"\n        @change=\"val => onSelectChange(val, 'classTypeName', 'classTypeName')\"\n        :options=\"classTypeOptions\"\n      ></c-select-picker> -->\n      <van-field name=\"radio\" label=\"是否重读\" class=\"w-5em\">\n        <template #input>\n          <van-radio-group\n            v-model=\"formData.isRepetition\"\n            direction=\"horizontal\"\n          >\n            <van-radio :name=\"true\">是</van-radio>\n            <van-radio :name=\"false\">否</van-radio>\n          </van-radio-group>\n        </template>\n      </van-field>\n      <!-- <c-select-picker\n        v-model=\"formData.shuttleType\"\n        v-show=\"fieldVisible\"\n        label=\"接送方式\"\n        value-key=\"dictionaryKey\"\n        text-key=\"dictionaryValueZh\"\n        :options=\"shuttleTypeOptions\"\n      ></c-select-picker>\n      <c-select-picker\n        v-model=\"formData.shuttleAreaCode\"\n        v-show=\"fieldVisible\"\n        label=\"接送路线\"\n        placeholder=\"地区\"\n        value-key=\"areaCode\"\n        text-key=\"areaName\"\n        :options=\"shuttleAreaOptions\"\n      ></c-select-picker>\n      <c-select-picker\n        v-model=\"formData.shuttleDistrictCode\"\n        v-show=\"fieldVisible\"\n        label=\" \"\n        placeholder=\"区县\"\n        value-key=\"districtCode\"\n        text-key=\"districtName\"\n        :options=\"shuttleDistrictOptions\"\n      ></c-select-picker>\n      <c-select-picker\n        v-model=\"formData.shuttlePointCode\"\n        v-show=\"fieldVisible\"\n        label=\" \"\n        placeholder=\"下车点\"\n        value-key=\"pointCode\"\n        text-key=\"pointName\"\n        :options=\"shuttlePointOptions\"\n      ></c-select-picker> -->\n    </van-form>\n    <div class=\"sims-form-bottom\">\n      <van-button block plain type=\"info\" native-type=\"back\" @click=\"onBack\"\n        >上一步</van-button\n      >\n      <van-button block type=\"info\" native-type=\"submit\" @click=\"onSubmit\"\n        >提交</van-button\n      >\n    </div>\n  </div>\n</template>\n<script>\nimport {\n  Form,\n  Field,\n  Picker,\n  Popup,\n  DatetimePicker,\n  RadioGroup,\n  Radio,\n  Area,\n  Uploader,\n  Button\n} from 'vant';\nimport {\n  codeConverterName,\n  getAreaData\n} from '@/pages/sims/plugins/common/area';\nimport CSelectPicker from '@/pages/h5/components/common/CSelectPicker.vue';\nimport { queryConjunctiveList } from '../../../plugins/common/utils';\nimport {\n  queryCampusInfoList,\n  queryRelevanceInfoList,\n  saveEnrAttendH5,\n  pointQueryPage, //级联查询下车点\n  districtQueryPage, //级联查询接送县区\n  areaQueryPage, //级联查询接送\n  queryShuttleTypeBySchoolCode //按照学校查询接送方式\n} from '@/pages/h5/api/sims/enrollFill/index';\nimport { Toast } from 'vant';\nimport mixins from './mixins';\nimport PageHeader from '../components/pageHeader.vue';\nimport FieldIcon from '../components/FieldIcon.vue';\nexport default {\n  name: 'EnrollInfo',\n  mixins: [mixins],\n  components: {\n    PageHeader,\n    [Form.name]: Form,\n    [Field.name]: Field,\n    [Picker.name]: Picker,\n    [Popup.name]: Popup,\n    [DatetimePicker.name]: DatetimePicker,\n    [RadioGroup.name]: RadioGroup,\n    [Radio.name]: Radio,\n    [Area.name]: Area,\n    [Uploader.name]: Uploader,\n    [Button.name]: Button,\n    FieldIcon\n    // CSelectPicker\n  },\n  data() {\n    return {\n      inited: false,\n      areaList: getAreaData(), // 省市区\n      schoolYearOptions: [], // 学年\n      termOptions: [], // 学期\n      sourceOptions: [], // 来源\n      columns: ['杭州', '宁波', '温州', '绍兴', '湖州', '嘉兴', '金华', '衢州'],\n      campusOptions: [], // 校区\n      schoolOptions: [], // 学校\n      departOptions: [], // 学部\n      gradeOptions: [], // 年级\n      classTypeOptions: [], // 班级类型\n      showPastSchoolAddressPicker: false, // 原就读学校弹框显隐\n      shuttleTypeOptions: [], //接送方式\n      shuttleAreaOptions: [], //接送地区\n      shuttleDistrictOptions: [], //接送区县\n      shuttlePointOptions: [], //接送下车点\n      fieldVisible: false, // 校区、学校、学部、年级、班级类型显隐\n      formData: {\n        oriSchoolType: null,\n        oriSchoolName: null,\n        oriSchoolClass: null,\n        signYearType: null,\n        signTermType: null,\n        enrollType: null,\n        isExtern: null,\n        isRepetition: null,\n        pastSchoolAddress: null,\n        oriSchoolProvince: null,\n        oriSchoolCity: null,\n        oriSchoolArea: null,\n        campusCode: null,\n        schoolCode: null,\n        departCode: null,\n        gradeCode: null,\n        classTypeCode: null,\n        reread: null,\n        shuttleType: null,\n        shuttleAreaCode: null,\n        shuttleDistrictCode: null,\n        shuttlePointCode: null,\n        county: null\n      }\n    };\n  },\n  computed: {\n    //下拉选择\n    computedSourceOptions() {\n      let { signTermType } = { ...this.formData };\n      return this.sourceOptions.filter(option => {\n        //春季招生时，只展示“外招”来源\n        if (signTermType === '1') {\n          return option.value === '0';\n        } else if (signTermType === '0') {\n          //秋季招生时，展示“外招”和“择升”\n          return ['0', '2'].includes(option.value);\n        } else if (!signTermType) {\n          return false;\n        }\n        return true;\n      });\n    }\n  },\n  watch: {\n    'pageData.enrAttendModel': {\n      handler(newVal) {\n        this.initData(newVal);\n      }\n    },\n    // 学年变化\n    'formData.signYearType': {\n      handler() {\n        this.fieldVisible = this.formData.signYearType ? true : false;\n        if (this.inited) {\n          this.formData.campusCode = null;\n          this.formData.campusName = null;\n        }\n      }\n    },\n    //校区切换\n    'formData.campusCode': {\n      handler() {\n        if (this.inited) {\n          this.formData.schoolCode = null;\n          this.formData.schoolName = null;\n          this.schoolOptions = [];\n        }\n        this.getCascaderOptions({\n          childCodeType: 2, //当前查询类型 1-校区;2-学校;3-学部;4-年级;5-班级;6-班级类型\n          codeType: 1, //上级父类型 1-校区;2-学校;3-学部;4-年级;5-班级;6-班级类型\n          code: this.formData.campusCode\n        }).then(data => {\n          this.schoolOptions = data;\n        });\n      }\n    },\n    //学校变化\n    'formData.schoolCode': {\n      handler() {\n        if (this.inited) {\n          this.formData.departCode = null;\n          this.formData.departName = null;\n          this.formData.shuttleType = null;\n          this.departOptions = [];\n          this.shuttleTypeOptions = [];\n        }\n        //查询学部信息\n        this.getCascaderOptions({\n          childCodeType: 3, //当前查询类型 1-校区;2-学校;3-学部;4-年级;5-班级;6-班级类型\n          codeType: 2, //上级父类型 1-校区;2-学校;3-学部;4-年级;5-班级;6-班级类型\n          code: this.formData.schoolCode\n        }).then(data => {\n          this.departOptions = data;\n        });\n        //查询接送方式\n        queryShuttleTypeBySchoolCode(this.formData.schoolCode).then(res => {\n          this.shuttleTypeOptions = res.data[0].children;\n        });\n      }\n    },\n    //学部变化\n    'formData.departCode': {\n      handler() {\n        if (this.inited) {\n          this.formData.gradeCode = null;\n          this.formData.gradeName = null;\n          this.gradeOptions = [];\n        }\n        console.log(this.formData.signYearType);\n        this.getCascaderOptions({\n          childCodeType: 4, //当前查询类型 1-校区;2-学校;3-学部;4-年级;5-班级;6-班级类型\n          codeType: 3, //上级父类型 1-校区;2-学校;3-学部;4-年级;5-班级;6-班级类型\n          code: this.formData.departCode,\n          signYearType: this.formData.signYearType\n        }).then(data => {\n          this.gradeOptions = data;\n        });\n      }\n    },\n    //年级变化\n    'formData.gradeCode': {\n      handler() {\n        if (this.inited) {\n          this.formData.classTypeCode = null;\n          this.formData.classTypeName = null;\n          this.classTypeOptions = [];\n        }\n        this.getClassTypeOptions({\n          signYearType: this.formData.signYearType,\n          departCode: this.formData.departCode,\n          gradeCode: this.formData.gradeCode\n        }).then(data => {\n          this.classTypeOptions = data;\n        });\n      }\n    },\n    //接送方式改变，刷新接送地区\n    'formData.shuttleType': {\n      handler() {\n        if (this.inited) {\n          this.formData.shuttleAreaCode = null;\n          this.formData.shuttleAreaName = null;\n          this.shuttleAreaOptions = [];\n        }\n        if (!this.formData.shuttleType) return;\n        return areaQueryPage({\n          shuttleType: this.formData.shuttleType,\n          schoolCode: this.formData.schoolCode\n        }).then(res => {\n          this.shuttleAreaOptions = res.data.records;\n        });\n      }\n    },\n    //接送地区变化，刷新接送区县\n    'formData.shuttleAreaCode': {\n      handler() {\n        if (this.inited) {\n          this.formData.shuttleDistrictCode = null;\n          this.formData.shuttleDistrictName = null;\n          this.shuttleDistrictOptions = [];\n        }\n        if (!this.formData.shuttleAreaCode) return;\n        return districtQueryPage({\n          shuttleType: this.formData.shuttleType,\n          areaCode: this.formData.shuttleAreaCode,\n          schoolCode: this.formData.schoolCode\n        }).then(res => {\n          this.shuttleDistrictOptions = res.data.records;\n        });\n      }\n    },\n    //接送区县变化，刷新下车点\n    'formData.shuttleDistrictCode': {\n      handler() {\n        if (this.inited) {\n          this.formData.shuttlePointCode = null;\n          this.formData.shuttlePointName = null;\n          this.shuttlePointOptions = [];\n        }\n        if (!this.formData.shuttleDistrictCode) return;\n        return pointQueryPage({\n          shuttleType: this.formData.shuttleType,\n          areaCode: this.formData.shuttleAreaCode,\n          districtCode: this.formData.shuttleDistrictCode,\n          schoolCode: this.formData.schoolCode\n        }).then(res => {\n          this.shuttlePointOptions = res.data.records;\n        });\n      }\n    },\n    //学期变化\n    'formData.signTermType': {\n      handler() {\n        if (this.inited) {\n          this.formData.enrollType = null;\n        }\n      }\n    }\n  },\n  created() {\n    console.log(this.$store);\n    this.schoolYearOptions = this.$D('XNM');\n    this.termOptions = this.$D('BMXQM');\n    this.sourceOptions = this.$D('ZSLYM');\n    this.getCampusList();\n  },\n  methods: {\n    /**\n     * 获取地址\n     */\n    getAddress(provinceCode, cityCode, countyCode) {\n      return [\n        codeConverterName(provinceCode),\n        codeConverterName(cityCode),\n        codeConverterName(countyCode)\n      ]\n        .filter(item => item)\n        .join('/');\n    },\n    //初始化数据\n    initData(newVal) {\n      let { oriSchoolProvince, oriSchoolCity, oriSchoolArea } = {\n        ...newVal\n      };\n      Object.assign(this.formData, newVal);\n      //更新出生地\n      if (oriSchoolProvince) {\n        this.formData.pastSchoolAddress = this.getAddress(\n          oriSchoolProvince,\n          oriSchoolCity,\n          oriSchoolArea\n        );\n      }\n      this.$nextTick(() => {\n        this.inited = true;\n      });\n    },\n    // 获取校区信息\n    getCampusList() {\n      queryCampusInfoList({}, true).then(data => {\n        this.campusOptions = data;\n        console.log(data);\n      });\n    },\n    // 获取级联信息\n    getCascaderOptions(item) {\n      return new Promise(resolve => {\n        queryConjunctiveList(item, true).then(data => {\n          resolve(data);\n        });\n      });\n    },\n    // 获取班级类型\n    getClassTypeOptions(item) {\n      return new Promise(resolve => {\n        queryRelevanceInfoList(item, true).then(data => {\n          resolve(data);\n        });\n      });\n    },\n    // 表单提交\n    onSubmit() {\n      let loading = Toast.loading();\n      //保存身份信息\n      saveEnrAttendH5({\n        ...this.formData,\n        staffCode: this.$route.query.staffCode\n      })\n        .then(res => {\n          loading.close();\n          Toast.success('操作成功');\n          this.$router.replace('/sims/entrollFill/complete');\n        })\n        .catch(e => {\n          loading.close();\n          Toast.fail(e.message);\n        });\n    },\n    //下拉框选择切换\n    onSelectChange(val, labelField, valueField = 'label') {\n      this.formData[labelField] = val[valueField];\n    },\n    /**\n     * 原就读学校地址\n     */\n    onConfirmPastSchoolAddress(val) {\n      this.formData.oriSchoolProvince = val[0].code;\n      this.formData.oriSchoolCity = val[1].code;\n      this.formData.oriSchoolArea = val[2].code;\n      this.formData.pastSchoolAddress = this.getAddress(\n        val[0].code,\n        val[1].code,\n        val[2].code\n      );\n      this.showPastSchoolAddressPicker = false;\n    },\n    // 回退\n    onBack() {\n      this.$router.replace({\n        path: '/sims/entrollFill/familyInfo',\n        query: this.$route.query\n      });\n    }\n  }\n};\n</script>\n<style lang=\"less\" scoped>\n@import url('../assets/less/global/index.less');\n@import './less/sims-form.less';\n.app-container {\n  padding: 0;\n}\n.title {\n  font-weight: bold;\n}\n</style>\n"]}]}