{"remainingRequest":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/src/pages/bonus-tool-admin/views/login/index.vue?vue&type=style&index=0&id=63729914&lang=less&scoped=true&","dependencies":[{"path":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/src/pages/bonus-tool-admin/views/login/index.vue","mtime":1646020538152},{"path":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/node_modules/less-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/node_modules/style-resources-loader/lib/index.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/yjy-projects/multi-project/mutilwap/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgouYXBwLWNvbnRhaW5lciB7CiAgcG9zaXRpb246IGFic29sdXRlOwogIGxlZnQ6IDA7CiAgdG9wOiAwOwogIHJpZ2h0OiAwOwogIGJvdHRvbTogMDsKICBtaW4taGVpZ2h0OiA4MjBweDsKICBtaW4td2lkdGg6IDgyMHB4OwogIGJhY2tncm91bmQtaW1hZ2U6IHVybCguLi8uLi9hc3NldHMvaW1hZ2VzL2xvZ2luX2JnLnBuZyk7CiAgYmFja2dyb3VuZC1zaXplOiBjb3ZlcjsKICBiYWNrZ3JvdW5kLXJlcGVhdDogbm8tcmVwZWF0OwogIC5sb2dpbi1wYW5lbCwKICAucmVwYXNzd29yZC1wYW5lbCB7CiAgICBwb3NpdGlvbjogcmVsYXRpdmU7CiAgICBib3gtc2l6aW5nOiBib3JkZXItYm94OwogICAgbWFyZ2luOiAxNDJweCBhdXRvIDIyMHB4OwogICAgd2lkdGg6IDY4MHB4OwogICAgaGVpZ2h0OiA1NDBweDsKICAgIHBhZGRpbmc6IDY0cHggMCA1MnB4OwogICAgZGlzcGxheTogZmxleDsKICAgIGZsZXgtZGlyZWN0aW9uOiBjb2x1bW47CiAgICAvLyBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsKICAgIGFsaWduLWl0ZW1zOiBjZW50ZXI7CiAgICBiYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDAsIDAsIDAsIDAuNDQpOwogICAgYm9yZGVyLXJhZGl1czogMTBweDsKCiAgICAubG9naW4tdHh0IHsKICAgICAgZm9udC1zaXplOiAzNnB4OwogICAgICBjb2xvcjogI2ZmZmY7CiAgICAgIG1hcmdpbi1ib3R0b206IDY0cHg7CiAgICB9CiAgICAuZWwtZm9ybS1pdGVtIHsKICAgICAgd2lkdGg6IDM3NnB4OwogICAgICAvLyBtYXJnaW4tYm90dG9tOiAxNnB4OwogICAgfQogIH0KICAucmVwYXNzd29yZC1wYW5lbCB7CiAgICBwYWRkaW5nOiAxMThweDsKICB9Cn0K"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsdA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/pages/bonus-tool-admin/views/login","sourcesContent":["<template>\n  <div class=\"app-container\">\n    <!-- 管理端端 -->\n    <!-- 登录 -->\n    <div class=\"login-panel\" v-if=\"!isFirstLogin\">\n      <div class=\"login-txt\">海亮教育集团校园激励分配管理后台</div>\n\n      <el-form\n        ref=\"loginFormRef\"\n        :model=\"loginForm\"\n        :rules=\"rules\"\n        @keydown.native.enter.prevent=\"login\"\n      >\n        <el-form-item prop=\"username\">\n          <el-input\n            v-model=\"loginForm.username\"\n            placeholder=\"账号\"\n            maxlength=\"11\"\n            autofocus\n            autocomplete=\"on\"\n          ></el-input>\n        </el-form-item>\n        <el-form-item prop=\"password\">\n          <el-input\n            v-model=\"loginForm.password\"\n            type=\"password\"\n            autocomplete=\"on\"\n            placeholder=\"密码\"\n          ></el-input>\n        </el-form-item>\n        <!--submit button-->\n        <el-form-item style=\"margin-top: 40px\">\n          <el-button\n            type=\"primary\"\n            style=\"width: 100%; margin-top: 20px; background: #0076f6;\"\n            @click=\"login\"\n          >\n            登录\n          </el-button>\n        </el-form-item>\n        <!-- <el-form-item style=\"text-align: center;\"> -->\n        <p style=\"text-align:center;\">\n          <el-link @click=\"dialogVisible = true\" type=\"primary\"\n            >忘记密码</el-link\n          >\n        </p>\n        <!-- </el-form-item> -->\n        <!-- <el-form-item\n          style=\"text-align: center; border-bottom: none; color: #fff; cursor: pointer;\"\n        >\n          若忘记密码，请联系管理员\n        </el-form-item> -->\n      </el-form>\n    </div>\n    <!-- 重置密码 -->\n    <div class=\"repassword-panel\" v-else>\n      <el-form\n        ref=\"rePasswordFormRef\"\n        :model=\"rePasswordForm\"\n        :rules=\"rules\"\n        @keydown.native.enter.prevent=\"toRepassword\"\n      >\n        <el-form-item prop=\"newPass1\">\n          <el-input\n            v-model=\"rePasswordForm.newPass1\"\n            type=\"password\"\n            maxlength=\"11\"\n            autofocus\n            placeholder=\"设置新密码\"\n          ></el-input>\n        </el-form-item>\n        <el-form-item prop=\"newPass2\">\n          <el-input\n            v-model=\"rePasswordForm.newPass2\"\n            type=\"password\"\n            maxlength=\"11\"\n            placeholder=\"确认新密码\"\n          ></el-input>\n        </el-form-item>\n        <!--submit button-->\n        <el-form-item style=\"margin-top: 40px\">\n          <el-button\n            type=\"primary\"\n            style=\"width: 100%; margin-top: 20px; background: #0076f6;\"\n            @click=\"toRepassword\"\n          >\n            确认修改\n          </el-button>\n        </el-form-item>\n        <el-form-item\n          style=\"text-align: center; border-bottom: none; color: #fff;cursor: pointer;\"\n        >\n          修改完成后，后续登录\n        </el-form-item>\n      </el-form>\n    </div>\n\n    <!-- 忘记密码 -->\n    <el-dialog\n      title=\"修改密码\"\n      :visible.sync=\"dialogVisible\"\n      width=\"600px\"\n      :close-on-click-modal=\"false\"\n      :close-on-press-escape=\"false\"\n      :show-close=\"false\"\n      :lock-scroll=\"false\"\n      center\n    >\n      <div style=\"width:500px;margin:auto;\">\n        <el-form\n          ref=\"formPassRf\"\n          :model=\"formPass\"\n          :rules=\"rulesForm\"\n          label-width=\"130px\"\n          status-icon\n        >\n          <el-form-item label=\"管理员密保手机：\" prop=\"phoneNum\">\n            <el-row :gutter=\"20\">\n              <el-col :span=\"14\"\n                ><el-input\n                  v-model.number=\"formPass.phoneNum\"\n                  autocomplete=\"off\"\n                  disabled\n                ></el-input\n              ></el-col>\n              <el-col :span=\"6\"></el-col>\n            </el-row>\n          </el-form-item>\n          <el-form-item label=\"验证码：\" prop=\"checkNum\">\n            <el-row :gutter=\"20\">\n              <el-col :span=\"14\"\n                ><el-input\n                  v-model.number=\"formPass.checkNum\"\n                  autocomplete=\"off\"\n                ></el-input\n              ></el-col>\n              <el-col :span=\"6\"\n                ><el-button type=\"primary\" @click=\"funGetCode()\">{{\n                  showSecond ? `${second}s` : '发送验证码'\n                }}</el-button></el-col\n              >\n            </el-row>\n          </el-form-item>\n          <el-form-item label=\"新密码：\" prop=\"newPass\">\n            <el-row :gutter=\"20\">\n              <el-col :span=\"14\"\n                ><el-input\n                  type=\"password\"\n                  autocomplete=\"off\"\n                  v-model=\"formPass.newPass\"\n                ></el-input\n              ></el-col>\n              <el-col :span=\"6\"></el-col>\n            </el-row>\n          </el-form-item>\n          <el-form-item label=\"新密码确认：\" prop=\"newPassSec\">\n            <el-row :gutter=\"20\">\n              <el-col :span=\"14\"\n                ><el-input\n                  type=\"password\"\n                  autocomplete=\"off\"\n                  v-model=\"formPass.newPassSec\"\n                ></el-input\n              ></el-col>\n              <el-col :span=\"6\"></el-col>\n            </el-row>\n          </el-form-item>\n        </el-form>\n      </div>\n      <div slot=\"footer\">\n        <el-button @click=\"resetForm('formPassRf')\">取 消</el-button>\n        <el-button type=\"primary\" @click=\"submitForm('formPassRf')\"\n          >确 定</el-button\n        >\n      </div>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\n// import { method } from 'cypress/types/bluebird';\n\nimport { updatePass, getCode, resetForgetPassword } from '../../api/user';\nimport { Row, Col, Form, FormItem, Input, Link } from 'element-ui';\nexport default {\n  name: 'Login',\n  components: {\n    [Form.name]: Form,\n    [FormItem.name]: FormItem,\n    [Input.name]: Input,\n    [Option.name]: Option,\n    [Link.name]: Link,\n    [Row.name]: Row,\n    [Col.name]: Col\n  },\n  data() {\n    // 手机号验证\n    var checkPhoneNum = (rule, value, callback) => {\n      if (!value) {\n        return callback(new Error('手机号码不能为空'));\n      }\n      let phone = /^(((13[0-9]{1})|(15[0-9]{1})|(18[0-9]{1}))+\\d{8})$/;\n      setTimeout(() => {\n        if (!Number.isInteger(value)) {\n          callback(new Error('请输入正确的手机号码'));\n        } else if (value.toString().length == 11) {\n          if (phone.test(value)) {\n            callback();\n          } else {\n            callback(new Error('请输入正确的手机号码'));\n          }\n        } else {\n          callback(new Error('请输入正确的手机号码'));\n        }\n      }, 1000);\n    };\n    // 验证码校验\n    var checkAge = (rule, value, callback) => {\n      if (!value) {\n        return callback(new Error('验证码不能为空'));\n      }\n      setTimeout(() => {\n        if (!Number.isInteger(value)) {\n          callback(new Error('请输入数字值'));\n        } else {\n          if (value.toString().length == 6) {\n            callback();\n          } else {\n            callback(new Error('验证码为六位有效数字'));\n          }\n        }\n      }, 1000);\n    };\n    // 新密码校验\n    var validatePass = (rule, value, callback) => {\n      if (value === '') {\n        callback(new Error('请输入密码'));\n      } else {\n        if (value.toString().length > 5) {\n          if (this.formPass.newPassSec !== '') {\n            this.$refs.formPassRf.validateField('newPassSec');\n          }\n          callback();\n        } else {\n          callback(new Error('密码长度至少为六位'));\n        }\n      }\n    };\n    // 二次输入密码校验\n    var validatePass2 = (rule, value, callback) => {\n      if (value === '') {\n        callback(new Error('请再次输入密码'));\n      } else if (value !== this.formPass.newPass) {\n        callback(new Error('两次输入密码不一致!'));\n      } else {\n        callback();\n      }\n    };\n    return {\n      loginForm: {\n        userName: '',\n        passWord: ''\n      },\n      rePasswordForm: {\n        newPass1: '',\n        newPass2: ''\n      },\n      rules: {\n        username: {\n          required: true,\n          type: 'string',\n          message: '请输入账号',\n          trigger: 'blur'\n        },\n        password: {\n          required: true,\n          type: 'string',\n          pattern: /^.{6,}$/,\n          message: '密码至少6位',\n          trigger: 'blur'\n        },\n        newPass1: {\n          required: true,\n          type: 'string',\n          pattern: /^.{6,}$/,\n          message: '密码至少6位',\n          trigger: 'blur'\n        },\n        newPass2: [\n          {\n            validator: (rule, value, callback) => {\n              if (value === '') {\n                callback(new Error('请再次输入密码'));\n              } else if (value !== this.rePasswordForm.newPass1) {\n                callback(new Error('两次输入密码不一致!'));\n              } else {\n                callback();\n              }\n            },\n            trigger: 'blur'\n          }\n        ]\n      },\n      redirect: undefined,\n      otherQuery: {},\n      isFirstLogin: false,\n      dialogVisible: false,\n      formPass: {\n        phoneNum: '159****0317',\n        checkNum: '',\n        newPass: '',\n        newPassSec: ''\n      },\n      showSecond: false,\n      timer: null,\n      second: 60,\n      rulesForm: {\n        // phoneNum: [{ validator: checkPhoneNum, trigger: 'blur' }],\n        checkNum: [{ validator: checkAge, trigger: 'blur' }],\n        newPass: [{ validator: validatePass, trigger: 'blur' }],\n        newPassSec: [{ validator: validatePass2, trigger: 'blur' }]\n      }\n    };\n  },\n  watch: {\n    $route: {\n      handler: function(route) {\n        const query = route.query;\n        if (query) {\n          this.redirect = query.redirect;\n          this.otherQuery = this.getOtherQuery(query);\n        }\n      },\n      immediate: true\n    }\n  },\n  created() {\n    // 跳转到单点登录页面\n    // location.href = this.$store.state.settings.ssoLoginUrl;\n  },\n  methods: {\n    // 发送验证码\n    funGetCode() {\n      if (this.showSecond) {\n        return;\n      }\n      if (!this.formPass.phoneNum) {\n        this.$message({\n          message: '请填写手机号',\n          type: 'warning'\n        });\n        return;\n      }\n      getCode({ phone: '15968510317' }).then(res => {\n        if (res.status === 200) {\n          this.$message({\n            message: '发送成功',\n            type: 'success'\n          });\n          this.showSecond = true;\n          this.timer = setInterval(() => {\n            this.second -= 1;\n            if (this.second <= 0) {\n              this.timer = null;\n              this.second = 60;\n              this.showSecond = false;\n            }\n          }, 1000);\n        }\n      });\n    },\n    // 忘记密码修改提交\n    submitForm(formName) {\n      this.$refs[formName].validate(valid => {\n        if (valid) {\n          resetForgetPassword({\n            newPass: this.formPass.newPass,\n            code: this.formPass.checkNum\n          })\n            .then(res => {\n              this.$message({\n                message: '新密码设置成功',\n                type: 'success'\n              });\n              this.resetForm('formPassRf');\n            })\n            .catch(res => {});\n        } else {\n          this.$message({\n            message: '请填写完全后提交！',\n            type: 'error'\n          });\n          return false;\n        }\n      });\n    },\n    // 取消则重置\n    resetForm(formName) {\n      this.dialogVisible = false;\n      this.$refs[formName].resetFields();\n    },\n    login() {\n      this.$refs.loginFormRef.validate(async valid => {\n        if (valid) {\n          this.$store\n            .dispatch('user/login', this.loginForm)\n            .then(isFirstLogin => {\n              if (isFirstLogin === true) return (this.isFirstLogin = true);\n              this.$router.push({\n                path: this.redirect || '/',\n                query: this.otherQuery\n              });\n            })\n            .catch(() => {})\n            .finally(() => {\n              this.loading = false;\n            });\n        } else {\n          this.autoFocus();\n        }\n      });\n    },\n    toRepassword() {\n      this.$refs.rePasswordFormRef.validate(valid => {\n        if (valid) {\n          updatePass({\n            newPass: this.rePasswordForm.newPass1,\n            userName: this.loginForm.username\n          })\n            .then(isFirstLogin => {\n              if (isFirstLogin === true) return (this.isFirstLogin = true);\n              this.$router.push({\n                path: this.redirect || '/',\n                query: this.otherQuery\n              });\n            })\n            .catch(() => {})\n            .finally(() => {\n              this.loading = false;\n            });\n        } else {\n          this.autoFocus();\n        }\n      });\n    },\n    getOtherQuery(query) {\n      return Object.keys(query).reduce((acc, cur) => {\n        if (cur !== 'redirect') {\n          acc[cur] = query[cur];\n        }\n        return acc;\n      }, {});\n    },\n    /**\n     * 自动聚焦\n     */\n    autoFocus() {\n      this.$nextTick(_ => {\n        const isError = document.getElementsByClassName('is-error');\n        if (isError.length > 0) {\n          isError[0].querySelector('input').focus();\n          return false;\n        }\n      });\n    }\n  }\n};\n</script>\n\n<style lang=\"less\" scoped>\n.app-container {\n  position: absolute;\n  left: 0;\n  top: 0;\n  right: 0;\n  bottom: 0;\n  min-height: 820px;\n  min-width: 820px;\n  background-image: url(../../assets/images/login_bg.png);\n  background-size: cover;\n  background-repeat: no-repeat;\n  .login-panel,\n  .repassword-panel {\n    position: relative;\n    box-sizing: border-box;\n    margin: 142px auto 220px;\n    width: 680px;\n    height: 540px;\n    padding: 64px 0 52px;\n    display: flex;\n    flex-direction: column;\n    // justify-content: center;\n    align-items: center;\n    background-color: rgba(0, 0, 0, 0.44);\n    border-radius: 10px;\n\n    .login-txt {\n      font-size: 36px;\n      color: #ffff;\n      margin-bottom: 64px;\n    }\n    .el-form-item {\n      width: 376px;\n      // margin-bottom: 16px;\n    }\n  }\n  .repassword-panel {\n    padding: 118px;\n  }\n}\n</style>\n"]}]}