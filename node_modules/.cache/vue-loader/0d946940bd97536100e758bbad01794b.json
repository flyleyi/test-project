{"remainingRequest":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/fuyueyi/Desktop/practice/mutilwap/src/pages/visitor-h5/views/verify-visitor/UrgencyArrive.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/src/pages/visitor-h5/views/verify-visitor/UrgencyArrive.vue","mtime":1645178321203},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/fuyueyi/Desktop/practice/mutilwap/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IGZvcm1hdGVEYXRlIH0gZnJvbSAnQC9wYWdlcy92aXNpdG9yLWg1L3BsdWdpbnMvY29tbW9uL3V0aWxzJzsKaW1wb3J0IGNvbmZpcm1Nb2RhbCBmcm9tICcuL2NvbXBvbmVudHMvQ29uZmlybU1vZGFsJzsKaW1wb3J0IHRpbWVQaWNrZXIgZnJvbSAnLi9jb21wb25lbnRzL1RpbWVTZWxlY3QnOwppbXBvcnQgaW1hZ2VVcGxvYWQgZnJvbSAnLi9jb21wb25lbnRzL0ltYWdlVXBsb2FkJzsKaW1wb3J0IHsgYWRkVXJnZW50VmlzaXQgfSBmcm9tICdAL3BhZ2VzL3Zpc2l0b3ItaDUvYXBpL3ZlcmlmeSc7CmV4cG9ydCBkZWZhdWx0IHsKICBjb21wb25lbnRzOiB7IGNvbmZpcm1Nb2RhbCwgdGltZVBpY2tlciwgaW1hZ2VVcGxvYWQgfSwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgaXNTYXZlOiBmYWxzZSwKICAgICAgc2hvd1BhbmVsOiBmYWxzZSwKICAgICAgbGFiZWxMaXN0OiBbCiAgICAgICAgeyB0aXRsZTogJ+WFrOWuiScsIHZhbHVlOiAnMicgfSwKICAgICAgICB7IHRpdGxlOiAn5Lqk6K2mJywgdmFsdWU6ICczJyB9LAogICAgICAgIHsgdGl0bGU6ICfmtojpmLInLCB2YWx1ZTogJzEnIH0sCiAgICAgICAgeyB0aXRsZTogJ+WFtuS7licsIHZhbHVlOiAnMCcgfQogICAgICBdLAogICAgICByZWFzb25MaXN0OiBbCiAgICAgICAgeyB0aXRsZTogJ+S+i+ihjOajgOafpScsIHZhbHVlOiAnMScgfSwKICAgICAgICB7IHRpdGxlOiAn5qGI5Lu2JywgdmFsdWU6ICcyJyB9CiAgICAgIF0sCiAgICAgIGZvcm1PYmo6IHsKICAgICAgICB2aXNpdERlcGFydG1lbnQ6ICcyJywKICAgICAgICBudW1iZXI6ICcnLAogICAgICAgIHJlbWFya3M6ICcnLAogICAgICAgIHZpc2l0VGltZTogbmV3IERhdGUoKS5nZXRUaW1lKCksCiAgICAgICAgdXJsOiBbXQogICAgICB9CiAgICB9OwogIH0sCiAgbWV0aG9kczogewogICAgaW5pdCgpIHsKICAgICAgdGhpcy5mb3JtT2JqID0gewogICAgICAgIHZpc2l0RGVwYXJ0bWVudDogJzInLAogICAgICAgIG51bWJlcjogJycsCiAgICAgICAgcmVtYXJrczogJycsCiAgICAgICAgdmlzaXRUaW1lOiBuZXcgRGF0ZSgpLmdldFRpbWUoKSwKICAgICAgICB1cmw6IFtdCiAgICAgIH07CiAgICAgIHRoaXMuaXNTYXZlID0gZmFsc2U7CiAgICAgIHRoaXMuJHJlZnMudXJnZW5jeVRpbWUuZGF0ZSA9IGZvcm1hdGVEYXRlKG5ldyBEYXRlKCksIDQpOwogICAgICB0aGlzLiRyZWZzLnVyZ2VuY3lUaW1lLnNlbGVjdGVkVGltZSA9IGZvcm1hdGVEYXRlKG5ldyBEYXRlKCksIDUpOwogICAgfSwKICAgIGNoYW5nZUxhYmVsKGl0ZW0pIHsKICAgICAgdGhpcy5mb3JtT2JqLnZpc2l0RGVwYXJ0bWVudCA9IGl0ZW0udmFsdWU7CiAgICB9LAogICAgc2VsZWN0UmVhc29uKGl0ZW0pIHsKICAgICAgdGhpcy5mb3JtT2JqLnJlbWFya3MgPSBpdGVtLnRpdGxlOwogICAgfSwKICAgIGdldFRpbWUoZGF0ZSkgewogICAgICBkYXRlID0gZGF0ZS5yZXBsYWNlKC8tL2csICcvJyk7CiAgICAgIHRoaXMuZm9ybU9iai52aXNpdFRpbWUgPSBuZXcgRGF0ZShkYXRlKS5nZXRUaW1lKCk7CiAgICB9LAogICAgZ2V0VXJsKHZhbHVlKSB7CiAgICAgIHRoaXMuZm9ybU9iai51cmwgPSB2YWx1ZTsKICAgIH0sCiAgICBzYXZlKCkgewogICAgICB0aGlzLmlzU2F2ZSA9IHRydWU7CiAgICAgIHRoaXMuJHJlZnMudXJnZW5jeUZvcm0udmFsaWRhdGUoKS50aGVuKHJlcyA9PiB7CiAgICAgICAgaWYgKCF0aGlzLmZvcm1PYmoudmlzaXRUaW1lKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGFkZFVyZ2VudFZpc2l0KHRoaXMuZm9ybU9iaikKICAgICAgICAgIC50aGVuKHJlcyA9PiB7CiAgICAgICAgICAgIGlmIChyZXMuc3VjY2VzcykgewogICAgICAgICAgICAgIHRoaXMuc2hvd1BhbmVsID0gdHJ1ZTsKICAgICAgICAgICAgICB0aGlzLmluaXQoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfSkKICAgICAgICAgIC5jYXRjaChlID0+IHsKICAgICAgICAgICAgdGhpcy4kdG9hc3QubG9hZGluZyh7CiAgICAgICAgICAgICAgbWVzc2FnZTogZS5kYXRhLm1lc3NhZ2UKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9KTsKICAgICAgfSk7CiAgICB9LAogICAgY2xvc2VQYW5lbCgpIHsKICAgICAgdGhpcy5zaG93UGFuZWwgPSBmYWxzZTsKICAgICAgdGhpcy4kcm91dGVyLnB1c2goJy92ZXJpZnktbGlzdCcpOwogICAgfQogIH0sCiAgbW91bnRlZCgpIHsKICAgIHRoaXMuJHJlZnMudXJnZW5jeVRpbWUuZGF0ZSA9IGZvcm1hdGVEYXRlKG5ldyBEYXRlKCksIDQpOwogICAgdGhpcy4kcmVmcy51cmdlbmN5VGltZS5zZWxlY3RlZFRpbWUgPSBmb3JtYXRlRGF0ZShuZXcgRGF0ZSgpLCA1KTsKICB9Cn07Cg=="},{"version":3,"sources":["UrgencyArrive.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6FA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"UrgencyArrive.vue","sourceRoot":"src/pages/visitor-h5/views/verify-visitor","sourcesContent":["<template>\n  <div class=\"urgency-wrapper\">\n    <van-form ref=\"urgencyForm\">\n      <div class=\"form-line\">\n        <div class=\"form-title\">访客部门</div>\n        <ul class=\"span-tab\">\n          <li\n            :class=\"item.value == formObj.visitDepartment ? 'active' : ''\"\n            v-for=\"item in labelList\"\n            :key=\"item.value\"\n            @click=\"changeLabel(item)\"\n          >\n            {{ item.title }}\n          </li>\n        </ul>\n      </div>\n      <div class=\"form-line\">\n        <div class=\"form-title\">到访人数</div>\n        <van-field\n          required\n          type=\"number\"\n          class=\"form-input\"\n          name=\"number\"\n          v-model=\"formObj.number\"\n          placeholder=\"请输入到访人数\"\n          :rules=\"[\n            {\n              required: true,\n              message: '到访人数小于等于99',\n              pattern: /^([1-9]|[1-9]\\d)$/\n            }\n          ]\"\n        />\n      </div>\n      <div class=\"form-line form-time\">\n        <span class=\"form-required\">*</span>\n        <div class=\"form-title\">到访时间</div>\n        <time-picker\n          ref=\"urgencyTime\"\n          class=\"form-input\"\n          @setDateTime=\"getTime\"\n        ></time-picker>\n        <span v-if=\"!formObj.visitTime && isSave\" class=\"form-error\"\n          >到访时间未填写</span\n        >\n      </div>\n      <div class=\"form-line \">\n        <div class=\"form-title\">备注</div>\n        <van-field\n          required\n          class=\"form-textarea\"\n          rows=\"4\"\n          autosize\n          type=\"textarea\"\n          v-model=\"formObj.remarks\"\n          maxlength=\"50\"\n          placeholder=\"请填写拜访单位、拜访人员及拜访事由（最多50个字）\"\n          :rules=\"[{ required: true, message: '' }]\"\n        />\n        <!--   <div class=\"example\">\n          <ul class=\"example-ul\">\n            <li\n              @click=\"selectReason(item)\"\n              v-for=\"item in reasonList\"\n              :key=\"item.value\"\n            >\n              {{ item.title }}\n            </li>\n          </ul>\n        </div> -->\n      </div>\n\n      <div class=\"form-line\">\n        <image-upload\n          :imageShowList=\"formObj.url\"\n          @backUrlData=\"getUrl($event)\"\n        ></image-upload>\n      </div>\n\n      <div class=\"btn-save\">\n        <van-button type=\"info\" size=\"large\" @click=\"save\">提交</van-button>\n      </div>\n    </van-form>\n\n    <confirm-modal\n      :showPanel=\"showPanel\"\n      title=\"提交完成\"\n      @closePanel=\"closePanel\"\n    ></confirm-modal>\n  </div>\n</template>\n\n<script>\nimport { formateDate } from '@/pages/visitor-h5/plugins/common/utils';\nimport confirmModal from './components/ConfirmModal';\nimport timePicker from './components/TimeSelect';\nimport imageUpload from './components/ImageUpload';\nimport { addUrgentVisit } from '@/pages/visitor-h5/api/verify';\nexport default {\n  components: { confirmModal, timePicker, imageUpload },\n  data() {\n    return {\n      isSave: false,\n      showPanel: false,\n      labelList: [\n        { title: '公安', value: '2' },\n        { title: '交警', value: '3' },\n        { title: '消防', value: '1' },\n        { title: '其他', value: '0' }\n      ],\n      reasonList: [\n        { title: '例行检查', value: '1' },\n        { title: '案件', value: '2' }\n      ],\n      formObj: {\n        visitDepartment: '2',\n        number: '',\n        remarks: '',\n        visitTime: new Date().getTime(),\n        url: []\n      }\n    };\n  },\n  methods: {\n    init() {\n      this.formObj = {\n        visitDepartment: '2',\n        number: '',\n        remarks: '',\n        visitTime: new Date().getTime(),\n        url: []\n      };\n      this.isSave = false;\n      this.$refs.urgencyTime.date = formateDate(new Date(), 4);\n      this.$refs.urgencyTime.selectedTime = formateDate(new Date(), 5);\n    },\n    changeLabel(item) {\n      this.formObj.visitDepartment = item.value;\n    },\n    selectReason(item) {\n      this.formObj.remarks = item.title;\n    },\n    getTime(date) {\n      date = date.replace(/-/g, '/');\n      this.formObj.visitTime = new Date(date).getTime();\n    },\n    getUrl(value) {\n      this.formObj.url = value;\n    },\n    save() {\n      this.isSave = true;\n      this.$refs.urgencyForm.validate().then(res => {\n        if (!this.formObj.visitTime) {\n          return;\n        }\n        addUrgentVisit(this.formObj)\n          .then(res => {\n            if (res.success) {\n              this.showPanel = true;\n              this.init();\n            }\n          })\n          .catch(e => {\n            this.$toast.loading({\n              message: e.data.message\n            });\n          });\n      });\n    },\n    closePanel() {\n      this.showPanel = false;\n      this.$router.push('/verify-list');\n    }\n  },\n  mounted() {\n    this.$refs.urgencyTime.date = formateDate(new Date(), 4);\n    this.$refs.urgencyTime.selectedTime = formateDate(new Date(), 5);\n  }\n};\n</script>\n\n<style lang=\"less\" scoped>\n/deep/ .van-cell--required::before {\n  left: -11px;\n  top: -30px;\n}\n/deep/ .form-detail .van-cell--required::before {\n  top: 8px;\n}\n/deep/ .van-field__error-message {\n  margin-top: 7px;\n  margin-left: -12px;\n  font-weight: 400;\n  color: #ff5756;\n}\n.urgency-wrapper {\n  padding-top: 15px;\n}\n.form-line {\n  padding: 0 16px;\n  box-sizing: border-box;\n  position: relative;\n  margin-bottom: 16px;\n  .form-error {\n    position: absolute;\n    bottom: -18px;\n    font-weight: 400;\n    color: #ff5756;\n    font-size: 12px;\n  }\n  &.form-time {\n    .form-input {\n      padding-top: 0;\n    }\n  }\n  .form-title {\n    font-size: 15px;\n    font-family: PingFangSC-Regular, PingFang SC;\n    font-weight: 400;\n    color: rgba(0, 0, 0, 0.85);\n    line-height: 21px;\n    margin-bottom: 10px;\n  }\n  .form-input,\n  .form-textarea {\n    width: 343px;\n    height: 40px;\n    background: #ffffff;\n    border-radius: 5px;\n    border: 1px solid #abbfd6;\n    padding-top: 7px;\n  }\n\n  .form-textarea {\n    height: 130px;\n  }\n\n  .span-tab {\n    display: flex;\n    li {\n      width: 82px;\n      height: 40px;\n      line-height: 40px;\n      background: #ffffff;\n      border-radius: 5px;\n      border: 1px solid #abbfd6;\n      margin-right: 5px;\n      text-align: center;\n      &.active {\n        border: 1px solid #3388ff;\n        background: rgba(51, 136, 255, 0.08);\n      }\n    }\n  }\n\n  .example-ul {\n    display: flex;\n    position: absolute;\n    bottom: 10px;\n    left: 24px;\n    li {\n      background: #ffffff;\n      border-radius: 2px;\n      border: 1px solid #abbfd6;\n      padding: 4px 9px;\n      border-radius: 2px;\n      margin-right: 5px;\n    }\n  }\n}\n\n.btn-save {\n  width: 350px;\n  margin: 0 auto;\n}\n\n.form-required {\n  position: absolute;\n  left: 5px;\n  top: 3px;\n  color: red;\n}\n</style>\n"]}]}