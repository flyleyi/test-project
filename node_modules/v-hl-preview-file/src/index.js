import Viewer from 'v-viewer';
import 'viewerjs/dist/viewer.css';
import PreviewFile from './components/preview-file.vue';

let instance;

export default {
  install (Vue, options) {
    if (Vue.prototype.$isServer) return;
    if (!instance) {
      // 创建组件实例的构造器
      const PreviewFileConstructor = Vue.extend(PreviewFile);
      PreviewFileConstructor.use(Viewer);
      // 将组件实例化挂在到根路径
      instance = new PreviewFileConstructor({});
      instance.$mount();
      document.body.appendChild(instance.$el);
    }
    Vue.prototype.$previewFile || Object.defineProperty(Vue.prototype, '$previewFile', {
      value: instance.init,
    });
  }
}

